function getURIparam(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regexS="[\\?&]"+name+"=([^&#]*)",regex=new RegExp(regexS),results=regex.exec(window.location.href);return null==results?"":results[1]}function SpaceMonitorCtrl($scope){$scope.$on("Add_Space",function(event,message){console.log("got new space",message),$scope.$apply()})}!function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);return"function"===type||jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0!==not})}function sibling(cur,dir){do cur=cur[dir];while(cur&&1!==cur.nodeType);return cur}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function detach(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1)):(document.detachEvent("onreadystatechange",completed),window.detachEvent("onload",completed))}function completed(){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(detach(),jQuery.ready())}function dataAttr(elem,key,data){if(void 0===data&&1===elem.nodeType){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();if(data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else data=void 0}return data}function isEmptyDataObject(obj){var name;for(name in obj)if(("data"!==name||!jQuery.isEmptyObject(obj[name]))&&"toJSON"!==name)return!1;return!0}function internalData(elem,name,data,pvt){if(jQuery.acceptData(elem)){var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if(id&&cache[id]&&(pvt||cache[id].data)||void 0!==data||"string"!=typeof name)return id||(id=isNode?elem[internalKey]=deletedIds.pop()||jQuery.guid++:internalKey),cache[id]||(cache[id]=isNode?{}:{toJSON:jQuery.noop}),("object"==typeof name||"function"==typeof name)&&(pvt?cache[id]=jQuery.extend(cache[id],name):cache[id].data=jQuery.extend(cache[id].data,name)),thisCache=cache[id],pvt||(thisCache.data||(thisCache.data={}),thisCache=thisCache.data),void 0!==data&&(thisCache[jQuery.camelCase(name)]=data),"string"==typeof name?(ret=thisCache[name],null==ret&&(ret=thisCache[jQuery.camelCase(name)])):ret=thisCache,ret}}function internalRemoveData(elem,name,pvt){if(jQuery.acceptData(elem)){var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(cache[id]){if(name&&(thisCache=pvt?cache[id]:cache[id].data)){jQuery.isArray(name)?name=name.concat(jQuery.map(name,jQuery.camelCase)):name in thisCache?name=[name]:(name=jQuery.camelCase(name),name=name in thisCache?[name]:name.split(" ")),i=name.length;for(;i--;)delete thisCache[name[i]];if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache))return}(pvt||(delete cache[id].data,isEmptyDataObject(cache[id])))&&(isNode?jQuery.cleanData([elem],!0):support.deleteExpando||cache!=cache.window?delete cache[id]:cache[id]=null)}}}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement)for(;list.length;)safeFrag.createElement(list.pop());return safeFrag}function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):void 0;if(!found)for(found=[],elems=context.childNodes||context;null!=(elem=elems[i]);i++)!tag||jQuery.nodeName(elem,tag)?found.push(elem):jQuery.merge(found,getAll(elem,tag));return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){rcheckableType.test(elem.type)&&(elem.defaultChecked=elem.checked)}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==jQuery.find.attr(elem,"type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var elem,i=0;null!=(elem=elems[i]);i++)jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){if(1===dest.nodeType&&jQuery.hasData(src)){var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle,curData.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}curData.data&&(curData.data=jQuery.extend({},curData.data))}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(1===dest.nodeType){if(nodeName=dest.nodeName.toLowerCase(),!support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events)jQuery.removeEvent(dest,e,data.handle);dest.removeAttribute(jQuery.expando)}"script"===nodeName&&dest.text!==src.text?(disableScript(dest).text=src.text,restoreScript(dest)):"object"===nodeName?(dest.parentNode&&(dest.outerHTML=src.outerHTML),support.html5Clone&&src.innerHTML&&!jQuery.trim(dest.innerHTML)&&(dest.innerHTML=src.innerHTML)):"input"===nodeName&&rcheckableType.test(src.type)?(dest.defaultChecked=dest.checked=src.checked,dest.value!==src.value&&(dest.value=src.value)):"option"===nodeName?dest.defaultSelected=dest.selected=src.defaultSelected:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}}function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=(iframe[0].contentWindow||iframe[0].contentDocument).document,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function addGetHookIf(conditionFn,hookFn){return{get:function(){var condition=conditionFn();if(null!=condition)return condition?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(style,name){if(name in style)return name;for(var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=jQuery._data(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName)))):(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,attrs={height:type},i=0;for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),checkDisplay="none"===display?jQuery._data(elem,"olddisplay")||defaultDisplay(elem.nodeName):display,"inline"===checkDisplay&&"none"===jQuery.css(elem,"float")&&(support.inlineBlockNeedsLayout&&"inline"!==defaultDisplay(elem.nodeName)?style.zoom=1:style.display="inline-block")),opts.overflow&&(style.overflow="hidden",support.shrinkWrapBlocks()||anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else display=void 0;if(jQuery.isEmptyObject(orig))"inline"===("none"===display?defaultDisplay(elem.nodeName):display)&&(style.display=display);else{dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=jQuery._data(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType.charAt(0)?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType?elem.defaultView||elem.parentWindow:!1}var deletedIds=[],slice=deletedIds.slice,concat=deletedIds.concat,push=deletedIds.push,indexOf=deletedIds.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},version="1.11.2",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?0>num?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:deletedIds.sort,splice:deletedIds.splice},jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray||function(obj){return"array"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj==obj.window},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)+1>=0},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},isPlainObject:function(obj){var key;if(!obj||"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(support.ownLast)for(key in obj)return hasOwn.call(obj,key);for(key in obj);return void 0===key||hasOwn.call(obj,key)},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(data){data&&jQuery.trim(data)&&(window.execScript||function(data){window.eval.call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){var len;if(arr){if(indexOf)return indexOf.call(arr,elem,i);for(len=arr.length,i=i?0>i?Math.max(0,len+i):i:0;len>i;i++)if(i in arr&&arr[i]===elem)return i}return-1},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;)first[i++]=second[j++];if(len!==len)for(;void 0!==second[j];)first[i++]=second[j++];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;length>i;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):void 0},now:function(){return+new Date},support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],nodeType=context.nodeType,"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&documentIsHTML){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=1!==nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&"undefined"!=typeof context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;
for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;len>i;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,parent=doc.defaultView,parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",unloadHandler,!1):parent.attachEvent&&parent.attachEvent("onunload",unloadHandler)),documentIsHTML=!isXML(doc),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node="undefined"!=typeof elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return"undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\f]' msallowcapture=''><option selected=''></option></select>",div.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),div.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),!(!support.matchesSelector||!documentIsHTML||rbuggyMatches&&rbuggyMatches.test(expr)||rbuggyQSA&&rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||"undefined"!=typeof elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,document=window.document,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}if(elem=document.getElementById(match[2]),elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1,this[0]=elem}return this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?"undefined"!=typeof rootjQuery.ready?rootjQuery.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){for(var matched=[],cur=elem[dir];cur&&9!==cur.nodeType&&(void 0===until||1!==cur.nodeType||!jQuery(cur).is(until));)1===cur.nodeType&&matched.push(cur),cur=cur[dir];return matched},sibling:function(n,elem){for(var r=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&r.push(n);return r}}),jQuery.fn.extend({has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;len>i;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){return elem?"string"==typeof elem?jQuery.inArray(this[0],jQuery(elem)):jQuery.inArray(elem.jquery?elem[0]:elem,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(ret=jQuery.filter(selector,ret)),this.length>1&&(guaranteedUnique[name]||(ret=jQuery.unique(ret)),rparentsprev.test(name)&&(ret=ret.reverse())),this.pushStack(ret)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=void 0,this},disabled:function(){return!list},lock:function(){return stack=void 0,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){if(wait===!0?!--jQuery.readyWait:!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready);jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.triggerHandler&&(jQuery(document).triggerHandler("ready"),jQuery(document).off("ready")))
}}}),jQuery.ready.promise=function(obj){if(!readyList)if(readyList=jQuery.Deferred(),"complete"===document.readyState)setTimeout(jQuery.ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1);else{document.attachEvent("onreadystatechange",completed),window.attachEvent("onload",completed);var top=!1;try{top=null==window.frameElement&&document.documentElement}catch(e){}top&&top.doScroll&&!function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach(),jQuery.ready()}}()}return readyList.promise(obj)};var i,strundefined="undefined";for(i in jQuery(support))break;support.ownLast="0"!==i,support.inlineBlockNeedsLayout=!1,jQuery(function(){var val,div,body,container;body=document.getElementsByTagName("body")[0],body&&body.style&&(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),typeof div.style.zoom!==strundefined&&(div.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",support.inlineBlockNeedsLayout=val=3===div.offsetWidth,val&&(body.style.zoom=1)),body.removeChild(container))}),function(){var div=document.createElement("div");if(null==support.deleteExpando){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}div=null}(),jQuery.acceptData=function(elem){var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],nodeType=+elem.nodeType||1;return 1!==nodeType&&9!==nodeType?!1:!noData||noData!==!0&&elem.getAttribute("classid")===noData};var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){return elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando],!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,!0)},_removeData:function(elem,name){return internalRemoveData(elem,name,!0)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=jQuery.data(elem),1===elem.nodeType&&!jQuery._data(elem,"parsedAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));jQuery._data(elem,"parsedAttrs",!0)}return data}return"object"==typeof key?this.each(function(){jQuery.data(this,key)}):arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):void 0},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=jQuery._data(elem,type),data&&(!queue||jQuery.isArray(data)?queue=jQuery._data(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue"),jQuery._removeData(elem,key)})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=jQuery._data(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;length>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},rcheckableType=/^(?:checkbox|radio)$/i;!function(){var input=document.createElement("input"),div=document.createElement("div"),fragment=document.createDocumentFragment();if(div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",support.leadingWhitespace=3===div.firstChild.nodeType,support.tbody=!div.getElementsByTagName("tbody").length,support.htmlSerialize=!!div.getElementsByTagName("link").length,support.html5Clone="<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML,input.type="checkbox",input.checked=!0,fragment.appendChild(input),support.appendChecked=input.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue,fragment.appendChild(div),div.innerHTML="<input type='radio' checked='checked' name='t'/>",support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,support.noCloneEvent=!0,div.attachEvent&&(div.attachEvent("onclick",function(){support.noCloneEvent=!1}),div.cloneNode(!0).click()),null==support.deleteExpando){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}}(),function(){var i,eventName,div=document.createElement("div");for(i in{submit:!0,change:!0,focusin:!0})eventName="on"+i,(support[i+"Bubbles"]=eventName in window)||(div.setAttribute(eventName,"t"),support[i+"Bubbles"]=div.attributes[eventName].expando===!1);div=null}();var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(elemData){for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery===strundefined||e&&jQuery.event.triggered===e.type?void 0:jQuery.event.dispatch.apply(eventHandle.elem,arguments)},eventHandle.elem=elem),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||(elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent&&elem.attachEvent("on"+type,eventHandle))),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0);elem=null}},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,jQuery._removeData(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&jQuery.acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());if(event.type=type,!onlyHandlers&&!event.isDefaultPrevented()&&(!special._default||special._default.apply(eventPath.pop(),data)===!1)&&jQuery.acceptData(elem)&&ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)}return event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.namespace_re||event.namespace_re.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!=this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=originalEvent.srcElement||document),3===event.target.nodeType&&(event.target=event.target.parentNode),event.metaKey=!!event.metaKey,fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),!event.relatedTarget&&fromElement&&(event.relatedTarget=fromElement===event.target?original.toElement:fromElement),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return jQuery.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)}:function(elem,type,handle){var name="on"+type;elem.detachEvent&&(typeof elem[name]===strundefined&&(elem[name]=null),elem.detachEvent(name,handle))},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.returnValue===!1?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),support.submitBubbles||(jQuery.event.special.submit={setup:function(){return jQuery.nodeName(this,"form")?!1:void jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:void 0;form&&!jQuery._data(form,"submitBubbles")&&(jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=!0}),jQuery._data(form,"submitBubbles",!0))})},postDispatch:function(event){event._submit_bubble&&(delete event._submit_bubble,this.parentNode&&!event.isTrigger&&jQuery.event.simulate("submit",this.parentNode,event,!0))},teardown:function(){return jQuery.nodeName(this,"form")?!1:void jQuery.event.remove(this,"._submit")}}),support.changeBubbles||(jQuery.event.special.change={setup:function(){return rformElems.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(jQuery.event.add(this,"propertychange._change",function(event){"checked"===event.originalEvent.propertyName&&(this._just_changed=!0)}),jQuery.event.add(this,"click._change",function(event){this._just_changed&&!event.isTrigger&&(this._just_changed=!1),jQuery.event.simulate("change",this,event,!0)})),!1):void jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")&&(jQuery.event.add(elem,"change._change",function(event){!this.parentNode||event.isSimulated||event.isTrigger||jQuery.event.simulate("change",this.parentNode,event,!0)}),jQuery._data(elem,"changeBubbles",!0))})},handle:function(event){var elem=event.target;return this!==elem||event.isSimulated||event.isTrigger||"radio"!==elem.type&&"checkbox"!==elem.type?event.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return jQuery.event.remove(this,"._change"),!rformElems.test(this.nodeName)}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix);attaches||doc.addEventListener(orig,handler,!0),jQuery._data(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix)-1;attaches?jQuery._data(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),jQuery._removeData(doc,fix))}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")?clone=elem.cloneNode(!0):(fragmentDiv.innerHTML=elem.outerHTML,fragmentDiv.removeChild(clone=fragmentDiv.firstChild)),!(support.noCloneEvent&&support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0;null!=(node=srcElements[i]);++i)destElements[i]&&fixCloneNodeIssues(node,destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0;null!=(node=srcElements[i]);i++)cloneCopyEvent(node,destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),destElements=srcElements=node=null,clone},buildFragment:function(elems,context,scripts,selection){for(var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||safe.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)&&nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0])),!support.tbody)for(elem="table"!==tag||rtbody.test(elem)?"<table>"!==wrap[1]||rtbody.test(elem)?0:tmp:tmp.firstChild,j=elem&&elem.childNodes.length;j--;)jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length&&elem.removeChild(tbody);for(jQuery.merge(nodes,tmp.childNodes),tmp.textContent="";tmp.firstChild;)tmp.removeChild(tmp.firstChild);tmp=safe.lastChild}else nodes.push(context.createTextNode(elem));for(tmp&&safe.removeChild(tmp),support.appendChecked||jQuery.grep(getAll(nodes,"input"),fixDefaultChecked),i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(safe.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return tmp=null,safe},cleanData:function(elems,acceptData){for(var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=support.deleteExpando,special=jQuery.event.special;null!=(elem=elems[i]);i++)if((acceptData||jQuery.acceptData(elem))&&(id=elem[internalKey],data=id&&cache[id])){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);cache[id]&&(delete cache[id],deleteExpando?delete elem[internalKey]:typeof elem.removeAttribute!==strundefined?elem.removeAttribute(internalKey):elem[internalKey]=null,deletedIds.push(id))}}}),jQuery.fn.extend({text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++){for(1===elem.nodeType&&jQuery.cleanData(getAll(elem,!1));elem.firstChild;)elem.removeChild(elem.firstChild);elem.options&&jQuery.nodeName(elem,"select")&&(elem.options.length=0)}return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value)return 1===elem.nodeType?elem.innerHTML.replace(rinlinejQuery,""):void 0;if(!("string"!=typeof value||rnoInnerhtml.test(value)||!support.htmlSerialize&&rnoshimcache.test(value)||!support.leadingWhitespace&&rleadingWhitespace.test(value)||wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()])){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];return this.domManip(arguments,function(elem){arg=this.parentNode,jQuery.cleanData(getAll(this)),arg&&arg.replaceChild(elem,this)}),arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,"")));fragment=first=null}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={};!function(){var shrinkWrapBlocksVal;support.shrinkWrapBlocks=function(){if(null!=shrinkWrapBlocksVal)return shrinkWrapBlocksVal;shrinkWrapBlocksVal=!1;var div,body,container;return body=document.getElementsByTagName("body")[0],body&&body.style?(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),typeof div.style.zoom!==strundefined&&(div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",div.appendChild(document.createElement("div")).style.width="5px",shrinkWrapBlocksVal=3!==div.offsetWidth),body.removeChild(container),shrinkWrapBlocksVal):void 0}}();var getStyles,curCSS,rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),rposition=/^(top|right|bottom|left)$/;
window.getComputedStyle?(getStyles=function(elem){return elem.ownerDocument.defaultView.opener?elem.ownerDocument.defaultView.getComputedStyle(elem,null):window.getComputedStyle(elem,null)},curCSS=function(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:void 0,computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0===ret?ret:ret+""}):document.documentElement.currentStyle&&(getStyles=function(elem){return elem.currentStyle},curCSS=function(elem,name,computed){var left,rs,rsLeft,ret,style=elem.style;return computed=computed||getStyles(elem),ret=computed?computed[name]:void 0,null==ret&&style&&style[name]&&(ret=style[name]),rnumnonpx.test(ret)&&!rposition.test(name)&&(left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rsLeft&&(rs.left=elem.currentStyle.left),style.left="fontSize"===name?"1em":ret,ret=style.pixelLeft+"px",style.left=left,rsLeft&&(rs.left=rsLeft)),void 0===ret?ret:ret+""||"auto"}),function(){function computeStyleTests(){var div,body,container,contents;body=document.getElementsByTagName("body")[0],body&&body.style&&(div=document.createElement("div"),container=document.createElement("div"),container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(container).appendChild(div),div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",pixelPositionVal=boxSizingReliableVal=!1,reliableMarginRightVal=!0,window.getComputedStyle&&(pixelPositionVal="1%"!==(window.getComputedStyle(div,null)||{}).top,boxSizingReliableVal="4px"===(window.getComputedStyle(div,null)||{width:"4px"}).width,contents=div.appendChild(document.createElement("div")),contents.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",contents.style.marginRight=contents.style.width="0",div.style.width="1px",reliableMarginRightVal=!parseFloat((window.getComputedStyle(contents,null)||{}).marginRight),div.removeChild(contents)),div.innerHTML="<table><tr><td></td><td>t</td></tr></table>",contents=div.getElementsByTagName("td"),contents[0].style.cssText="margin:0;border:0;padding:0;display:none",reliableHiddenOffsetsVal=0===contents[0].offsetHeight,reliableHiddenOffsetsVal&&(contents[0].style.display="",contents[1].style.display="none",reliableHiddenOffsetsVal=0===contents[0].offsetHeight),body.removeChild(container))}var div,style,a,pixelPositionVal,boxSizingReliableVal,reliableHiddenOffsetsVal,reliableMarginRightVal;div=document.createElement("div"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],style=a&&a.style,style&&(style.cssText="float:left;opacity:.5",support.opacity="0.5"===style.opacity,support.cssFloat=!!style.cssFloat,div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,support.boxSizing=""===style.boxSizing||""===style.MozBoxSizing||""===style.WebkitBoxSizing,jQuery.extend(support,{reliableHiddenOffsets:function(){return null==reliableHiddenOffsetsVal&&computeStyleTests(),reliableHiddenOffsetsVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computeStyleTests(),boxSizingReliableVal},pixelPosition:function(){return null==pixelPositionVal&&computeStyleTests(),pixelPositionVal},reliableMarginRight:function(){return null==reliableMarginRightVal&&computeStyleTests(),reliableMarginRightVal}}))}(),jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;if(name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];if(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),null!=value&&value===value&&("number"!==type||jQuery.cssNumber[origName]||(value+="px"),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),!(hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra)))))try{style[name]=value}catch(e){}}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?rdisplayswap.test(jQuery.css(elem,"display"))&&0===elem.offsetWidth?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),support.opacity||(jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+100*value+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1,(value>=1||""===value)&&""===jQuery.trim(filter.replace(ralpha,""))&&style.removeAttribute&&(style.removeAttribute("filter"),""===value||currentStyle&&!currentStyle.filter)||(style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity)}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.pos=eased=this.options.duration?jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||jQuery._data(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},function(){var input,div,select,a,opt;div=document.createElement("div"),div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=div.getElementsByTagName("a")[0],select=document.createElement("select"),opt=select.appendChild(document.createElement("option")),input=div.getElementsByTagName("input")[0],a.style.cssText="top:1px",support.getSetAttribute="t"!==div.className,support.style=/top/.test(a.getAttribute("style")),support.hrefNormalized="/a"===a.getAttribute("href"),support.checkOn=!!input.value,support.optSelected=opt.selected,support.enctype=!!document.createElement("form").enctype,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.setAttribute("value",""),support.input=""===input.getAttribute("value"),input.value="t",input.setAttribute("type","radio"),support.radioValue="t"===input.value}();var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],!(!option.selected&&i!==index||(support.optDisabled?option.disabled:null!==option.getAttribute("disabled"))||option.parentNode.disabled&&jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)if(option=options[i],jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0)try{option.selected=optionSet=!0}catch(_){option.scrollHeight}else option.selected=!1;return optionSet||(elem.selectedIndex=-1),options}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=support.getSetAttribute,getSetInput=support.input;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret):null!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):void jQuery.removeAttr(elem,name))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)?getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem[propName]=!1:elem[jQuery.camelCase("default-"+name)]=elem[propName]=!1:jQuery.attr(elem,name,""),elem.removeAttribute(getSetAttribute?name:propName)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name):elem[jQuery.camelCase("default-"+name)]=elem[name]=!0,name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}:function(elem,name,isXML){return isXML?void 0:elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}}),getSetInput&&getSetAttribute||(jQuery.attrHooks.value={set:function(elem,value,name){return jQuery.nodeName(elem,"input")?void(elem.defaultValue=value):nodeHook&&nodeHook.set(elem,value,name)}}),getSetAttribute||(nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);return ret||elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name)),ret.value=value+="","value"===name||value===elem.getAttribute(name)?value:void 0}},attrHandle.id=attrHandle.name=attrHandle.coords=function(elem,name,isXML){var ret;return isXML?void 0:(ret=elem.getAttributeNode(name))&&""!==ret.value?ret.value:null},jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);return ret&&ret.specified?ret.value:void 0},set:nodeHook.set},jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,""===value?!1:value,name)}},jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){return""===value?(elem.setAttribute(name,"auto"),value):void 0}}})),support.style||(jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||void 0},set:function(elem,value){return elem.style.cssText=value+""}});var rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return name=jQuery.propFix[name]||name,this.each(function(){try{this[name]=void 0,delete this[name]}catch(e){}})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}}),support.hrefNormalized||jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex),null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),support.enctype||(jQuery.propFix.enctype="encoding");var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed="string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),elem.className!==finalValue&&(elem.className=finalValue)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=0===arguments.length||"string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");finalValue=value?jQuery.trim(cur):"",elem.className!==finalValue&&(elem.className=finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):this.each(jQuery.isFunction(value)?function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}:function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else(type===strundefined||"boolean"===type)&&(this.className&&jQuery._data(this,"__className__",this.className),this.className=this.className||value===!1?"":jQuery._data(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1}}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now(),rquery=/\?/,rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;jQuery.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data+"");var requireNonComma,depth=null,str=jQuery.trim(data+"");return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){return requireNonComma&&comma&&(depth=0),0===depth?token:(requireNonComma=open||comma,depth+=!close-!open,"")}))?Function("return "+str)():jQuery.error("Invalid JSON: "+data)},jQuery.parseXML=function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{window.DOMParser?(tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")):(xml=new ActiveXObject("Microsoft.XMLDOM"),xml.async="false",xml.loadXML(data))}catch(e){xml=void 0}return xml&&xml.documentElement&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;
fireGlobals=jQuery.event&&s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstChild&&1===elem.firstChild.nodeType;)elem=elem.firstChild;return elem}).append(this)}return this},wrapInner:function(html){return this.each(jQuery.isFunction(html)?function(i){jQuery(this).wrapInner(html.call(this,i))}:function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!support.reliableHiddenOffsets()&&"none"===(elem.style&&elem.style.display||jQuery.css(elem,"display"))},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=void 0!==window.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&createStandardXHR()||createActiveXHR()}:createStandardXHR;var xhrId=0,xhrCallbacks={},xhrSupported=jQuery.ajaxSettings.xhr();window.attachEvent&&window.attachEvent("onunload",function(){for(var key in xhrCallbacks)xhrCallbacks[key](void 0,!0)}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,xhrSupported=support.ajax=!!xhrSupported,xhrSupported&&jQuery.ajaxTransport(function(options){if(!options.crossDomain||support.cors){var callback;return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)void 0!==headers[i]&&xhr.setRequestHeader(i,headers[i]+"");xhr.send(options.hasContent&&options.data||null),callback=function(_,isAbort){var status,statusText,responses;if(callback&&(isAbort||4===xhr.readyState))if(delete xhrCallbacks[id],callback=void 0,xhr.onreadystatechange=jQuery.noop,isAbort)4!==xhr.readyState&&xhr.abort();else{responses={},status=xhr.status,"string"==typeof xhr.responseText&&(responses.text=xhr.responseText);try{statusText=xhr.statusText}catch(e){statusText=""}status||!options.isLocal||options.crossDomain?1223===status&&(status=204):status=responses.text?200:404}responses&&complete(status,statusText,responses,xhr.getAllResponseHeaders())},options.async?4===xhr.readyState?setTimeout(callback):xhr.onreadystatechange=xhrCallbacks[id]=callback:callback()},abort:function(){callback&&callback(void 0,!0)}}}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET",s.global=!1)}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script"),script.async=!0,s.scriptCharset&&(script.charset=s.scriptCharset),script.src=s.url,script.onload=script.onreadystatechange=function(_,isAbort){(isAbort||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),script=null,isAbort||callback(200,"success"))},head.insertBefore(script,head.firstChild)},abort:function(){script&&script.onload(void 0,!0)}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"):void 0}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,response,type,self=this,off=url.indexOf(" ");return off>=0&&(selector=jQuery.trim(url.slice(off,url.length)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):box},position:function(){if(this[0]){var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]:void(win?win.scrollTo(top?jQuery(win).scrollLeft():val,top?val:jQuery(win).scrollTop()):elem[method]=val)},method,val,arguments.length,null)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery}),function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();return"area"===nodeName?(map=element.parentNode,mapName=map.name,element.href&&mapName&&"map"===map.nodeName.toLowerCase()?(img=$("img[usemap='#"+mapName+"']")[0],!!img&&visible(img)):!1):(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length}function datepicker_getZindex(elem){for(var position,value;elem.length&&elem[0]!==document;){if(position=elem.css("position"),("absolute"===position||"relative"===position||"fixed"===position)&&(value=parseInt(elem.css("zIndex"),10),!isNaN(value)&&0!==value))return value;elem=elem.parent()}return 0}function Datepicker(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.regional.en=$.extend(!0,{},this.regional[""]),this.regional["en-US"]=$.extend(!0,{},this.regional.en),this.dpDiv=datepicker_bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function datepicker_bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.delegate(selector,"mouseout",function(){$(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(selector,"mouseover",datepicker_handleMouseover)}function datepicker_handleMouseover(){$.datepicker._isDisabledDatepicker(datepicker_instActive.inline?datepicker_instActive.dpDiv.parent()[0]:datepicker_instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).addClass("ui-datepicker-next-hover"))}function datepicker_extendRemove(target,props){$.extend(target,props);for(var name in props)null==props[name]&&(target[name]=props[name]);return target}function spinner_modifier(fn){return function(){var previous=this.element.val();fn.apply(this,arguments),this._refresh(),previous!==this.element.val()&&this._trigger("change")}}$.ui=$.ui||{},$.extend($.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),$.fn.extend({scrollParent:function(includeHidden){var position=this.css("position"),excludeStaticParent="absolute"===position,overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);return excludeStaticParent&&"static"===parent.css("position")?!1:overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return"fixed"!==position&&scrollParent.length?scrollParent:$(this[0].ownerDocument||document)},uniqueId:function(){var uuid=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++uuid)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&$(this).removeAttr("id")})}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],function(i,name){function reduce(elem,size,border,margin){return $.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0,border&&(size-=parseFloat($.css(elem,"border"+this+"Width"))||0),margin&&(size-=parseFloat($.css(elem,"margin"+this))||0)}),size}var side="Width"===name?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};$.fn["inner"+name]=function(size){return void 0===size?orig["inner"+name].call(this):this.each(function(){$(this).css(type,reduce(this,size)+"px")})},$.fn["outer"+name]=function(size,margin){return"number"!=typeof size?orig["outer"+name].call(this,size):this.each(function(){$(this).css(type,reduce(this,size,!0,margin)+"px")})}}),$.fn.addBack||($.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}),$("<a>").data("a-b","a").removeData("a-b").data("a-b")&&($.fn.removeData=function(removeData){return function(key){return arguments.length?removeData.call(this,$.camelCase(key)):removeData.call(this)}}($.fn.removeData)),$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),$.fn.extend({focus:function(orig){return function(delay,fn){return"number"==typeof delay?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus(),fn&&fn.call(elem)},delay)}):orig.apply(this,arguments)}}($.fn.focus),disableSelection:function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(eventType+".ui-disableSelection",function(event){event.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(zIndex){if(void 0!==zIndex)return this.css("zIndex",zIndex);if(this.length)for(var position,value,elem=$(this[0]);elem.length&&elem[0]!==document;){if(position=elem.css("position"),("absolute"===position||"relative"===position||"fixed"===position)&&(value=parseInt(elem.css("zIndex"),10),!isNaN(value)&&0!==value))return value;elem=elem.parent()}return 0}}),$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set)proto.plugins[i]=proto.plugins[i]||[],proto.plugins[i].push([option,set[i]])},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(set&&(allowDisconnected||instance.element[0].parentNode&&11!==instance.element[0].parentNode.nodeType))for(i=0;i<set.length;i++)instance.options[set[i][0]]&&set[i][1].apply(instance.element,args)}};var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;null!=(elem=elems[i]);i++)try{events=$._data(elem,"events"),events&&events.remove&&$(elem).triggerHandler("remove")}catch(e){}orig(elems)}}($.cleanData),$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];return name=name.split(".")[1],fullName=namespace+"-"+name,prototype||(prototype=base,base=$.Widget),$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)},$[namespace]=$[namespace]||{},existingConstructor=$[namespace][name],constructor=$[namespace][name]=function(options,element){return this._createWidget?void(arguments.length&&this._createWidget(options,element)):new constructor(options,element)},$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]}),basePrototype=new base,basePrototype.options=$.widget.extend({},basePrototype.options),$.each(prototype,function(prop,value){return $.isFunction(value)?void(proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var returnValue,__super=this._super,__superApply=this._superApply;return this._super=_super,this._superApply=_superApply,returnValue=value.apply(this,arguments),this._super=__super,this._superApply=__superApply,returnValue}}()):void(proxiedPrototype[prop]=value)}),constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName}),existingConstructor?($.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)}),delete existingConstructor._childConstructors):base._childConstructors.push(constructor),$.widget.bridge(name,constructor),constructor},$.widget.extend=function(target){for(var key,value,input=widget_slice.call(arguments,1),inputIndex=0,inputLength=input.length;inputLength>inputIndex;inputIndex++)for(key in input[inputIndex])value=input[inputIndex][key],input[inputIndex].hasOwnProperty(key)&&void 0!==value&&(target[key]=$.isPlainObject(value)?$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value):value);return target},$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall="string"==typeof options,args=widget_slice.call(arguments,1),returnValue=this;return options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options,this.each(isMethodCall?function(){var methodValue,instance=$.data(this,fullName);return"instance"===options?(returnValue=instance,!1):instance?$.isFunction(instance[options])&&"_"!==options.charAt(0)?(methodValue=instance[options].apply(instance,args),methodValue!==instance&&void 0!==methodValue?(returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue,!1):void 0):$.error("no such method '"+options+"' for "+name+" widget instance"):$.error("cannot call methods on "+name+" prior to initialization; attempted to call method '"+options+"'")}:function(){var instance=$.data(this,fullName);instance?(instance.option(options||{}),instance._init&&instance._init()):$.data(this,fullName,new object(options,this))}),returnValue}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0],this.element=$(element),this.uuid=widget_uuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=$(),this.hoverable=$(),this.focusable=$(),element!==this&&($.data(element,this.widgetFullName,this),this._on(!0,this.element,{remove:function(event){event.target===element&&this.destroy()}}),this.document=$(element.style?element.ownerDocument:element.document||element),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this.options=$.widget.extend({},this.options,this._getCreateOptions(),options),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var parts,curOption,i,options=key;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof key)if(options={},parts=key.split("."),key=parts.shift(),parts.length){for(curOption=options[key]=$.widget.extend({},this.options[key]),i=0;i<parts.length-1;i++)curOption[parts[i]]=curOption[parts[i]]||{},curOption=curOption[parts[i]];if(key=parts.pop(),1===arguments.length)return void 0===curOption[key]?null:curOption[key];curOption[key]=value}else{if(1===arguments.length)return void 0===this.options[key]?null:this.options[key];options[key]=value}return this._setOptions(options),this},_setOptions:function(options){var key;for(key in options)this._setOption(key,options[key]);return this},_setOption:function(key,value){return this.options[key]=value,"disabled"===key&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!value),value&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;"boolean"!=typeof suppressDisabledCheck&&(handlers=element,element=suppressDisabledCheck,suppressDisabledCheck=!1),handlers?(element=delegateElement=$(element),this.bindings=this.bindings.add(element)):(handlers=element,element=this.element,delegateElement=this.widget()),$.each(handlers,function(event,handler){function handlerProxy(){return suppressDisabledCheck||instance.options.disabled!==!0&&!$(this).hasClass("ui-state-disabled")?("string"==typeof handler?instance[handler]:handler).apply(instance,arguments):void 0}"string"!=typeof handler&&(handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++);var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];selector?delegateElement.delegate(selector,eventName,handlerProxy):element.bind(eventName,handlerProxy)})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,element.unbind(eventName).undelegate(eventName),this.bindings=$(this.bindings.not(element).get()),this.focusable=$(this.focusable.not(element).get()),this.hoverable=$(this.hoverable.not(element).get())},_delay:function(handler,delay){function handlerProxy(){return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element),this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element),this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];if(data=data||{},event=$.Event(event),event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase(),event.target=this.element[0],orig=event.originalEvent)for(prop in orig)prop in event||(event[prop]=orig[prop]);return this.element.trigger(event,data),!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===!1||event.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){"string"==typeof options&&(options={effect:options});var hasOptions,effectName=options?options===!0||"number"==typeof options?defaultEffect:options.effect||defaultEffect:method;options=options||{},"number"==typeof options&&(options={duration:options}),hasOptions=!$.isEmptyObject(options),options.complete=callback,options.delay&&element.delay(options.delay),hasOptions&&$.effects&&$.effects.effect[effectName]?element[method](options):effectName!==method&&element[effectName]?element[effectName](options.duration,options.easing,callback):element.queue(function(next){$(this)[method](),callback&&callback.call(element[0]),next()
})}});var mouseHandled=($.widget,!1);$(document).mouseup(function(){mouseHandled=!1});$.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).bind("click."+this.widgetName,function(event){return!0===$.data(event.target,that.widgetName+".preventClickEvent")?($.removeData(event.target,that.widgetName+".preventClickEvent"),event.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(event){if(!mouseHandled){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(event),this._mouseDownEvent=event;var that=this,btnIsLeft=1===event.which,elIsCancel="string"==typeof this.options.cancel&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:!1;return btnIsLeft&&!elIsCancel&&this._mouseCapture(event)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=this._mouseStart(event)!==!1,!this._mouseStarted)?(event.preventDefault(),!0):(!0===$.data(event.target,this.widgetName+".preventClickEvent")&&$.removeData(event.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(event){return that._mouseMove(event)},this._mouseUpDelegate=function(event){return that._mouseUp(event)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),event.preventDefault(),mouseHandled=!0,!0)):!0}},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button)return this._mouseUp(event);if(!event.which)return this._mouseUp(event)}return(event.which||event.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(event),event.preventDefault()):(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,event)!==!1,this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)),!this._mouseStarted)},_mouseUp:function(event){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,event.target===this._mouseDownEvent.target&&$.data(event.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(event)),mouseHandled=!1,!1},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});!function(){function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)]}function parseCss(element,property){return parseInt($.css(element,property),10)||0}function getDimensions(elem){var raw=elem[0];return 9===raw.nodeType?{width:elem.width(),height:elem.height(),offset:{top:0,left:0}}:$.isWindow(raw)?{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}}:raw.preventDefault?{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}}:{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()}}$.ui=$.ui||{};var cachedScrollbarWidth,supportsOffsetFractions,max=Math.max,abs=Math.abs,round=Math.round,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;$.position={scrollbarWidth:function(){if(void 0!==cachedScrollbarWidth)return cachedScrollbarWidth;var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];return $("body").append(div),w1=innerDiv.offsetWidth,div.css("overflow","scroll"),w2=innerDiv.offsetWidth,w1===w2&&(w2=div[0].clientWidth),div.remove(),cachedScrollbarWidth=w1-w2},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX="scroll"===overflowX||"auto"===overflowX&&within.width<within.element[0].scrollWidth,hasOverflowY="scroll"===overflowY||"auto"===overflowY&&within.height<within.element[0].scrollHeight;return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0}},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&9===withinElement[0].nodeType;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:withinElement.offset()||{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:isWindow||isDocument?withinElement.width():withinElement.outerWidth(),height:isWindow||isDocument?withinElement.height():withinElement.outerHeight()}}},$.fn.position=function(options){if(!options||!options.of)return _position.apply(this,arguments);options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};return dimensions=getDimensions(target),target[0].preventDefault&&(options.at="left top"),targetWidth=dimensions.width,targetHeight=dimensions.height,targetOffset=dimensions.offset,basePosition=$.extend({},targetOffset),$.each(["my","at"],function(){var horizontalOffset,verticalOffset,pos=(options[this]||"").split(" ");1===pos.length&&(pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"]),pos[0]=rhorizontal.test(pos[0])?pos[0]:"center",pos[1]=rvertical.test(pos[1])?pos[1]:"center",horizontalOffset=roffset.exec(pos[0]),verticalOffset=roffset.exec(pos[1]),offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0],options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]}),1===collision.length&&(collision[1]=collision[0]),"right"===options.at[0]?basePosition.left+=targetWidth:"center"===options.at[0]&&(basePosition.left+=targetWidth/2),"bottom"===options.at[1]?basePosition.top+=targetHeight:"center"===options.at[1]&&(basePosition.top+=targetHeight/2),atOffset=getOffsets(offsets.at,targetWidth,targetHeight),basePosition.left+=atOffset[0],basePosition.top+=atOffset[1],this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());"right"===options.my[0]?position.left-=elemWidth:"center"===options.my[0]&&(position.left-=elemWidth/2),"bottom"===options.my[1]?position.top-=elemHeight:"center"===options.my[1]&&(position.top-=elemHeight/2),position.left+=myOffset[0],position.top+=myOffset[1],supportsOffsetFractions||(position.left=round(position.left),position.top=round(position.top)),collisionPosition={marginLeft:marginLeft,marginTop:marginTop},$.each(["left","top"],function(i,dir){$.ui.position[collision[i]]&&$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})}),options.using&&(using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:0>right?"left":left>0?"right":"center",vertical:0>bottom?"top":top>0?"bottom":"middle"};elemWidth>targetWidth&&abs(left+right)<targetWidth&&(feedback.horizontal="center"),elemHeight>targetHeight&&abs(top+bottom)<targetHeight&&(feedback.vertical="middle"),feedback.important=max(abs(left),abs(right))>max(abs(top),abs(bottom))?"horizontal":"vertical",options.using.call(this,props,feedback)}),elem.offset($.extend(position,{using:using}))})},$.ui.position={fit:{left:function(position,data){var newOverRight,within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset;data.collisionWidth>outerWidth?overLeft>0&&0>=overRight?(newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset,position.left+=overLeft-newOverRight):position.left=overRight>0&&0>=overLeft?withinOffset:overLeft>overRight?withinOffset+outerWidth-data.collisionWidth:withinOffset:overLeft>0?position.left+=overLeft:overRight>0?position.left-=overRight:position.left=max(position.left-collisionPosLeft,position.left)},top:function(position,data){var newOverBottom,within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset;data.collisionHeight>outerHeight?overTop>0&&0>=overBottom?(newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset,position.top+=overTop-newOverBottom):position.top=overBottom>0&&0>=overTop?withinOffset:overTop>overBottom?withinOffset+outerHeight-data.collisionHeight:withinOffset:overTop>0?position.top+=overTop:overBottom>0?position.top-=overBottom:position.top=max(position.top-collisionPosTop,position.top)}},flip:{left:function(position,data){var newOverRight,newOverLeft,within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset="left"===data.my[0]?-data.elemWidth:"right"===data.my[0]?data.elemWidth:0,atOffset="left"===data.at[0]?data.targetWidth:"right"===data.at[0]?-data.targetWidth:0,offset=-2*data.offset[0];0>overLeft?(newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset,(0>newOverRight||newOverRight<abs(overLeft))&&(position.left+=myOffset+atOffset+offset)):overRight>0&&(newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft,(newOverLeft>0||abs(newOverLeft)<overRight)&&(position.left+=myOffset+atOffset+offset))},top:function(position,data){var newOverTop,newOverBottom,within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top="top"===data.my[1],myOffset=top?-data.elemHeight:"bottom"===data.my[1]?data.elemHeight:0,atOffset="top"===data.at[1]?data.targetHeight:"bottom"===data.at[1]?-data.targetHeight:0,offset=-2*data.offset[1];0>overTop?(newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset,position.top+myOffset+atOffset+offset>overTop&&(0>newOverBottom||newOverBottom<abs(overTop))&&(position.top+=myOffset+atOffset+offset)):overBottom>0&&(newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop,position.top+myOffset+atOffset+offset>overBottom&&(newOverTop>0||abs(newOverTop)<overBottom)&&(position.top+=myOffset+atOffset+offset))}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments),$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments),$.ui.position.fit.top.apply(this,arguments)}}},function(){var testElement,testElementParent,testElementStyle,offsetLeft,i,body=document.getElementsByTagName("body")[0],div=document.createElement("div");testElement=document.createElement(body?"div":"body"),testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},body&&$.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"});for(i in testElementStyle)testElement.style[i]=testElementStyle[i];testElement.appendChild(div),testElementParent=body||document.documentElement,testElementParent.insertBefore(testElement,testElementParent.firstChild),div.style.cssText="position: absolute; left: 10.7432222px;",offsetLeft=$(div).offset().left,supportsOffsetFractions=offsetLeft>10&&11>offsetLeft,testElement.innerHTML="",testElementParent.removeChild(testElement)}()}();$.ui.position,$.widget("ui.accordion",{version:"1.11.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var options=this.options;this.prevShow=this.prevHide=$(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),options.collapsible||options.active!==!1&&null!=options.active||(options.active=0),this._processPanels(),options.active<0&&(options.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():$()}},_createIcons:function(){var icons=this.options.icons;icons&&($("<span>").addClass("ui-accordion-header-icon ui-icon "+icons.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(icons.header).addClass(icons.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var contents;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),contents=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&contents.css("height","")},_setOption:function(key,value){return"active"===key?void this._activate(value):("event"===key&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(value)),this._super(key,value),"collapsible"!==key||value||this.options.active!==!1||this._activate(0),"icons"===key&&(this._destroyIcons(),value&&this._createIcons()),void("disabled"===key&&(this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!value))))},_keydown:function(event){if(!event.altKey&&!event.ctrlKey){var keyCode=$.ui.keyCode,length=this.headers.length,currentIndex=this.headers.index(event.target),toFocus=!1;switch(event.keyCode){case keyCode.RIGHT:case keyCode.DOWN:toFocus=this.headers[(currentIndex+1)%length];break;case keyCode.LEFT:case keyCode.UP:toFocus=this.headers[(currentIndex-1+length)%length];break;case keyCode.SPACE:case keyCode.ENTER:this._eventHandler(event);break;case keyCode.HOME:toFocus=this.headers[0];break;case keyCode.END:toFocus=this.headers[length-1]}toFocus&&($(event.target).attr("tabIndex",-1),$(toFocus).attr("tabIndex",0),toFocus.focus(),event.preventDefault())}},_panelKeyDown:function(event){event.keyCode===$.ui.keyCode.UP&&event.ctrlKey&&$(event.currentTarget).prev().focus()},refresh:function(){var options=this.options;this._processPanels(),options.active===!1&&options.collapsible===!0||!this.headers.length?(options.active=!1,this.active=$()):options.active===!1?this._activate(0):this.active.length&&!$.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(options.active=!1,this.active=$()):this._activate(Math.max(0,options.active-1)):options.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var prevHeaders=this.headers,prevPanels=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),prevPanels&&(this._off(prevHeaders.not(this.headers)),this._off(prevPanels.not(this.panels)))},_refresh:function(){var maxHeight,options=this.options,heightStyle=options.heightStyle,parent=this.element.parent();this.active=this._findActive(options.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var header=$(this),headerId=header.uniqueId().attr("id"),panel=header.next(),panelId=panel.uniqueId().attr("id");header.attr("aria-controls",panelId),panel.attr("aria-labelledby",headerId)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(options.event),"fill"===heightStyle?(maxHeight=parent.height(),this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");"absolute"!==position&&"fixed"!==position&&(maxHeight-=elem.outerHeight(!0))}),this.headers.each(function(){maxHeight-=$(this).outerHeight(!0)}),this.headers.next().each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===heightStyle&&(maxHeight=0,this.headers.next().each(function(){maxHeight=Math.max(maxHeight,$(this).css("height","").height())}).height(maxHeight))},_activate:function(index){var active=this._findActive(index)[0];active!==this.active[0]&&(active=active||this.active[0],this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop}))},_findActive:function(selector){return"number"==typeof selector?this.headers.eq(selector):$()},_setupEvents:function(event){var events={keydown:"_keydown"};event&&$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,events),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(event){var options=this.options,active=this.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():clicked.next(),toHide=active.next(),eventData={oldHeader:active,oldPanel:toHide,newHeader:collapsing?$():clicked,newPanel:toShow};event.preventDefault(),clickedIsActive&&!options.collapsible||this._trigger("beforeActivate",event,eventData)===!1||(options.active=collapsing?!1:this.headers.index(clicked),this.active=clickedIsActive?$():clicked,this._toggle(eventData),active.removeClass("ui-accordion-header-active ui-state-active"),options.icons&&active.children(".ui-accordion-header-icon").removeClass(options.icons.activeHeader).addClass(options.icons.header),clickedIsActive||(clicked.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),options.icons&&clicked.children(".ui-accordion-header-icon").removeClass(options.icons.header).addClass(options.icons.activeHeader),clicked.next().addClass("ui-accordion-content-active")))},_toggle:function(data){var toShow=data.newPanel,toHide=this.prevShow.length?this.prevShow:data.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=toShow,this.prevHide=toHide,this.options.animate?this._animate(toShow,toHide,data):(toHide.hide(),toShow.show(),this._toggleComplete(data)),toHide.attr({"aria-hidden":"true"}),toHide.prev().attr("aria-selected","false"),toShow.length&&toHide.length?toHide.prev().attr({tabIndex:-1,"aria-expanded":"false"}):toShow.length&&this.headers.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),toShow.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(toShow,toHide,data){var total,easing,duration,that=this,adjust=0,down=toShow.length&&(!toHide.length||toShow.index()<toHide.index()),animate=this.options.animate||{},options=down&&animate.down||animate,complete=function(){that._toggleComplete(data)};return"number"==typeof options&&(duration=options),"string"==typeof options&&(easing=options),easing=easing||options.easing||animate.easing,duration=duration||options.duration||animate.duration,toHide.length?toShow.length?(total=toShow.show().outerHeight(),toHide.animate(this.hideProps,{duration:duration,easing:easing,step:function(now,fx){fx.now=Math.round(now)}}),void toShow.hide().animate(this.showProps,{duration:duration,easing:easing,complete:complete,step:function(now,fx){fx.now=Math.round(now),"height"!==fx.prop?adjust+=fx.now:"content"!==that.options.heightStyle&&(fx.now=Math.round(total-toHide.outerHeight()-adjust),adjust=0)}})):toHide.animate(this.hideProps,duration,easing,complete):toShow.animate(this.showProps,duration,easing,complete)},_toggleComplete:function(data){var toHide=data.oldPanel;toHide.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),toHide.length&&(toHide.parent()[0].className=toHide.parent()[0].className),this._trigger("activate",null,data)}}),$.widget("ui.menu",{version:"1.11.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(event){event.preventDefault()},"click .ui-menu-item":function(event){var target=$(event.target);!this.mouseHandled&&target.not(".ui-state-disabled").length&&(this.select(event),event.isPropagationStopped()||(this.mouseHandled=!0),target.has(".ui-menu").length?this.expand(event):!this.element.is(":focus")&&$(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(event){if(!this.previousFilter){var target=$(event.currentTarget);target.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(event,target)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.find(this.options.items).eq(0);keepActiveItem||this.focus(event,item)},blur:function(event){this._delay(function(){$.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(event)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(event){this._closeOnDocumentClick(event)&&this.collapseAll(event),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var elem=$(this);elem.data("ui-menu-submenu-carat")&&elem.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(event){var match,prev,character,skip,preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(event);break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=!1,prev=this.previousFilter||"",character=String.fromCharCode(event.keyCode),skip=!1,clearTimeout(this.filterTimer),character===prev?skip=!0:character=prev+character,match=this._filterMenuItems(character),match=skip&&-1!==match.index(this.active.next())?this.active.nextAll(".ui-menu-item"):match,match.length||(character=String.fromCharCode(event.keyCode),match=this._filterMenuItems(character)),match.length?(this.focus(event,match),this.previousFilter=character,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}preventDefault&&event.preventDefault()},_activate:function(event){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(event):this.select(event))},refresh:function(){var menus,items,that=this,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),submenus.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.parent(),submenuCarat=$("<span>").addClass("ui-menu-icon ui-icon "+icon).data("ui-menu-submenu-carat",!0);item.attr("aria-haspopup","true").prepend(submenuCarat),menu.attr("aria-labelledby",item.attr("id"))}),menus=submenus.add(this.element),items=menus.find(this.options.items),items.not(".ui-menu-item").each(function(){var item=$(this);that._isDivider(item)&&item.addClass("ui-widget-content ui-menu-divider")}),items.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),items.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!$.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(key,value){"icons"===key&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(value.submenu),"disabled"===key&&this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value),this._super(key,value)},focus:function(event,item){var nested,focused;this.blur(event,event&&"focus"===event.type),this._scrollIntoView(item),this.active=item.first(),focused=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",focused.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),event&&"keydown"===event.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),nested=item.children(".ui-menu"),nested.length&&event&&/^mouse/.test(event.type)&&this._startOpening(nested),this.activeMenu=item.parent(),this._trigger("focus",event,{item:item})},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;this._hasScroll()&&(borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0,paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0,offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop,scroll=this.activeMenu.scrollTop(),elementHeight=this.activeMenu.height(),itemHeight=item.outerHeight(),0>offset?this.activeMenu.scrollTop(scroll+offset):offset+itemHeight>elementHeight&&this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight))},blur:function(event,fromFocus){fromFocus||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",event,{item:this.active}))},_startOpening:function(submenu){clearTimeout(this.timer),"true"===submenu.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(submenu)},this.delay))},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(submenu.parents(".ui-menu")).hide().attr("aria-hidden","true"),submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position)},collapseAll:function(event,all){clearTimeout(this.timer),this.timer=this._delay(function(){var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".ui-menu"));currentMenu.length||(currentMenu=this.element),this._close(currentMenu),this.blur(event),this.activeMenu=currentMenu},this.delay)},_close:function(startMenu){startMenu||(startMenu=this.active?this.active.parent():this.element),startMenu.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(event){return!$(event.target).closest(".ui-menu").length},_isDivider:function(item){return!/[^\-\u2014\u2013\s]/.test(item.text())},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".ui-menu-item",this.element);newItem&&newItem.length&&(this._close(),this.focus(event,newItem))},expand:function(event){var newItem=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();
newItem&&newItem.length&&(this._open(newItem.parent()),this._delay(function(){this.focus(event,newItem)}))},next:function(event){this._move("next","first",event)},previous:function(event){this._move("prev","last",event)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(direction,filter,event){var next;this.active&&(next="first"===direction||"last"===direction?this.active["first"===direction?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[direction+"All"](".ui-menu-item").eq(0)),next&&next.length&&this.active||(next=this.activeMenu.find(this.options.items)[filter]()),this.focus(event,next)},nextPage:function(event){var item,base,height;return this.active?void(this.isLastItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return item=$(this),item.offset().top-base-height<0}),this.focus(event,item)):this.focus(event,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(event)},previousPage:function(event){var item,base,height;return this.active?void(this.isFirstItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return item=$(this),item.offset().top-base+height>0}),this.focus(event,item)):this.focus(event,this.activeMenu.find(this.options.items).first()))):void this.next(event)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(event){this.active=this.active||$(event.target).closest(".ui-menu-item");var ui={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(event,!0),this._trigger("select",event,ui)},_filterMenuItems:function(character){var escapedCharacter=character.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),regex=new RegExp("^"+escapedCharacter,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return regex.test($.trim($(this).text()))})}});$.widget("ui.autocomplete",{version:"1.11.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea="textarea"===nodeName,isInput="input"===nodeName;this.isMultiLine=isTextarea?!0:isInput?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[isTextarea||isInput?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly"))return suppressKeyPress=!0,suppressInput=!0,void(suppressKeyPressRepeat=!0);suppressKeyPress=!1,suppressInput=!1,suppressKeyPressRepeat=!1;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=!0,this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=!0,this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=!0,this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=!0,this._keyEvent("next",event);break;case keyCode.ENTER:this.menu.active&&(suppressKeyPress=!0,event.preventDefault(),this.menu.select(event));break;case keyCode.TAB:this.menu.active&&this.menu.select(event);break;case keyCode.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(event),event.preventDefault());break;default:suppressKeyPressRepeat=!0,this._searchTimeout(event)}},keypress:function(event){if(suppressKeyPress)return suppressKeyPress=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&event.preventDefault());if(!suppressKeyPressRepeat){var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event)}}},input:function(event){return suppressInput?(suppressInput=!1,void event.preventDefault()):void this._searchTimeout(event)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(event){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(event),void this._change(event))}}),this._initSource(),this.menu=$("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(event){event.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var menuElement=this.menu.element[0];$(event.target).closest(".ui-menu-item").length||this._delay(function(){var that=this;this.document.one("mousedown",function(event){event.target===that.element[0]||event.target===menuElement||$.contains(menuElement,event.target)||that.close()})})},menufocus:function(event,ui){var label,item;return this.isNewMenu&&(this.isNewMenu=!1,event.originalEvent&&/^mouse/.test(event.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent)})):(item=ui.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",event,{item:item})&&event.originalEvent&&/^key/.test(event.originalEvent.type)&&this._value(item.value),label=ui.item.attr("aria-label")||item.value,void(label&&$.trim(label).length&&(this.liveRegion.children().hide(),$("<div>").text(label).appendTo(this.liveRegion))))},menuselect:function(event,ui){var item=ui.item.data("ui-autocomplete-item"),previous=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=previous,this._delay(function(){this.previous=previous,this.selectedItem=item})),!1!==this._trigger("select",event,{item:item})&&this._value(item.value),this.term=this._value(),this.close(event),this.selectedItem=item}}),this.liveRegion=$("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(key,value){this._super(key,value),"source"===key&&this._initSource(),"appendTo"===key&&this.menu.element.appendTo(this._appendTo()),"disabled"===key&&value&&this.xhr&&this.xhr.abort()},_appendTo:function(){var element=this.options.appendTo;return element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)),element&&element[0]||(element=this.element.closest(".ui-front")),element.length||(element=this.document[0].body),element},_initSource:function(){var array,url,that=this;$.isArray(this.options.source)?(array=this.options.source,this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term))}):"string"==typeof this.options.source?(url=this.options.source,this.source=function(request,response){that.xhr&&that.xhr.abort(),that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data)},error:function(){response([])}})}):this.source=this.options.source},_searchTimeout:function(event){clearTimeout(this.searching),this.searching=this._delay(function(){var equalValues=this.term===this._value(),menuVisible=this.menu.element.is(":visible"),modifierKey=event.altKey||event.ctrlKey||event.metaKey||event.shiftKey;(!equalValues||equalValues&&!menuVisible&&!modifierKey)&&(this.selectedItem=null,this.search(null,event))},this.options.delay)},search:function(value,event){return value=null!=value?value:this._value(),this.term=this._value(),value.length<this.options.minLength?this.close(event):this._trigger("search",event)!==!1?this._search(value):void 0},_search:function(value){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:value},this._response())},_response:function(){var index=++this.requestIndex;return $.proxy(function(content){index===this.requestIndex&&this.__response(content),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(content){content&&(content=this._normalize(content)),this._trigger("response",null,{content:content}),!this.options.disabled&&content&&content.length&&!this.cancelSearch?(this._suggest(content),this._trigger("open")):this._close()},close:function(event){this.cancelSearch=!0,this._close(event)},_close:function(event){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",event))},_change:function(event){this.previous!==this._value()&&this._trigger("change",event,{item:this.selectedItem})},_normalize:function(items){return items.length&&items[0].label&&items[0].value?items:$.map(items,function(item){return"string"==typeof item?{label:item,value:item}:$.extend({},item,{label:item.label||item.value,value:item.value||item.label})})},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items),this.isNewMenu=!0,this.menu.refresh(),ul.show(),this._resizeMenu(),ul.position($.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-autocomplete-item",item)},_renderItem:function(ul,item){return $("<li>").text(item.label).appendTo(ul)},_move:function(direction,event){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[direction](event):void this.search(null,event)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(keyEvent,event){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(keyEvent,event),event.preventDefault())}}),$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}}),$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(content){var message;this._superApply(arguments),this.options.disabled||this.cancelSearch||(message=content&&content.length?this.options.messages.results(content.length):this.options.messages.noResults,this.liveRegion.children().hide(),$("<div>").text(message).appendTo(this.liveRegion))}});var lastActive,baseClasses=($.ui.autocomplete,"ui-button ui-widget ui-state-default ui-corner-all"),typeClasses="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",formResetHandler=function(){var form=$(this);setTimeout(function(){form.find(":ui-button").button("refresh")},1)},radioGroup=function(radio){var name=radio.name,form=radio.form,radios=$([]);return name&&(name=name.replace(/'/g,"\\'"),radios=form?$(form).find("[name='"+name+"'][type=radio]"):$("[name='"+name+"'][type=radio]",radio.ownerDocument).filter(function(){return!this.form})),radios};$.widget("ui.button",{version:"1.11.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,formResetHandler),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var that=this,options=this.options,toggleButton="checkbox"===this.type||"radio"===this.type,activeClass=toggleButton?"":"ui-state-active";null===options.label&&(options.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(baseClasses).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){options.disabled||this===lastActive&&$(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){options.disabled||$(this).removeClass(activeClass)}).bind("click"+this.eventNamespace,function(event){options.disabled&&(event.preventDefault(),event.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),toggleButton&&this.element.bind("change"+this.eventNamespace,function(){that.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return options.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled)return!1;$(this).addClass("ui-state-active"),that.buttonElement.attr("aria-pressed","true");var radio=that.element[0];radioGroup(radio).not(radio).map(function(){return $(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return options.disabled?!1:($(this).addClass("ui-state-active"),lastActive=this,void that.document.one("mouseup",function(){lastActive=null}))}).bind("mouseup"+this.eventNamespace,function(){return options.disabled?!1:void $(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(event){return options.disabled?!1:void((event.keyCode===$.ui.keyCode.SPACE||event.keyCode===$.ui.keyCode.ENTER)&&$(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){$(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(event){event.keyCode===$.ui.keyCode.SPACE&&$(this).click()})),this._setOption("disabled",options.disabled),this._resetButton()},_determineButtonType:function(){var ancestor,labelSelector,checked;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(ancestor=this.element.parents().last(),labelSelector="label[for='"+this.element.attr("id")+"']",this.buttonElement=ancestor.find(labelSelector),this.buttonElement.length||(ancestor=ancestor.length?ancestor.siblings():this.element.siblings(),this.buttonElement=ancestor.filter(labelSelector),this.buttonElement.length||(this.buttonElement=ancestor.find(labelSelector))),this.element.addClass("ui-helper-hidden-accessible"),checked=this.element.is(":checked"),checked&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",checked)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(baseClasses+" ui-state-active "+typeClasses).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(key,value){return this._super(key,value),"disabled"===key?(this.widget().toggleClass("ui-state-disabled",!!value),this.element.prop("disabled",!!value),void(value&&this.buttonElement.removeClass("checkbox"===this.type||"radio"===this.type?"ui-state-focus":"ui-state-focus ui-state-active"))):void this._resetButton()},refresh:function(){var isDisabled=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");isDisabled!==this.options.disabled&&this._setOption("disabled",isDisabled),"radio"===this.type?radioGroup(this.element[0]).each(function(){$(this).is(":checked")?$(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):$(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var buttonElement=this.buttonElement.removeClass(typeClasses),buttonText=$("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(buttonElement.empty()).text(),icons=this.options.icons,multipleIcons=icons.primary&&icons.secondary,buttonClasses=[];icons.primary||icons.secondary?(this.options.text&&buttonClasses.push("ui-button-text-icon"+(multipleIcons?"s":icons.primary?"-primary":"-secondary")),icons.primary&&buttonElement.prepend("<span class='ui-button-icon-primary ui-icon "+icons.primary+"'></span>"),icons.secondary&&buttonElement.append("<span class='ui-button-icon-secondary ui-icon "+icons.secondary+"'></span>"),this.options.text||(buttonClasses.push(multipleIcons?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||buttonElement.attr("title",$.trim(buttonText)))):buttonClasses.push("ui-button-text-only"),buttonElement.addClass(buttonClasses.join(" "))}}),$.widget("ui.buttonset",{version:"1.11.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(key,value){"disabled"===key&&this.buttons.button("option",key,value),this._super(key,value)},refresh:function(){var rtl="rtl"===this.element.css("direction"),allButtons=this.element.find(this.options.items),existingButtons=allButtons.filter(":ui-button");allButtons.not(":ui-button").button(),existingButtons.button("refresh"),this.buttons=allButtons.map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(rtl?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(rtl?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}});$.ui.button;$.extend($.ui,{datepicker:{version:"1.11.2"}});var datepicker_instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){return datepicker_extendRemove(this._defaults,settings||{}),this},_attachDatepicker:function(target,settings){var nodeName,inline,inst;nodeName=target.nodeName.toLowerCase(),inline="div"===nodeName||"span"===nodeName,target.id||(this.uuid+=1,target.id="dp"+this.uuid),inst=this._newInst($(target),inline),inst.settings=$.extend({},settings||{}),"input"===nodeName?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:inline?datepicker_bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]),inst.trigger=$([]),input.hasClass(this.markerClassName)||(this._attachments(input,inst),input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(inst),$.data(target,"datepicker",inst),inst.settings.disabled&&this._disableDatepicker(target))},_attachments:function(input,inst){var showOn,buttonText,buttonImage,appendText=this._get(inst,"appendText"),isRTL=this._get(inst,"isRTL");inst.append&&inst.append.remove(),appendText&&(inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>"),input[isRTL?"before":"after"](inst.append)),input.unbind("focus",this._showDatepicker),inst.trigger&&inst.trigger.remove(),showOn=this._get(inst,"showOn"),("focus"===showOn||"both"===showOn)&&input.focus(this._showDatepicker),("button"===showOn||"both"===showOn)&&(buttonText=this._get(inst,"buttonText"),buttonImage=this._get(inst,"buttonImage"),inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$("<button type='button'></button>").addClass(this._triggerClass).html(buttonImage?$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText}):buttonText)),input[isRTL?"before":"after"](inst.trigger),inst.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(input[0])):$.datepicker._showDatepicker(input[0]),!1}))},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var findMax,max,maxI,i,date=new Date(2009,11,20),dateFormat=this._get(inst,"dateFormat");dateFormat.match(/[DM]/)&&(findMax=function(names){for(max=0,maxI=0,i=0;i<names.length;i++)names[i].length>max&&(max=names[i].length,maxI=i);return maxI},date.setMonth(findMax(this._get(inst,dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))),date.setDate(findMax(this._get(inst,dateFormat.match(/DD/)?"dayNames":"dayNamesShort"))+20-date.getDay())),inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);divSpan.hasClass(this.markerClassName)||(divSpan.addClass(this.markerClassName).append(inst.dpDiv),$.data(target,"datepicker",inst),this._setDate(inst,this._getDefaultDate(inst),!0),this._updateDatepicker(inst),this._updateAlternate(inst),inst.settings.disabled&&this._disableDatepicker(target),inst.dpDiv.css("display","block"))},_dialogDatepicker:function(input,date,onSelect,settings,pos){var id,browserWidth,browserHeight,scrollX,scrollY,inst=this._dialogInst;return inst||(this.uuid+=1,id="dp"+this.uuid,this._dialogInput=$("<input type='text' id='"+id+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),inst=this._dialogInst=this._newInst(this._dialogInput,!1),inst.settings={},$.data(this._dialogInput[0],"datepicker",inst)),datepicker_extendRemove(inst.settings,settings||{}),date=date&&date.constructor===Date?this._formatDate(inst,date):date,this._dialogInput.val(date),this._pos=pos?pos.length?pos:[pos.pageX,pos.pageY]:null,this._pos||(browserWidth=document.documentElement.clientWidth,browserHeight=document.documentElement.clientHeight,scrollX=document.documentElement.scrollLeft||document.body.scrollLeft,scrollY=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[browserWidth/2-100+scrollX,browserHeight/2-150+scrollY]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),inst.settings.onSelect=onSelect,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],"datepicker",inst),this},_destroyDatepicker:function(target){var nodeName,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),$.removeData(target,"datepicker"),"input"===nodeName?(inst.append.remove(),inst.trigger.remove(),$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===nodeName||"span"===nodeName)&&$target.removeClass(this.markerClassName).empty())},_enableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),"input"===nodeName?(target.disabled=!1,inst.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===nodeName||"span"===nodeName)&&(inline=$target.children("."+this._inlineClass),inline.children().removeClass("ui-state-disabled"),inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value}))},_disableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),"input"===nodeName?(target.disabled=!0,inst.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===nodeName||"span"===nodeName)&&(inline=$target.children("."+this._inlineClass),inline.children().addClass("ui-state-disabled"),inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value}),this._disabledInputs[this._disabledInputs.length]=target)},_isDisabledDatepicker:function(target){if(!target)return!1;for(var i=0;i<this._disabledInputs.length;i++)if(this._disabledInputs[i]===target)return!0;return!1},_getInst:function(target){try{return $.data(target,"datepicker")}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var settings,date,minDate,maxDate,inst=this._getInst(target);return 2===arguments.length&&"string"==typeof name?"defaults"===name?$.extend({},$.datepicker._defaults):inst?"all"===name?$.extend({},inst.settings):this._get(inst,name):null:(settings=name||{},"string"==typeof name&&(settings={},settings[name]=value),void(inst&&(this._curInst===inst&&this._hideDatepicker(),date=this._getDateDatepicker(target,!0),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),datepicker_extendRemove(inst.settings,settings),null!==minDate&&void 0!==settings.dateFormat&&void 0===settings.minDate&&(inst.settings.minDate=this._formatDate(inst,minDate)),null!==maxDate&&void 0!==settings.dateFormat&&void 0===settings.maxDate&&(inst.settings.maxDate=this._formatDate(inst,maxDate)),"disabled"in settings&&(settings.disabled?this._disableDatepicker(target):this._enableDatepicker(target)),this._attachments($(target),inst),this._autoSize(inst),this._setDate(inst,date),this._updateAlternate(inst),this._updateDatepicker(inst))))},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);inst&&this._updateDatepicker(inst)},_setDateDatepicker:function(target,date){var inst=this._getInst(target);inst&&(this._setDate(inst,date),this._updateDatepicker(inst),this._updateAlternate(inst))},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);return inst&&!inst.inline&&this._setDateFromField(inst,noDefault),inst?this._getDate(inst):null},_doKeyDown:function(event){var onSelect,dateStr,sel,inst=$.datepicker._getInst(event.target),handled=!0,isRTL=inst.dpDiv.is(".ui-datepicker-rtl");if(inst._keyEvent=!0,$.datepicker._datepickerShowing)switch(event.keyCode){case 9:$.datepicker._hideDatepicker(),handled=!1;break;case 13:return sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv),sel[0]&&$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0]),onSelect=$.datepicker._get(inst,"onSelect"),onSelect?(dateStr=$.datepicker._formatDate(inst),onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst])):$.datepicker._hideDatepicker(),!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 35:(event.ctrlKey||event.metaKey)&&$.datepicker._clearDate(event.target),handled=event.ctrlKey||event.metaKey;break;case 36:(event.ctrlKey||event.metaKey)&&$.datepicker._gotoToday(event.target),handled=event.ctrlKey||event.metaKey;break;case 37:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,isRTL?1:-1,"D"),handled=event.ctrlKey||event.metaKey,event.originalEvent.altKey&&$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 38:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,-7,"D"),handled=event.ctrlKey||event.metaKey;break;case 39:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,isRTL?-1:1,"D"),handled=event.ctrlKey||event.metaKey,event.originalEvent.altKey&&$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 40:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,7,"D"),handled=event.ctrlKey||event.metaKey;break;default:handled=!1}else 36===event.keyCode&&event.ctrlKey?$.datepicker._showDatepicker(this):handled=!1;handled&&(event.preventDefault(),event.stopPropagation())},_doKeyPress:function(event){var chars,chr,inst=$.datepicker._getInst(event.target);return $.datepicker._get(inst,"constrainInput")?(chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat")),chr=String.fromCharCode(null==event.charCode?event.keyCode:event.charCode),event.ctrlKey||event.metaKey||" ">chr||!chars||chars.indexOf(chr)>-1):void 0},_doKeyUp:function(event){var date,inst=$.datepicker._getInst(event.target);if(inst.input.val()!==inst.lastVal)try{date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),inst.input?inst.input.val():null,$.datepicker._getFormatConfig(inst)),date&&($.datepicker._setDateFromField(inst),$.datepicker._updateAlternate(inst),$.datepicker._updateDatepicker(inst))}catch(err){}return!0},_showDatepicker:function(input){if(input=input.target||input,"input"!==input.nodeName.toLowerCase()&&(input=$("input",input.parentNode)[0]),!$.datepicker._isDisabledDatepicker(input)&&$.datepicker._lastInput!==input){var inst,beforeShow,beforeShowSettings,isFixed,offset,showAnim,duration;inst=$.datepicker._getInst(input),$.datepicker._curInst&&$.datepicker._curInst!==inst&&($.datepicker._curInst.dpDiv.stop(!0,!0),inst&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0])),beforeShow=$.datepicker._get(inst,"beforeShow"),beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{},beforeShowSettings!==!1&&(datepicker_extendRemove(inst.settings,beforeShowSettings),inst.lastVal=null,$.datepicker._lastInput=input,$.datepicker._setDateFromField(inst),$.datepicker._inDialog&&(input.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(input),$.datepicker._pos[1]+=input.offsetHeight),isFixed=!1,$(input).parents().each(function(){return isFixed|="fixed"===$(this).css("position"),!isFixed
}),offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]},$.datepicker._pos=null,inst.dpDiv.empty(),inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(inst),offset=$.datepicker._checkOffset(inst,offset,isFixed),inst.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":isFixed?"fixed":"absolute",display:"none",left:offset.left+"px",top:offset.top+"px"}),inst.inline||(showAnim=$.datepicker._get(inst,"showAnim"),duration=$.datepicker._get(inst,"duration"),inst.dpDiv.css("z-index",datepicker_getZindex($(input))+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects.effect[showAnim]?inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration):inst.dpDiv[showAnim||"show"](showAnim?duration:null),$.datepicker._shouldFocusInput(inst)&&inst.input.focus(),$.datepicker._curInst=inst))}},_updateDatepicker:function(inst){this.maxRows=4,datepicker_instActive=inst,inst.dpDiv.empty().append(this._generateHTML(inst)),this._attachHandlers(inst);var origyearshtml,numMonths=this._getNumberOfMonths(inst),cols=numMonths[1],width=17,activeCell=inst.dpDiv.find("."+this._dayOverClass+" a");activeCell.length>0&&datepicker_handleMouseover.apply(activeCell.get(0)),inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),cols>1&&inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",width*cols+"em"),inst.dpDiv[(1!==numMonths[0]||1!==numMonths[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)&&inst.input.focus(),inst.yearshtml&&(origyearshtml=inst.yearshtml,setTimeout(function(){origyearshtml===inst.yearshtml&&inst.yearshtml&&inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml),origyearshtml=inst.yearshtml=null},0))},_shouldFocusInput:function(inst){return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus")},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth(),dpHeight=inst.dpDiv.outerHeight(),inputWidth=inst.input?inst.input.outerWidth():0,inputHeight=inst.input?inst.input.outerHeight():0,viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());return offset.left-=this._get(inst,"isRTL")?dpWidth-inputWidth:0,offset.left-=isFixed&&offset.left===inst.input.offset().left?$(document).scrollLeft():0,offset.top-=isFixed&&offset.top===inst.input.offset().top+inputHeight?$(document).scrollTop():0,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight):0),offset},_findPos:function(obj){for(var position,inst=this._getInst(obj),isRTL=this._get(inst,"isRTL");obj&&("hidden"===obj.type||1!==obj.nodeType||$.expr.filters.hidden(obj));)obj=obj[isRTL?"previousSibling":"nextSibling"];return position=$(obj).offset(),[position.left,position.top]},_hideDatepicker:function(input){var showAnim,duration,postProcess,onClose,inst=this._curInst;!inst||input&&inst!==$.data(input,"datepicker")||this._datepickerShowing&&(showAnim=this._get(inst,"showAnim"),duration=this._get(inst,"duration"),postProcess=function(){$.datepicker._tidyDialog(inst)},$.effects&&($.effects.effect[showAnim]||$.effects[showAnim])?inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess):inst.dpDiv["slideDown"===showAnim?"slideUp":"fadeIn"===showAnim?"fadeOut":"hide"](showAnim?duration:null,postProcess),showAnim||postProcess(),this._datepickerShowing=!1,onClose=this._get(inst,"onClose"),onClose&&onClose.apply(inst.input?inst.input[0]:null,[inst.input?inst.input.val():"",inst]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if($.datepicker._curInst){var $target=$(event.target),inst=$.datepicker._getInst($target[0]);($target[0].id!==$.datepicker._mainDivId&&0===$target.parents("#"+$.datepicker._mainDivId).length&&!$target.hasClass($.datepicker.markerClassName)&&!$target.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||$target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==inst)&&$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id),inst=this._getInst(target[0]);this._isDisabledDatepicker(target[0])||(this._adjustInstDate(inst,offset+("M"===period?this._get(inst,"showCurrentAtPos"):0),period),this._updateDatepicker(inst))},_gotoToday:function(id){var date,target=$(id),inst=this._getInst(target[0]);this._get(inst,"gotoCurrent")&&inst.currentDay?(inst.selectedDay=inst.currentDay,inst.drawMonth=inst.selectedMonth=inst.currentMonth,inst.drawYear=inst.selectedYear=inst.currentYear):(date=new Date,inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear()),this._notifyChange(inst),this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id),inst=this._getInst(target[0]);inst["selected"+("M"===period?"Month":"Year")]=inst["draw"+("M"===period?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10),this._notifyChange(inst),this._adjustDate(target)},_selectDay:function(id,month,year,td){var inst,target=$(id);$(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])||(inst=this._getInst(target[0]),inst.selectedDay=inst.currentDay=$("a",td).html(),inst.selectedMonth=inst.currentMonth=month,inst.selectedYear=inst.currentYear=year,this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear)))},_clearDate:function(id){var target=$(id);this._selectDate(target,"")},_selectDate:function(id,dateStr){var onSelect,target=$(id),inst=this._getInst(target[0]);dateStr=null!=dateStr?dateStr:this._formatDate(inst),inst.input&&inst.input.val(dateStr),this._updateAlternate(inst),onSelect=this._get(inst,"onSelect"),onSelect?onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst]):inst.input&&inst.input.trigger("change"),inst.inline?this._updateDatepicker(inst):(this._hideDatepicker(),this._lastInput=inst.input[0],"object"!=typeof inst.input[0]&&inst.input.focus(),this._lastInput=null)},_updateAlternate:function(inst){var altFormat,date,dateStr,altField=this._get(inst,"altField");altField&&(altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat"),date=this._getDate(inst),dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst)),$(altField).each(function(){$(this).val(dateStr)}))},noWeekends:function(date){var day=date.getDay();return[day>0&&6>day,""]},iso8601Week:function(date){var time,checkDate=new Date(date.getTime());return checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7)),time=checkDate.getTime(),checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1},parseDate:function(format,value,settings){if(null==format||null==value)throw"Invalid arguments";if(value="object"==typeof value?value.toString():value+"",""===value)return null;var iFormat,dim,extra,date,iValue=0,shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,shortYearCutoff="string"!=typeof shortYearCutoffTemp?shortYearCutoffTemp:(new Date).getFullYear()%100+parseInt(shortYearCutoffTemp,10),dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,literal=!1,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches},getNumber=function(match){var isDoubled=lookAhead(match),size="@"===match?14:"!"===match?20:"y"===match&&isDoubled?4:"o"===match?3:2,minSize="y"===match?size:1,digits=new RegExp("^\\d{"+minSize+","+size+"}"),num=value.substring(iValue).match(digits);if(!num)throw"Missing number at position "+iValue;return iValue+=num[0].length,parseInt(num[0],10)},getName=function(match,shortNames,longNames){var index=-1,names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if($.each(names,function(i,pair){var name=pair[1];return value.substr(iValue,name.length).toLowerCase()===name.toLowerCase()?(index=pair[0],iValue+=name.length,!1):void 0}),-1!==index)return index+1;throw"Unknown name at position "+iValue},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat))throw"Unexpected literal at position "+iValue;iValue++};for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?checkLiteral():literal=!1;else switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":date=new Date(getNumber("@")),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"!":date=new Date((getNumber("!")-this._ticksTo1970)/1e4),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"'":lookAhead("'")?checkLiteral():literal=!0;break;default:checkLiteral()}if(iValue<value.length&&(extra=value.substr(iValue),!/^\s+/.test(extra)))throw"Extra/unparsed characters found in date: "+extra;if(-1===year?year=(new Date).getFullYear():100>year&&(year+=(new Date).getFullYear()-(new Date).getFullYear()%100+(shortYearCutoff>=year?0:-100)),doy>-1)for(month=1,day=doy;;){if(dim=this._getDaysInMonth(year,month-1),dim>=day)break;month++,day-=dim}if(date=this._daylightSavingAdjust(new Date(year,month-1,day)),date.getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day)throw"Invalid date";return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(format,date,settings){if(!date)return"";var iFormat,dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches},formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match))for(;num.length<len;)num="0"+num;return num},formatName=function(match,value,shortNames,longNames){return lookAhead(match)?longNames[value]:shortNames[value]},output="",literal=!1;if(date)for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?output+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/864e5),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100;break;case"@":output+=date.getTime();break;case"!":output+=1e4*date.getTime()+this._ticksTo1970;break;case"'":lookAhead("'")?output+="'":literal=!0;break;default:output+=format.charAt(iFormat)}return output},_possibleChars:function(format){var iFormat,chars="",literal=!1,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches};for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?chars+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":lookAhead("'")?chars+="'":literal=!0;break;default:chars+=format.charAt(iFormat)}return chars},_get:function(inst,name){return void 0!==inst.settings[name]?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()!==inst.lastVal){var dateFormat=this._get(inst,"dateFormat"),dates=inst.lastVal=inst.input?inst.input.val():null,defaultDate=this._getDefaultDate(inst),date=defaultDate,settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){dates=noDefault?"":dates}inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear(),inst.currentDay=dates?date.getDate():0,inst.currentMonth=dates?date.getMonth():0,inst.currentYear=dates?date.getFullYear():0,this._adjustInstDate(inst)}},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date;return date.setDate(date.getDate()+offset),date},offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}for(var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date,year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,matches=pattern.exec(offset);matches;){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=7*parseInt(matches[1],10);break;case"m":case"M":month+=parseInt(matches[1],10),day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10),day=Math.min(day,$.datepicker._getDaysInMonth(year,month))}matches=pattern.exec(offset)}return new Date(year,month,day)},newDate=null==date||""===date?defaultDate:"string"==typeof date?offsetString(date):"number"==typeof date?isNaN(date)?defaultDate:offsetNumeric(date):new Date(date.getTime());return newDate=newDate&&"Invalid Date"===newDate.toString()?defaultDate:newDate,newDate&&(newDate.setHours(0),newDate.setMinutes(0),newDate.setSeconds(0),newDate.setMilliseconds(0)),this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){return date?(date.setHours(date.getHours()>12?date.getHours()+2:0),date):null},_setDate:function(inst,date,noChange){var clear=!date,origMonth=inst.selectedMonth,origYear=inst.selectedYear,newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date));inst.selectedDay=inst.currentDay=newDate.getDate(),inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth(),inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear(),origMonth===inst.selectedMonth&&origYear===inst.selectedYear||noChange||this._notifyChange(inst),this._adjustInstDate(inst),inst.input&&inst.input.val(clear?"":this._formatDate(inst))},_getDate:function(inst){var startDate=!inst.currentYear||inst.input&&""===inst.input.val()?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return startDate},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths"),id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){$.datepicker._adjustDate(id,-stepMonths,"M")},next:function(){$.datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(id)},selectDay:function(){return $.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return $.datepicker._selectMonthYear(id,this,"M"),!1},selectYear:function(){return $.datepicker._selectMonthYear(id,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,monthNames,monthNamesShort,beforeShowDay,showOtherMonths,selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,printDate,dRow,tbody,daySettings,otherMonth,unselectable,tempDate=new Date,today=this._daylightSavingAdjust(new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),showButtonPanel=this._get(inst,"showButtonPanel"),hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),numMonths=this._getNumberOfMonths(inst),showCurrentAtPos=this._get(inst,"showCurrentAtPos"),stepMonths=this._get(inst,"stepMonths"),isMultiMonth=1!==numMonths[0]||1!==numMonths[1],currentDate=this._daylightSavingAdjust(inst.currentDay?new Date(inst.currentYear,inst.currentMonth,inst.currentDay):new Date(9999,9,9)),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),drawMonth=inst.drawMonth-showCurrentAtPos,drawYear=inst.drawYear;if(0>drawMonth&&(drawMonth+=12,drawYear--),maxDate)for(maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-numMonths[0]*numMonths[1]+1,maxDate.getDate())),maxDraw=minDate&&minDate>maxDraw?minDate:maxDraw;this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw;)drawMonth--,0>drawMonth&&(drawMonth=11,drawYear--);for(inst.drawMonth=drawMonth,inst.drawYear=drawYear,prevText=this._get(inst,"prevText"),prevText=navigationAsDateFormat?this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)):prevText,prev=this._canAdjustMonth(inst,-1,drawYear,drawMonth)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>",nextText=this._get(inst,"nextText"),nextText=navigationAsDateFormat?this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)):nextText,next=this._canAdjustMonth(inst,1,drawYear,drawMonth)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>",currentText=this._get(inst,"currentText"),gotoDate=this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today,currentText=navigationAsDateFormat?this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)):currentText,controls=inst.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(inst,"closeText")+"</button>",buttonPanel=showButtonPanel?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"",firstDay=parseInt(this._get(inst,"firstDay"),10),firstDay=isNaN(firstDay)?0:firstDay,showWeek=this._get(inst,"showWeek"),dayNames=this._get(inst,"dayNames"),dayNamesMin=this._get(inst,"dayNamesMin"),monthNames=this._get(inst,"monthNames"),monthNamesShort=this._get(inst,"monthNamesShort"),beforeShowDay=this._get(inst,"beforeShowDay"),showOtherMonths=this._get(inst,"showOtherMonths"),selectOtherMonths=this._get(inst,"selectOtherMonths"),defaultDate=this._getDefaultDate(inst),html="",row=0;row<numMonths[0];row++){for(group="",this.maxRows=4,col=0;col<numMonths[1];col++){if(selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay)),cornerClass=" ui-corner-all",calender="",isMultiMonth){if(calender+="<div class='ui-datepicker-group",numMonths[1]>1)switch(col){case 0:calender+=" ui-datepicker-group-first",cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last",cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle",cornerClass=""}calender+="'>"}for(calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+(/all|left/.test(cornerClass)&&0===row?isRTL?next:prev:"")+(/all|right/.test(cornerClass)&&0===row?isRTL?prev:next:"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead><tr>",thead=showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"",dow=0;7>dow;dow++)day=(dow+firstDay)%7,thead+="<th scope='col'"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>";for(calender+=thead+"</tr></thead><tbody>",daysInMonth=this._getDaysInMonth(drawYear,drawMonth),drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth&&(inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)),leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7,curRows=Math.ceil((leadDays+daysInMonth)/7),numRows=isMultiMonth&&this.maxRows>curRows?this.maxRows:curRows,this.maxRows=numRows,printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays)),dRow=0;numRows>dRow;dRow++){for(calender+="<tr>",tbody=showWeek?"<td class='ui-datepicker-week-col'>"+this._get(inst,"calculateWeek")(printDate)+"</td>":"",dow=0;7>dow;dow++)daySettings=beforeShowDay?beforeShowDay.apply(inst.input?inst.input[0]:null,[printDate]):[!0,""],otherMonth=printDate.getMonth()!==drawMonth,unselectable=otherMonth&&!selectOtherMonths||!daySettings[0]||minDate&&minDate>printDate||maxDate&&printDate>maxDate,tbody+="<td class='"+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+(printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent||defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime()?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+(otherMonth&&!showOtherMonths||!daySettings[2]?"":" title='"+daySettings[2].replace(/'/g,"&#39;")+"'")+(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+(otherMonth&&!showOtherMonths?"&#xa0;":unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>")+"</td>",printDate.setDate(printDate.getDate()+1),printDate=this._daylightSavingAdjust(printDate);calender+=tbody+"</tr>"}drawMonth++,drawMonth>11&&(drawMonth=0,drawYear++),calender+="</tbody></table>"+(isMultiMonth?"</div>"+(numMonths[0]>0&&col===numMonths[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),group+=calender}html+=group}return html+=buttonPanel,inst._keyEvent=!1,html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,changeMonth=this._get(inst,"changeMonth"),changeYear=this._get(inst,"changeYear"),showMonthAfterYear=this._get(inst,"showMonthAfterYear"),html="<div class='ui-datepicker-title'>",monthHtml="";if(secondary||!changeMonth)monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>";else{for(inMinYear=minDate&&minDate.getFullYear()===drawYear,inMaxYear=maxDate&&maxDate.getFullYear()===drawYear,monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",month=0;12>month;month++)(!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())&&(monthHtml+="<option value='"+month+"'"+(month===drawMonth?" selected='selected'":"")+">"+monthNamesShort[month]+"</option>");monthHtml+="</select>"}if(showMonthAfterYear||(html+=monthHtml+(!secondary&&changeMonth&&changeYear?"":"&#xa0;")),!inst.yearshtml)if(inst.yearshtml="",secondary||!changeYear)html+="<span class='ui-datepicker-year'>"+drawYear+"</span>";else{for(years=this._get(inst,"yearRange").split(":"),thisYear=(new Date).getFullYear(),determineYear=function(value){var year=value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):value.match(/[+\-].*/)?thisYear+parseInt(value,10):parseInt(value,10);return isNaN(year)?thisYear:year},year=determineYear(years[0]),endYear=Math.max(year,determineYear(years[1]||"")),year=minDate?Math.max(year,minDate.getFullYear()):year,endYear=maxDate?Math.min(endYear,maxDate.getFullYear()):endYear,inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";endYear>=year;year++)inst.yearshtml+="<option value='"+year+"'"+(year===drawYear?" selected='selected'":"")+">"+year+"</option>";inst.yearshtml+="</select>",html+=inst.yearshtml,inst.yearshtml=null}return html+=this._get(inst,"yearSuffix"),showMonthAfterYear&&(html+=(!secondary&&changeMonth&&changeYear?"":"&#xa0;")+monthHtml),html+="</div>"},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+("Y"===period?offset:0),month=inst.drawMonth+("M"===period?offset:0),day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+("D"===period?offset:0),date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear(),("M"===period||"Y"===period)&&this._notifyChange(inst)},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),newDate=minDate&&minDate>date?minDate:date;return maxDate&&newDate>maxDate?maxDate:newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");onChange&&onChange.apply(inst.input?inst.input[0]:null,[inst.selectedYear,inst.selectedMonth+1,inst])},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return null==numMonths?[1,1]:"number"==typeof numMonths?[1,numMonths]:numMonths},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst),date=this._daylightSavingAdjust(new Date(curYear,curMonth+(0>offset?offset:numMonths[0]*numMonths[1]),1));return 0>offset&&date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth())),this._isInRange(inst,date)},_isInRange:function(inst,date){var yearSplit,currentYear,minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),minYear=null,maxYear=null,years=this._get(inst,"yearRange");return years&&(yearSplit=years.split(":"),currentYear=(new Date).getFullYear(),minYear=parseInt(yearSplit[0],10),maxYear=parseInt(yearSplit[1],10),yearSplit[0].match(/[+\-].*/)&&(minYear+=currentYear),yearSplit[1].match(/[+\-].*/)&&(maxYear+=currentYear)),(!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())&&(!minYear||date.getFullYear()>=minYear)&&(!maxYear||date.getFullYear()<=maxYear)},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");return shortYearCutoff="string"!=typeof shortYearCutoff?shortYearCutoff:(new Date).getFullYear()%100+parseInt(shortYearCutoff,10),{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){day||(inst.currentDay=inst.selectedDay,inst.currentMonth=inst.selectedMonth,inst.currentYear=inst.selectedYear);var date=day?"object"==typeof day?day:this._daylightSavingAdjust(new Date(year,month,day)):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}}),$.fn.datepicker=function(options){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick),$.datepicker.initialized=!0),0===$("#"+$.datepicker._mainDivId).length&&$("body").append($.datepicker.dpDiv);var otherArgs=Array.prototype.slice.call(arguments,1);return"string"!=typeof options||"isDisabled"!==options&&"getDate"!==options&&"widget"!==options?"option"===options&&2===arguments.length&&"string"==typeof arguments[1]?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs)):this.each(function(){"string"==typeof options?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)}):$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.11.2";$.datepicker;$.widget("ui.draggable",$.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(key,value){this._super(key,value),"handle"===key&&(this._removeHandleClassName(),this._setHandleClassName())
},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(event){var o=this.options;return this._blurActiveElement(event),this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(event),this.handle?(this._blockFrames(o.iframeFix===!0?"iframe":o.iframeFix),!0):!1)},_blockFrames:function(selector){this.iframeBlocks=this.document.find(selector).map(function(){var iframe=$(this);return $("<div>").css("position","absolute").appendTo(iframe.parent()).outerWidth(iframe.outerWidth()).outerHeight(iframe.outerHeight()).offset(iframe.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(event){var document=this.document[0];if(this.handleElement.is(event.target))try{document.activeElement&&"body"!==document.activeElement.nodeName.toLowerCase()&&$(document.activeElement).blur()}catch(error){}},_mouseStart:function(event){var o=this.options;return this.helper=this._createHelper(event),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===$(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(event),this.originalPosition=this.position=this._generatePosition(event,!1),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this._setContainment(),this._trigger("start",event)===!1?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this._normalizeRightBottom(),this._mouseDrag(event,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,event),!0)},_refreshOffsets:function(event){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:event.pageX-this.offset.left,top:event.pageY-this.offset.top}},_mouseDrag:function(event,noPropagation){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(event,!0),this.positionAbs=this._convertPositionTo("absolute"),!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===!1)return this._mouseUp({}),!1;this.position=ui.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),!1},_mouseStop:function(event){var that=this,dropped=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(dropped=$.ui.ddmanager.drop(this,event)),this.dropped&&(dropped=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!dropped||"valid"===this.options.revert&&dropped||this.options.revert===!0||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){that._trigger("stop",event)!==!1&&that._clear()}):this._trigger("stop",event)!==!1&&this._clear(),!1},_mouseUp:function(event){return this._unblockFrames(),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,event),this.handleElement.is(event.target)&&this.element.focus(),$.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(event){return this.options.handle?!!$(event.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(event){var o=this.options,helperIsFunction=$.isFunction(o.helper),helper=helperIsFunction?$(o.helper.apply(this.element[0],[event])):"clone"===o.helper?this.element.clone().removeAttr("id"):this.element;return helper.parents("body").length||helper.appendTo("parent"===o.appendTo?this.element[0].parentNode:o.appendTo),helperIsFunction&&helper[0]===this.element[0]&&this._setPositionRelative(),helper[0]===this.element[0]||/(fixed|absolute)/.test(helper.css("position"))||helper.css("position","absolute"),helper},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_isRootNode:function(element){return/(html|body)/i.test(element.tagName)||element===this.document[0]},_getParentOffset:function(){var po=this.offsetParent.offset(),document=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var p=this.element.position(),scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollTop()),left:p.left-(parseInt(this.helper.css("left"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var isUserScrollable,c,ce,o=this.options,document=this.document[0];return this.relativeContainer=null,o.containment?"window"===o.containment?void(this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),c=$(o.containment),ce=c[0],void(ce&&(isUserScrollable=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(isUserScrollable?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(isUserScrollable?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c))):void(this.containment=null)},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top)*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)*mod}},_generatePosition:function(event,constrainPosition){var containment,co,top,left,o=this.options,scrollIsRootNode=this._isRootNode(this.scrollParent[0]),pageX=event.pageX,pageY=event.pageY;return scrollIsRootNode&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),constrainPosition&&(this.containment&&(this.relativeContainer?(co=this.relativeContainer.offset(),containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]):containment=this.containment,event.pageX-this.offset.click.left<containment[0]&&(pageX=containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<containment[1]&&(pageY=containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>containment[2]&&(pageX=containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>containment[3]&&(pageY=containment[3]+this.offset.click.top)),o.grid&&(top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,pageY=containment?top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3]?top:top-this.offset.click.top>=containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,pageX=containment?left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2]?left:left-this.offset.click.left>=containment[0]?left-o.grid[0]:left+o.grid[0]:left),"y"===o.axis&&(pageX=this.originalPageX),"x"===o.axis&&(pageY=this.originalPageY)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(type,event,ui){return ui=ui||this._uiHash(),$.ui.plugin.call(this,type,[event,ui,this],!0),/^(drag|start|stop)/.test(type)&&(this.positionAbs=this._convertPositionTo("absolute"),ui.offset=this.positionAbs),$.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.sortables=[],$(draggable.options.connectToSortable).each(function(){var sortable=$(this).sortable("instance");sortable&&!sortable.options.disabled&&(draggable.sortables.push(sortable),sortable.refreshPositions(),sortable._trigger("activate",event,uiSortable))})},stop:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.cancelHelperRemoval=!1,$.each(draggable.sortables,function(){var sortable=this;sortable.isOver?(sortable.isOver=0,draggable.cancelHelperRemoval=!0,sortable.cancelHelperRemoval=!1,sortable._storedCSS={position:sortable.placeholder.css("position"),top:sortable.placeholder.css("top"),left:sortable.placeholder.css("left")},sortable._mouseStop(event),sortable.options.helper=sortable.options._helper):(sortable.cancelHelperRemoval=!0,sortable._trigger("deactivate",event,uiSortable))})},drag:function(event,ui,draggable){$.each(draggable.sortables,function(){var innermostIntersecting=!1,sortable=this;sortable.positionAbs=draggable.positionAbs,sortable.helperProportions=draggable.helperProportions,sortable.offset.click=draggable.offset.click,sortable._intersectsWith(sortable.containerCache)&&(innermostIntersecting=!0,$.each(draggable.sortables,function(){return this.positionAbs=draggable.positionAbs,this.helperProportions=draggable.helperProportions,this.offset.click=draggable.offset.click,this!==sortable&&this._intersectsWith(this.containerCache)&&$.contains(sortable.element[0],this.element[0])&&(innermostIntersecting=!1),innermostIntersecting})),innermostIntersecting?(sortable.isOver||(sortable.isOver=1,sortable.currentItem=ui.helper.appendTo(sortable.element).data("ui-sortable-item",!0),sortable.options._helper=sortable.options.helper,sortable.options.helper=function(){return ui.helper[0]},event.target=sortable.currentItem[0],sortable._mouseCapture(event,!0),sortable._mouseStart(event,!0,!0),sortable.offset.click.top=draggable.offset.click.top,sortable.offset.click.left=draggable.offset.click.left,sortable.offset.parent.left-=draggable.offset.parent.left-sortable.offset.parent.left,sortable.offset.parent.top-=draggable.offset.parent.top-sortable.offset.parent.top,draggable._trigger("toSortable",event),draggable.dropped=sortable.element,$.each(draggable.sortables,function(){this.refreshPositions()}),draggable.currentItem=draggable.element,sortable.fromOutside=draggable),sortable.currentItem&&(sortable._mouseDrag(event),ui.position=sortable.position)):sortable.isOver&&(sortable.isOver=0,sortable.cancelHelperRemoval=!0,sortable.options._revert=sortable.options.revert,sortable.options.revert=!1,sortable._trigger("out",event,sortable._uiHash(sortable)),sortable._mouseStop(event,!0),sortable.options.revert=sortable.options._revert,sortable.options.helper=sortable.options._helper,sortable.placeholder&&sortable.placeholder.remove(),draggable._refreshOffsets(event),ui.position=draggable._generatePosition(event,!0),draggable._trigger("fromSortable",event),draggable.dropped=!1,$.each(draggable.sortables,function(){this.refreshPositions()}))})}}),$.ui.plugin.add("draggable","cursor",{start:function(event,ui,instance){var t=$("body"),o=instance.options;t.css("cursor")&&(o._cursor=t.css("cursor")),t.css("cursor",o.cursor)},stop:function(event,ui,instance){var o=instance.options;o._cursor&&$("body").css("cursor",o._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("opacity")&&(o._opacity=t.css("opacity")),t.css("opacity",o.opacity)},stop:function(event,ui,instance){var o=instance.options;o._opacity&&$(ui.helper).css("opacity",o._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(event,ui,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(event,ui,i){var o=i.options,scrolled=!1,scrollParent=i.scrollParentNotHidden[0],document=i.document[0];scrollParent!==document&&"HTML"!==scrollParent.tagName?(o.axis&&"x"===o.axis||(i.overflowOffset.top+scrollParent.offsetHeight-event.pageY<o.scrollSensitivity?scrollParent.scrollTop=scrolled=scrollParent.scrollTop+o.scrollSpeed:event.pageY-i.overflowOffset.top<o.scrollSensitivity&&(scrollParent.scrollTop=scrolled=scrollParent.scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(i.overflowOffset.left+scrollParent.offsetWidth-event.pageX<o.scrollSensitivity?scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft+o.scrollSpeed:event.pageX-i.overflowOffset.left<o.scrollSensitivity&&(scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)))),scrolled!==!1&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(i,event)}}),$.ui.plugin.add("draggable","snap",{start:function(event,ui,i){var o=i.options;i.snapElements=[],$(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var $t=$(this),$o=$t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})})},drag:function(event,ui,inst){var ts,bs,ls,rs,l,r,t,b,i,first,o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--)l=inst.snapElements[i].left-inst.margins.left,r=l+inst.snapElements[i].width,t=inst.snapElements[i].top-inst.margins.top,b=t+inst.snapElements[i].height,l-d>x2||x1>r+d||t-d>y2||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)?(inst.snapElements[i].snapping&&inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=!1):("inner"!==o.snapMode&&(ts=Math.abs(t-y2)<=d,bs=Math.abs(b-y1)<=d,ls=Math.abs(l-x2)<=d,rs=Math.abs(r-x1)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left)),first=ts||bs||ls||rs,"outer"!==o.snapMode&&(ts=Math.abs(t-y1)<=d,bs=Math.abs(b-y2)<=d,ls=Math.abs(l-x1)<=d,rs=Math.abs(r-x2)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left)),!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)&&inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=ts||bs||ls||rs||first)}}),$.ui.plugin.add("draggable","stack",{start:function(event,ui,instance){var min,o=instance.options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});group.length&&(min=parseInt($(group[0]).css("zIndex"),10)||0,$(group).each(function(i){$(this).css("zIndex",min+i)}),this.css("zIndex",min+group.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("zIndex")&&(o._zIndex=t.css("zIndex")),t.css("zIndex",o.zIndex)},stop:function(event,ui,instance){var o=instance.options;o._zIndex&&$(ui.helper).css("zIndex",o._zIndex)}});$.ui.draggable;$.widget("ui.resizable",$.ui.mouse,{version:"1.11.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(value){return parseInt(value,10)||0},_isNumber:function(value){return!isNaN(parseInt(value,10))},_hasScroll:function(el,a){if("hidden"===$(el).css("overflow"))return!1;var scroll=a&&"left"===a?"scrollLeft":"scrollTop",has=!1;return el[scroll]>0?!0:(el[scroll]=1,has=el[scroll]>0,el[scroll]=0,has)},_create:function(){var n,i,handle,axis,hname,that=this,o=this.options;if(this.element.addClass("ui-resizable"),$.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=o.handles||($(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),n=this.handles.split(","),this.handles={},i=0;i<n.length;i++)handle=$.trim(n[i]),hname="ui-resizable-"+handle,axis=$("<div class='ui-resizable-handle "+hname+"'></div>"),axis.css({zIndex:o.zIndex}),"se"===handle&&axis.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[handle]=".ui-resizable-"+handle,this.element.append(axis);this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=this.element.children(this.handles[i]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(axis=$(this.handles[i],this.element),padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth(),padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),target.css(padPos,padWrapper),this._proportionallyResize()),$(this.handles[i]).length},this._renderAxis(this.element),this._handles=$(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){that.resizing||(this.className&&(axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),that.axis=axis&&axis[1]?axis[1]:"se")}),o.autoHide&&(this._handles.hide(),$(this.element).addClass("ui-resizable-autohide").mouseenter(function(){o.disabled||($(this).removeClass("ui-resizable-autohide"),that._handles.show())}).mouseleave(function(){o.disabled||that.resizing||($(this).addClass("ui-resizable-autohide"),that._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(_destroy(this.element),wrapper=this.element,this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper),wrapper.remove()),this.originalElement.css("resize",this.originalResizeStyle),_destroy(this.originalElement),this},_mouseCapture:function(event){var i,handle,capture=!1;for(i in this.handles)handle=$(this.handles[i])[0],(handle===event.target||$.contains(handle,event.target))&&(capture=!0);return!this.options.disabled&&capture},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,el=this.element;return this.resizing=!0,this._renderProxy(),curleft=this._num(this.helper.css("left")),curtop=this._num(this.helper.css("top")),o.containment&&(curleft+=$(o.containment).scrollLeft()||0,curtop+=$(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:curleft,top:curtop},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:el.width(),height:el.height()},this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()},this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()},this.originalPosition={left:curleft,top:curtop},this.originalMousePosition={left:event.pageX,top:event.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,cursor=$(".ui-resizable-"+this.axis).css("cursor"),$("body").css("cursor","auto"===cursor?this.axis+"-resize":cursor),el.addClass("ui-resizable-resizing"),this._propagate("start",event),!0},_mouseDrag:function(event){var data,props,smp=this.originalMousePosition,a=this.axis,dx=event.pageX-smp.left||0,dy=event.pageY-smp.top||0,trigger=this._change[a];return this._updatePrevProperties(),trigger?(data=trigger.apply(this,[event,dx,dy]),this._updateVirtualBoundaries(event.shiftKey),(this._aspectRatio||event.shiftKey)&&(data=this._updateRatio(data,event)),data=this._respectSize(data,event),this._updateCache(data),this._propagate("resize",event),props=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),$.isEmptyObject(props)||(this._updatePrevProperties(),this._trigger("resize",event,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(event){this.resizing=!1;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;return this._helper&&(pr=this._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&this._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,s={width:that.helper.width()-soffsetw,height:that.helper.height()-soffseth},left=parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left)||null,top=parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top)||null,o.animate||this.element.css($.extend(s,{top:top,left:left})),that.helper.height(that.size.height),that.helper.width(that.size.width),this._helper&&!o.animate&&this._proportionallyResize()),$("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",event),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var props={};return this.position.top!==this.prevPosition.top&&(props.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(props.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(props.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(props.height=this.size.height+"px"),this.helper.css(props),props},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||forceAspectRatio)&&(pMinWidth=b.minHeight*this.aspectRatio,pMinHeight=b.minWidth/this.aspectRatio,pMaxWidth=b.maxHeight*this.aspectRatio,pMaxHeight=b.maxWidth/this.aspectRatio,pMinWidth>b.minWidth&&(b.minWidth=pMinWidth),pMinHeight>b.minHeight&&(b.minHeight=pMinHeight),pMaxWidth<b.maxWidth&&(b.maxWidth=pMaxWidth),pMaxHeight<b.maxHeight&&(b.maxHeight=pMaxHeight)),this._vBoundaries=b},_updateCache:function(data){this.offset=this.helper.offset(),this._isNumber(data.left)&&(this.position.left=data.left),this._isNumber(data.top)&&(this.position.top=data.top),this._isNumber(data.height)&&(this.size.height=data.height),this._isNumber(data.width)&&(this.size.width=data.width)},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;return this._isNumber(data.height)?data.width=data.height*this.aspectRatio:this._isNumber(data.width)&&(data.height=data.width/this.aspectRatio),"sw"===a&&(data.left=cpos.left+(csize.width-data.width),data.top=null),"nw"===a&&(data.top=cpos.top+(csize.height-data.height),data.left=cpos.left+(csize.width-data.width)),data},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=this._isNumber(data.width)&&o.maxWidth&&o.maxWidth<data.width,ismaxh=this._isNumber(data.height)&&o.maxHeight&&o.maxHeight<data.height,isminw=this._isNumber(data.width)&&o.minWidth&&o.minWidth>data.width,isminh=this._isNumber(data.height)&&o.minHeight&&o.minHeight>data.height,dw=this.originalPosition.left+this.originalSize.width,dh=this.position.top+this.size.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);return isminw&&(data.width=o.minWidth),isminh&&(data.height=o.minHeight),ismaxw&&(data.width=o.maxWidth),ismaxh&&(data.height=o.maxHeight),isminw&&cw&&(data.left=dw-o.minWidth),ismaxw&&cw&&(data.left=dw-o.maxWidth),isminh&&ch&&(data.top=dh-o.minHeight),ismaxh&&ch&&(data.top=dh-o.maxHeight),data.width||data.height||data.left||!data.top?data.width||data.height||data.top||!data.left||(data.left=null):data.top=null,data},_getPaddingPlusBorderDimensions:function(element){for(var i=0,widths=[],borders=[element.css("borderTopWidth"),element.css("borderRightWidth"),element.css("borderBottomWidth"),element.css("borderLeftWidth")],paddings=[element.css("paddingTop"),element.css("paddingRight"),element.css("paddingBottom"),element.css("paddingLeft")];4>i;i++)widths[i]=parseInt(borders[i],10)||0,widths[i]+=parseInt(paddings[i],10)||0;return{height:widths[0]+widths[2],width:widths[1]+widths[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var prel,i=0,element=this.helper||this.element;i<this._proportionallyResizeElements.length;i++)prel=this._proportionallyResizeElements[i],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(prel)),prel.css({height:element.height()-this.outerDimensions.height||0,width:element.width()-this.outerDimensions.width||0})},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset(),this._helper?(this.helper=this.helper||$("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element
},_change:{e:function(event,dx){return{width:this.originalSize.width+dx}},w:function(event,dx){var cs=this.originalSize,sp=this.originalPosition;return{left:sp.left+dx,width:cs.width-dx}},n:function(event,dx,dy){var cs=this.originalSize,sp=this.originalPosition;return{top:sp.top+dy,height:cs.height-dy}},s:function(event,dx,dy){return{height:this.originalSize.height+dy}},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]),"resize"!==n&&this._trigger(n,event,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).resizable("instance"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&that._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:that.size.width-soffsetw,height:that.size.height-soffseth},left=parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left)||null,top=parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top)||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseInt(that.element.css("width"),10),height:parseInt(that.element.css("height"),10),top:parseInt(that.element.css("top"),10),left:parseInt(that.element.css("left"),10)};pr&&pr.length&&$(pr[0]).css({width:data.width,height:data.height}),that._updateCache(data),that._propagate("resize",event)}})}}),$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).resizable("instance"),o=that.options,el=that.element,oc=o.containment,ce=oc instanceof $?oc.get(0):/parent/.test(oc)?el.parent().get(0):oc;ce&&(that.containerElement=$(ce),/document/.test(oc)||oc===document?(that.containerOffset={left:0,top:0},that.containerPosition={left:0,top:0},that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}):(element=$(ce),p=[],$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=that._num(element.css("padding"+name))}),that.containerOffset=element.offset(),that.containerPosition=element.position(),that.containerSize={height:element.innerHeight()-p[3],width:element.innerWidth()-p[1]},co=that.containerOffset,ch=that.containerSize.height,cw=that.containerSize.width,width=that._hasScroll(ce,"left")?ce.scrollWidth:cw,height=that._hasScroll(ce)?ce.scrollHeight:ch,that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height}))},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement,continueResize=!0;ce[0]!==document&&/static/.test(ce.css("position"))&&(cop=co),cp.left<(that._helper?co.left:0)&&(that.size.width=that.size.width+(that._helper?that.position.left-co.left:that.position.left-cop.left),pRatio&&(that.size.height=that.size.width/that.aspectRatio,continueResize=!1),that.position.left=o.helper?co.left:0),cp.top<(that._helper?co.top:0)&&(that.size.height=that.size.height+(that._helper?that.position.top-co.top:that.position.top),pRatio&&(that.size.width=that.size.height*that.aspectRatio,continueResize=!1),that.position.top=that._helper?co.top:0),isParent=that.containerElement.get(0)===that.element.parent().get(0),isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position")),isParent&&isOffsetRelative?(that.offset.left=that.parentData.left+that.position.left,that.offset.top=that.parentData.top+that.position.top):(that.offset.left=that.element.offset().left,that.offset.top=that.element.offset().top),woset=Math.abs(that.sizeDiff.width+(that._helper?that.offset.left-cop.left:that.offset.left-co.left)),hoset=Math.abs(that.sizeDiff.height+(that._helper?that.offset.top-cop.top:that.offset.top-co.top)),woset+that.size.width>=that.parentData.width&&(that.size.width=that.parentData.width-woset,pRatio&&(that.size.height=that.size.width/that.aspectRatio,continueResize=!1)),hoset+that.size.height>=that.parentData.height&&(that.size.height=that.parentData.height-hoset,pRatio&&(that.size.width=that.size.height*that.aspectRatio,continueResize=!1)),continueResize||(that.position.left=that.prevPosition.left,that.position.top=that.prevPosition.top,that.size.width=that.prevSize.width,that.size.height=that.prevSize.height)},stop:function(){var that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;that._helper&&!o.animate&&/relative/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h}),that._helper&&!o.animate&&/static/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}}),$.ui.plugin.add("resizable","alsoResize",{start:function(){var that=$(this).resizable("instance"),o=that.options,_store=function(exp){$(exp).each(function(){var el=$(this);el.data("ui-resizable-alsoresize",{width:parseInt(el.width(),10),height:parseInt(el.height(),10),left:parseInt(el.css("left"),10),top:parseInt(el.css("top"),10)})})};"object"!=typeof o.alsoResize||o.alsoResize.parentNode?_store(o.alsoResize):o.alsoResize.length?(o.alsoResize=o.alsoResize[0],_store(o.alsoResize)):$.each(o.alsoResize,function(exp){_store(exp)})},resize:function(event,ui){var that=$(this).resizable("instance"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:that.size.height-os.height||0,width:that.size.width-os.width||0,top:that.position.top-op.top||0,left:that.position.left-op.left||0},_alsoResize=function(exp,c){$(exp).each(function(){var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},css=c&&c.length?c:el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);sum&&sum>=0&&(style[prop]=sum||null)}),el.css(style)})};"object"!=typeof o.alsoResize||o.alsoResize.nodeType?_alsoResize(o.alsoResize):$.each(o.alsoResize,function(exp,c){_alsoResize(exp,c)})},stop:function(){$(this).removeData("resizable-alsoresize")}}),$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).resizable("instance"),o=that.options,cs=that.size;that.ghost=that.originalElement.clone(),that.ghost.css({opacity:.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof o.ghost?o.ghost:""),that.ghost.appendTo(that.helper)},resize:function(){var that=$(this).resizable("instance");that.ghost&&that.ghost.css({position:"relative",height:that.size.height,width:that.size.width})},stop:function(){var that=$(this).resizable("instance");that.ghost&&that.helper&&that.helper.get(0).removeChild(that.ghost.get(0))}}),$.ui.plugin.add("resizable","grid",{resize:function(){var outerDimensions,that=$(this).resizable("instance"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid="number"==typeof o.grid?[o.grid,o.grid]:o.grid,gridX=grid[0]||1,gridY=grid[1]||1,ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&o.maxWidth<newWidth,isMaxHeight=o.maxHeight&&o.maxHeight<newHeight,isMinWidth=o.minWidth&&o.minWidth>newWidth,isMinHeight=o.minHeight&&o.minHeight>newHeight;o.grid=grid,isMinWidth&&(newWidth+=gridX),isMinHeight&&(newHeight+=gridY),isMaxWidth&&(newWidth-=gridX),isMaxHeight&&(newHeight-=gridY),/^(se|s|e)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight):/^(ne)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.top=op.top-oy):/^(sw)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.left=op.left-ox):((0>=newHeight-gridY||0>=newWidth-gridX)&&(outerDimensions=that._getPaddingPlusBorderDimensions(this)),newHeight-gridY>0?(that.size.height=newHeight,that.position.top=op.top-oy):(newHeight=gridY-outerDimensions.height,that.size.height=newHeight,that.position.top=op.top+os.height-newHeight),newWidth-gridX>0?(that.size.width=newWidth,that.position.left=op.left-ox):(newWidth=gridY-outerDimensions.height,that.size.width=newWidth,that.position.left=op.left+os.width-newWidth))}});$.ui.resizable,$.widget("ui.dialog",{version:"1.11.2",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(pos){var topOffset=$(this).css(pos).offset().top;0>topOffset&&$(this).css("top",pos.top-topOffset)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&$.fn.draggable&&this._makeDraggable(),this.options.resizable&&$.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var element=this.options.appendTo;return element&&(element.jquery||element.nodeType)?$(element):this.document.find(element||"body").eq(0)},_destroy:function(){var next,originalPosition=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),next=originalPosition.parent.children().eq(originalPosition.index),next.length&&next[0]!==this.element[0]?next.before(this.element):originalPosition.parent.append(this.element)},widget:function(){return this.uiDialog},disable:$.noop,enable:$.noop,close:function(event){var activeElement,that=this;if(this._isOpen&&this._trigger("beforeClose",event)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{activeElement=this.document[0].activeElement,activeElement&&"body"!==activeElement.nodeName.toLowerCase()&&$(activeElement).blur()}catch(error){}this._hide(this.uiDialog,this.options.hide,function(){that._trigger("close",event)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(event,silent){var moved=!1,zIndicies=this.uiDialog.siblings(".ui-front:visible").map(function(){return+$(this).css("z-index")}).get(),zIndexMax=Math.max.apply(null,zIndicies);return zIndexMax>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",zIndexMax+1),moved=!0),moved&&!silent&&this._trigger("focus",event),moved},open:function(){var that=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=$(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){that._focusTabbable(),that._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var hasFocus=this._focusedElement;hasFocus||(hasFocus=this.element.find("[autofocus]")),hasFocus.length||(hasFocus=this.element.find(":tabbable")),hasFocus.length||(hasFocus=this.uiDialogButtonPane.find(":tabbable")),hasFocus.length||(hasFocus=this.uiDialogTitlebarClose.filter(":tabbable")),hasFocus.length||(hasFocus=this.uiDialog),hasFocus.eq(0).focus()},_keepFocus:function(event){function checkFocus(){var activeElement=this.document[0].activeElement,isActive=this.uiDialog[0]===activeElement||$.contains(this.uiDialog[0],activeElement);isActive||this._focusTabbable()}event.preventDefault(),checkFocus.call(this),this._delay(checkFocus)},_createWrapper:function(){this.uiDialog=$("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(event){if(this.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE)return event.preventDefault(),void this.close(event);if(event.keyCode===$.ui.keyCode.TAB&&!event.isDefaultPrevented()){var tabbables=this.uiDialog.find(":tabbable"),first=tabbables.filter(":first"),last=tabbables.filter(":last");event.target!==last[0]&&event.target!==this.uiDialog[0]||event.shiftKey?event.target!==first[0]&&event.target!==this.uiDialog[0]||!event.shiftKey||(this._delay(function(){last.focus()}),event.preventDefault()):(this._delay(function(){first.focus()}),event.preventDefault())}},mousedown:function(event){this._moveToTop(event)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var uiDialogTitle;this.uiDialogTitlebar=$("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(event){$(event.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=$("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(event){event.preventDefault(),this.close(event)}}),uiDialogTitle=$("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(uiDialogTitle),this.uiDialog.attr({"aria-labelledby":uiDialogTitle.attr("id")})},_title:function(title){this.options.title||title.html("&#160;"),title.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=$("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var that=this,buttons=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),$.isEmptyObject(buttons)||$.isArray(buttons)&&!buttons.length?void this.uiDialog.removeClass("ui-dialog-buttons"):($.each(buttons,function(name,props){var click,buttonOptions;props=$.isFunction(props)?{click:props,text:name}:props,props=$.extend({type:"button"},props),click=props.click,props.click=function(){click.apply(that.element[0],arguments)},buttonOptions={icons:props.icons,text:props.showText},delete props.icons,delete props.showText,$("<button></button>",props).button(buttonOptions).appendTo(that.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function filteredUi(ui){return{position:ui.position,offset:ui.offset}}var that=this,options=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(event,ui){$(this).addClass("ui-dialog-dragging"),that._blockFrames(),that._trigger("dragStart",event,filteredUi(ui))},drag:function(event,ui){that._trigger("drag",event,filteredUi(ui))},stop:function(event,ui){var left=ui.offset.left-that.document.scrollLeft(),top=ui.offset.top-that.document.scrollTop();options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" top"+(top>=0?"+":"")+top,of:that.window},$(this).removeClass("ui-dialog-dragging"),that._unblockFrames(),that._trigger("dragStop",event,filteredUi(ui))}})},_makeResizable:function(){function filteredUi(ui){return{originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size}}var that=this,options=this.options,handles=options.resizable,position=this.uiDialog.css("position"),resizeHandles="string"==typeof handles?handles:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:options.maxWidth,maxHeight:options.maxHeight,minWidth:options.minWidth,minHeight:this._minHeight(),handles:resizeHandles,start:function(event,ui){$(this).addClass("ui-dialog-resizing"),that._blockFrames(),that._trigger("resizeStart",event,filteredUi(ui))},resize:function(event,ui){that._trigger("resize",event,filteredUi(ui))},stop:function(event,ui){var offset=that.uiDialog.offset(),left=offset.left-that.document.scrollLeft(),top=offset.top-that.document.scrollTop();options.height=that.uiDialog.height(),options.width=that.uiDialog.width(),options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" top"+(top>=0?"+":"")+top,of:that.window},$(this).removeClass("ui-dialog-resizing"),that._unblockFrames(),that._trigger("resizeStop",event,filteredUi(ui))}}).css("position",position)},_trackFocus:function(){this._on(this.widget(),{focusin:function(event){this._makeFocusTarget(),this._focusedElement=$(event.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var instances=this._trackingInstances(),exists=$.inArray(this,instances);-1!==exists&&instances.splice(exists,1)},_trackingInstances:function(){var instances=this.document.data("ui-dialog-instances");return instances||(instances=[],this.document.data("ui-dialog-instances",instances)),instances},_minHeight:function(){var options=this.options;return"auto"===options.height?options.minHeight:Math.min(options.minHeight,options.height)},_position:function(){var isVisible=this.uiDialog.is(":visible");isVisible||this.uiDialog.show(),this.uiDialog.position(this.options.position),isVisible||this.uiDialog.hide()},_setOptions:function(options){var that=this,resize=!1,resizableOptions={};$.each(options,function(key,value){that._setOption(key,value),key in that.sizeRelatedOptions&&(resize=!0),key in that.resizableRelatedOptions&&(resizableOptions[key]=value)}),resize&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",resizableOptions)},_setOption:function(key,value){var isDraggable,isResizable,uiDialog=this.uiDialog;"dialogClass"===key&&uiDialog.removeClass(this.options.dialogClass).addClass(value),"disabled"!==key&&(this._super(key,value),"appendTo"===key&&this.uiDialog.appendTo(this._appendTo()),"buttons"===key&&this._createButtons(),"closeText"===key&&this.uiDialogTitlebarClose.button({label:""+value}),"draggable"===key&&(isDraggable=uiDialog.is(":data(ui-draggable)"),isDraggable&&!value&&uiDialog.draggable("destroy"),!isDraggable&&value&&this._makeDraggable()),"position"===key&&this._position(),"resizable"===key&&(isResizable=uiDialog.is(":data(ui-resizable)"),isResizable&&!value&&uiDialog.resizable("destroy"),isResizable&&"string"==typeof value&&uiDialog.resizable("option","handles",value),isResizable||value===!1||this._makeResizable()),"title"===key&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var nonContentHeight,minContentHeight,maxContentHeight,options=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),options.minWidth>options.width&&(options.width=options.minWidth),nonContentHeight=this.uiDialog.css({height:"auto",width:options.width}).outerHeight(),minContentHeight=Math.max(0,options.minHeight-nonContentHeight),maxContentHeight="number"==typeof options.maxHeight?Math.max(0,options.maxHeight-nonContentHeight):"none","auto"===options.height?this.element.css({minHeight:minContentHeight,maxHeight:maxContentHeight,height:"auto"}):this.element.height(Math.max(0,options.height-nonContentHeight)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var iframe=$(this);return $("<div>").css({position:"absolute",width:iframe.outerWidth(),height:iframe.outerHeight()}).appendTo(iframe.parent()).offset(iframe.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(event){return $(event.target).closest(".ui-dialog").length?!0:!!$(event.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var isOpening=!0;this._delay(function(){isOpening=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(event){isOpening||this._allowInteraction(event)||(event.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=$("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var overlays=this.document.data("ui-dialog-overlays")-1;overlays?this.document.data("ui-dialog-overlays",overlays):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}});$.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var proportions,o=this.options,accept=o.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept)},this.proportions=function(){return arguments.length?void(proportions=arguments[0]):proportions?proportions:proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(o.scope),o.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(scope){$.ui.ddmanager.droppables[scope]=$.ui.ddmanager.droppables[scope]||[],$.ui.ddmanager.droppables[scope].push(this)},_splice:function(drop){for(var i=0;i<drop.length;i++)drop[i]===this&&drop.splice(i,1)},_destroy:function(){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(key,value){if("accept"===key)this.accept=$.isFunction(value)?value:function(d){return d.is(value)};else if("scope"===key){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop),this._addToManager(value)}this._super(key,value)},_activate:function(event){var draggable=$.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),draggable&&this._trigger("activate",event,this.ui(draggable))},_deactivate:function(event){var draggable=$.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),draggable&&this._trigger("deactivate",event,this.ui(draggable))},_over:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",event,this.ui(draggable)))},_out:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",event,this.ui(draggable)))},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=!1;return draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$(this).droppable("instance");return inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],draggable.currentItem||draggable.element)&&$.ui.intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance,event)?(childrenIntersection=!0,!1):void 0}),childrenIntersection?!1:this.accept.call(this.element[0],draggable.currentItem||draggable.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",event,this.ui(draggable)),this.element):!1):!1},ui:function(c){return{draggable:c.currentItem||c.element,helper:c.helper,position:c.position,offset:c.positionAbs}}}),$.ui.intersect=function(){function isOverAxis(x,reference,size){return x>=reference&&reference+size>x}return function(draggable,droppable,toleranceMode,event){if(!droppable.offset)return!1;var x1=(draggable.positionAbs||draggable.position.absolute).left+draggable.margins.left,y1=(draggable.positionAbs||draggable.position.absolute).top+draggable.margins.top,x2=x1+draggable.helperProportions.width,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,t=droppable.offset.top,r=l+droppable.proportions().width,b=t+droppable.proportions().height;switch(toleranceMode){case"fit":return x1>=l&&r>=x2&&y1>=t&&b>=y2;case"intersect":return l<x1+draggable.helperProportions.width/2&&x2-draggable.helperProportions.width/2<r&&t<y1+draggable.helperProportions.height/2&&y2-draggable.helperProportions.height/2<b;case"pointer":return isOverAxis(event.pageY,t,droppable.proportions().height)&&isOverAxis(event.pageX,l,droppable.proportions().width);case"touch":return(y1>=t&&b>=y1||y2>=t&&b>=y2||t>y1&&y2>b)&&(x1>=l&&r>=x1||x2>=l&&r>=x2||l>x1&&x2>r);default:return!1}}}(),$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++)if(!(m[i].options.disabled||t&&!m[i].accept.call(m[i].element[0],t.currentItem||t.element))){for(j=0;j<list.length;j++)if(list[j]===m[i].element[0]){m[i].proportions().height=0;continue droppablesLoop}m[i].visible="none"!==m[i].element.css("display"),m[i].visible&&("mousedown"===type&&m[i]._activate.call(m[i],event),m[i].offset=m[i].element.offset(),m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight}))}},drop:function(draggable,event){var dropped=!1;return $.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&$.ui.intersect(draggable,this,this.options.tolerance,event)&&(dropped=this._drop.call(this,event)||dropped),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,event)))}),dropped},dragStart:function(draggable,event){draggable.element.parentsUntil("body").bind("scroll.droppable",function(){draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)})},drag:function(draggable,event){draggable.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(draggable,event),$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var parentInstance,scope,parent,intersects=$.ui.intersect(draggable,this,this.options.tolerance,event),c=!intersects&&this.isover?"isout":intersects&&!this.isover?"isover":null;c&&(this.options.greedy&&(scope=this.options.scope,parent=this.element.parents(":data(ui-droppable)").filter(function(){return $(this).droppable("instance").options.scope===scope}),parent.length&&(parentInstance=$(parent[0]).droppable("instance"),parentInstance.greedyChild="isover"===c)),parentInstance&&"isover"===c&&(parentInstance.isover=!1,parentInstance.isout=!0,parentInstance._out.call(parentInstance,event)),this[c]=!0,this["isout"===c?"isover":"isout"]=!1,this["isover"===c?"_over":"_out"].call(this,event),parentInstance&&"isout"===c&&(parentInstance.isout=!1,parentInstance.isover=!0,parentInstance._over.call(parentInstance,event)))}})},dragStop:function(draggable,event){draggable.element.parentsUntil("body").unbind("scroll.droppable"),draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)}};var dataSpace=($.ui.droppable,"ui-effects-"),jQuery=$;$.effects={effect:{}},function(jQuery,undefined){function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};return null==value?allowEmpty||!prop.def?null:prop.def:(value=type.floor?~~value:parseFloat(value),isNaN(value)?prop.def:type.mod?(value+type.mod)%type.mod:0>value?0:type.max<value?type.max:value)}function stringParse(string){var inst=color(),rgba=inst._rgba=[];return string=string.toLowerCase(),each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";return values?(parsed=inst[spaceName](values),inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache],rgba=inst._rgba=parsed._rgba,!1):void 0}),rgba.length?("0,0,0,0"===rgba.join()&&jQuery.extend(rgba,colors.transparent),inst):colors[string]}function hue2rgb(p,q,h){return h=(h+1)%1,1>6*h?p+(q-p)*h*6:1>2*h?q:2>3*h?p+(q-p)*(2/3-h)*6:p}var colors,stepHooks="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],execResult[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)]
}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]]}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha)},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},support=color.support={},supportElem=jQuery("<p>")[0],each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)",support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1,each(spaces,function(spaceName,space){space.cache="_"+spaceName,space.props.alpha={idx:3,type:"percent",def:1}}),color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(red===undefined)return this._rgba=[null,null,null,null],this;(red.jquery||red.nodeType)&&(red=jQuery(red).css(green),green=undefined);var inst=this,type=jQuery.type(red),rgba=this._rgba=[];return green!==undefined&&(red=[red,green,blue,alpha],type="array"),"string"===type?this.parse(stringParse(red)||colors._default):"array"===type?(each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop)}),this):"object"===type?(red instanceof color?each(spaces,function(spaceName,space){red[space.cache]&&(inst[space.cache]=red[space.cache].slice())}):each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if("alpha"===key||null==red[key])return;inst[cache]=space.to(inst._rgba)}inst[cache][prop.idx]=clamp(red[key],prop,!0)}),inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0&&(inst[cache][3]=1,space.from&&(inst._rgba=space.from(inst[cache])))}),this):void 0},is:function(compare){var is=color(compare),same=!0,inst=this;return each(spaces,function(_,space){var localCache,isCache=is[space.cache];return isCache&&(localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[],each(space.props,function(_,prop){return null!=isCache[prop.idx]?same=isCache[prop.idx]===localCache[prop.idx]:void 0})),same}),same},_space:function(){var used=[],inst=this;return each(spaces,function(spaceName,space){inst[space.cache]&&used.push(spaceName)}),used.pop()},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=0===this.alpha()?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();return end=end[space.cache],each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};null!==endValue&&(null===startValue?result[index]=endValue:(type.mod&&(endValue-startValue>type.mod/2?startValue+=type.mod:startValue-endValue>type.mod/2&&(startValue-=type.mod)),result[index]=clamp((endValue-startValue)*distance+startValue,prop)))}),this[spaceName](result)},blend:function(opaque){if(1===this._rgba[3])return this;var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v}))},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return null==v?i>2?1:0:v});return 1===rgba[3]&&(rgba.pop(),prefix="rgb("),prefix+rgba.join()+")"},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){return null==v&&(v=i>2?1:0),i&&3>i&&(v=Math.round(100*v)+"%"),v});return 1===hsla[3]&&(hsla.pop(),prefix="hsl("),prefix+hsla.join()+")"},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();return includeAlpha&&rgba.push(~~(255*alpha)),"#"+jQuery.map(rgba,function(v){return v=(v||0).toString(16),1===v.length?"0"+v:v}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),color.fn.parse.prototype=color.fn,spaces.hsla.to=function(rgba){if(null==rgba[0]||null==rgba[1]||null==rgba[2])return[null,null,null,rgba[3]];var h,s,r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=.5*add;return h=min===max?0:r===max?60*(g-b)/diff+360:g===max?60*(b-r)/diff+120:60*(r-g)/diff+240,s=0===diff?0:.5>=l?diff/add:diff/(2-add),[Math.round(h)%360,s,l,null==a?1:a]},spaces.hsla.from=function(hsla){if(null==hsla[0]||null==hsla[1]||null==hsla[2])return[null,null,null,hsla[3]];var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=.5>=l?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(255*hue2rgb(p,q,h+1/3)),Math.round(255*hue2rgb(p,q,h)),Math.round(255*hue2rgb(p,q,h-1/3)),a]},each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]&&(this[cache]=to(this._rgba)),value===undefined)return this[cache].slice();var ret,type=jQuery.type(value),arr="array"===type||"object"===type?value:arguments,local=this[cache].slice();return each(props,function(key,prop){var val=arr["object"===type?key:prop.idx];null==val&&(val=local[prop.idx]),local[prop.idx]=clamp(val,prop)}),from?(ret=color(from(local)),ret[cache]=local,ret):color(local)},each(props,function(key,prop){color.fn[key]||(color.fn[key]=function(value){var match,vtype=jQuery.type(value),fn="alpha"===key?this._hsla?"hsla":"rgba":spaceName,local=this[fn](),cur=local[prop.idx];return"undefined"===vtype?cur:("function"===vtype&&(value=value.call(this,cur),vtype=jQuery.type(value)),null==value&&prop.empty?this:("string"===vtype&&(match=rplusequals.exec(value),match&&(value=cur+parseFloat(match[2])*("+"===match[1]?1:-1))),local[prop.idx]=value,this[fn](local)))})})}),color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if("transparent"!==value&&("string"!==jQuery.type(value)||(parsed=stringParse(value)))){if(value=color(parsed||value),!support.rgba&&1!==value._rgba[3]){for(curElem="backgroundColor"===hook?elem.parentNode:elem;(""===backgroundColor||"transparent"===backgroundColor)&&curElem&&curElem.style;)try{backgroundColor=jQuery.css(curElem,"backgroundColor"),curElem=curElem.parentNode}catch(e){}value=value.blend(backgroundColor&&"transparent"!==backgroundColor?backgroundColor:"_default")}value=value.toRgbaString()}try{elem.style[hook]=value}catch(e){}}},jQuery.fx.step[hook]=function(fx){fx.colorInit||(fx.start=color(fx.elem,hook),fx.end=color(fx.end),fx.colorInit=!0),jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos))}})},color.hook(stepHooks),jQuery.cssHooks.borderColor={expand:function(value){var expanded={};return each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value}),expanded}},colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function getElementStyles(elem){var key,len,style=elem.ownerDocument.defaultView?elem.ownerDocument.defaultView.getComputedStyle(elem,null):elem.currentStyle,styles={};if(style&&style.length&&style[0]&&style[style[0]])for(len=style.length;len--;)key=style[len],"string"==typeof style[key]&&(styles[$.camelCase(key)]=style[key]);else for(key in style)"string"==typeof style[key]&&(styles[key]=style[key]);return styles}function styleDifference(oldStyle,newStyle){var name,value,diff={};for(name in newStyle)value=newStyle[name],oldStyle[name]!==value&&(shorthandStyles[name]||($.fx.step[name]||!isNaN(parseFloat(value)))&&(diff[name]=value));return diff}var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){("none"!==fx.end&&!fx.setAttr||1===fx.pos&&!fx.setAttr)&&(jQuery.style(fx.elem,prop,fx.end),fx.setAttr=!0)}}),$.fn.addBack||($.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}),$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var applyClassChange,animated=$(this),baseClass=animated.attr("class")||"",allAnimations=o.children?animated.find("*").addBack():animated;allAnimations=allAnimations.map(function(){var el=$(this);return{el:el,start:getElementStyles(this)}}),applyClassChange=function(){$.each(classAnimationActions,function(i,action){value[action]&&animated[action+"Class"](value[action])})},applyClassChange(),allAnimations=allAnimations.map(function(){return this.end=getElementStyles(this.el[0]),this.diff=styleDifference(this.start,this.end),this}),animated.attr("class",baseClass),allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred(),opts=$.extend({},o,{queue:!1,complete:function(){dfd.resolve(styleInfo)}});return this.el.animate(this.diff,opts),dfd.promise()}),$.when.apply($,allAnimations.get()).done(function(){applyClassChange(),$.each(arguments,function(){var el=this.el;$.each(this.diff,function(key){el.css(key,"")})}),o.complete.call(animated[0])})})},$.fn.extend({addClass:function(orig){return function(classNames,speed,easing,callback){return speed?$.effects.animateClass.call(this,{add:classNames},speed,easing,callback):orig.apply(this,arguments)}}($.fn.addClass),removeClass:function(orig){return function(classNames,speed,easing,callback){return arguments.length>1?$.effects.animateClass.call(this,{remove:classNames},speed,easing,callback):orig.apply(this,arguments)}}($.fn.removeClass),toggleClass:function(orig){return function(classNames,force,speed,easing,callback){return"boolean"==typeof force||void 0===force?speed?$.effects.animateClass.call(this,force?{add:classNames}:{remove:classNames},speed,easing,callback):orig.apply(this,arguments):$.effects.animateClass.call(this,{toggle:classNames},force,speed,easing)}}($.fn.toggleClass),switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.call(this,{add:add,remove:remove},speed,easing,callback)}})}(),function(){function _normalizeArguments(effect,options,speed,callback){return $.isPlainObject(effect)&&(options=effect,effect=effect.effect),effect={effect:effect},null==options&&(options={}),$.isFunction(options)&&(callback=options,speed=null,options={}),("number"==typeof options||$.fx.speeds[options])&&(callback=speed,speed=options,options={}),$.isFunction(speed)&&(callback=speed,speed=null),options&&$.extend(effect,options),speed=speed||options.duration,effect.duration=$.fx.off?0:"number"==typeof speed?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default,effect.complete=callback||options.complete,effect}function standardAnimationOption(option){return!option||"number"==typeof option||$.fx.speeds[option]?!0:"string"!=typeof option||$.effects.effect[option]?$.isFunction(option)?!0:"object"!=typeof option||option.effect?!1:!0:!0}$.extend($.effects,{version:"1.11.2",save:function(element,set){for(var i=0;i<set.length;i++)null!==set[i]&&element.data(dataSpace+set[i],element[0].style[set[i]])},restore:function(element,set){var val,i;for(i=0;i<set.length;i++)null!==set[i]&&(val=element.data(dataSpace+set[i]),void 0===val&&(val=""),element.css(set[i],val))},setMode:function(el,mode){return"toggle"===mode&&(mode=el.is(":hidden")?"show":"hide"),mode},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height}switch(origin[1]){case"left":x=0;break;case"center":x=.5;break;case"right":x=1;break;default:x=origin[1]/original.width}return{x:x,y:y}},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper"))return element.parent();var props={width:element.outerWidth(!0),height:element.outerHeight(!0),"float":element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()},active=document.activeElement;try{active.id}catch(e){active=document.body}return element.wrap(wrapper),(element[0]===active||$.contains(element[0],active))&&$(active).focus(),wrapper=element.parent(),"static"===element.css("position")?(wrapper.css({position:"relative"}),element.css({position:"relative"})):($.extend(props,{position:element.css("position"),zIndex:element.css("z-index")}),$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos),isNaN(parseInt(props[pos],10))&&(props[pos]="auto")}),element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),element.css(size),wrapper.css(props).show()},removeWrapper:function(element){var active=document.activeElement;return element.parent().is(".ui-effects-wrapper")&&(element.parent().replaceWith(element),(element[0]===active||$.contains(element[0],active))&&$(active).focus()),element},setTransition:function(element,list,factor,value){return value=value||{},$.each(list,function(i,x){var unit=element.cssUnit(x);unit[0]>0&&(value[x]=unit[0]*factor+unit[1])}),value}}),$.fn.extend({effect:function(){function run(next){function done(){$.isFunction(complete)&&complete.call(elem[0]),$.isFunction(next)&&next()}var elem=$(this),complete=args.complete,mode=args.mode;(elem.is(":hidden")?"hide"===mode:"show"===mode)?(elem[mode](),done()):effectMethod.call(elem[0],args,done)}var args=_normalizeArguments.apply(this,arguments),mode=args.mode,queue=args.queue,effectMethod=$.effects.effect[args.effect];return $.fx.off||!effectMethod?mode?this[mode](args.duration,args.complete):this.each(function(){args.complete&&args.complete.call(this)}):queue===!1?this.each(run):this.queue(queue||"fx",run)},show:function(orig){return function(option){if(standardAnimationOption(option))return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="show",this.effect.call(this,args)}}($.fn.show),hide:function(orig){return function(option){if(standardAnimationOption(option))return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="hide",this.effect.call(this,args)}}($.fn.hide),toggle:function(orig){return function(option){if(standardAnimationOption(option)||"boolean"==typeof option)return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="toggle",this.effect.call(this,args)}}($.fn.toggle),cssUnit:function(key){var style=this.css(key),val=[];return $.each(["em","px","%","pt"],function(i,unit){style.indexOf(unit)>0&&(val=[parseFloat(style),unit])}),val}})}(),function(){var baseEasings={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){baseEasings[name]=function(p){return Math.pow(p,i+2)}}),$.extend(baseEasings,{Sine:function(p){return 1-Math.cos(p*Math.PI/2)},Circ:function(p){return 1-Math.sqrt(1-p*p)},Elastic:function(p){return 0===p||1===p?p:-Math.pow(2,8*(p-1))*Math.sin((80*(p-1)-7.5)*Math.PI/15)},Back:function(p){return p*p*(3*p-2)},Bounce:function(p){for(var pow2,bounce=4;p<((pow2=Math.pow(2,--bounce))-1)/11;);return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((3*pow2-2)/22-p,2)}}),$.each(baseEasings,function(name,easeIn){$.easing["easeIn"+name]=easeIn,$.easing["easeOut"+name]=function(p){return 1-easeIn(1-p)},$.easing["easeInOut"+name]=function(p){return.5>p?easeIn(2*p)/2:1-easeIn(-2*p+2)/2}})}();$.effects,$.effects.effect.blind=function(o,done){var wrapper,distance,margin,el=$(this),rvertical=/up|down|vertical/,rpositivemotion=/up|left|vertical|horizontal/,props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),direction=o.direction||"up",vertical=rvertical.test(direction),ref=vertical?"height":"width",ref2=vertical?"top":"left",motion=rpositivemotion.test(direction),animation={},show="show"===mode;el.parent().is(".ui-effects-wrapper")?$.effects.save(el.parent(),props):$.effects.save(el,props),el.show(),wrapper=$.effects.createWrapper(el).css({overflow:"hidden"}),distance=wrapper[ref](),margin=parseFloat(wrapper.css(ref2))||0,animation[ref]=show?distance:0,motion||(el.css(vertical?"bottom":"right",0).css(vertical?"top":"left","auto").css({position:"absolute"}),animation[ref2]=show?margin:distance+margin),show&&(wrapper.css(ref,0),motion||wrapper.css(ref2,margin+distance)),wrapper.animate(animation,{duration:o.duration,easing:o.easing,queue:!1,complete:function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})},$.effects.effect.bounce=function(o,done){var i,upAnim,downAnim,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),hide="hide"===mode,show="show"===mode,direction=o.direction||"up",distance=o.distance,times=o.times||5,anims=2*times+(show||hide?1:0),speed=o.duration/anims,easing=o.easing,ref="up"===direction||"down"===direction?"top":"left",motion="up"===direction||"left"===direction,queue=el.queue(),queuelen=queue.length;for((show||hide)&&props.push("opacity"),$.effects.save(el,props),el.show(),$.effects.createWrapper(el),distance||(distance=el["top"===ref?"outerHeight":"outerWidth"]()/3),show&&(downAnim={opacity:1},downAnim[ref]=0,el.css("opacity",0).css(ref,motion?2*-distance:2*distance).animate(downAnim,speed,easing)),hide&&(distance/=Math.pow(2,times-1)),downAnim={},downAnim[ref]=0,i=0;times>i;i++)upAnim={},upAnim[ref]=(motion?"-=":"+=")+distance,el.animate(upAnim,speed,easing).animate(downAnim,speed,easing),distance=hide?2*distance:distance/2;hide&&(upAnim={opacity:0},upAnim[ref]=(motion?"-=":"+=")+distance,el.animate(upAnim,speed,easing)),el.queue(function(){hide&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}),queuelen>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1))),el.dequeue()},$.effects.effect.clip=function(o,done){var wrapper,animate,distance,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,direction=o.direction||"vertical",vert="vertical"===direction,size=vert?"height":"width",position=vert?"top":"left",animation={};$.effects.save(el,props),el.show(),wrapper=$.effects.createWrapper(el).css({overflow:"hidden"}),animate="IMG"===el[0].tagName?wrapper:el,distance=animate[size](),show&&(animate.css(size,0),animate.css(position,distance/2)),animation[size]=show?distance:0,animation[position]=show?0:distance/2,animate.animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){show||el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})},$.effects.effect.drop=function(o,done){var distance,el=$(this),props=["position","top","bottom","left","right","opacity","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,direction=o.direction||"left",ref="up"===direction||"down"===direction?"top":"left",motion="up"===direction||"left"===direction?"pos":"neg",animation={opacity:show?1:0};$.effects.save(el,props),el.show(),$.effects.createWrapper(el),distance=o.distance||el["top"===ref?"outerHeight":"outerWidth"](!0)/2,show&&el.css("opacity",0).css(ref,"pos"===motion?-distance:distance),animation[ref]=(show?"pos"===motion?"+=":"-=":"pos"===motion?"-=":"+=")+distance,el.animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})},$.effects.effect.explode=function(o,done){function childComplete(){pieces.push(this),pieces.length===rows*cells&&animComplete()}function animComplete(){el.css({visibility:"visible"}),$(pieces).remove(),show||el.hide(),done()}var i,j,left,top,mx,my,rows=o.pieces?Math.round(Math.sqrt(o.pieces)):3,cells=rows,el=$(this),mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,offset=el.show().css("visibility","hidden").offset(),width=Math.ceil(el.outerWidth()/cells),height=Math.ceil(el.outerHeight()/rows),pieces=[];for(i=0;rows>i;i++)for(top=offset.top+i*height,my=i-(rows-1)/2,j=0;cells>j;j++)left=offset.left+j*width,mx=j-(cells-1)/2,el.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*width,top:-i*height}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:width,height:height,left:left+(show?mx*width:0),top:top+(show?my*height:0),opacity:show?0:1}).animate({left:left+(show?0:mx*width),top:top+(show?0:my*height),opacity:show?1:0},o.duration||500,o.easing,childComplete)},$.effects.effect.fade=function(o,done){var el=$(this),mode=$.effects.setMode(el,o.mode||"toggle");el.animate({opacity:mode},{queue:!1,duration:o.duration,easing:o.easing,complete:done})},$.effects.effect.fold=function(o,done){var wrapper,distance,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show="show"===mode,hide="hide"===mode,size=o.size||15,percent=/([0-9]+)%/.exec(size),horizFirst=!!o.horizFirst,widthFirst=show!==horizFirst,ref=widthFirst?["width","height"]:["height","width"],duration=o.duration/2,animation1={},animation2={};$.effects.save(el,props),el.show(),wrapper=$.effects.createWrapper(el).css({overflow:"hidden"}),distance=widthFirst?[wrapper.width(),wrapper.height()]:[wrapper.height(),wrapper.width()],percent&&(size=parseInt(percent[1],10)/100*distance[hide?0:1]),show&&wrapper.css(horizFirst?{height:0,width:size}:{height:size,width:0}),animation1[ref[0]]=show?distance[0]:size,animation2[ref[1]]=show?distance[1]:0,wrapper.animate(animation1,duration,o.easing).animate(animation2,duration,o.easing,function(){hide&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()})},$.effects.effect.highlight=function(o,done){var elem=$(this),props=["backgroundImage","backgroundColor","opacity"],mode=$.effects.setMode(elem,o.mode||"show"),animation={backgroundColor:elem.css("backgroundColor")};"hide"===mode&&(animation.opacity=0),$.effects.save(elem,props),elem.show().css({backgroundImage:"none",backgroundColor:o.color||"#ffff99"}).animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){"hide"===mode&&elem.hide(),$.effects.restore(elem,props),done()}})},$.effects.effect.size=function(o,done){var original,baseline,factor,el=$(this),props0=["position","top","bottom","left","right","width","height","overflow","opacity"],props1=["position","top","bottom","left","right","overflow","opacity"],props2=["width","height","overflow"],cProps=["fontSize"],vProps=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],hProps=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],mode=$.effects.setMode(el,o.mode||"effect"),restore=o.restore||"effect"!==mode,scale=o.scale||"both",origin=o.origin||["middle","center"],position=el.css("position"),props=restore?props0:props1,zero={height:0,width:0,outerHeight:0,outerWidth:0};"show"===mode&&el.show(),original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()},"toggle"===o.mode&&"show"===mode?(el.from=o.to||zero,el.to=o.from||original):(el.from=o.from||("show"===mode?zero:original),el.to=o.to||("hide"===mode?zero:original)),factor={from:{y:el.from.height/original.height,x:el.from.width/original.width},to:{y:el.to.height/original.height,x:el.to.width/original.width}},("box"===scale||"both"===scale)&&(factor.from.y!==factor.to.y&&(props=props.concat(vProps),el.from=$.effects.setTransition(el,vProps,factor.from.y,el.from),el.to=$.effects.setTransition(el,vProps,factor.to.y,el.to)),factor.from.x!==factor.to.x&&(props=props.concat(hProps),el.from=$.effects.setTransition(el,hProps,factor.from.x,el.from),el.to=$.effects.setTransition(el,hProps,factor.to.x,el.to))),("content"===scale||"both"===scale)&&factor.from.y!==factor.to.y&&(props=props.concat(cProps).concat(props2),el.from=$.effects.setTransition(el,cProps,factor.from.y,el.from),el.to=$.effects.setTransition(el,cProps,factor.to.y,el.to)),$.effects.save(el,props),el.show(),$.effects.createWrapper(el),el.css("overflow","hidden").css(el.from),origin&&(baseline=$.effects.getBaseline(origin,original),el.from.top=(original.outerHeight-el.outerHeight())*baseline.y,el.from.left=(original.outerWidth-el.outerWidth())*baseline.x,el.to.top=(original.outerHeight-el.to.outerHeight)*baseline.y,el.to.left=(original.outerWidth-el.to.outerWidth)*baseline.x),el.css(el.from),("content"===scale||"both"===scale)&&(vProps=vProps.concat(["marginTop","marginBottom"]).concat(cProps),hProps=hProps.concat(["marginLeft","marginRight"]),props2=props0.concat(vProps).concat(hProps),el.find("*[width]").each(function(){var child=$(this),c_original={height:child.height(),width:child.width(),outerHeight:child.outerHeight(),outerWidth:child.outerWidth()};restore&&$.effects.save(child,props2),child.from={height:c_original.height*factor.from.y,width:c_original.width*factor.from.x,outerHeight:c_original.outerHeight*factor.from.y,outerWidth:c_original.outerWidth*factor.from.x},child.to={height:c_original.height*factor.to.y,width:c_original.width*factor.to.x,outerHeight:c_original.height*factor.to.y,outerWidth:c_original.width*factor.to.x},factor.from.y!==factor.to.y&&(child.from=$.effects.setTransition(child,vProps,factor.from.y,child.from),child.to=$.effects.setTransition(child,vProps,factor.to.y,child.to)),factor.from.x!==factor.to.x&&(child.from=$.effects.setTransition(child,hProps,factor.from.x,child.from),child.to=$.effects.setTransition(child,hProps,factor.to.x,child.to)),child.css(child.from),child.animate(child.to,o.duration,o.easing,function(){restore&&$.effects.restore(child,props2)})})),el.animate(el.to,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){0===el.to.opacity&&el.css("opacity",el.from.opacity),"hide"===mode&&el.hide(),$.effects.restore(el,props),restore||("static"===position?el.css({position:"relative",top:el.to.top,left:el.to.left}):$.each(["top","left"],function(idx,pos){el.css(pos,function(_,str){var val=parseInt(str,10),toRef=idx?el.to.left:el.to.top;return"auto"===str?toRef+"px":val+toRef+"px"})})),$.effects.removeWrapper(el),done()}})},$.effects.effect.scale=function(o,done){var el=$(this),options=$.extend(!0,{},o),mode=$.effects.setMode(el,o.mode||"effect"),percent=parseInt(o.percent,10)||(0===parseInt(o.percent,10)?0:"hide"===mode?0:100),direction=o.direction||"both",origin=o.origin,original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()},factor={y:"horizontal"!==direction?percent/100:1,x:"vertical"!==direction?percent/100:1};options.effect="size",options.queue=!1,options.complete=done,"effect"!==mode&&(options.origin=origin||["middle","center"],options.restore=!0),options.from=o.from||("show"===mode?{height:0,width:0,outerHeight:0,outerWidth:0}:original),options.to={height:original.height*factor.y,width:original.width*factor.x,outerHeight:original.outerHeight*factor.y,outerWidth:original.outerWidth*factor.x},options.fade&&("show"===mode&&(options.from.opacity=0,options.to.opacity=1),"hide"===mode&&(options.from.opacity=1,options.to.opacity=0)),el.effect(options)},$.effects.effect.puff=function(o,done){var elem=$(this),mode=$.effects.setMode(elem,o.mode||"hide"),hide="hide"===mode,percent=parseInt(o.percent,10)||150,factor=percent/100,original={height:elem.height(),width:elem.width(),outerHeight:elem.outerHeight(),outerWidth:elem.outerWidth()};$.extend(o,{effect:"scale",queue:!1,fade:!0,mode:mode,complete:done,percent:hide?percent:100,from:hide?original:{height:original.height*factor,width:original.width*factor,outerHeight:original.outerHeight*factor,outerWidth:original.outerWidth*factor}}),elem.effect(o)},$.effects.effect.pulsate=function(o,done){var i,elem=$(this),mode=$.effects.setMode(elem,o.mode||"show"),show="show"===mode,hide="hide"===mode,showhide=show||"hide"===mode,anims=2*(o.times||5)+(showhide?1:0),duration=o.duration/anims,animateTo=0,queue=elem.queue(),queuelen=queue.length;for((show||!elem.is(":visible"))&&(elem.css("opacity",0).show(),animateTo=1),i=1;anims>i;i++)elem.animate({opacity:animateTo},duration,o.easing),animateTo=1-animateTo;elem.animate({opacity:animateTo},duration,o.easing),elem.queue(function(){hide&&elem.hide(),done()}),queuelen>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1))),elem.dequeue()},$.effects.effect.shake=function(o,done){var i,el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),direction=o.direction||"left",distance=o.distance||20,times=o.times||3,anims=2*times+1,speed=Math.round(o.duration/anims),ref="up"===direction||"down"===direction?"top":"left",positiveMotion="up"===direction||"left"===direction,animation={},animation1={},animation2={},queue=el.queue(),queuelen=queue.length;for($.effects.save(el,props),el.show(),$.effects.createWrapper(el),animation[ref]=(positiveMotion?"-=":"+=")+distance,animation1[ref]=(positiveMotion?"+=":"-=")+2*distance,animation2[ref]=(positiveMotion?"-=":"+=")+2*distance,el.animate(animation,speed,o.easing),i=1;times>i;i++)el.animate(animation1,speed,o.easing).animate(animation2,speed,o.easing);el.animate(animation1,speed,o.easing).animate(animation,speed/2,o.easing).queue(function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}),queuelen>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1))),el.dequeue()},$.effects.effect.slide=function(o,done){var distance,el=$(this),props=["position","top","bottom","left","right","width","height"],mode=$.effects.setMode(el,o.mode||"show"),show="show"===mode,direction=o.direction||"left",ref="up"===direction||"down"===direction?"top":"left",positiveMotion="up"===direction||"left"===direction,animation={};$.effects.save(el,props),el.show(),distance=o.distance||el["top"===ref?"outerHeight":"outerWidth"](!0),$.effects.createWrapper(el).css({overflow:"hidden"}),show&&el.css(ref,positiveMotion?isNaN(distance)?"-"+distance:-distance:distance),animation[ref]=(show?positiveMotion?"+=":"-=":positiveMotion?"-=":"+=")+distance,el.animate(animation,{queue:!1,duration:o.duration,easing:o.easing,complete:function(){"hide"===mode&&el.hide(),$.effects.restore(el,props),$.effects.removeWrapper(el),done()}})},$.effects.effect.transfer=function(o,done){var elem=$(this),target=$(o.to),targetFixed="fixed"===target.css("position"),body=$("body"),fixTop=targetFixed?body.scrollTop():0,fixLeft=targetFixed?body.scrollLeft():0,endPosition=target.offset(),animation={top:endPosition.top-fixTop,left:endPosition.left-fixLeft,height:target.innerHeight(),width:target.innerWidth()},startPosition=elem.offset(),transfer=$("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(o.className).css({top:startPosition.top-fixTop,left:startPosition.left-fixLeft,height:elem.innerHeight(),width:elem.innerWidth(),position:targetFixed?"fixed":"absolute"}).animate(animation,o.duration,o.easing,function(){transfer.remove(),done()})},$.widget("ui.progressbar",{version:"1.11.2",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=$("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()
},value:function(newValue){return void 0===newValue?this.options.value:(this.options.value=this._constrainedValue(newValue),void this._refreshValue())},_constrainedValue:function(newValue){return void 0===newValue&&(newValue=this.options.value),this.indeterminate=newValue===!1,"number"!=typeof newValue&&(newValue=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,newValue))},_setOptions:function(options){var value=options.value;delete options.value,this._super(options),this.options.value=this._constrainedValue(value),this._refreshValue()},_setOption:function(key,value){"max"===key&&(value=Math.max(this.min,value)),"disabled"===key&&this.element.toggleClass("ui-state-disabled",!!value).attr("aria-disabled",value),this._super(key,value)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var value=this.options.value,percentage=this._percentage();this.valueDiv.toggle(this.indeterminate||value>this.min).toggleClass("ui-corner-right",value===this.options.max).width(percentage.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=$("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":value}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==value&&(this.oldValue=value,this._trigger("change")),value===this.options.max&&this._trigger("complete")}}),$.widget("ui.selectable",$.ui.mouse,{version:"1.11.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var selectees,that=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){selectees=$(that.options.filter,that.element[0]),selectees.addClass("ui-selectee"),selectees.each(function(){var $this=$(this),pos=$this.offset();$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:!1,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=selectees.addClass("ui-selectee"),this._mouseInit(),this.helper=$("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(event){var that=this,options=this.options;this.opos=[event.pageX,event.pageY],this.options.disabled||(this.selectees=$(options.filter,this.element[0]),this._trigger("start",event),$(options.appendTo).append(this.helper),this.helper.css({left:event.pageX,top:event.pageY,width:0,height:0}),options.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=!0,event.metaKey||event.ctrlKey||(selectee.$element.removeClass("ui-selected"),selectee.selected=!1,selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element}))}),$(event.target).parents().addBack().each(function(){var doSelect,selectee=$.data(this,"selectable-item");return selectee?(doSelect=!event.metaKey&&!event.ctrlKey||!selectee.$element.hasClass("ui-selected"),selectee.$element.removeClass(doSelect?"ui-unselecting":"ui-selected").addClass(doSelect?"ui-selecting":"ui-unselecting"),selectee.unselecting=!doSelect,selectee.selecting=doSelect,selectee.selected=doSelect,doSelect?that._trigger("selecting",event,{selecting:selectee.element}):that._trigger("unselecting",event,{unselecting:selectee.element}),!1):void 0}))},_mouseDrag:function(event){if(this.dragged=!0,!this.options.disabled){var tmp,that=this,options=this.options,x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;return x1>x2&&(tmp=x2,x2=x1,x1=tmp),y1>y2&&(tmp=y2,y2=y1,y1=tmp),this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1}),this.selectees.each(function(){var selectee=$.data(this,"selectable-item"),hit=!1;selectee&&selectee.element!==that.element[0]&&("touch"===options.tolerance?hit=!(selectee.left>x2||selectee.right<x1||selectee.top>y2||selectee.bottom<y1):"fit"===options.tolerance&&(hit=selectee.left>x1&&selectee.right<x2&&selectee.top>y1&&selectee.bottom<y2),hit?(selectee.selected&&(selectee.$element.removeClass("ui-selected"),selectee.selected=!1),selectee.unselecting&&(selectee.$element.removeClass("ui-unselecting"),selectee.unselecting=!1),selectee.selecting||(selectee.$element.addClass("ui-selecting"),selectee.selecting=!0,that._trigger("selecting",event,{selecting:selectee.element}))):(selectee.selecting&&((event.metaKey||event.ctrlKey)&&selectee.startselected?(selectee.$element.removeClass("ui-selecting"),selectee.selecting=!1,selectee.$element.addClass("ui-selected"),selectee.selected=!0):(selectee.$element.removeClass("ui-selecting"),selectee.selecting=!1,selectee.startselected&&(selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0),that._trigger("unselecting",event,{unselecting:selectee.element}))),selectee.selected&&(event.metaKey||event.ctrlKey||selectee.startselected||(selectee.$element.removeClass("ui-selected"),selectee.selected=!1,selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element})))))}),!1}},_mouseStop:function(event){var that=this;return this.dragged=!1,$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-unselecting"),selectee.unselecting=!1,selectee.startselected=!1,that._trigger("unselected",event,{unselected:selectee.element})}),$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-selecting").addClass("ui-selected"),selectee.selecting=!1,selectee.selected=!0,selectee.startselected=!0,that._trigger("selected",event,{selected:selectee.element})}),this._trigger("stop",event),this.helper.remove(),!1}}),$.widget("ui.selectmenu",{version:"1.11.2",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var selectmenuId=this.element.uniqueId().attr("id");this.ids={element:selectmenuId,button:selectmenuId+"-button",menu:selectmenuId+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var that=this,tabindex=this.element.attr("tabindex");this.label=$("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(event){this.button.focus(),event.preventDefault()}}),this.element.hide(),this.button=$("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:tabindex||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),$("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=$("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){that.menuItems||that._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var that=this;this.menu=$("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=$("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(event,ui){event.preventDefault(),that._setSelection(),that._select(ui.item.data("ui-selectmenu-item"),event)},focus:function(event,ui){var item=ui.item.data("ui-selectmenu-item");null!=that.focusIndex&&item.index!==that.focusIndex&&(that._trigger("focus",event,{item:item}),that.isOpen||that._select(item,event)),that.focusIndex=item.index,that.button.attr("aria-activedescendant",that.menuItems.eq(item.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var item,options=this.element.find("option");options.length&&(this._parseOptions(options),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),item=this._getSelectedItem(),this.menuInstance.focus(null,item),this._setAria(item.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(event){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",event))},_position:function(){this.menuWrap.position($.extend({of:this.button},this.options.position))},close:function(event){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",event))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(ul,items){var that=this,currentOptgroup="";$.each(items,function(index,item){item.optgroup!==currentOptgroup&&($("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(item.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:item.optgroup}).appendTo(ul),currentOptgroup=item.optgroup),that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-selectmenu-item",item)},_renderItem:function(ul,item){var li=$("<li>");return item.disabled&&li.addClass("ui-state-disabled"),this._setText(li,item.label),li.appendTo(ul)},_setText:function(element,value){value?element.text(value):element.html("&#160;")},_move:function(direction,event){var item,next,filter=".ui-menu-item";this.isOpen?item=this.menuItems.eq(this.focusIndex):(item=this.menuItems.eq(this.element[0].selectedIndex),filter+=":not(.ui-state-disabled)"),next="first"===direction||"last"===direction?item["first"===direction?"prevAll":"nextAll"](filter).eq(-1):item[direction+"All"](filter).eq(0),next.length&&this.menuInstance.focus(event,next)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(event){this[this.isOpen?"close":"open"](event)},_setSelection:function(){var selection;this.range&&(window.getSelection?(selection=window.getSelection(),selection.removeAllRanges(),selection.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(event){this.isOpen&&($(event.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(event))}},_buttonEvents:{mousedown:function(){var selection;window.getSelection?(selection=window.getSelection(),selection.rangeCount&&(this.range=selection.getRangeAt(0))):this.range=document.selection.createRange()},click:function(event){this._setSelection(),this._toggle(event)},keydown:function(event){var preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.TAB:case $.ui.keyCode.ESCAPE:this.close(event),preventDefault=!1;break;case $.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(event);break;case $.ui.keyCode.UP:event.altKey?this._toggle(event):this._move("prev",event);break;case $.ui.keyCode.DOWN:event.altKey?this._toggle(event):this._move("next",event);break;case $.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(event):this._toggle(event);break;case $.ui.keyCode.LEFT:this._move("prev",event);break;case $.ui.keyCode.RIGHT:this._move("next",event);break;case $.ui.keyCode.HOME:case $.ui.keyCode.PAGE_UP:this._move("first",event);break;case $.ui.keyCode.END:case $.ui.keyCode.PAGE_DOWN:this._move("last",event);break;default:this.menu.trigger(event),preventDefault=!1}preventDefault&&event.preventDefault()}},_selectFocusedItem:function(event){var item=this.menuItems.eq(this.focusIndex);item.hasClass("ui-state-disabled")||this._select(item.data("ui-selectmenu-item"),event)},_select:function(item,event){var oldIndex=this.element[0].selectedIndex;this.element[0].selectedIndex=item.index,this._setText(this.buttonText,item.label),this._setAria(item),this._trigger("select",event,{item:item}),item.index!==oldIndex&&this._trigger("change",event,{item:item}),this.close(event)},_setAria:function(item){var id=this.menuItems.eq(item.index).attr("id");this.button.attr({"aria-labelledby":id,"aria-activedescendant":id}),this.menu.attr("aria-activedescendant",id)},_setOption:function(key,value){"icons"===key&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(value.button),this._super(key,value),"appendTo"===key&&this.menuWrap.appendTo(this._appendTo()),"disabled"===key&&(this.menuInstance.option("disabled",value),this.button.toggleClass("ui-state-disabled",value).attr("aria-disabled",value),this.element.prop("disabled",value),value?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===key&&this._resizeButton()},_appendTo:function(){var element=this.options.appendTo;return element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)),element&&element[0]||(element=this.element.closest(".ui-front")),element.length||(element=this.document[0].body),element},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var width=this.options.width;width||(width=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(width)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(options){var data=[];options.each(function(index,item){var option=$(item),optgroup=option.parent("optgroup");data.push({element:option,index:index,value:option.attr("value"),label:option.text(),optgroup:optgroup.attr("label")||"",disabled:optgroup.prop("disabled")||option.prop("disabled")})}),this.items=data},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),$.widget("ui.slider",$.ui.mouse,{version:"1.11.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),handle="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",handles=[];for(handleCount=options.values&&options.values.length||1,existingHandles.length>handleCount&&(existingHandles.slice(handleCount).remove(),existingHandles=existingHandles.slice(0,handleCount)),i=existingHandles.length;handleCount>i;i++)handles.push(handle);this.handles=existingHandles.add($(handles.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(i){$(this).data("ui-slider-handle-index",i)})},_createRange:function(){var options=this.options,classes="";options.range?(options.range===!0&&(options.values?options.values.length&&2!==options.values.length?options.values=[options.values[0],options.values[0]]:$.isArray(options.values)&&(options.values=options.values.slice(0)):options.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=$("<div></div>").appendTo(this.element),classes="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(classes+("min"===options.range||"max"===options.range?" ui-slider-range-"+options.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,allowed,offset,mouseOverHandle,that=this,o=this.options;return o.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position),distance=this._valueMax()-this._valueMin()+1,this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));(distance>thisDistance||distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min))&&(distance=thisDistance,closestHandle=$(this),index=i)}),allowed=this._start(event,index),allowed===!1?!1:(this._mouseSliding=!0,this._handleIndex=index,closestHandle.addClass("ui-state-active").focus(),offset=closestHandle.offset(),mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-closestHandle.width()/2,top:event.pageY-offset.top-closestHandle.height()/2-(parseInt(closestHandle.css("borderTopWidth"),10)||0)-(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+(parseInt(closestHandle.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(event,index,normValue),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);return this._slide(event,this._handleIndex,normValue),!1},_mouseStop:function(event){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(event,this._handleIndex),this._change(event,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;return"horizontal"===this.orientation?(pixelTotal=this.elementSize.width,pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(pixelTotal=this.elementSize.height,pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),percentMouse=pixelMouse/pixelTotal,percentMouse>1&&(percentMouse=1),0>percentMouse&&(percentMouse=0),"vertical"===this.orientation&&(percentMouse=1-percentMouse),valueTotal=this._valueMax()-this._valueMin(),valueMouse=this._valueMin()+percentMouse*valueTotal,this._trimAlignValue(valueMouse)},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};return this.options.values&&this.options.values.length&&(uiHash.value=this.values(index),uiHash.values=this.values()),this._trigger("start",event,uiHash)},_slide:function(event,index,newVal){var otherVal,newValues,allowed;this.options.values&&this.options.values.length?(otherVal=this.values(index?0:1),2===this.options.values.length&&this.options.range===!0&&(0===index&&newVal>otherVal||1===index&&otherVal>newVal)&&(newVal=otherVal),newVal!==this.values(index)&&(newValues=this.values(),newValues[index]=newVal,allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal,values:newValues}),otherVal=this.values(index?0:1),allowed!==!1&&this.values(index,newVal))):newVal!==this.value()&&(allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal}),allowed!==!1&&this.value(newVal))},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};this.options.values&&this.options.values.length&&(uiHash.value=this.values(index),uiHash.values=this.values()),this._trigger("stop",event,uiHash)},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};this.options.values&&this.options.values.length&&(uiHash.value=this.values(index),uiHash.values=this.values()),this._lastChangedValue=index,this._trigger("change",event,uiHash)}},value:function(newValue){return arguments.length?(this.options.value=this._trimAlignValue(newValue),this._refreshValue(),void this._change(null,0)):this._value()},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1)return this.options.values[index]=this._trimAlignValue(newValue),this._refreshValue(),void this._change(null,index);if(!arguments.length)return this._values();if(!$.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(index):this.value();for(vals=this.options.values,newValues=arguments[0],i=0;i<vals.length;i+=1)vals[i]=this._trimAlignValue(newValues[i]),this._change(null,i);this._refreshValue()},_setOption:function(key,value){var i,valsLength=0;switch("range"===key&&this.options.range===!0&&("min"===value?(this.options.value=this._values(0),this.options.values=null):"max"===value&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),$.isArray(this.options.values)&&(valsLength=this.options.values.length),"disabled"===key&&this.element.toggleClass("ui-state-disabled",!!value),this._super(key,value),key){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===value?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;valsLength>i;i+=1)this._change(null,i);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var val=this.options.value;return val=this._trimAlignValue(val)},_values:function(index){var val,vals,i;if(arguments.length)return val=this.options.values[index],val=this._trimAlignValue(val);if(this.options.values&&this.options.values.length){for(vals=this.options.values.slice(),i=0;i<vals.length;i+=1)vals[i]=this._trimAlignValue(vals[i]);return vals}return[]},_trimAlignValue:function(val){if(val<=this._valueMin())return this._valueMin();if(val>=this._valueMax())return this._valueMax();var step=this.options.step>0?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;return 2*Math.abs(valModStep)>=step&&(alignValue+=valModStep>0?step:-step),parseFloat(alignValue.toFixed(5))},_calculateNewMax:function(){var remainder=(this.options.max-this._valueMin())%this.options.step;this.max=this.options.max-remainder},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=this._animateOff?!1:o.animate,_set={};this.options.values&&this.options.values.length?this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100,_set["horizontal"===that.orientation?"left":"bottom"]=valPercent+"%",$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate),that.options.range===!0&&("horizontal"===that.orientation?(0===i&&that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate),1===i&&that.range[animate?"animate":"css"]({width:valPercent-lastValPercent+"%"},{queue:!1,duration:o.animate})):(0===i&&that.range.stop(1,1)[animate?"animate":"css"]({bottom:valPercent+"%"},o.animate),1===i&&that.range[animate?"animate":"css"]({height:valPercent-lastValPercent+"%"},{queue:!1,duration:o.animate}))),lastValPercent=valPercent}):(value=this.value(),valueMin=this._valueMin(),valueMax=this._valueMax(),valPercent=valueMax!==valueMin?(value-valueMin)/(valueMax-valueMin)*100:0,_set["horizontal"===this.orientation?"left":"bottom"]=valPercent+"%",this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate),"min"===oRange&&"horizontal"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate),"max"===oRange&&"horizontal"===this.orientation&&this.range[animate?"animate":"css"]({width:100-valPercent+"%"},{queue:!1,duration:o.animate}),"min"===oRange&&"vertical"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate),"max"===oRange&&"vertical"===this.orientation&&this.range[animate?"animate":"css"]({height:100-valPercent+"%"},{queue:!1,duration:o.animate}))},_handleEvents:{keydown:function(event){var allowed,curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(event.preventDefault(),!this._keySliding&&(this._keySliding=!0,$(event.target).addClass("ui-state-active"),allowed=this._start(event,index),allowed===!1))return}switch(step=this.options.step,curVal=newVal=this.options.values&&this.options.values.length?this.values(index):this.value(),event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax())return;newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin())return;newVal=this._trimAlignValue(curVal-step)}this._slide(event,index,newVal)},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(event,index),this._change(event,index),$(event.target).removeClass("ui-state-active"))}}}),$.widget("ui.sortable",$.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(x,reference,size){return x>=reference&&reference+size>x},_isFloating:function(item){return/left|right/.test(item.css("float"))||/inline|table-cell/.test(item.css("display"))},_create:function(){var o=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===o.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(key,value){this._super(key,value),"handle"===key&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),$.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--)this.items[i].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=!1,that=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(event),$(event.target).parents().each(function(){return $.data(this,that.widgetName+"-item")===that?(currentItem=$(this),!1):void 0}),$.data(event.target,that.widgetName+"-item")===that&&(currentItem=$(event.target)),currentItem&&(!this.options.handle||overrideHandle||($(this.options.handle,currentItem).find("*").addBack().each(function(){this===event.target&&(validHandle=!0)}),validHandle))?(this.currentItem=currentItem,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(event),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(event),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(body=this.document.find("body"),this.storedCursor=body.css("cursor"),body.css("cursor",o.cursor),this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",event,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!noActivation)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",event,this._uiHash(this));
return $.ui.ddmanager&&($.ui.ddmanager.current=this),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(event),!0},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=!1;for(this.position=this._generatePosition(event),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-event.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed:event.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-event.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed:event.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)),event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed))),scrolled!==!1&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(item=this.items[i],itemElement=item.item[0],intersection=this._intersectsWithPointer(item),intersection&&item.instance===this.currentContainer&&itemElement!==this.currentItem[0]&&this.placeholder[1===intersection?"next":"prev"]()[0]!==itemElement&&!$.contains(this.placeholder[0],itemElement)&&("semi-dynamic"===this.options.type?!$.contains(this.element[0],itemElement):!0)){if(this.direction=1===intersection?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(item))break;this._rearrange(event,item),this._trigger("change",event,this._uiHash());break}return this._contactContainers(event),$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),this._trigger("sort",event,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(event,noPropagation){if(event){if($.ui.ddmanager&&!this.options.dropBehaviour&&$.ui.ddmanager.drop(this,event),this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};axis&&"x"!==axis||(animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),axis&&"y"!==axis||(animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event)})}else this._clear(event,noPropagation);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("deactivate",null,this._uiHash(this)),this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",null,this._uiHash(this)),this.containers[i].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),$.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?$(this.domPosition.prev).after(this.currentItem):$(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];return o=o||{},$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||/(.+)[\-=_](.+)/);res&&str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]))}),!str.length&&o.key&&str.push(o.key+"="),str.join("&")},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];return o=o||{},items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"")}),ret},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight="x"===this.options.axis||y1+dyClick>t&&b>y1+dyClick,isOverElementWidth="y"===this.options.axis||x1+dxClick>l&&r>x1+dxClick,isOverElement=isOverElementHeight&&isOverElementWidth;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"]?isOverElement:l<x1+this.helperProportions.width/2&&x2-this.helperProportions.width/2<r&&t<y1+this.helperProportions.height/2&&y2-this.helperProportions.height/2<b},_intersectsWithPointer:function(item){var isOverElementHeight="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth,verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();return isOverElement?this.floating?horizontalDirection&&"right"===horizontalDirection||"down"===verticalDirection?2:1:verticalDirection&&("down"===verticalDirection?2:1):!1},_intersectsWithSides:function(item){var isOverBottomHalf=this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+item.height/2,item.height),isOverRightHalf=this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+item.width/2,item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();return this.floating&&horizontalDirection?"right"===horizontalDirection&&isOverRightHalf||"left"===horizontalDirection&&!isOverRightHalf:verticalDirection&&("down"===verticalDirection&&isOverBottomHalf||"up"===verticalDirection&&!isOverBottomHalf)},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return 0!==delta&&(delta>0?"down":"up")},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return 0!==delta&&(delta>0?"right":"left")},refresh:function(event){return this._refreshItems(event),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith},_getItemsAsjQuery:function(connected){function addItems(){items.push(this)}var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected)for(i=connectWith.length-1;i>=0;i--)for(cur=$(connectWith[i]),j=cur.length-1;j>=0;j--)inst=$.data(cur[j],this.widgetFullName),inst&&inst!==this&&!inst.options.disabled&&queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);for(queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=queries.length-1;i>=0;i--)queries[i][0].each(addItems);return $(items)},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++)if(list[j]===item.item[0])return!1;return!0})},_refreshItems:function(event){this.items=[],this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready)for(i=connectWith.length-1;i>=0;i--)for(cur=$(connectWith[i]),j=cur.length-1;j>=0;j--)inst=$.data(cur[j],this.widgetFullName),inst&&inst!==this&&!inst.options.disabled&&(queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]),this.containers.push(inst));for(i=queries.length-1;i>=0;i--)for(targetData=queries[i][1],_queries=queries[i][0],j=0,queriesLength=_queries.length;queriesLength>j;j++)item=$(_queries[j]),item.data(this.widgetName+"-item",targetData),items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0})},refreshPositions:function(fast){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,item,t,p;for(i=this.items.length-1;i>=0;i--)item=this.items[i],item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]||(t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item,fast||(item.width=t.outerWidth(),item.height=t.outerHeight()),p=t.offset(),item.left=p.left,item.top=p.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)p=this.containers[i].element.offset(),this.containers[i].containerCache.left=p.left,this.containers[i].containerCache.top=p.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(that){that=that||this;var className,o=that.options;o.placeholder&&o.placeholder.constructor!==String||(className=o.placeholder,o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]).addClass(className||that.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===nodeName?that.currentItem.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(element)}):"img"===nodeName&&element.attr("src",that.currentItem.attr("src")),className||element.css("visibility","hidden"),element},update:function(container,p){(!className||o.forcePlaceholderSize)&&(p.height()||p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10)),p.width()||p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10)))}}),that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem)),that.currentItem.after(that.placeholder),o.placeholder.update(that,that.placeholder)},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,cur,nearBottom,floating,axis,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--)if(!$.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0]))continue;innermostContainer=this.containers[i],innermostIndex=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",event,this._uiHash(this)),this.containers[i].containerCache.over=0);if(innermostContainer)if(1===this.containers.length)this.containers[innermostIndex].containerCache.over||(this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1);else{for(dist=1e4,itemWithLeastDistance=null,floating=innermostContainer.floating||this._isFloating(this.currentItem),posProperty=floating?"left":"top",sizeProperty=floating?"width":"height",axis=floating?"clientX":"clientY",j=this.items.length-1;j>=0;j--)$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])&&this.items[j].item[0]!==this.currentItem[0]&&(cur=this.items[j].item.offset()[posProperty],nearBottom=!1,event[axis]-cur>this.items[j][sizeProperty]/2&&(nearBottom=!0),Math.abs(event[axis]-cur)<dist&&(dist=Math.abs(event[axis]-cur),itemWithLeastDistance=this.items[j],this.direction=nearBottom?"up":"down"));if(!itemWithLeastDistance&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[innermostIndex])return void(this.currentContainer.containerCache.over||(this.containers[innermostIndex]._trigger("over",event,this._uiHash()),this.currentContainer.containerCache.over=1));itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,!0):this._rearrange(event,null,this.containers[innermostIndex].element,!0),this._trigger("change",event,this._uiHash()),this.containers[innermostIndex]._trigger("change",event,this._uiHash(this)),this.currentContainer=this.containers[innermostIndex],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):"clone"===o.helper?this.currentItem.clone():this.currentItem;return helper.parents("body").length||$("parent"!==o.appendTo?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]),helper[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!helper[0].style.width||o.forceHelperSize)&&helper.width(this.currentItem.width()),(!helper[0].style.height||o.forceHelperSize)&&helper.height(this.currentItem.height()),helper},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var ce,co,over,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),("document"===o.containment||"window"===o.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$("document"===o.containment?document:window).width()-this.helperProportions.width-this.margins.left,($("document"===o.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(ce=$(o.containment)[0],co=$(o.containment).offset(),over="hidden"!==$(ce).css("overflow"),this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop())*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod}},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(event.pageX-this.offset.click.left<this.containment[0]&&(pageX=this.containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<this.containment[1]&&(pageY=this.containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>this.containment[2]&&(pageX=this.containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>this.containment[3]&&(pageY=this.containment[3]+this.offset.click.top)),o.grid&&(top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1],pageY=this.containment?top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3]?top:top-this.offset.click.top>=this.containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0],pageX=this.containment?left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2]?left:left-this.offset.click.left>=this.containment[0]?left-o.grid[0]:left+o.grid[0]:left)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop()),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())}},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?i.item[0]:i.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){counter===this.counter&&this.refreshPositions(!hardRefresh)})},_clear:function(event,noPropagation){function delayEvent(type,instance,container){return function(event){container._trigger(type,event,instance._uiHash(instance))}}this.reverting=!1;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!noPropagation&&delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||noPropagation||delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash())}),this!==this.currentContainer&&(noPropagation||(delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash())}),delayedTriggers.push(function(c){return function(event){c._trigger("receive",event,this._uiHash(this))}}.call(this,this.currentContainer)),delayedTriggers.push(function(c){return function(event){c._trigger("update",event,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)noPropagation||delayedTriggers.push(delayEvent("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(delayedTriggers.push(delayEvent("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,noPropagation||this._trigger("beforeStop",event,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!noPropagation){for(i=0;i<delayedTriggers.length;i++)delayedTriggers[i].call(this,event);this._trigger("stop",event,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){$.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null}}}),$.widget("ui.spinner",{version:"1.11.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var options={},element=this.element;return $.each(["min","max","step"],function(i,option){var value=element.attr(option);void 0!==value&&value.length&&(options[option]=value)}),options},_events:{keydown:function(event){this._start(event)&&this._keydown(event)&&event.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(event){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",event)))},mousewheel:function(event,delta){if(delta){if(!this.spinning&&!this._start(event))return!1;this._spin((delta>0?1:-1)*this.options.step,event),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(event)},100),event.preventDefault()}},"mousedown .ui-spinner-button":function(event){function checkFocus(){var isActive=this.element[0]===this.document[0].activeElement;isActive||(this.element.focus(),this.previous=previous,this._delay(function(){this.previous=previous}))}var previous;previous=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),event.preventDefault(),checkFocus.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,checkFocus.call(this)}),this._start(event)!==!1&&this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(event){return $(event.currentTarget).hasClass("ui-state-active")?this._start(event)===!1?!1:void this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var uiSpinner=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=uiSpinner.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*uiSpinner.height())&&uiSpinner.height()>0&&uiSpinner.height(uiSpinner.height()),this.options.disabled&&this.disable()},_keydown:function(event){var options=this.options,keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.UP:return this._repeat(null,1,event),!0;case keyCode.DOWN:return this._repeat(null,-1,event),!0;case keyCode.PAGE_UP:return this._repeat(null,options.page,event),!0;case keyCode.PAGE_DOWN:return this._repeat(null,-options.page,event),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(event){return this.spinning||this._trigger("start",event)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(i,steps,event){i=i||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,steps,event)},i),this._spin(steps*this.options.step,event)},_spin:function(step,event){var value=this.value()||0;this.counter||(this.counter=1),value=this._adjustValue(value+step*this._increment(this.counter)),this.spinning&&this._trigger("spin",event,{value:value})===!1||(this._value(value),this.counter++)},_increment:function(i){var incremental=this.options.incremental;return incremental?$.isFunction(incremental)?incremental(i):Math.floor(i*i*i/5e4-i*i/500+17*i/200+1):1},_precision:function(){var precision=this._precisionOf(this.options.step);return null!==this.options.min&&(precision=Math.max(precision,this._precisionOf(this.options.min))),precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return-1===decimal?0:str.length-decimal-1},_adjustValue:function(value){var base,aboveMin,options=this.options;return base=null!==options.min?options.min:0,aboveMin=value-base,aboveMin=Math.round(aboveMin/options.step)*options.step,value=base+aboveMin,value=parseFloat(value.toFixed(this._precision())),null!==options.max&&value>options.max?options.max:null!==options.min&&value<options.min?options.min:value},_stop:function(event){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",event))},_setOption:function(key,value){if("culture"===key||"numberFormat"===key){var prevValue=this._parse(this.element.val());return this.options[key]=value,void this.element.val(this._format(prevValue))}("max"===key||"min"===key||"step"===key)&&"string"==typeof value&&(value=this._parse(value)),"icons"===key&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(value.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(value.down)),this._super(key,value),"disabled"===key&&(this.widget().toggleClass("ui-state-disabled",!!value),this.element.prop("disabled",!!value),this.buttons.button(value?"disable":"enable"))},_setOptions:spinner_modifier(function(options){this._super(options)}),_parse:function(val){return"string"==typeof val&&""!==val&&(val=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(val,10,this.options.culture):+val),""===val||isNaN(val)?null:val},_format:function(value){return""===value?"":window.Globalize&&this.options.numberFormat?Globalize.format(value,this.options.numberFormat,this.options.culture):value},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var value=this.value();return null===value?!1:value===this._adjustValue(value)},_value:function(value,allowAny){var parsed;""!==value&&(parsed=this._parse(value),null!==parsed&&(allowAny||(parsed=this._adjustValue(parsed)),value=this._format(parsed))),this.element.val(value),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:spinner_modifier(function(steps){this._stepUp(steps)}),_stepUp:function(steps){this._start()&&(this._spin((steps||1)*this.options.step),this._stop())},stepDown:spinner_modifier(function(steps){this._stepDown(steps)}),_stepDown:function(steps){this._start()&&(this._spin((steps||1)*-this.options.step),this._stop())},pageUp:spinner_modifier(function(pages){this._stepUp((pages||1)*this.options.page)}),pageDown:spinner_modifier(function(pages){this._stepDown((pages||1)*this.options.page)}),value:function(newVal){return arguments.length?void spinner_modifier(this._value).call(this,newVal):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),$.widget("ui.tabs",{version:"1.11.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var rhash=/#.*$/;return function(anchor){var anchorUrl,locationUrl;anchor=anchor.cloneNode(!1),anchorUrl=anchor.href.replace(rhash,""),locationUrl=location.href.replace(rhash,"");try{anchorUrl=decodeURIComponent(anchorUrl)}catch(error){}try{locationUrl=decodeURIComponent(locationUrl)}catch(error){}return anchor.hash.length>1&&anchorUrl===locationUrl}}(),_create:function(){var that=this,options=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",options.collapsible),this._processTabs(),options.active=this._initialActive(),$.isArray(options.disabled)&&(options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li)
}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(options.active):$(),this._refresh(),this.active.length&&this.load(options.active)},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);return null===active&&(locationHash&&this.tabs.each(function(i,tab){return $(tab).attr("aria-controls")===locationHash?(active=i,!1):void 0}),null===active&&(active=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===active||-1===active)&&(active=this.tabs.length?0:!1)),active!==!1&&(active=this.tabs.index(this.tabs.eq(active)),-1===active&&(active=collapsible?!1:0)),!collapsible&&active===!1&&this.anchors.length&&(active=0),active},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):$()}},_tabKeydown:function(event){var focusedTab=$(this.document[0].activeElement).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=!0;if(!this._handlePageNav(event)){switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=!1,selectedIndex--;break;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:return event.preventDefault(),clearTimeout(this.activating),void this._activate(selectedIndex);case $.ui.keyCode.ENTER:return event.preventDefault(),clearTimeout(this.activating),void this._activate(selectedIndex===this.options.active?!1:selectedIndex);default:return}event.preventDefault(),clearTimeout(this.activating),selectedIndex=this._focusNextTab(selectedIndex,goingForward),event.ctrlKey||(focusedTab.attr("aria-selected","false"),this.tabs.eq(selectedIndex).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",selectedIndex)},this.delay))}},_panelKeydown:function(event){this._handlePageNav(event)||event.ctrlKey&&event.keyCode===$.ui.keyCode.UP&&(event.preventDefault(),this.active.focus())},_handlePageNav:function(event){return event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(index,goingForward){function constrain(){return index>lastTabIndex&&(index=0),0>index&&(index=lastTabIndex),index}for(var lastTabIndex=this.tabs.length-1;-1!==$.inArray(constrain(),this.options.disabled);)index=goingForward?index+1:index-1;return index},_focusNextTab:function(index,goingForward){return index=this._findNextTab(index,goingForward),this.tabs.eq(index).focus(),index},_setOption:function(key,value){return"active"===key?void this._activate(value):"disabled"===key?void this._setupDisabled(value):(this._super(key,value),"collapsible"===key&&(this.element.toggleClass("ui-tabs-collapsible",value),value||this.options.active!==!1||this._activate(0)),"event"===key&&this._setupEvents(value),void("heightStyle"===key&&this._setupHeightStyle(value)))},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab)}),this._processTabs(),options.active!==!1&&this.anchors.length?this.active.length&&!$.contains(this.tablist[0],this.active[0])?this.tabs.length===options.disabled.length?(options.active=!1,this.active=$()):this._activate(this._findNextTab(Math.max(0,options.active-1),!1)):options.active=this.tabs.index(this.active):(options.active=!1,this.active=$()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var that=this,prevTabs=this.tabs,prevAnchors=this.anchors,prevPanels=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(event){$(this).is(".ui-state-disabled")&&event.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){$(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=$(),this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");that._isLocal(anchor)?(selector=anchor.hash,panelId=selector.substring(1),panel=that.element.find(that._sanitizeSelector(selector))):(panelId=tab.attr("aria-controls")||$({}).uniqueId()[0].id,selector="#"+panelId,panel=that.element.find(selector),panel.length||(panel=that._createPanel(panelId),panel.insertAfter(that.panels[i-1]||that.tablist)),panel.attr("aria-live","polite")),panel.length&&(that.panels=that.panels.add(panel)),originalAriaControls&&tab.data("ui-tabs-aria-controls",originalAriaControls),tab.attr({"aria-controls":panelId,"aria-labelledby":anchorId}),panel.attr("aria-labelledby",anchorId)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),prevTabs&&(this._off(prevTabs.not(this.tabs)),this._off(prevAnchors.not(this.anchors)),this._off(prevPanels.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(id){return $("<div>").attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(disabled){$.isArray(disabled)&&(disabled.length?disabled.length===this.anchors.length&&(disabled=!0):disabled=!1);for(var li,i=0;li=this.tabs[i];i++)disabled===!0||-1!==$.inArray(i,disabled)?$(li).addClass("ui-state-disabled").attr("aria-disabled","true"):$(li).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=disabled},_setupEvents:function(event){var events={};event&&$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(event){event.preventDefault()}}),this._on(this.anchors,events),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();"fill"===heightStyle?(maxHeight=parent.height(),maxHeight-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");"absolute"!==position&&"fixed"!==position&&(maxHeight-=elem.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(!0)}),this.panels.each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===heightStyle&&(maxHeight=0,this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height())}).height(maxHeight))},_eventHandler:function(event){var options=this.options,active=this.active,anchor=$(event.currentTarget),tab=anchor.closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=active.length?this._getPanelForTab(active):$(),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault(),tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||clickedIsActive&&!options.collapsible||this._trigger("beforeActivate",event,eventData)===!1||(options.active=collapsing?!1:this.tabs.index(tab),this.active=clickedIsActive?$():tab,this.xhr&&this.xhr.abort(),toHide.length||toShow.length||$.error("jQuery UI Tabs: Mismatching fragment identifier."),toShow.length&&this.load(this.tabs.index(tab),event),this._toggle(event,eventData))},_toggle:function(event,eventData){function complete(){that.running=!1,that._trigger("activate",event,eventData)}function show(){eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),toShow.length&&that.options.show?that._show(toShow,that.options.show,complete):(toShow.show(),complete())}var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=!0,toHide.length&&this.options.hide?this._hide(toHide,this.options.hide,function(){eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),show()}):(eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),toHide.hide(),show()),toHide.attr("aria-hidden","true"),eventData.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),toShow.length&&toHide.length?eventData.oldTab.attr("tabIndex",-1):toShow.length&&this.tabs.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),toShow.attr("aria-hidden","false"),eventData.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(index){var anchor,active=this._findActive(index);active[0]!==this.active[0]&&(active.length||(active=this.active),anchor=active.find(".ui-tabs-anchor")[0],this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop}))},_findActive:function(index){return index===!1?$():this.tabs.eq(index)},_getIndex:function(index){return"string"==typeof index&&(index=this.anchors.index(this.anchors.filter("[href$='"+index+"']"))),index},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){$.data(this,"ui-tabs-destroy")?$(this).remove():$(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");prev?li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls"):li.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(index){var disabled=this.options.disabled;disabled!==!1&&(void 0===index?disabled=!1:(index=this._getIndex(index),disabled=$.isArray(disabled)?$.map(disabled,function(num){return num!==index?num:null}):$.map(this.tabs,function(li,num){return num!==index?num:null})),this._setupDisabled(disabled))},disable:function(index){var disabled=this.options.disabled;if(disabled!==!0){if(void 0===index)disabled=!0;else{if(index=this._getIndex(index),-1!==$.inArray(index,disabled))return;disabled=$.isArray(disabled)?$.merge([index],disabled).sort():[index]}this._setupDisabled(disabled)}},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel};this._isLocal(anchor[0])||(this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData)),this.xhr&&"canceled"!==this.xhr.statusText&&(tab.addClass("ui-tabs-loading"),panel.attr("aria-busy","true"),this.xhr.success(function(response){setTimeout(function(){panel.html(response),that._trigger("load",event,eventData)},1)}).complete(function(jqXHR,status){setTimeout(function(){"abort"===status&&that.panels.stop(!1,!0),tab.removeClass("ui-tabs-loading"),panel.removeAttr("aria-busy"),jqXHR===that.xhr&&delete that.xhr},1)})))},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href"),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData))}}},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id))}}),$.widget("ui.tooltip",{version:"1.11.2",options:{content:function(){var title=$(this).attr("title")||"";return $("<a>").text(title).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(elem,id){var describedby=(elem.attr("aria-describedby")||"").split(/\s+/);describedby.push(id),elem.data("ui-tooltip-id",id).attr("aria-describedby",$.trim(describedby.join(" ")))},_removeDescribedBy:function(elem){var id=elem.data("ui-tooltip-id"),describedby=(elem.attr("aria-describedby")||"").split(/\s+/),index=$.inArray(id,describedby);-1!==index&&describedby.splice(index,1),elem.removeData("ui-tooltip-id"),describedby=$.trim(describedby.join(" ")),describedby?elem.attr("aria-describedby",describedby):elem.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=$("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(key,value){var that=this;return"disabled"===key?(this[value?"_disable":"_enable"](),void(this.options[key]=value)):(this._super(key,value),void("content"===key&&$.each(this.tooltips,function(id,tooltipData){that._updateContent(tooltipData.element)})))},_disable:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur");event.target=event.currentTarget=tooltipData.element[0],that.close(event,!0)}),this.element.find(this.options.items).addBack().each(function(){var element=$(this);element.is("[title]")&&element.data("ui-tooltip-title",element.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var element=$(this);element.data("ui-tooltip-title")&&element.attr("title",element.data("ui-tooltip-title"))})},open:function(event){var that=this,target=$(event?event.target:this.element).closest(this.options.items);target.length&&!target.data("ui-tooltip-id")&&(target.attr("title")&&target.data("ui-tooltip-title",target.attr("title")),target.data("ui-tooltip-open",!0),event&&"mouseover"===event.type&&target.parents().each(function(){var blurEvent,parent=$(this);parent.data("ui-tooltip-open")&&(blurEvent=$.Event("blur"),blurEvent.target=blurEvent.currentTarget=this,that.close(blurEvent,!0)),parent.attr("title")&&(parent.uniqueId(),that.parents[this.id]={element:this,title:parent.attr("title")},parent.attr("title",""))}),this._updateContent(target,event))},_updateContent:function(target,event){var content,contentOption=this.options.content,that=this,eventType=event?event.type:null;return"string"==typeof contentOption?this._open(event,target,contentOption):(content=contentOption.call(target[0],function(response){target.data("ui-tooltip-open")&&that._delay(function(){event&&(event.type=eventType),this._open(event,target,response)})}),void(content&&this._open(event,target,content)))},_open:function(event,target,content){function position(event){positionOption.of=event,tooltip.is(":hidden")||tooltip.position(positionOption)}var tooltipData,tooltip,events,delayedShow,a11yContent,positionOption=$.extend({},this.options.position);if(content){if(tooltipData=this._find(target))return void tooltipData.tooltip.find(".ui-tooltip-content").html(content);target.is("[title]")&&(event&&"mouseover"===event.type?target.attr("title",""):target.removeAttr("title")),tooltipData=this._tooltip(target),tooltip=tooltipData.tooltip,this._addDescribedBy(target,tooltip.attr("id")),tooltip.find(".ui-tooltip-content").html(content),this.liveRegion.children().hide(),content.clone?(a11yContent=content.clone(),a11yContent.removeAttr("id").find("[id]").removeAttr("id")):a11yContent=content,$("<div>").html(a11yContent).appendTo(this.liveRegion),this.options.track&&event&&/^mouse/.test(event.type)?(this._on(this.document,{mousemove:position}),position(event)):tooltip.position($.extend({of:target},this.options.position)),tooltip.hide(),this._show(tooltip,this.options.show),this.options.show&&this.options.show.delay&&(delayedShow=this.delayedShow=setInterval(function(){tooltip.is(":visible")&&(position(positionOption.of),clearInterval(delayedShow))},$.fx.interval)),this._trigger("open",event,{tooltip:tooltip}),events={keyup:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){var fakeEvent=$.Event(event);fakeEvent.currentTarget=target[0],this.close(fakeEvent,!0)}}},target[0]!==this.element[0]&&(events.remove=function(){this._removeTooltip(tooltip)}),event&&"mouseover"!==event.type||(events.mouseleave="close"),event&&"focusin"!==event.type||(events.focusout="close"),this._on(!0,target,events)}},close:function(event){var tooltip,that=this,target=$(event?event.currentTarget:this.element),tooltipData=this._find(target);tooltipData&&(tooltip=tooltipData.tooltip,tooltipData.closing||(clearInterval(this.delayedShow),target.data("ui-tooltip-title")&&!target.attr("title")&&target.attr("title",target.data("ui-tooltip-title")),this._removeDescribedBy(target),tooltipData.hiding=!0,tooltip.stop(!0),this._hide(tooltip,this.options.hide,function(){that._removeTooltip($(this))}),target.removeData("ui-tooltip-open"),this._off(target,"mouseleave focusout keyup"),target[0]!==this.element[0]&&this._off(target,"remove"),this._off(this.document,"mousemove"),event&&"mouseleave"===event.type&&$.each(this.parents,function(id,parent){$(parent.element).attr("title",parent.title),delete that.parents[id]}),tooltipData.closing=!0,this._trigger("close",event,{tooltip:tooltip}),tooltipData.hiding||(tooltipData.closing=!1)))},_tooltip:function(element){var tooltip=$("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),id=tooltip.uniqueId().attr("id");return $("<div>").addClass("ui-tooltip-content").appendTo(tooltip),tooltip.appendTo(this.document[0].body),this.tooltips[id]={element:element,tooltip:tooltip}},_find:function(target){var id=target.data("ui-tooltip-id");return id?this.tooltips[id]:null},_removeTooltip:function(tooltip){tooltip.remove(),delete this.tooltips[tooltip.attr("id")]},_destroy:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur"),element=tooltipData.element;event.target=event.currentTarget=element[0],that.close(event,!0),$("#"+id).remove(),element.data("ui-tooltip-title")&&(element.attr("title")||element.attr("title",element.data("ui-tooltip-title")),element.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}})}),function(undefined){function dfl(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw new Error("Implement me")}}function hasOwnProp(a,b){return hasOwnProperty.call(a,b)}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function printMsg(msg){moment.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend(function(){return firstTime&&(printMsg(msg),firstTime=!1),fn.apply(this,arguments)},fn)}function deprecateSimple(name,msg){deprecations[name]||(printMsg(msg),deprecations[name]=!0)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.localeData().ordinal(func.call(this,a),period)}}function monthDiff(a,b){var anchor2,adjust,wholeMonthDiff=12*(b.year()-a.year())+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months");return 0>b-anchor?(anchor2=a.clone().add(wholeMonthDiff-1,"months"),adjust=(b-anchor)/(anchor-anchor2)):(anchor2=a.clone().add(wholeMonthDiff+1,"months"),adjust=(b-anchor)/(anchor2-anchor)),-(wholeMonthDiff+adjust)}function meridiemFixWrap(locale,hour,meridiem){var isPm;return null==meridiem?hour:null!=locale.meridiemHour?locale.meridiemHour(hour,meridiem):null!=locale.isPM?(isPm=locale.isPM(meridiem),isPm&&12>hour&&(hour+=12),isPm||12!==hour||(hour=0),hour):hour}function Locale(){}function Moment(config,skipOverflow){skipOverflow!==!1&&checkOverflow(config),copyConfig(this,config),this._d=new Date(+config._d),updateInProgress===!1&&(updateInProgress=!0,moment.updateOffset(this),updateInProgress=!1)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=moment.localeData(),this._bubble()}function extend(a,b){for(var i in b)hasOwnProp(b,i)&&(a[i]=b[i]);return hasOwnProp(b,"toString")&&(a.toString=b.toString),hasOwnProp(b,"valueOf")&&(a.valueOf=b.valueOf),a}function copyConfig(to,from){var i,prop,val;if("undefined"!=typeof from._isAMomentObject&&(to._isAMomentObject=from._isAMomentObject),"undefined"!=typeof from._i&&(to._i=from._i),"undefined"!=typeof from._f&&(to._f=from._f),"undefined"!=typeof from._l&&(to._l=from._l),"undefined"!=typeof from._strict&&(to._strict=from._strict),"undefined"!=typeof from._tzm&&(to._tzm=from._tzm),"undefined"!=typeof from._isUTC&&(to._isUTC=from._isUTC),"undefined"!=typeof from._offset&&(to._offset=from._offset),"undefined"!=typeof from._pf&&(to._pf=from._pf),"undefined"!=typeof from._locale&&(to._locale=from._locale),momentProperties.length>0)for(i in momentProperties)prop=momentProperties[i],val=from[prop],"undefined"!=typeof val&&(to[prop]=val);return to}function absRound(number){return 0>number?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength,forceSign){for(var output=""+Math.abs(number),sign=number>=0;output.length<targetLength;)output="0"+output;return(sign?forceSign?"+":"":"-")+output}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function momentsDifference(base,other){var res;return other=makeAs(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):(res=positiveMomentsDifference(other,base),res.milliseconds=-res.milliseconds,res.months=-res.months),res}function createAdder(direction,name){return function(val,period){var dur,tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period)."),tmp=val,val=period,period=tmp),val="string"==typeof val?+val:val,dur=moment.duration(val,period),addOrSubtractDurationFromMoment(this,dur,direction),this}}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=null==updateOffset?!0:updateOffset,milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),days&&rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding),months&&rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding),updateOffset&&moment.updateOffset(mom,days||months)}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;len>i;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)hasOwnProp(inputObject,prop)&&(normalizedProp=normalizeUnits(prop),normalizedProp&&(normalizedInput[normalizedProp]=inputObject[prop]));return normalizedInput}function makeList(field){var count,setter;if(0===field.indexOf("week"))count=7,setter="day";else{if(0!==field.indexOf("month"))return;count=12,setter="month"}moment[field]=function(format,index){var i,getter,method=moment._locale[field],results=[];if("number"==typeof format&&(index=format,format=undefined),getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment._locale,m,format||"")},null!=index)return getter(index);for(i=0;count>i;i++)results.push(getter(i));return results}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=coercedNumber>=0?Math.floor(coercedNumber):Math.ceil(coercedNumber)),value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function checkOverflow(m){var overflow;m._a&&-2===m._pf.overflow&&(overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>24||24===m._a[HOUR]&&(0!==m._a[MINUTE]||0!==m._a[SECOND]||0!==m._a[MILLISECOND])?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1,m._pf._overflowDayOfYear&&(YEAR>overflow||overflow>DATE)&&(overflow=DATE),m._pf.overflow=overflow)}function isValid(m){return null==m._isValid&&(m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated,m._strict&&(m._isValid=m._isValid&&0===m._pf.charsLeftOver&&0===m._pf.unusedTokens.length&&m._pf.bigHour===undefined)),m._isValid}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){for(var j,next,locale,split,i=0;i<names.length;){for(split=normalizeLocale(names[i]).split("-"),j=split.length,next=normalizeLocale(names[i+1]),next=next?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&hasModule)try{oldLocale=moment.locale(),require("./locale/"+name),moment.locale(oldLocale)}catch(e){}return locales[name]}function makeAs(input,model){var res,diff;return model._isUTC?(res=model.clone(),diff=(moment.isMoment(input)||isDate(input)?+input:+moment(input))-+res,res._d.setTime(+res._d+diff),moment.updateOffset(res,!1),res):moment(input).local()}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;length>i;i++)array[i]=formatTokenFunctions[array[i]]?formatTokenFunctions[array[i]]:removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;length>i;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]||(formatFunctions[format]=makeFormatFunction(format)),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}var i=5;for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict)return parseTokenOneDigit;case"SS":if(strict)return parseTokenTwoDigits;case"SSS":if(strict)return parseTokenThreeDigits;case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return config._locale._meridiemParse;case"x":return parseTokenOffsetMs;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return strict?config._locale._ordinalParse:config._locale._ordinalParseLenient;default:return a=new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"))}}function utcOffsetFromString(string){string=string||"";var possibleTzMatches=string.match(parseTokenTimezone)||[],tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(60*parts[1])+toInt(parts[2]);return"+"===parts[0]?minutes:-minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":null!=input&&(datePartArray[MONTH]=3*(toInt(input)-1));break;case"M":case"MM":null!=input&&(datePartArray[MONTH]=toInt(input)-1);break;case"MMM":case"MMMM":a=config._locale.monthsParse(input,token,config._strict),null!=a?datePartArray[MONTH]=a:config._pf.invalidMonth=input;break;case"D":case"DD":null!=input&&(datePartArray[DATE]=toInt(input));break;case"Do":null!=input&&(datePartArray[DATE]=toInt(parseInt(input.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":null!=input&&(config._dayOfYear=toInt(input));break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;
case"a":case"A":config._meridiem=input;break;case"h":case"hh":config._pf.bigHour=!0;case"H":case"HH":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(1e3*("0."+input));break;case"x":config._d=new Date(toInt(input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=utcOffsetFromString(input);break;case"dd":case"ddd":case"dddd":a=config._locale.weekdaysParse(input),null!=a?(config._w=config._w||{},config._w.d=a):config._pf.invalidWeekday=input;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":token=token.substr(0,1);case"gggg":case"GGGG":case"GGGGG":token=token.substr(0,2),input&&(config._w=config._w||{},config._w[token]=toInt(input));break;case"gg":case"GG":config._w=config._w||{},config._w[token]=moment.parseTwoDigitYear(input)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;w=config._w,null!=w.GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year),week=dfl(w.W,1),weekday=dfl(w.E,1)):(dow=config._locale._week.dow,doy=config._locale._week.doy,weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year),week=dfl(w.w,1),null!=w.d?(weekday=w.d,dow>weekday&&++week):weekday=null!=w.e?w.e+dow:dow),temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear}function dateFromConfig(config){var i,date,currentDate,yearToUse,input=[];if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),config._dayOfYear&&(yearToUse=dfl(config._a[YEAR],currentDate[YEAR]),config._dayOfYear>daysInYear(yearToUse)&&(config._pf._overflowDayOfYear=!0),date=makeUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;3>i&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;7>i;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];24===config._a[HOUR]&&0===config._a[MINUTE]&&0===config._a[SECOND]&&0===config._a[MILLISECOND]&&(config._nextDay=!0,config._a[HOUR]=0),config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),config._nextDay&&(config._a[HOUR]=24)}}function dateFromObject(config){var normalizedInput;config._d||(normalizedInput=normalizeObjectUnits(config._i),config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day||normalizedInput.date,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond],dateFromConfig(config))}function currentDateArray(config){var now=new Date;return config._useUTC?[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]:[now.getFullYear(),now.getMonth(),now.getDate()]}function makeDateFromStringAndFormat(config){if(config._f===moment.ISO_8601)return void parseISO(config);config._a=[],config._pf.empty=!0;var i,parsedInput,tokens,token,skipped,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0],parsedInput&&(skipped=string.substr(0,string.indexOf(parsedInput)),skipped.length>0&&config._pf.unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?config._pf.empty=!1:config._pf.unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&config._pf.unusedTokens.push(token);config._pf.charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&config._pf.unusedInput.push(string),config._pf.bigHour===!0&&config._a[HOUR]<=12&&(config._pf.bigHour=undefined),config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem),dateFromConfig(config),checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return config._pf.invalidFormat=!0,void(config._d=new Date(0/0));for(i=0;i<config._f.length;i++)currentScore=0,tempConfig=copyConfig({},config),null!=config._useUTC&&(tempConfig._useUTC=config._useUTC),tempConfig._pf=defaultParsingFlags(),tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),isValid(tempConfig)&&(currentScore+=tempConfig._pf.charsLeftOver,currentScore+=10*tempConfig._pf.unusedTokens.length,tempConfig._pf.score=currentScore,(null==scoreToBeat||scoreToBeat>currentScore)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){for(config._pf.iso=!0,i=0,l=isoDates.length;l>i;i++)if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}for(i=0,l=isoTimes.length;l>i;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}string.match(parseTokenTimezone)&&(config._f+="Z"),makeDateFromStringAndFormat(config)}else config._isValid=!1}function makeDateFromString(config){parseISO(config),config._isValid===!1&&(delete config._isValid,moment.createFromInputFallback(config))}function map(arr,fn){var i,res=[];for(i=0;i<arr.length;++i)res.push(fn(arr[i],i));return res}function makeDateFromInput(config){var matched,input=config._i;input===undefined?config._d=new Date:isDate(input)?config._d=new Date(+input):null!==(matched=aspNetJsonRegex.exec(input))?config._d=new Date(+matched[1]):"string"==typeof input?makeDateFromString(config):isArray(input)?(config._a=map(input.slice(0),function(obj){return parseInt(obj,10)}),dateFromConfig(config)):"object"==typeof input?dateFromObject(config):"number"==typeof input?config._d=new Date(input):moment.createFromInputFallback(config)}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return 1970>y&&date.setFullYear(y),date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return 1970>y&&date.setUTCFullYear(y),date}function parseWeekday(input,locale){if("string"==typeof input)if(isNaN(input)){if(input=locale.weekdaysParse(input),"number"!=typeof input)return null}else input=parseInt(input,10);return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(posNegDuration,withoutSuffix,locale){var duration=moment.duration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),args=seconds<relativeTimeThresholds.s&&["s",seconds]||1===minutes&&["m"]||minutes<relativeTimeThresholds.m&&["mm",minutes]||1===hours&&["h"]||hours<relativeTimeThresholds.h&&["hh",hours]||1===days&&["d"]||days<relativeTimeThresholds.d&&["dd",days]||1===months&&["M"]||months<relativeTimeThresholds.M&&["MM",months]||1===years&&["y"]||["yy",years];return args[2]=withoutSuffix,args[3]=+posNegDuration>0,args[4]=locale,substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),end-7>daysToDayOfWeek&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add(daysToDayOfWeek,"d"),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var daysToAdd,dayOfYear,d=makeUTCDate(year,0,1).getUTCDay();return d=0===d?7:d,weekday=null!=weekday?weekday:firstDayOfWeek,daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(firstDayOfWeek>d?7:0),dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1,{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var res,input=config._i,format=config._f;return config._locale=config._locale||moment.localeData(config._l),null===input||format===undefined&&""===input?moment.invalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),moment.isMoment(input)?new Moment(input,!0):(format?isArray(format)?makeDateFromStringAndArray(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),res=new Moment(config),res._nextDay&&(res.add(1,"d"),res._nextDay=undefined),res))}function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return moment();for(res=moments[0],i=1;i<moments.length;++i)moments[i][fn](res)&&(res=moments[i]);return res}function rawMonthSetter(mom,value){var dayOfMonth;return"string"==typeof value&&(value=mom.localeData().monthsParse(value),"number"!=typeof value)?mom:(dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom)}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){return"Month"===unit?rawMonthSetter(mom,value):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function makeAccessor(unit,keepTime){return function(value){return null!=value?(rawSetter(this,unit,value),moment.updateOffset(this,keepTime),this):rawGetter(this,unit)}}function daysToYears(days){return 400*days/146097}function yearsToDays(years){return 146097*years/400}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeGlobal(shouldDeprecate){"undefined"==typeof ender&&(oldGlobalMoment=globalScope.moment,globalScope.moment=shouldDeprecate?deprecate("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",moment):moment)}for(var moment,oldGlobalMoment,i,VERSION="2.9.0",globalScope="undefined"==typeof global||"undefined"!=typeof window&&window!==global.window?this:global,round=Math.round,hasOwnProperty=Object.prototype.hasOwnProperty,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,locales={},momentProperties=[],hasModule="undefined"!=typeof module&&module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenOffsetMs=/[\+\-]?\d+/,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,unitMillisecondFactors=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,d:26,M:11},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.localeData().monthsShort(this,format)},MMMM:function(format){return this.localeData().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.localeData().weekdaysMin(this,format)},ddd:function(format){return this.localeData().weekdaysShort(this,format)},dddd:function(format){return this.localeData().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=this.utcOffset(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=this.utcOffset(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},deprecations={},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"],updateInProgress=!1;ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),extend(Locale.prototype,{set:function(config){var prop,i;for(i in config)prop=config[i],"function"==typeof prop?this[i]=prop:this["_"+i]=prop;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName,format,strict){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;12>i;i++){if(mom=moment.utc([2e3,i]),strict&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")),strict||this._monthsParse[i]||(regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"MMMM"===format&&this._longMonthsParse[i].test(monthName))return i;if(strict&&"MMM"===format&&this._shortMonthsParse[i].test(monthName))return i;if(!strict&&this._monthsParse[i].test(monthName))return i}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;7>i;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom,now){var output=this._calendar[key];return"function"==typeof output?output.apply(mom,[now]):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},firstDayOfWeek:function(){return this._week.dow},firstDayOfYear:function(){return this._week.doy},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),moment=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),c={},c._isAMomentObject=!0,c._i=input,c._f=format,c._l=locale,c._strict=strict,c._isUTC=!1,c._pf=defaultParsingFlags(),makeMoment(c)},moment.suppressDeprecationWarnings=!1,moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))}),moment.min=function(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)},moment.max=function(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)},moment.utc=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),c={},c._isAMomentObject=!0,c._useUTC=!0,c._isUTC=!0,c._l=locale,c._i=input,c._f=format,c._strict=strict,c._pf=defaultParsingFlags(),makeMoment(c).utc()},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var sign,ret,parseIso,diffRes,duration=input,match=null;return moment.isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetTimeSpanJsonRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=isoDurationRegex.exec(input))?(sign="-"===match[1]?-1:1,parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign},duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}):null==duration?duration={}:"object"==typeof duration&&("from"in duration||"to"in duration)&&(diffRes=momentsDifference(moment(duration.from),moment(duration.to)),duration={},duration.ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),moment.isDuration(input)&&hasOwnProp(input,"_locale")&&(ret._locale=input._locale),ret},moment.version=VERSION,moment.defaultFormat=isoFormat,moment.ISO_8601=function(){},moment.momentProperties=momentProperties,moment.updateOffset=function(){},moment.relativeTimeThreshold=function(threshold,limit){return relativeTimeThresholds[threshold]===undefined?!1:limit===undefined?relativeTimeThresholds[threshold]:(relativeTimeThresholds[threshold]=limit,!0)},moment.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",function(key,value){return moment.locale(key,value)}),moment.locale=function(key,values){var data;return key&&(data="undefined"!=typeof values?moment.defineLocale(key,values):moment.localeData(key),data&&(moment.duration._locale=moment._locale=data)),moment._locale._abbr},moment.defineLocale=function(name,values){return null!==values?(values.abbr=name,locales[name]||(locales[name]=new Locale),locales[name].set(values),moment.locale(name),locales[name]):(delete locales[name],null)},moment.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",function(key){return moment.localeData(key)}),moment.localeData=function(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return moment._locale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return chooseLocale(key)},moment.isMoment=function(obj){return obj instanceof Moment||null!=obj&&hasOwnProp(obj,"_isAMomentObject")},moment.isDuration=function(obj){return obj instanceof Duration};for(i=lists.length-1;i>=0;--i)makeList(lists[i]);moment.normalizeUnits=function(units){return normalizeUnits(units)},moment.invalid=function(flags){var m=moment.utc(0/0);return null!=flags?extend(m._pf,flags):m._pf.userInvalidated=!0,m},moment.parseZone=function(){return moment.apply(null,arguments).parseZone()},moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)},moment.isDate=isDate,extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return+this._d-6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();return 0<m.year()&&m.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toISODate:function(){return formatMoment(this,"YYYY-MM-DD")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){return this._a?this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0:!1},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(keepLocalTime){return this.utcOffset(0,keepLocalTime)},local:function(keepLocalTime){return this._isUTC&&(this.utcOffset(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.subtract(this._dateUtcOffset(),"m")),this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.localeData().postformat(output)},add:createAdder(1,"add"),subtract:createAdder(-1,"subtract"),diff:function(input,units,asFloat){var diff,output,that=makeAs(input,this),zoneDiff=6e4*(that.utcOffset()-this.utcOffset());return units=normalizeUnits(units),"year"===units||"month"===units||"quarter"===units?(output=monthDiff(this,that),"quarter"===units?output/=3:"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(time){var now=time||moment(),sod=makeAs(now,this).startOf("day"),diff=this.diff(sod,"days",!0),format=-6>diff?"sameElse":-1>diff?"lastWeek":0>diff?"lastDay":1>diff?"sameDay":2>diff?"nextDay":7>diff?"nextWeek":"sameElse";return this.format(this.localeData().calendar(format,this,moment(now)))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=parseWeekday(input,this.localeData()),this.add(input-day,"d")):day},month:makeAccessor("Month",!0),startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units?this.weekday(0):"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(units){return units=normalizeUnits(units),units===undefined||"millisecond"===units?this:this.startOf(units).add(1,"isoWeek"===units?"week":units).subtract(1,"ms")},isAfter:function(input,units){var inputMs;return units=normalizeUnits("undefined"!=typeof units?units:"millisecond"),"millisecond"===units?(input=moment.isMoment(input)?input:moment(input),+this>+input):(inputMs=moment.isMoment(input)?+input:+moment(input),inputMs<+this.clone().startOf(units))},isBefore:function(input,units){var inputMs;return units=normalizeUnits("undefined"!=typeof units?units:"millisecond"),"millisecond"===units?(input=moment.isMoment(input)?input:moment(input),+input>+this):(inputMs=moment.isMoment(input)?+input:+moment(input),+this.clone().endOf(units)<inputMs)},isBetween:function(from,to,units){return this.isAfter(from,units)&&this.isBefore(to,units)},isSame:function(input,units){var inputMs;return units=normalizeUnits(units||"millisecond"),"millisecond"===units?(input=moment.isMoment(input)?input:moment(input),+this===+input):(inputMs=+moment(input),+this.clone().startOf(units)<=inputMs&&inputMs<=+this.clone().endOf(units))},min:deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),this>other?this:other}),max:deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),other>this?this:other}),zone:deprecate("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(input,keepLocalTime){return null!=input?("string"!=typeof input&&(input=-input),this.utcOffset(input,keepLocalTime),this):-this.utcOffset()}),utcOffset:function(input,keepLocalTime){var localAdjust,offset=this._offset||0;return null!=input?("string"==typeof input&&(input=utcOffsetFromString(input)),Math.abs(input)<16&&(input=60*input),!this._isUTC&&keepLocalTime&&(localAdjust=this._dateUtcOffset()),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.add(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?addOrSubtractDurationFromMoment(this,moment.duration(input-offset,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,moment.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?offset:this._dateUtcOffset()},isLocal:function(){return!this._isUTC},isUtcOffset:function(){return this._isUTC},isUtc:function(){return this._isUTC&&0===this._offset},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(utcOffsetFromString(this._i)),this},hasAlignedHourOffset:function(input){return input=input?moment(input).utcOffset():0,(this.utcOffset()-input)%60===0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")},quarter:function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==input?year:this.add(input-year,"y")},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add(input-year,"y")},week:function(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")},weekday:function(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){return units=normalizeUnits(units),this[units]()},set:function(units,value){var unit;if("object"==typeof units)for(unit in units)this.set(unit,units[unit]);else units=normalizeUnits(units),"function"==typeof this[units]&&this[units](value);return this},locale:function(key){var newLocaleData;return key===undefined?this._locale._abbr:(newLocaleData=moment.localeData(key),null!=newLocaleData&&(this._locale=newLocaleData),this)},lang:deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){return key===undefined?this.localeData():this.locale(key)}),localeData:function(){return this._locale
},_dateUtcOffset:function(){return 15*-Math.round(this._d.getTimezoneOffset()/15)}}),moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",!1),moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",!1),moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",!1),moment.fn.hour=moment.fn.hours=makeAccessor("Hours",!0),moment.fn.date=makeAccessor("Date",!0),moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",!0)),moment.fn.year=makeAccessor("FullYear",!0),moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",!0)),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.quarters=moment.fn.quarter,moment.fn.toJSON=moment.fn.toISOString,moment.fn.isUTC=moment.fn.isUtc,extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var seconds,minutes,hours,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,years=0;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),years=absRound(daysToYears(days)),days-=absRound(yearsToDays(years)),months+=absRound(days/30),days%=30,years+=absRound(months/12),months%=12,data.days=days,data.months=months,data.years=years},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12)},humanize:function(withSuffix){var output=relativeTime(this,!withSuffix,this.localeData());return withSuffix&&(output=this.localeData().pastFuture(+this,output)),this.localeData().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return units=normalizeUnits(units),this[units.toLowerCase()+"s"]()},as:function(units){var days,months;if(units=normalizeUnits(units),"month"===units||"year"===units)return days=this._days+this._milliseconds/864e5,months=this._months+12*daysToYears(days),"month"===units?months:months/12;switch(days=this._days+Math.round(yearsToDays(this._months/12)),units){case"week":return days/7+this._milliseconds/6048e5;case"day":return days+this._milliseconds/864e5;case"hour":return 24*days+this._milliseconds/36e5;case"minute":return 24*days*60+this._milliseconds/6e4;case"second":return 24*days*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*days*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+units)}},lang:moment.fn.lang,locale:moment.fn.locale,toIsoString:deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":""):"P0D"},localeData:function(){return this._locale},toJSON:function(){return this.toISOString()}}),moment.duration.fn.toString=moment.duration.fn.toISOString;for(i in unitMillisecondFactors)hasOwnProp(unitMillisecondFactors,i)&&makeDurationGetter(i.toLowerCase());moment.duration.fn.asMilliseconds=function(){return this.as("ms")},moment.duration.fn.asSeconds=function(){return this.as("s")},moment.duration.fn.asMinutes=function(){return this.as("m")},moment.duration.fn.asHours=function(){return this.as("h")},moment.duration.fn.asDays=function(){return this.as("d")},moment.duration.fn.asWeeks=function(){return this.as("weeks")},moment.duration.fn.asMonths=function(){return this.as("M")},moment.duration.fn.asYears=function(){return this.as("y")},moment.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),hasModule?module.exports=moment:"function"==typeof define&&define.amd?(define(function(require,exports,module){return module.config&&module.config()&&module.config().noGlobal===!0&&(globalScope.moment=oldGlobalMoment),moment}),makeGlobal(!0)):makeGlobal()}.call(this),function(root,factory){"use strict";"function"==typeof define&&define.amd?define(["moment"],factory):"object"==typeof exports?module.exports=factory(require("moment")):factory(root.moment)}(this,function(moment){"use strict";function charCodeToInt(charCode){return charCode>96?charCode-87:charCode>64?charCode-29:charCode-48}function unpackBase60(string){var num,i=0,parts=string.split("."),whole=parts[0],fractional=parts[1]||"",multiplier=1,out=0,sign=1;for(45===string.charCodeAt(0)&&(i=1,sign=-1),i;i<whole.length;i++)num=charCodeToInt(whole.charCodeAt(i)),out=60*out+num;for(i=0;i<fractional.length;i++)multiplier/=60,num=charCodeToInt(fractional.charCodeAt(i)),out+=num*multiplier;return out*sign}function arrayToInt(array){for(var i=0;i<array.length;i++)array[i]=unpackBase60(array[i])}function intToUntil(array,length){for(var i=0;length>i;i++)array[i]=Math.round((array[i-1]||0)+6e4*array[i]);array[length-1]=1/0}function mapIndices(source,indices){var i,out=[];for(i=0;i<indices.length;i++)out[i]=source[indices[i]];return out}function unpack(string){var data=string.split("|"),offsets=data[2].split(" "),indices=data[3].split(""),untils=data[4].split(" ");return arrayToInt(offsets),arrayToInt(indices),arrayToInt(untils),intToUntil(untils,indices.length),{name:data[0],abbrs:mapIndices(data[1].split(" "),indices),offsets:mapIndices(offsets,indices),untils:untils}}function Zone(packedString){packedString&&this._set(unpack(packedString))}function normalizeName(name){return(name||"").toLowerCase().replace(/\//g,"_")}function addZone(packed){var i,zone,zoneName;for("string"==typeof packed&&(packed=[packed]),i=0;i<packed.length;i++)zone=new Zone(packed[i]),zoneName=normalizeName(zone.name),zones[zoneName]=zone,upgradeLinksToZones(zoneName)}function getZone(name){return zones[normalizeName(name)]||null}function getNames(){var i,out=[];for(i in zones)zones.hasOwnProperty(i)&&zones[i]&&out.push(zones[i].name);return out.sort()}function addLink(aliases){var i,alias;for("string"==typeof aliases&&(aliases=[aliases]),i=0;i<aliases.length;i++)alias=aliases[i].split("|"),pushLink(alias[0],alias[1]),pushLink(alias[1],alias[0])}function upgradeLinksToZones(zoneName){if(links[zoneName]){var i,zone=zones[zoneName],linkNames=links[zoneName];for(i=0;i<linkNames.length;i++)copyZoneWithName(zone,linkNames[i]);links[zoneName]=null}}function copyZoneWithName(zone,name){var linkZone=zones[normalizeName(name)]=new Zone;linkZone._set(zone),linkZone.name=name}function pushLink(zoneName,linkName){zoneName=normalizeName(zoneName),zones[zoneName]?copyZoneWithName(zones[zoneName],linkName):(links[zoneName]=links[zoneName]||[],links[zoneName].push(linkName))}function loadData(data){addZone(data.zones),addLink(data.links),tz.dataVersion=data.version}function zoneExists(name){return zoneExists.didShowError||(zoneExists.didShowError=!0,logError("moment.tz.zoneExists('"+name+"') has been deprecated in favor of !moment.tz.zone('"+name+"')")),!!getZone(name)}function needsOffset(m){return!(!m._a||void 0!==m._tzm)}function logError(message){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(message)}function tz(){var args=Array.prototype.slice.call(arguments,0,-1),name=arguments[arguments.length-1],zone=getZone(name),out=moment.utc.apply(null,args);return zone&&needsOffset(out)&&out.add(zone.parse(out),"minutes"),out.tz(name),out}function abbrWrap(old){return function(){return this._z?this._z.abbr(this):old.call(this)}}function resetZoneWrap(old){return function(){return this._z=null,old.apply(this,arguments)}}if(void 0!==moment.tz)return moment;var VERSION="0.2.5",zones={},links={},momentVersion=moment.version.split("."),major=+momentVersion[0],minor=+momentVersion[1];(2>major||2===major&&6>minor)&&logError("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+moment.version+". See momentjs.com"),Zone.prototype={_set:function(unpacked){this.name=unpacked.name,this.abbrs=unpacked.abbrs,this.untils=unpacked.untils,this.offsets=unpacked.offsets},_index:function(timestamp){var i,target=+timestamp,untils=this.untils;for(i=0;i<untils.length;i++)if(target<untils[i])return i},parse:function(timestamp){var offset,offsetNext,offsetPrev,i,target=+timestamp,offsets=this.offsets,untils=this.untils,max=untils.length-1;for(i=0;max>i;i++)if(offset=offsets[i],offsetNext=offsets[i+1],offsetPrev=offsets[i?i-1:i],offsetNext>offset&&tz.moveAmbiguousForward?offset=offsetNext:offset>offsetPrev&&tz.moveInvalidForward&&(offset=offsetPrev),target<untils[i]-6e4*offset)return offsets[i];return offsets[max]},abbr:function(mom){return this.abbrs[this._index(mom)]},offset:function(mom){return this.offsets[this._index(mom)]}},tz.version=VERSION,tz.dataVersion="",tz._zones=zones,tz._links=links,tz.add=addZone,tz.link=addLink,tz.load=loadData,tz.zone=getZone,tz.zoneExists=zoneExists,tz.names=getNames,tz.Zone=Zone,tz.unpack=unpack,tz.unpackBase60=unpackBase60,tz.needsOffset=needsOffset,tz.moveInvalidForward=!0,tz.moveAmbiguousForward=!1;var fn=moment.fn;moment.tz=tz,moment.updateOffset=function(mom,keepTime){var offset;mom._z&&(offset=mom._z.offset(mom),Math.abs(offset)<16&&(offset/=60),mom.zone(offset,keepTime))},fn.tz=function(name){return name?(this._z=getZone(name),this._z?moment.updateOffset(this):logError("Moment Timezone has no data for "+name+". See http://momentjs.com/timezone/docs/#/data-loading/."),this):this._z?this._z.name:void 0},fn.zoneName=abbrWrap(fn.zoneName),fn.zoneAbbr=abbrWrap(fn.zoneAbbr),fn.utc=resetZoneWrap(fn.utc);var momentProperties=moment.momentProperties;return"[object Array]"===Object.prototype.toString.call(momentProperties)?(momentProperties.push("_z"),momentProperties.push("_a")):momentProperties&&(momentProperties._z=null),loadData({version:"2014j",zones:["Africa/Abidjan|GMT|0|0|","Africa/Addis_Ababa|EAT|-30|0|","Africa/Algiers|CET|-10|0|","Africa/Bangui|WAT|-10|0|","Africa/Blantyre|CAT|-20|0|","Africa/Cairo|EET EEST|-20 -30|0101010101010101010101010101010|1Cby0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0 1o10 jz0 gN0 pb0 1qN0 dX0 e10 xz0 1o10 bb0 e10 An0 1o10 5z0 e10 FX0 1o10 2L0 e10 IL0 1C10 Lz0","Africa/Casablanca|WET WEST|0 -10|01010101010101010101010101010101010101010|1Cco0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uo0 e00 DA0 11A0 rA0 e00 Jc0 WM0 m00 gM0 M00 WM0 jc0 e00 RA0 11A0 dA0 e00 Uo0 11A0 800 gM0 Xc0","Africa/Ceuta|CET CEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Africa/Johannesburg|SAST|-20|0|","Africa/Tripoli|EET CET CEST|-20 -10 -20|0120|1IlA0 TA0 1o00","Africa/Windhoek|WAST WAT|-20 -10|01010101010101010101010|1C1c0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0","America/Adak|HAST HADT|a0 90|01010101010101010101010|1BR00 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1BQX0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Anguilla|AST|40|0|","America/Araguaina|BRT BRST|30 20|010|1IdD0 Lz0","America/Argentina/Buenos_Aires|ART|30|0|","America/Asuncion|PYST PYT|30 40|01010101010101010101010|1C430 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0","America/Atikokan|EST|50|0|","America/Bahia|BRT BRST|30 20|010|1FJf0 Rb0","America/Bahia_Banderas|MST CDT CST|70 50 60|01212121212121212121212|1C1l0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Belem|BRT|30|0|","America/Belize|CST|60|0|","America/Boa_Vista|AMT|40|0|","America/Bogota|COT|50|0|","America/Boise|MST MDT|70 60|01010101010101010101010|1BQV0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Campo_Grande|AMST AMT|30 40|01010101010101010101010|1BIr0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10","America/Cancun|CST CDT|60 50|01010101010101010101010|1C1k0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Caracas|VET|4u|0|","America/Cayenne|GFT|30|0|","America/Chicago|CST CDT|60 50|01010101010101010101010|1BQU0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1C1l0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Creston|MST|70|0|","America/Dawson|PST PDT|80 70|01010101010101010101010|1BQW0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Detroit|EST EDT|50 40|01010101010101010101010|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Eirunepe|AMT ACT|40 50|01|1KLE0","America/Glace_Bay|AST ADT|40 30|01010101010101010101010|1BQS0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Godthab|WGT WGST|30 20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","America/Goose_Bay|AST ADT|40 30|01010101010101010101010|1BQQ1 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Grand_Turk|EST EDT AST|50 40 40|0101010101012|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Guayaquil|ECT|50|0|","America/Guyana|GYT|40|0|","America/Havana|CST CDT|50 40|01010101010101010101010|1BQR0 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0","America/La_Paz|BOT|40|0|","America/Lima|PET|50|0|","America/Metlakatla|PST|80|0|","America/Miquelon|PMST PMDT|30 20|01010101010101010101010|1BQR0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Montevideo|UYST UYT|20 30|01010101010101010101010|1BQQ0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10","America/Noronha|FNT|20|0|","America/North_Dakota/Beulah|MST MDT CST CDT|70 60 60 50|01232323232323232323232|1BQV0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Paramaribo|SRT|30|0|","America/Port-au-Prince|EST EDT|50 40|0101010101010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Santa_Isabel|PST PDT|80 70|01010101010101010101010|1C1m0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Santiago|CLST CLT|30 40|01010101010101010101010|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0","America/Sao_Paulo|BRST BRT|20 30|01010101010101010101010|1BIq0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10","America/Scoresbysund|EGT EGST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1BQPv 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Antarctica/Casey|CAST AWST|-b0 -80|0101|1BN30 40P0 KL0","Antarctica/Davis|DAVT DAVT|-50 -70|0101|1BPw0 3Wn0 KN0","Antarctica/DumontDUrville|DDUT|-a0|0|","Antarctica/Macquarie|AEDT MIST|-b0 -b0|01|1C140","Antarctica/Mawson|MAWT|-50|0|","Antarctica/McMurdo|NZDT NZST|-d0 -c0|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Antarctica/Rothera|ROTT|30|0|","Antarctica/Syowa|SYOT|-30|0|","Antarctica/Troll|UTC CEST|0 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Antarctica/Vostok|VOST|-60|0|","Asia/Aden|AST|-30|0|","Asia/Almaty|ALMT|-60|0|","Asia/Amman|EET EEST|-20 -30|010101010101010101010|1BVy0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0","Asia/Anadyr|ANAT ANAST ANAT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0","Asia/Aqtau|AQTT|-50|0|","Asia/Ashgabat|TMT|-50|0|","Asia/Baku|AZT AZST|-40 -50|01010101010101010101010|1BWo0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Bangkok|ICT|-70|0|","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1BWm0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0","Asia/Bishkek|KGT|-60|0|","Asia/Brunei|BNT|-80|0|","Asia/Calcutta|IST|-5u|0|","Asia/Chita|YAKT YAKST YAKT IRKT|-90 -a0 -a0 -80|01023|1BWh0 1qM0 WM0 8Hz0","Asia/Choibalsan|CHOT|-80|0|","Asia/Chongqing|CST|-80|0|","Asia/Dacca|BDT|-60|0|","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1C0m0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0","Asia/Dili|TLT|-90|0|","Asia/Dubai|GST|-40|0|","Asia/Dushanbe|TJT|-50|0|","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1BVW1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0","Asia/Hebron|EET EEST|-20 -30|0101010101010101010101010|1BVy0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0","Asia/Hong_Kong|HKT|-80|0|","Asia/Hovd|HOVT|-70|0|","Asia/Irkutsk|IRKT IRKST IRKT|-80 -90 -90|01020|1BWi0 1qM0 WM0 8Hz0","Asia/Istanbul|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Jakarta|WIB|-70|0|","Asia/Jayapura|WIT|-90|0|","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1BVA0 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0","Asia/Kabul|AFT|-4u|0|","Asia/Kamchatka|PETT PETST PETT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0","Asia/Karachi|PKT|-50|0|","Asia/Kashgar|XJT|-60|0|","Asia/Kathmandu|NPT|-5J|0|","Asia/Khandyga|VLAT VLAST VLAT YAKT YAKT|-a0 -b0 -b0 -a0 -90|010234|1BWg0 1qM0 WM0 17V0 7zD0","Asia/Krasnoyarsk|KRAT KRAST KRAT|-70 -80 -80|01020|1BWj0 1qM0 WM0 8Hz0","Asia/Kuala_Lumpur|MYT|-80|0|","Asia/Magadan|MAGT MAGST MAGT MAGT|-b0 -c0 -c0 -a0|01023|1BWf0 1qM0 WM0 8Hz0","Asia/Makassar|WITA|-80|0|","Asia/Manila|PHT|-80|0|","Asia/Nicosia|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Novokuznetsk|KRAT NOVST NOVT NOVT|-70 -70 -60 -70|01230|1BWj0 1qN0 WM0 8Hz0","Asia/Novosibirsk|NOVT NOVST NOVT|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0","Asia/Omsk|OMST OMSST OMST|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0","Asia/Oral|ORAT|-50|0|","Asia/Pyongyang|KST|-90|0|","Asia/Qyzylorda|QYZT|-60|0|","Asia/Rangoon|MMT|-6u|0|","Asia/Sakhalin|SAKT SAKST SAKT|-a0 -b0 -b0|01020|1BWg0 1qM0 WM0 8Hz0","Asia/Samarkand|UZT|-50|0|","Asia/Singapore|SGT|-80|0|","Asia/Srednekolymsk|MAGT MAGST MAGT SRET|-b0 -c0 -c0 -b0|01023|1BWf0 1qM0 WM0 8Hz0","Asia/Tbilisi|GET|-40|0|","Asia/Tehran|IRST IRDT|-3u -4u|01010101010101010101010|1BTUu 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0","Asia/Thimbu|BTT|-60|0|","Asia/Tokyo|JST|-90|0|","Asia/Ulaanbaatar|ULAT|-80|0|","Asia/Ust-Nera|MAGT MAGST MAGT VLAT VLAT|-b0 -c0 -c0 -b0 -a0|010234|1BWf0 1qM0 WM0 17V0 7zD0","Asia/Vladivostok|VLAT VLAST VLAT|-a0 -b0 -b0|01020|1BWg0 1qM0 WM0 8Hz0","Asia/Yakutsk|YAKT YAKST YAKT|-90 -a0 -a0|01020|1BWh0 1qM0 WM0 8Hz0","Asia/Yekaterinburg|YEKT YEKST YEKT|-50 -60 -60|01020|1BWl0 1qM0 WM0 8Hz0","Asia/Yerevan|AMT AMST|-40 -50|01010|1BWm0 1qM0 WM0 1qM0","Atlantic/Azores|AZOT AZOST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Atlantic/Canary|WET WEST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Atlantic/Cape_Verde|CVT|10|0|","Atlantic/South_Georgia|GST|20|0|","Atlantic/Stanley|FKST FKT|30 40|010|1C6R0 U10","Australia/ACT|AEDT AEST|-b0 -a0|01010101010101010101010|1C140 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1C14u 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Brisbane|AEST|-a0|0|","Australia/Darwin|ACST|-9u|0|","Australia/Eucla|ACWST|-8J|0|","Australia/LHI|LHDT LHST|-b0 -au|01010101010101010101010|1C130 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu","Australia/Perth|AWST|-80|0|","Chile/EasterIsland|EASST EAST|50 60|01010101010101010101010|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0","Eire|GMT IST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Etc/GMT+1|GMT+1|10|0|","Etc/GMT+10|GMT+10|a0|0|","Etc/GMT+11|GMT+11|b0|0|","Etc/GMT+12|GMT+12|c0|0|","Etc/GMT+2|GMT+2|20|0|","Etc/GMT+3|GMT+3|30|0|","Etc/GMT+4|GMT+4|40|0|","Etc/GMT+5|GMT+5|50|0|","Etc/GMT+6|GMT+6|60|0|","Etc/GMT+7|GMT+7|70|0|","Etc/GMT+8|GMT+8|80|0|","Etc/GMT+9|GMT+9|90|0|","Etc/GMT-1|GMT-1|-10|0|","Etc/GMT-10|GMT-10|-a0|0|","Etc/GMT-11|GMT-11|-b0|0|","Etc/GMT-12|GMT-12|-c0|0|","Etc/GMT-13|GMT-13|-d0|0|","Etc/GMT-14|GMT-14|-e0|0|","Etc/GMT-2|GMT-2|-20|0|","Etc/GMT-3|GMT-3|-30|0|","Etc/GMT-4|GMT-4|-40|0|","Etc/GMT-5|GMT-5|-50|0|","Etc/GMT-6|GMT-6|-60|0|","Etc/GMT-7|GMT-7|-70|0|","Etc/GMT-8|GMT-8|-80|0|","Etc/GMT-9|GMT-9|-90|0|","Etc/UCT|UCT|0|0|","Etc/UTC|UTC|0|0|","Europe/Belfast|GMT BST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Kaliningrad|EET EEST FET|-20 -30 -30|01020|1BWo0 1qM0 WM0 8Hz0","Europe/Minsk|EET EEST FET MSK|-20 -30 -30 -30|01023|1BWo0 1qM0 WM0 8Hy0","Europe/Moscow|MSK MSD MSK|-30 -40 -40|01020|1BWn0 1qM0 WM0 8Hz0","Europe/Samara|SAMT SAMST SAMT|-40 -40 -30|0120|1BWm0 1qN0 WM0","Europe/Simferopol|EET EEST MSK MSK|-20 -30 -40 -30|01010101023|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0","Europe/Volgograd|MSK MSK|-30 -40|01010|1BWn0 1qM0 WM0 8Hz0","HST|HST|a0|0|","Indian/Chagos|IOT|-60|0|","Indian/Christmas|CXT|-70|0|","Indian/Cocos|CCT|-6u|0|","Indian/Kerguelen|TFT|-50|0|","Indian/Mahe|SCT|-40|0|","Indian/Maldives|MVT|-50|0|","Indian/Mauritius|MUT|-40|0|","Indian/Reunion|RET|-40|0|","Kwajalein|MHT|-c0|0|","MET|MET MEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","NZ-CHAT|CHADT CHAST|-dJ -cJ|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Pacific/Apia|SST SDT WSDT WSST|b0 a0 -e0 -d0|01012323232323232323232|1Dbn0 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Pacific/Bougainville|PGT BST|-a0 -b0|01|1NwE0","Pacific/Chuuk|CHUT|-a0|0|","Pacific/Efate|VUT|-b0|0|","Pacific/Enderbury|PHOT|-d0|0|","Pacific/Fakaofo|TKT TKT|b0 -d0|01|1Gfn0","Pacific/Fiji|FJST FJT|-d0 -c0|01010101010101010101010|1BWe0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 xA0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0","Pacific/Funafuti|TVT|-c0|0|","Pacific/Galapagos|GALT|60|0|","Pacific/Gambier|GAMT|90|0|","Pacific/Guadalcanal|SBT|-b0|0|","Pacific/Guam|ChST|-a0|0|","Pacific/Kiritimati|LINT|-e0|0|","Pacific/Kosrae|KOST|-b0|0|","Pacific/Marquesas|MART|9u|0|","Pacific/Midway|SST|b0|0|","Pacific/Nauru|NRT|-c0|0|","Pacific/Niue|NUT|b0|0|","Pacific/Norfolk|NFT|-bu|0|","Pacific/Noumea|NCT|-b0|0|","Pacific/Palau|PWT|-90|0|","Pacific/Pohnpei|PONT|-b0|0|","Pacific/Port_Moresby|PGT|-a0|0|","Pacific/Rarotonga|CKT|a0|0|","Pacific/Tahiti|TAHT|a0|0|","Pacific/Tarawa|GILT|-c0|0|","Pacific/Tongatapu|TOT|-d0|0|","Pacific/Wake|WAKT|-c0|0|","Pacific/Wallis|WFT|-c0|0|"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Sao_Tome","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Addis_Ababa|Africa/Asmara","Africa/Addis_Ababa|Africa/Asmera","Africa/Addis_Ababa|Africa/Dar_es_Salaam","Africa/Addis_Ababa|Africa/Djibouti","Africa/Addis_Ababa|Africa/Juba","Africa/Addis_Ababa|Africa/Kampala","Africa/Addis_Ababa|Africa/Khartoum","Africa/Addis_Ababa|Africa/Mogadishu","Africa/Addis_Ababa|Africa/Nairobi","Africa/Addis_Ababa|Indian/Antananarivo","Africa/Addis_Ababa|Indian/Comoro","Africa/Addis_Ababa|Indian/Mayotte","Africa/Algiers|Africa/Tunis","Africa/Bangui|Africa/Brazzaville","Africa/Bangui|Africa/Douala","Africa/Bangui|Africa/Kinshasa","Africa/Bangui|Africa/Lagos","Africa/Bangui|Africa/Libreville","Africa/Bangui|Africa/Luanda","Africa/Bangui|Africa/Malabo","Africa/Bangui|Africa/Ndjamena","Africa/Bangui|Africa/Niamey","Africa/Bangui|Africa/Porto-Novo","Africa/Blantyre|Africa/Bujumbura","Africa/Blantyre|Africa/Gaborone","Africa/Blantyre|Africa/Harare","Africa/Blantyre|Africa/Kigali","Africa/Blantyre|Africa/Lubumbashi","Africa/Blantyre|Africa/Lusaka","Africa/Blantyre|Africa/Maputo","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Ceuta|Arctic/Longyearbyen","Africa/Ceuta|Atlantic/Jan_Mayen","Africa/Ceuta|CET","Africa/Ceuta|Europe/Amsterdam","Africa/Ceuta|Europe/Andorra","Africa/Ceuta|Europe/Belgrade","Africa/Ceuta|Europe/Berlin","Africa/Ceuta|Europe/Bratislava","Africa/Ceuta|Europe/Brussels","Africa/Ceuta|Europe/Budapest","Africa/Ceuta|Europe/Busingen","Africa/Ceuta|Europe/Copenhagen","Africa/Ceuta|Europe/Gibraltar","Africa/Ceuta|Europe/Ljubljana","Africa/Ceuta|Europe/Luxembourg","Africa/Ceuta|Europe/Madrid","Africa/Ceuta|Europe/Malta","Africa/Ceuta|Europe/Monaco","Africa/Ceuta|Europe/Oslo","Africa/Ceuta|Europe/Paris","Africa/Ceuta|Europe/Podgorica","Africa/Ceuta|Europe/Prague","Africa/Ceuta|Europe/Rome","Africa/Ceuta|Europe/San_Marino","Africa/Ceuta|Europe/Sarajevo","Africa/Ceuta|Europe/Skopje","Africa/Ceuta|Europe/Stockholm","Africa/Ceuta|Europe/Tirane","Africa/Ceuta|Europe/Vaduz","Africa/Ceuta|Europe/Vatican","Africa/Ceuta|Europe/Vienna","Africa/Ceuta|Europe/Warsaw","Africa/Ceuta|Europe/Zagreb","Africa/Ceuta|Europe/Zurich","Africa/Ceuta|Poland","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Anguilla|America/Antigua","America/Anguilla|America/Aruba","America/Anguilla|America/Barbados","America/Anguilla|America/Blanc-Sablon","America/Anguilla|America/Curacao","America/Anguilla|America/Dominica","America/Anguilla|America/Grenada","America/Anguilla|America/Guadeloupe","America/Anguilla|America/Kralendijk","America/Anguilla|America/Lower_Princes","America/Anguilla|America/Marigot","America/Anguilla|America/Martinique","America/Anguilla|America/Montserrat","America/Anguilla|America/Port_of_Spain","America/Anguilla|America/Puerto_Rico","America/Anguilla|America/Santo_Domingo","America/Anguilla|America/St_Barthelemy","America/Anguilla|America/St_Kitts","America/Anguilla|America/St_Lucia","America/Anguilla|America/St_Thomas","America/Anguilla|America/St_Vincent","America/Anguilla|America/Tortola","America/Anguilla|America/Virgin","America/Argentina/Buenos_Aires|America/Argentina/Catamarca","America/Argentina/Buenos_Aires|America/Argentina/ComodRivadavia","America/Argentina/Buenos_Aires|America/Argentina/Cordoba","America/Argentina/Buenos_Aires|America/Argentina/Jujuy","America/Argentina/Buenos_Aires|America/Argentina/La_Rioja","America/Argentina/Buenos_Aires|America/Argentina/Mendoza","America/Argentina/Buenos_Aires|America/Argentina/Rio_Gallegos","America/Argentina/Buenos_Aires|America/Argentina/Salta","America/Argentina/Buenos_Aires|America/Argentina/San_Juan","America/Argentina/Buenos_Aires|America/Argentina/San_Luis","America/Argentina/Buenos_Aires|America/Argentina/Tucuman","America/Argentina/Buenos_Aires|America/Argentina/Ushuaia","America/Argentina/Buenos_Aires|America/Buenos_Aires","America/Argentina/Buenos_Aires|America/Catamarca","America/Argentina/Buenos_Aires|America/Cordoba","America/Argentina/Buenos_Aires|America/Jujuy","America/Argentina/Buenos_Aires|America/Mendoza","America/Argentina/Buenos_Aires|America/Rosario","America/Atikokan|America/Cayman","America/Atikokan|America/Coral_Harbour","America/Atikokan|America/Jamaica","America/Atikokan|America/Panama","America/Atikokan|EST","America/Atikokan|Jamaica","America/Belem|America/Fortaleza","America/Belem|America/Maceio","America/Belem|America/Recife","America/Belem|America/Santarem","America/Belize|America/Costa_Rica","America/Belize|America/El_Salvador","America/Belize|America/Guatemala","America/Belize|America/Managua","America/Belize|America/Regina","America/Belize|America/Swift_Current","America/Belize|America/Tegucigalpa","America/Belize|Canada/East-Saskatchewan","America/Belize|Canada/Saskatchewan","America/Boa_Vista|America/Manaus","America/Boa_Vista|America/Porto_Velho","America/Boa_Vista|Brazil/West","America/Boise|America/Cambridge_Bay","America/Boise|America/Denver","America/Boise|America/Edmonton","America/Boise|America/Inuvik","America/Boise|America/Ojinaga","America/Boise|America/Shiprock","America/Boise|America/Yellowknife","America/Boise|Canada/Mountain","America/Boise|MST7MDT","America/Boise|Navajo","America/Boise|US/Mountain","America/Campo_Grande|America/Cuiaba","America/Cancun|America/Merida","America/Cancun|America/Mexico_City","America/Cancun|America/Monterrey","America/Cancun|Mexico/General","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Creston|America/Dawson_Creek","America/Creston|America/Hermosillo","America/Creston|America/Phoenix","America/Creston|MST","America/Creston|US/Arizona","America/Dawson|America/Ensenada","America/Dawson|America/Los_Angeles","America/Dawson|America/Tijuana","America/Dawson|America/Vancouver","America/Dawson|America/Whitehorse","America/Dawson|Canada/Pacific","America/Dawson|Canada/Yukon","America/Dawson|Mexico/BajaNorte","America/Dawson|PST8PDT","America/Dawson|US/Pacific","America/Dawson|US/Pacific-New","America/Detroit|America/Fort_Wayne","America/Detroit|America/Indiana/Indianapolis","America/Detroit|America/Indiana/Marengo","America/Detroit|America/Indiana/Petersburg","America/Detroit|America/Indiana/Vevay","America/Detroit|America/Indiana/Vincennes","America/Detroit|America/Indiana/Winamac","America/Detroit|America/Indianapolis","America/Detroit|America/Iqaluit","America/Detroit|America/Kentucky/Louisville","America/Detroit|America/Kentucky/Monticello","America/Detroit|America/Louisville","America/Detroit|America/Montreal","America/Detroit|America/Nassau","America/Detroit|America/New_York","America/Detroit|America/Nipigon","America/Detroit|America/Pangnirtung","America/Detroit|America/Thunder_Bay","America/Detroit|America/Toronto","America/Detroit|Canada/Eastern","America/Detroit|EST5EDT","America/Detroit|US/East-Indiana","America/Detroit|US/Eastern","America/Detroit|US/Michigan","America/Eirunepe|America/Porto_Acre","America/Eirunepe|America/Rio_Branco","America/Eirunepe|Brazil/Acre","America/Glace_Bay|America/Halifax","America/Glace_Bay|America/Moncton","America/Glace_Bay|America/Thule","America/Glace_Bay|Atlantic/Bermuda","America/Glace_Bay|Canada/Atlantic","America/Havana|Cuba","America/Metlakatla|Pacific/Pitcairn","America/Noronha|Brazil/DeNoronha","America/Santiago|Antarctica/Palmer","America/Santiago|Chile/Continental","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","Antarctica/McMurdo|Antarctica/South_Pole","Antarctica/McMurdo|NZ","Antarctica/McMurdo|Pacific/Auckland","Asia/Aden|Asia/Baghdad","Asia/Aden|Asia/Bahrain","Asia/Aden|Asia/Kuwait","Asia/Aden|Asia/Qatar","Asia/Aden|Asia/Riyadh","Asia/Aqtau|Asia/Aqtobe","Asia/Ashgabat|Asia/Ashkhabad","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Calcutta|Asia/Colombo","Asia/Calcutta|Asia/Kolkata","Asia/Chongqing|Asia/Chungking","Asia/Chongqing|Asia/Harbin","Asia/Chongqing|Asia/Macao","Asia/Chongqing|Asia/Macau","Asia/Chongqing|Asia/Shanghai","Asia/Chongqing|Asia/Taipei","Asia/Chongqing|PRC","Asia/Chongqing|ROC","Asia/Dacca|Asia/Dhaka","Asia/Dubai|Asia/Muscat","Asia/Hong_Kong|Hongkong","Asia/Istanbul|Europe/Istanbul","Asia/Istanbul|Turkey","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kashgar|Asia/Urumqi","Asia/Kathmandu|Asia/Katmandu","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Makassar|Asia/Ujung_Pandang","Asia/Nicosia|EET","Asia/Nicosia|Europe/Athens","Asia/Nicosia|Europe/Bucharest","Asia/Nicosia|Europe/Chisinau","Asia/Nicosia|Europe/Helsinki","Asia/Nicosia|Europe/Kiev","Asia/Nicosia|Europe/Mariehamn","Asia/Nicosia|Europe/Nicosia","Asia/Nicosia|Europe/Riga","Asia/Nicosia|Europe/Sofia","Asia/Nicosia|Europe/Tallinn","Asia/Nicosia|Europe/Tiraspol","Asia/Nicosia|Europe/Uzhgorod","Asia/Nicosia|Europe/Vilnius","Asia/Nicosia|Europe/Zaporozhye","Asia/Pyongyang|Asia/Seoul","Asia/Pyongyang|ROK","Asia/Samarkand|Asia/Tashkent","Asia/Singapore|Singapore","Asia/Tehran|Iran","Asia/Thimbu|Asia/Thimphu","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Atlantic/Canary|Atlantic/Faeroe","Atlantic/Canary|Atlantic/Faroe","Atlantic/Canary|Atlantic/Madeira","Atlantic/Canary|Europe/Lisbon","Atlantic/Canary|Portugal","Atlantic/Canary|WET","Australia/ACT|Australia/Canberra","Australia/ACT|Australia/Currie","Australia/ACT|Australia/Hobart","Australia/ACT|Australia/Melbourne","Australia/ACT|Australia/NSW","Australia/ACT|Australia/Sydney","Australia/ACT|Australia/Tasmania","Australia/ACT|Australia/Victoria","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/LHI|Australia/Lord_Howe","Australia/Perth|Australia/West","Chile/EasterIsland|Pacific/Easter","Eire|Europe/Dublin","Etc/UCT|UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Belfast|Europe/Guernsey","Europe/Belfast|Europe/Isle_of_Man","Europe/Belfast|Europe/Jersey","Europe/Belfast|Europe/London","Europe/Belfast|GB","Europe/Belfast|GB-Eire","Europe/Moscow|W-SU","HST|Pacific/Honolulu","HST|Pacific/Johnston","HST|US/Hawaii","Kwajalein|Pacific/Kwajalein","Kwajalein|Pacific/Majuro","NZ-CHAT|Pacific/Chatham","Pacific/Chuuk|Pacific/Truk","Pacific/Chuuk|Pacific/Yap","Pacific/Guam|Pacific/Saipan","Pacific/Midway|Pacific/Pago_Pago","Pacific/Midway|Pacific/Samoa","Pacific/Midway|US/Samoa","Pacific/Pohnpei|Pacific/Ponape"]}),moment
}),function(root,undefined){function isString(obj){return!!(""===obj||obj&&obj.charCodeAt&&obj.substr)}function isArray(obj){return nativeIsArray?nativeIsArray(obj):"[object Array]"===toString.call(obj)}function isObject(obj){return"[object Object]"===toString.call(obj)}function defaults(object,defs){var key;object=object||{},defs=defs||{};for(key in defs)defs.hasOwnProperty(key)&&null==object[key]&&(object[key]=defs[key]);return object}function map(obj,iterator,context){var i,j,results=[];if(!obj)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);for(i=0,j=obj.length;j>i;i++)results[i]=iterator.call(context,obj[i],i,obj);return results}function checkPrecision(val,base){return val=Math.round(Math.abs(val)),isNaN(val)?base:val}function checkCurrencyFormat(format){var defaults=lib.settings.currency.format;return"function"==typeof format&&(format=format()),isString(format)&&format.match("%v")?{pos:format,neg:format.replace("-","").replace("%v","-%v"),zero:format}:format&&format.pos&&format.pos.match("%v")?format:isString(defaults)?lib.settings.currency.format={pos:defaults,neg:defaults.replace("%v","-%v"),zero:defaults}:defaults}var lib={};lib.version="0.3.2",lib.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var nativeMap=Array.prototype.map,nativeIsArray=Array.isArray,toString=Object.prototype.toString,unformat=lib.unformat=lib.parse=function(value,decimal){if(isArray(value))return map(value,function(val){return unformat(val,decimal)});if(value=value||0,"number"==typeof value)return value;decimal=decimal||".";var regex=new RegExp("[^0-9-"+decimal+"]",["g"]),unformatted=parseFloat((""+value).replace(/\((.*)\)/,"-$1").replace(regex,"").replace(decimal,"."));return isNaN(unformatted)?0:unformatted},toFixed=lib.toFixed=function(value,precision){precision=checkPrecision(precision,lib.settings.number.precision);var power=Math.pow(10,precision);return(Math.round(lib.unformat(value)*power)/power).toFixed(precision)},formatNumber=lib.formatNumber=function(number,precision,thousand,decimal){if(isArray(number))return map(number,function(val){return formatNumber(val,precision,thousand,decimal)});number=unformat(number);var opts=defaults(isObject(precision)?precision:{precision:precision,thousand:thousand,decimal:decimal},lib.settings.number),usePrecision=checkPrecision(opts.precision),negative=0>number?"-":"",base=parseInt(toFixed(Math.abs(number||0),usePrecision),10)+"",mod=base.length>3?base.length%3:0;return negative+(mod?base.substr(0,mod)+opts.thousand:"")+base.substr(mod).replace(/(\d{3})(?=\d)/g,"$1"+opts.thousand)+(usePrecision?opts.decimal+toFixed(Math.abs(number),usePrecision).split(".")[1]:"")},formatMoney=lib.formatMoney=function(number,symbol,precision,thousand,decimal,format){if(isArray(number))return map(number,function(val){return formatMoney(val,symbol,precision,thousand,decimal,format)});number=unformat(number);var opts=defaults(isObject(symbol)?symbol:{symbol:symbol,precision:precision,thousand:thousand,decimal:decimal,format:format},lib.settings.currency),formats=checkCurrencyFormat(opts.format),useFormat=number>0?formats.pos:0>number?formats.neg:formats.zero;return useFormat.replace("%s",opts.symbol).replace("%v",formatNumber(Math.abs(number),checkPrecision(opts.precision),opts.thousand,opts.decimal))};lib.formatColumn=function(list,symbol,precision,thousand,decimal,format){if(!list)return[];var opts=defaults(isObject(symbol)?symbol:{symbol:symbol,precision:precision,thousand:thousand,decimal:decimal,format:format},lib.settings.currency),formats=checkCurrencyFormat(opts.format),padAfterSymbol=formats.pos.indexOf("%s")<formats.pos.indexOf("%v")?!0:!1,maxLength=0,formatted=map(list,function(val){if(isArray(val))return lib.formatColumn(val,opts);val=unformat(val);var useFormat=val>0?formats.pos:0>val?formats.neg:formats.zero,fVal=useFormat.replace("%s",opts.symbol).replace("%v",formatNumber(Math.abs(val),checkPrecision(opts.precision),opts.thousand,opts.decimal));return fVal.length>maxLength&&(maxLength=fVal.length),fVal});return map(formatted,function(val){return isString(val)&&val.length<maxLength?padAfterSymbol?val.replace(opts.symbol,opts.symbol+new Array(maxLength-val.length+1).join(" ")):new Array(maxLength-val.length+1).join(" ")+val:val})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=lib),exports.accounting=lib):"function"==typeof define&&define.amd?define([],function(){return lib}):(lib.noConflict=function(oldAccounting){return function(){return root.accounting=oldAccounting,lib.noConflict=undefined,lib}}(root.accounting),root.accounting=lib)}(this),function(window,document,undefined){"use strict";function minErr(module){return function(){var message,i,code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments,stringify=function(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof obj?"undefined":"string"!=typeof obj?JSON.stringify(obj):obj};for(message=prefix+template.replace(/\{\d+\}/g,function(match){var arg,index=+match.slice(1,-1);return index+2<templateArgs.length?(arg=templateArgs[index+2],"function"==typeof arg?arg.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof arg?"undefined":"string"!=typeof arg?toJson(arg):arg):match}),message=message+"\nhttp://errors.angularjs.org/1.2.28/"+(module?module+"/":"")+code,i=2;i<arguments.length;i++)message=message+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(stringify(arguments[i]));return new Error(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;var length=obj.length;return 1===obj.nodeType&&length?!0:isString(obj)||isArray(obj)||0===length||"number"==typeof length&&length>0&&length-1 in obj}function forEach(obj,iterator,context){var key;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key);else if(isArray(obj)||isArrayLike(obj))for(key=0;key<obj.length;key++)iterator.call(context,obj[key],key);else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context);else for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key);return obj}function sortedKeys(obj){var keys=[];for(var key in obj)obj.hasOwnProperty(key)&&keys.push(key);return keys.sort()}function forEachSorted(obj,iterator,context){for(var keys=sortedKeys(obj),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){for(var digit,index=uid.length;index;){if(index--,digit=uid[index].charCodeAt(0),57==digit)return uid[index]="A",uid.join("");if(90!=digit)return uid[index]=String.fromCharCode(digit+1),uid.join("");uid[index]="0"}return uid.unshift("0"),uid.join("")}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function extend(dst){var h=dst.$$hashKey;return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst[key]=value})}),setHashKey(dst,h),dst}function int(str){return parseInt(str,10)}function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!=value&&"object"==typeof value}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function map(obj,iterator,context){var results=[];return forEach(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results}function includes(array,obj){return-1!=indexOf(array,obj)}function indexOf(array,obj){if(array.indexOf)return array.indexOf(obj);for(var i=0;i<array.length;i++)if(obj===array[i])return i;return-1}function arrayRemove(array,value){var index=indexOf(array,value);return index>=0&&array.splice(index,1),value}function copy(source,destination,stackSource,stackDest){if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(destination){if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");if(stackSource=stackSource||[],stackDest=stackDest||[],isObject(source)){var index=indexOf(stackSource,source);if(-1!==index)return stackDest[index];stackSource.push(source),stackDest.push(destination)}var result;if(isArray(source)){destination.length=0;for(var i=0;i<source.length;i++)result=copy(source[i],null,stackSource,stackDest),isObject(source[i])&&(stackSource.push(source[i]),stackDest.push(result)),destination.push(result)}else{var h=destination.$$hashKey;isArray(destination)?destination.length=0:forEach(destination,function(value,key){delete destination[key]});for(var key in source)result=copy(source[key],null,stackSource,stackDest),isObject(source[key])&&(stackSource.push(source[key]),stackDest.push(result)),destination[key]=result;setHashKey(destination,h)}}else destination=source,source&&(isArray(source)?destination=copy(source,[],stackSource,stackDest):isDate(source)?destination=new Date(source.getTime()):isRegExp(source)?(destination=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]),destination.lastIndex=source.lastIndex):isObject(source)&&(destination=copy(source,{},stackSource,stackDest)));return destination}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0;i<src.length;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)!hasOwnProperty.call(src,key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key])}return dst||src}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)?isNaN(o1.getTime())&&isNaN(o2.getTime())||o1.getTime()===o2.getTime():!1;if(isRegExp(o1)&&isRegExp(o2))return o1.toString()==o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2))return!1;keySet={};for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!keySet.hasOwnProperty(key)&&"$"!==key.charAt(0)&&o2[key]!==undefined&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,curryArgs.concat(slice.call(arguments,0))):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return"undefined"==typeof obj?undefined:JSON.stringify(obj,toJsonReplacer,pretty?"  ":null)}function fromJson(json){return isString(json)?JSON.parse(json):json}function toBoolean(value){if("function"==typeof value)value=!0;else if(value&&0!==value.length){var v=lowercase(""+value);value=!("f"==v||"0"==v||"false"==v||"no"==v||"n"==v||"[]"==v)}else value=!1;return value}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var TEXT_NODE=3,elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===TEXT_NODE?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var key_value,key,obj={};return forEach((keyValue||"").split("&"),function(keyValue){if(keyValue&&(key_value=keyValue.replace(/\+/g,"%20").split("="),key=tryDecodeURIComponent(key_value[0]),isDefined(key))){var val=isDefined(key_value[1])?tryDecodeURIComponent(key_value[1]):!0;hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val}}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function angularInit(element,bootstrap){function append(element){element&&elements.push(element)}var appElement,module,elements=[element],names=["ng:app","ng-app","x-ng-app","data-ng-app"],NG_APP_CLASS_REGEXP=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;forEach(names,function(name){names[name]=!0,append(document.getElementById(name)),name=name.replace(":","\\:"),element.querySelectorAll&&(forEach(element.querySelectorAll("."+name),append),forEach(element.querySelectorAll("."+name+"\\:"),append),forEach(element.querySelectorAll("["+name+"]"),append))}),forEach(elements,function(element){if(!appElement){var className=" "+element.className+" ",match=NG_APP_CLASS_REGEXP.exec(className);match?(appElement=element,module=(match[2]||"").replace(/\s+/g,",")):forEach(element.attributes,function(attr){!appElement&&names[attr.name]&&(appElement=element,module=attr.value)})}}),appElement&&bootstrap(appElement,module?[module]:[])}function bootstrap(element,modules){var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===document?"document":startingTag(element);throw ngMinErr("btstrpd","App Already Bootstrapped with this Element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),modules.unshift("ng");var injector=createInjector(modules);return injector.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),void(angular.resumeBootstrap=function(extraModules){forEach(extraModules,function(module){modules.push(module)}),doBootstrap()}))}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){jQuery=window.jQuery,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),jqLitePatchJQueryRemove("remove",!0,!0,!1),jqLitePatchJQueryRemove("empty",!1,!1,!1),jqLitePatchJQueryRemove("html",!1,!1,!0)):jqLite=JQLite,angular.element=jqLite}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockElements(nodes){var startNode=nodes[0],endNode=nodes[nodes.length-1];if(startNode===endNode)return jqLite(startNode);var element=startNode,elements=[element];do{if(element=element.nextSibling,!element)break;elements.push(element)}while(element!==endNode);return jqLite(elements)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod){return function(){return invokeQueue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],runBlocks=[],config=invokeLater("$injector","invoke"),moduleInstance={_invokeQueue:invokeQueue,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLater("$provide","provider"),factory:invokeLater("$provide","factory"),service:invokeLater("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),animation:invokeLater("$animateProvider","register"),filter:invokeLater("$filterProvider","register"),controller:invokeLater("$controllerProvider","register"),directive:invokeLater("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0},$$minErr:minErr,$$csp:csp}),angularModule=setupModuleLoader(window);try{angularModule("ngLocale")}catch(e){angularModule("ngLocale",[]).provider("$locale",$LocaleProvider)}angularModule("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,required:requiredDirective,ngRequired:requiredDirective,ngValue:ngValueDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpBackend:$HttpBackendProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$asyncCallback:$$AsyncCallbackProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLitePatchJQueryRemove(name,dispatchThis,filterElems,getterIfNoArguments){function removePatch(param){var set,setIndex,setLength,element,childIndex,childLength,children,list=filterElems&&param?[this.filter(param)]:[this],fireEvent=dispatchThis;if(!getterIfNoArguments||null!=param)for(;list.length;)for(set=list.shift(),setIndex=0,setLength=set.length;setLength>setIndex;setIndex++)for(element=jqLite(set[setIndex]),fireEvent?element.triggerHandler("$destroy"):fireEvent=!fireEvent,childIndex=0,childLength=(children=element.children()).length;childLength>childIndex;childIndex++)list.push(jQuery(children[childIndex]));return originalJqFn.apply(this,arguments)}var originalJqFn=jQuery.fn[name];originalJqFn=originalJqFn.$original||originalJqFn,removePatch.$original=originalJqFn,jQuery.fn[name]=removePatch}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,j,jj,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML="<div>&#160;</div>"+wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],tmp.removeChild(tmp.firstChild),i=wrap[0];i--;)tmp=tmp.lastChild;for(j=0,jj=tmp.childNodes.length;jj>j;++j)nodes.push(tmp.childNodes[j]);tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",nodes}function jqLiteParseHTML(html,context){context=context||document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:jqLiteBuildFragment(html,context)}function JQLite(element){if(element instanceof JQLite)return element;if(isString(element)&&(element=trim(element)),!(this instanceof JQLite)){if(isString(element)&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}if(isString(element)){jqLiteAddNodes(this,jqLiteParseHTML(element));var fragment=jqLite(document.createDocumentFragment());fragment.append(this)}else jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element){jqLiteRemoveData(element);for(var i=0,children=element.childNodes||[];i<children.length;i++)jqLiteDealoc(children[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var events=jqLiteExpandoStore(element,"events"),handle=jqLiteExpandoStore(element,"handle");handle&&(isUndefined(type)?forEach(events,function(eventHandler,type){removeEventListenerFn(element,type,eventHandler),delete events[type]}):forEach(type.split(" "),function(type){isUndefined(fn)?(removeEventListenerFn(element,type,events[type]),delete events[type]):arrayRemove(events[type]||[],fn)}))}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=jqCache[expandoId];if(expandoStore){if(name)return void delete jqCache[expandoId].data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=undefined}}function jqLiteExpandoStore(element,key,value){var expandoId=element.ng339,expandoStore=jqCache[expandoId||-1];return isDefined(value)?(expandoStore||(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={}),void(expandoStore[key]=value)):expandoStore&&expandoStore[key]}function jqLiteData(element,key,value){var data=jqLiteExpandoStore(element,"data"),isSetter=isDefined(value),keyDefined=!isSetter&&isDefined(key),isSimpleGetter=keyDefined&&!isObject(key);if(data||isSimpleGetter||jqLiteExpandoStore(element,"data",data={}),isSetter)data[key]=value;else{if(!keyDefined)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}function jqLiteHasClass(element,selector){return element.getAttribute?(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1:!1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===existingClasses.indexOf(" "+cssClass+" ")&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements){elements=elements.nodeName||!isDefined(elements.length)||isWindow(elements)?[elements]:elements;for(var i=0;i<elements.length;i++)root.push(elements[i])}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){9==element.nodeType&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;ii>i;i++)if((value=jqLite.data(element,names[i]))!==undefined)return value;element=element.parentNode||11===element.nodeType&&element.host}}function jqLiteEmpty(element){for(var i=0,childNodes=element.childNodes;i<childNodes.length;i++)jqLiteDealoc(childNodes[i]);for(;element.firstChild;)element.removeChild(element.firstChild)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[element.nodeName]&&booleanAttr}function createEventHandler(element,events){var eventHandler=function(event,type){if(event.preventDefault||(event.preventDefault=function(){event.returnValue=!1}),event.stopPropagation||(event.stopPropagation=function(){event.cancelBubble=!0}),event.target||(event.target=event.srcElement||document),isUndefined(event.defaultPrevented)){var prevent=event.preventDefault;event.preventDefault=function(){event.defaultPrevented=!0,prevent.call(event)},event.defaultPrevented=!1}event.isDefaultPrevented=function(){return event.defaultPrevented||event.returnValue===!1};var eventHandlersCopy=shallowCopy(events[type||event.type]||[]);forEach(eventHandlersCopy,function(fn){fn.call(element,event)}),8>=msie?(event.preventDefault=null,event.stopPropagation=null,event.isDefaultPrevented=null):(delete event.preventDefault,delete event.stopPropagation,delete event.isDefaultPrevented)};return eventHandler.elem=element,eventHandler}function hashKey(obj,nextUidFn){var key,objType=typeof obj;return"function"==objType||"object"==objType&&null!==obj?"function"==typeof(key=obj.$$hashKey)?key=obj.$$hashKey():key===undefined&&(key=obj.$$hashKey=(nextUidFn||nextUid)()):key=obj,objType+":"+key}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function annotate(fn){var $inject,fnText,argDecl,last;return"function"==typeof fn?($inject=fn.$inject)||($inject=[],fn.length&&(fnText=fn.toString().replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})),fn.$inject=$inject):isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0),$inject}function createInjector(modulesToLoad){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function factory(name,factoryFn){return provider(name,{$get:factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val))}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){var moduleFn,invokeQueue,i,ii,runBlocks=[];return forEach(modulesToLoad,function(module){if(!loadedModules.get(module)){loadedModules.put(module,!0);try{if(isString(module))for(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),invokeQueue=moduleFn._invokeQueue,i=0,ii=invokeQueue.length;ii>i;i++){var invokeArgs=invokeQueue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}else isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)
}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function invoke(fn,self,locals){var length,i,key,args=[],$inject=annotate(fn);for(i=0,length=$inject.length;length>i;i++){if(key=$inject[i],"string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key))}return isArray(fn)&&(fn=fn[length]),fn.apply(self,args)}function instantiate(Type,locals){var instance,returnedValue,Constructor=function(){};return Constructor.prototype=(isArray(Type)?Type[Type.length-1]:Type).prototype,instance=new Constructor,returnedValue=invoke(Type,instance,locals),isObject(returnedValue)||isFunction(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],!0),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(){throw $injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(servicename){var provider=providerInjector.get(servicename+providerSuffix);return instanceInjector.invoke(provider.$get,provider)});return forEach(loadModules(modulesToLoad),function(fn){instanceInjector.invoke(fn||noop)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return forEach(list,function(element){result||"a"!==lowercase(element.nodeName)||(result=element)}),result}function scroll(){var elm,hash=$location.hash();hash?(elm=document.getElementById(hash))?elm.scrollIntoView():(elm=getFirstAnchor(document.getElementsByName(hash)))?elm.scrollIntoView():"top"===hash&&$window.scrollTo(0,0):$window.scrollTo(0,0)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(){$rootScope.$evalAsync(scroll)}),scroll}]}function $$AsyncCallbackProvider(){this.$get=["$$rAF","$timeout",function($$rAF,$timeout){return $$rAF.supported?function(fn){return $$rAF(fn)}:function(fn){return $timeout(fn,0,!1)}}]}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function startPoller(interval,setTimeout){!function check(){forEach(pollFns,function(pollFn){pollFn()}),pollTimeout=setTimeout(check,interval)}()}function fireUrlChange(){lastBrowserUrl!=self.url()&&(lastBrowserUrl=self.url(),forEach(urlChangeListeners,function(listener){listener(self.url())}))}var self=this,rawDocument=document[0],location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){forEach(pollFns,function(pollFn){pollFn()}),0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var pollTimeout,pollFns=[];self.addPollFn=function(fn){return isUndefined(pollTimeout)&&startPoller(100,setTimeout),pollFns.push(fn),fn};var lastBrowserUrl=location.href,baseElement=document.find("base"),reloadLocation=null;self.url=function(url,replace){if(location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){if(lastBrowserUrl==url)return;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,!sameBase&&$sniffer.history?replace?history.replaceState(null,"",url):(history.pushState(null,"",url),baseElement.attr("href",baseElement.attr("href"))):(sameBase||(reloadLocation=url),replace?location.replace(url):location.href=url),self}return reloadLocation||location.href.replace(/%27/g,"'")};var urlChangeListeners=[],urlChangeInit=!1;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",fireUrlChange),$sniffer.hashchange?jqLite(window).on("hashchange",fireUrlChange):self.addPollFn(fireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var lastCookies={},lastCookieString="",cookiePath=self.baseHref();self.cookies=function(name,value){var cookieLength,cookieArray,cookie,i,index;if(!name){if(rawDocument.cookie!==lastCookieString)for(lastCookieString=rawDocument.cookie,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=unescape(cookie.substring(0,index)),lastCookies[name]===undefined&&(lastCookies[name]=unescape(cookie.substring(index+1))));return lastCookies}value===undefined?rawDocument.cookie=escape(name)+"=;path="+cookiePath+";expires=Thu, 01 Jan 1970 00:00:00 GMT":isString(value)&&(cookieLength=(rawDocument.cookie=escape(name)+"="+escape(value)+";path="+cookiePath).length+1,cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"))},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data={},capacity=options&&options.capacity||Number.MAX_VALUE,lruHash={},freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}if(!isUndefined(value))return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}delete data[key],size--},removeAll:function(){data={},size=0,lruHash={},freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function $CompileProvider($provide,$$sanitizeUriProvider){var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\d\w_\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\d\w_\-]+)(?:\:([^;]+))?;?)/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/;this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"A",directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$http,$templateCache,$parse,$controller,$rootScope,$document,$sce,$animate,$$sanitizeUri){function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes)),forEach($compileNodes,function(node,index){3==node.nodeType&&node.nodeValue.match(/\S+/)&&($compileNodes[index]=node=jqLite(node).wrap("<span></span>").parent()[0])});var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);return safeAddClass($compileNodes,"ng-scope"),function(scope,cloneConnectFn,transcludeControllers,parentBoundTranscludeFn){assertArg(scope,"scope");var $linkNode=cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes;forEach(transcludeControllers,function(instance,name){$linkNode.data("$"+name+"Controller",instance)});for(var i=0,ii=$linkNode.length;ii>i;i++){var node=$linkNode[i],nodeType=node.nodeType;(1===nodeType||9===nodeType)&&$linkNode.eq(i).data("$scope",scope)}return cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,n,childBoundTranscludeFn,nodeListLength=nodeList.length,stableNodeList=new Array(nodeListLength);for(i=0;nodeListLength>i;i++)stableNodeList[i]=nodeList[i];for(i=0,n=0,ii=linkFns.length;ii>i;n++)node=stableNodeList[n],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),jqLite.data(node,"$scope",childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,undefined,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:undefined,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&safeAddClass(attrs.$$element,"ng-scope"),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),linkFns.push(nodeLinkFn,childLinkFn),linkFnFound=linkFnFound||nodeLinkFn||childLinkFn,previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){var boundTranscludeFn=function(transcludedScope,cloneFn,controllers){var scopeCreated=!1;transcludedScope||(transcludedScope=scope.$new(),transcludedScope.$$transcluded=!0,scopeCreated=!0);var clone=transcludeFn(transcludedScope,cloneFn,controllers,previousBoundTranscludeFn);return scopeCreated&&clone.on("$destroy",function(){transcludedScope.$destroy()}),clone};return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case 1:addDirective(directives,directiveNormalize(nodeName_(node).toLowerCase()),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName=!1,attrEndName=!1;if(attr=nAttrs[j],!msie||msie>=8||attr.specified){name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),(isNgAttr=NG_ATTR_BINDING.test(ngAttrName))&&(name=snake_case(ngAttrName.substr(6),"-"));var directiveNName=ngAttrName.replace(/(Start|End)$/,"");ngAttrName===directiveNName+"Start"&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,(isNgAttr||!attrs.hasOwnProperty(nName))&&(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}}if(className=node.className,isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case 3:addTextInterpolateDirective(directives,node.nodeValue);break;case 8:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);1==node.nodeType&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function getControllers(directiveName,require,$element,elementControllers){var value,retrievalMethod="data",optional=!1;if(isString(require)){for(;"^"==(value=require.charAt(0))||"?"==value;)require=require.substr(1),"^"==value&&(retrievalMethod="inheritedData"),optional=optional||"?"==value;if(value=null,elementControllers&&"data"===retrievalMethod&&(value=elementControllers[require]),value=value||$element[retrievalMethod]("$"+require+"Controller"),!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",require,directiveName);return value}return isArray(require)&&(value=[],forEach(require,function(require){value.push(getControllers(directiveName,require,$element,elementControllers))})),value}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn){var transcludeControllers;return arguments.length<2&&(cloneAttachFn=scope,scope=undefined),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),boundTranscludeFn(scope,cloneAttachFn,transcludeControllers)}var attrs,$element,i,ii,linkFn,controller,isolateScope,transcludeFn,elementControllers={};if(attrs=compileNode===linkNode?templateAttrs:shallowCopy(templateAttrs,new Attributes(jqLite(linkNode),templateAttrs.$attr)),$element=attrs.$$element,newIsolateScopeDirective){var LOCAL_REGEXP=/^\s*([@=&])(\??)\s*(\w*)\s*$/;isolateScope=scope.$new(!0),!templateDirective||templateDirective!==newIsolateScopeDirective&&templateDirective!==newIsolateScopeDirective.$$originalDirective?$element.data("$isolateScopeNoTemplate",isolateScope):$element.data("$isolateScope",isolateScope),safeAddClass($element,"ng-isolate-scope"),forEach(newIsolateScopeDirective.scope,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,match=definition.match(LOCAL_REGEXP)||[],attrName=match[3]||scopeName,optional="?"==match[2],mode=match[1];switch(isolateScope.$$isolateBindings[scopeName]=mode+attrName,mode){case"@":attrs.$observe(attrName,function(value){isolateScope[scopeName]=value}),attrs.$$observers[attrName].$$scope=scope,attrs[attrName]&&(isolateScope[scopeName]=$interpolate(attrs[attrName])(scope));break;case"=":if(optional&&!attrs[attrName])return;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=isolateScope[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",attrs[attrName],newIsolateScopeDirective.name)},lastValue=isolateScope[scopeName]=parentGet(scope),isolateScope.$watch(function(){var parentValue=parentGet(scope);return compare(parentValue,isolateScope[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=isolateScope[scopeName]):isolateScope[scopeName]=parentValue),lastValue=parentValue},null,parentGet.literal);break;case"&":parentGet=$parse(attrs[attrName]),isolateScope[scopeName]=function(locals){return parentGet(scope,locals)};break;default:throw $compileMinErr("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",newIsolateScopeDirective.name,scopeName,definition)}})}for(transcludeFn=boundTranscludeFn&&controllersBoundTransclude,controllerDirectives&&forEach(controllerDirectives,function(directive){var controllerInstance,locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn};controller=directive.controller,"@"==controller&&(controller=attrs[directive.name]),controllerInstance=$controller(controller,locals),elementControllers[directive.name]=controllerInstance,hasElementTranscludeDirective||$element.data("$"+directive.name+"Controller",controllerInstance),directive.controllerAs&&(locals.$scope[directive.controllerAs]=controllerInstance)}),i=0,ii=preLinkFns.length;ii>i;i++)try{linkFn=preLinkFns[i],linkFn(linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,undefined,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)try{linkFn=postLinkFns[i],linkFn(linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}previousCompileContext=previousCompileContext||{};for(var newScopeDirective,directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=undefined,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(newScopeDirective=newScopeDirective||directive,directive.templateUrl||(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode),isObject(directiveValue)&&(newIsolateScopeDirective=directive))),directiveName=directive.name,!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||{},assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue?(hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective})):($template=jqLite(jqLiteClone(compileNode)).contents(),$compileNode.empty(),childTranscludeFn=compile($template,transcludeFn))),directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:jqLite(trim(directiveValue)),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));newIsolateScopeDirective&&markDirectivesAsIsolate(templateDirectives),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn,attrStart,attrEnd):linkFn&&addLinkFns(linkFn.pre,linkFn.post,attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function markDirectivesAsIsolate(directives){for(var j=0,jj=directives.length;jj>j;j++)directives[j]=inherit(directives[j],{$$isolateScope:!0})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{directive=directives[i],(maxPriority===undefined||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)&&(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),tDirectives.push(directive),match=directive)}catch(e){$exceptionHandler(e)}return match}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?($element.attr("style",$element.attr("style")+";"+value),dst.style=(dst.style?dst.style+";":"")+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=extend({},origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl;return $compileNode.empty(),$http.get($sce.getTrustedResourceUrl(templateUrl),{cache:$templateCache}).success(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:jqLite(trim(content)),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectivesAsIsolate(templateDirectives),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}linkQueue=null}).error(function(response,code,headers,config){throw $compileMinErr("tpload","Failed to load template: {0}",config.url)}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;linkQueue?(linkQueue.push(scope),linkQueue.push(node),linkQueue.push(rootElement),linkQueue.push(childBoundTranscludeFn)):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",previousDirective.name,directive.name,what,startingTag(element))
}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var parent=templateNode.parent(),hasCompileParent=parent.length;return hasCompileParent&&safeAddClass(templateNode.parent(),"ng-binding"),function(scope,node){var parent=node.parent(),bindings=parent.data("$binding")||[];bindings.push(interpolateFn),parent.data("$binding",bindings),hasCompileParent||safeAddClass(parent,"ng-binding"),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"FORM"==tag&&"action"==attrNormalizedName||"IMG"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name){var interpolateFn=$interpolate(value,!0);if(interpolateFn){if("multiple"===name&&"SELECT"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers={});if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");interpolateFn=$interpolate(attr[name],!0,getTrustedContext(node,name)),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1;break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=document.createDocumentFragment();fragment.appendChild(firstElementToRemove),newNode[jqLite.expando]=firstElementToRemove[jqLite.expando];for(var k=1,kk=elementsToRemove.length;kk>k;k++){var element=elementsToRemove[k];jqLite(element).remove(),fragment.appendChild(element),delete elementsToRemove[k]}elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}var Attributes=function(element,attr){this.$$element=element,this.$attr=attr||{}};Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses),toRemove=tokenDifference(oldClasses,newClasses);0===toAdd.length?$animate.removeClass(this.$$element,toRemove):0===toRemove.length?$animate.addClass(this.$$element,toAdd):$animate.setClass(this.$$element,toAdd,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,booleanKey=getBooleanAttrName(this.$$element[0],key);booleanKey&&(this.$$element.prop(key,value),attrName=booleanKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),("A"===nodeName&&"href"===key||"IMG"===nodeName&&"src"===key)&&(this[key]=value=$$sanitizeUri(value,"src"===key)),writeAttr!==!1&&(null===value||value===undefined?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[key],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers={}),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||fn(attrs[key])}),fn}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol||"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/;return compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function $ControllerProvider(){var controllers={},CNTRL_REG=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.$get=["$injector","$window",function($injector,$window){return function(expression,locals){var instance,match,constructor,identifier;if(isString(expression)&&(match=expression.match(CNTRL_REG),constructor=match[1],identifier=match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||getter($window,constructor,!0),assertArgFn(expression,constructor,!0)),instance=$injector.instantiate(expression,locals),identifier){if(!locals||"object"!=typeof locals.$scope)throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",constructor||expression.name,identifier);locals.$scope[identifier]=instance}return instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(){$log.error.apply($log,arguments)}}]}function parseHeaders(headers){var key,val,i,parsed={};return headers?(forEach(headers.split("\n"),function(line){i=line.indexOf(":"),key=lowercase(trim(line.substr(0,i))),val=trim(line.substr(i+1)),key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}),parsed):parsed}function headersGetter(headers){var headersObj=isObject(headers)?headers:undefined;return function(name){return headersObj||(headersObj=parseHeaders(headers)),name?headersObj[lowercase(name)]||null:headersObj}}function transformData(data,headers,fns){return isFunction(fns)?fns(data,headers):(forEach(fns,function(fn){data=fn(data,headers)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var JSON_START=/^\s*(\[|\{[^\{])/,JSON_END=/[\}\]]\s*$/,PROTECTION_PREFIX=/^\)\]\}',?\n/,CONTENT_TYPE_APPLICATION_JSON={"Content-Type":"application/json;charset=utf-8"},defaults=this.defaults={transformResponse:[function(data){return isString(data)&&(data=data.replace(PROTECTION_PREFIX,""),JSON_START.test(data)&&JSON_END.test(data)&&(data=fromJson(data))),data}],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},interceptorFactories=this.interceptors=[],responseInterceptorFactories=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$browser,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function transformResponse(response){var resp=extend({},response,{data:transformData(response.data,response.headers,config.transformResponse)});return isSuccess(response.status)?resp:$q.reject(resp)}function mergeHeaders(config){function execHeaders(headers){var headerContent;forEach(headers,function(headerFn,header){isFunction(headerFn)&&(headerContent=headerFn(),null!=headerContent?headers[header]=headerContent:delete headers[header])})}var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return execHeaders(reqHeaders),reqHeaders}var config={method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse},headers=mergeHeaders(requestConfig);extend(config,requestConfig),config.headers=headers,config.method=uppercase(config.method);var serverRequest=function(config){headers=config.headers;var reqData=transformData(config.data,headersGetter(headers),config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData,headers).then(transformResponse,transformResponse)},chain=[serverRequest,undefined],promise=$q.when(config);for(forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&chain.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&chain.push(interceptor.response,interceptor.responseError)});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(thenFn,rejectFn)}return promise.success=function(fn){return promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise},promise}function createShortMethods(){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend(config||{},{method:name,url:url}))}})}function createShortMethodsWithData(){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend(config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData,reqHeaders){function done(status,response,headersString,statusText){cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),resolvePromise(response,status,headersString,statusText),$rootScope.$$phase||$rootScope.$apply()}function resolvePromise(response,status,headers,statusText){status=Math.max(status,0),(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function removePendingReq(){var idx=indexOf($http.pendingRequests,config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,url=buildUrl(config.url,config.params);if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache)if(cachedResp=cache.get(url),isDefined(cachedResp)){if(isPromiseLike(cachedResp))return cachedResp.then(removePendingReq,removePendingReq),cachedResp;isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK")}else cache.put(url,promise);if(isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$browser.cookies()[config.xsrfCookieName||defaults.xsrfCookieName]:undefined;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType)}return promise}function buildUrl(url,params){if(!params)return url;var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)||(value=[value]),forEach(value,function(v){isObject(v)&&(v=isDate(v)?v.toISOString():toJson(v)),parts.push(encodeUriQuery(key)+"="+encodeUriQuery(v))}))}),parts.length>0&&(url+=(-1==url.indexOf("?")?"?":"&")+parts.join("&")),url}var defaultCache=$cacheFactory("$http"),reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),forEach(responseInterceptorFactories,function(interceptorFactory,index){var responseFn=isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory);reversedInterceptors.splice(index,0,{response:function(response){return responseFn($q.when(response))},responseError:function(response){return responseFn($q.reject(response))}})}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function createXhr(method){if(8>=msie&&(!method.match(/^(get|post|head|put|delete|options)$/i)||!window.XMLHttpRequest))return new window.ActiveXObject("Microsoft.XMLHTTP");if(window.XMLHttpRequest)return new window.XMLHttpRequest;throw minErr("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")}function $HttpBackendProvider(){this.$get=["$browser","$window","$document",function($browser,$window,$document){return createHttpBackend($browser,createXhr,$browser.defer,$window.angular.callbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackId,done){var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks[callbackId].called||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),8>=msie&&(script.onreadystatechange=function(){isString(script.readyState)&&/loaded|complete/.test(script.readyState)&&(script.onreadystatechange=null,callback({type:"load"}))}),rawDocument.body.appendChild(script),callback}var ABORTED=-1;return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){status=ABORTED,jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){timeoutId&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),status=1223===status?204:status,statusText=statusText||"",callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}var status;if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data,callbacks[callbackId].called=!0};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),callbackId,function(status,text){completeRequest(callback,status,callbacks[callbackId].data,"",text),callbacks[callbackId]=noop})}else{var xhr=createXhr(method);if(xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onreadystatechange=function(){if(xhr&&4==xhr.readyState){var responseHeaders=null,response=null,statusText="";status!==ABORTED&&(responseHeaders=xhr.getAllResponseHeaders(),response="response"in xhr?xhr.response:xhr.responseText),status===ABORTED&&10>msie||(statusText=xhr.statusText),completeRequest(callback,status||xhr.status,response,responseHeaders,statusText)}},withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(post||null)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function $interpolate(text,mustHaveExpression,trustedContext){for(var startIndex,endIndex,fn,exp,index=0,parts=[],length=text.length,hasInterpolation=!1,concat=[];length>index;)-1!=(startIndex=text.indexOf(startSymbol,index))&&-1!=(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))?(index!=startIndex&&parts.push(text.substring(index,startIndex)),parts.push(fn=$parse(exp=text.substring(startIndex+startSymbolLength,endIndex))),fn.exp=exp,index=endIndex+endSymbolLength,hasInterpolation=!0):(index!=length&&parts.push(text.substring(index)),index=length);if((length=parts.length)||(parts.push(""),length=1),trustedContext&&parts.length>1)throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text);return!mustHaveExpression||hasInterpolation?(concat.length=length,fn=function(context){try{for(var part,i=0,ii=length;ii>i;i++){if("function"==typeof(part=parts[i]))if(part=part(context),part=trustedContext?$sce.getTrusted(trustedContext,part):$sce.valueOf(part),null==part)part="";else switch(typeof part){case"string":break;case"number":part=""+part;break;default:part=toJson(part)}concat[i]=part}return concat.join("")}catch(err){var newErr=$interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString());$exceptionHandler(newErr)}},fn.exp=text,fn.parts=parts,fn):void 0}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length;return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q",function($rootScope,$window,$q){function interval(fn,delay,count,invokeApply){var setInterval=$window.setInterval,clearInterval=$window.clearInterval,deferred=$q.defer(),promise=deferred.promise,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply;return count=isDefined(count)?count:0,promise.then(null,null,fn),promise.$$intervalId=setInterval(function(){deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return promise&&promise.$$intervalId in intervals?(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0):!1},interval}]}function $LocaleProvider(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"",posSuf:"",negPre:"(",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(num){return 1===num?"one":"other"}}}}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj,appBase){var parsedUrl=urlResolve(absoluteUrl,appBase);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=int(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj,appBase){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl,appBase);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function beginsWith(begin,whole){return 0===whole.indexOf(begin)?whole.substr(begin.length):void 0}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"";var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this,appBase),this.$$parse=function(url){var pathUrl=beginsWith(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this,appBase),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url){var appUrl,prevAppUrl,rewrittenUrl;return(appUrl=beginsWith(appBase,url))!==undefined?(prevAppUrl=appUrl,rewrittenUrl=(appUrl=beginsWith(basePrefix,appUrl))!==undefined?appBaseNoFile+(beginsWith("/",appUrl)||appUrl):appBase+prevAppUrl):(appUrl=beginsWith(appBaseNoFile,url))!==undefined?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile==url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,hashPrefix){var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this,appBase),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return 0===url.indexOf(base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutBaseUrl=beginsWith(appBase,url)||beginsWith(appBaseNoFile,url),withoutHashUrl="#"==withoutBaseUrl.charAt(0)?beginsWith(hashPrefix,withoutBaseUrl):this.$$html5?withoutBaseUrl:"";if(!isString(withoutHashUrl))throw $locationMinErr("ihshprfx",'Invalid url "{0}", missing hash prefix "{1}".',url,hashPrefix);parseAppUrl(withoutHashUrl,this,appBase),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url){return stripHash(appBase)==stripHash(url)?(this.$$parse(url),!0):!1}}function LocationHashbangInHtml5Url(appBase,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments);var appBaseNoFile=stripFile(appBase);this.$$parseLinkUrl=function(url){var rewrittenUrl,appUrl;return appBase==stripHash(url)?rewrittenUrl=url:(appUrl=beginsWith(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode=!1;this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isDefined(mode)?(html5Mode=mode,this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function($rootScope,$browser,$sniffer,$rootElement){function afterLocationChange(oldUrl){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();html5Mode?(appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url):(appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl),$location=new LocationMode(appBase,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl);var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(!event.ctrlKey&&!event.metaKey&&2!=event.which){for(var elm=jqLite(event.target);"a"!==lowercase(elm[0].nodeName);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!=$browser.url()&&($rootScope.$apply(),window.angular["ff-684208-preventDefault"]=!0))}}),$location.absUrl()!=initialUrl&&$browser.url($location.absUrl(),!0),$browser.onUrlChange(function(newUrl){$location.absUrl()!=newUrl&&($rootScope.$evalAsync(function(){var oldUrl=$location.absUrl();$location.$$parse(newUrl),$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl).defaultPrevented?($location.$$parse(oldUrl),$browser.url(oldUrl)):afterLocationChange(oldUrl)}),$rootScope.$$phase||$rootScope.$digest())});var changeCounter=0;return $rootScope.$watch(function(){var oldUrl=$browser.url(),currentReplace=$location.$$replace;return changeCounter&&oldUrl==$location.absUrl()||(changeCounter++,$rootScope.$evalAsync(function(){$rootScope.$broadcast("$locationChangeStart",$location.absUrl(),oldUrl).defaultPrevented?$location.$$parse(oldUrl):($browser.url($location.absUrl(),currentReplace),afterLocationChange(oldUrl))})),$location.$$replace=!1,changeCounter}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.document&&obj.location&&obj.alert&&obj.setInterval)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||BIND&&obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function setter(obj,path,setValue,fullExp,options){ensureSafeObject(obj,fullExp),options=options||{};for(var key,element=path.split("."),i=0;element.length>1;i++){key=ensureSafeMemberName(element.shift(),fullExp);var propertyObj=ensureSafeObject(obj[key],fullExp);propertyObj||(propertyObj={},obj[key]=propertyObj),obj=propertyObj,obj.then&&options.unwrapPromises&&(promiseWarning(fullExp),"$$v"in obj||!function(promise){promise.then(function(val){promise.$$v=val})}(obj),obj.$$v===undefined&&(obj.$$v={}),obj=obj.$$v)}return key=ensureSafeMemberName(element.shift(),fullExp),ensureSafeObject(obj[key],fullExp),obj[key]=setValue,setValue}function isPossiblyDangerousMemberName(name){return"constructor"==name}function cspSafeGetterFn(key0,key1,key2,key3,key4,fullExp,options){ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),ensureSafeMemberName(key2,fullExp),ensureSafeMemberName(key3,fullExp),ensureSafeMemberName(key4,fullExp);var eso=function(o){return ensureSafeObject(o,fullExp)},expensiveChecks=options.expensiveChecks,eso0=expensiveChecks||isPossiblyDangerousMemberName(key0)?eso:identity,eso1=expensiveChecks||isPossiblyDangerousMemberName(key1)?eso:identity,eso2=expensiveChecks||isPossiblyDangerousMemberName(key2)?eso:identity,eso3=expensiveChecks||isPossiblyDangerousMemberName(key3)?eso:identity,eso4=expensiveChecks||isPossiblyDangerousMemberName(key4)?eso:identity;return options.unwrapPromises?function(scope,locals){var promise,pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=eso0(pathVal[key0]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso0(val)})),pathVal=eso0(pathVal.$$v)),key1?null==pathVal?undefined:(pathVal=eso1(pathVal[key1]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso1(val)
})),pathVal=eso1(pathVal.$$v)),key2?null==pathVal?undefined:(pathVal=eso2(pathVal[key2]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso2(val)})),pathVal=eso2(pathVal.$$v)),key3?null==pathVal?undefined:(pathVal=eso3(pathVal[key3]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso3(val)})),pathVal=eso3(pathVal.$$v)),key4?null==pathVal?undefined:(pathVal=eso4(pathVal[key4]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso4(val)})),pathVal=eso4(pathVal.$$v)),pathVal):pathVal):pathVal):pathVal):pathVal)}:function(scope,locals){var pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=eso0(pathVal[key0]),key1?null==pathVal?undefined:(pathVal=eso1(pathVal[key1]),key2?null==pathVal?undefined:(pathVal=eso2(pathVal[key2]),key3?null==pathVal?undefined:(pathVal=eso3(pathVal[key3]),key4?null==pathVal?undefined:pathVal=eso4(pathVal[key4]):pathVal):pathVal):pathVal):pathVal)}}function getterFnWithExtraArgs(fn,fullExpression){return function(s,l){return fn(s,l,promiseWarning,ensureSafeObject,fullExpression)}}function getterFn(path,options,fullExp){var expensiveChecks=options.expensiveChecks,getterFnCache=expensiveChecks?getterFnCacheExpensive:getterFnCacheDefault;if(getterFnCache.hasOwnProperty(path))return getterFnCache[path];var fn,pathKeys=path.split("."),pathKeysLength=pathKeys.length;if(options.csp)fn=6>pathKeysLength?cspSafeGetterFn(pathKeys[0],pathKeys[1],pathKeys[2],pathKeys[3],pathKeys[4],fullExp,options):function(scope,locals){var val,i=0;do val=cspSafeGetterFn(pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],fullExp,options)(scope,locals),locals=undefined,scope=val;while(pathKeysLength>i);return val};else{var code="var p;\n";expensiveChecks&&(code+="s = eso(s, fe);\nl = eso(l, fe);\n");var needsEnsureSafeObject=expensiveChecks;forEach(pathKeys,function(key,index){ensureSafeMemberName(key,fullExp);var lookupJs=(index?"s":'((l&&l.hasOwnProperty("'+key+'"))?l:s)')+'["'+key+'"]',wrapWithEso=expensiveChecks||isPossiblyDangerousMemberName(key);wrapWithEso&&(lookupJs="eso("+lookupJs+", fe)",needsEnsureSafeObject=!0),code+="if(s == null) return undefined;\ns="+lookupJs+";\n",options.unwrapPromises&&(code+='if (s && s.then) {\n pw("'+fullExp.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v='+(wrapWithEso?"eso(v)":"v")+";});\n}\n s="+(wrapWithEso?"eso(s.$$v)":"s.$$v")+"\n}\n")}),code+="return s;";var evaledFnGetter=new Function("s","l","pw","eso","fe",code);evaledFnGetter.toString=valueFn(code),(needsEnsureSafeObject||options.unwrapPromises)&&(evaledFnGetter=getterFnWithExtraArgs(evaledFnGetter,fullExp)),fn=evaledFnGetter}return"hasOwnProperty"!==path&&(getterFnCache[path]=fn),fn}function $ParseProvider(){var cacheDefault={},cacheExpensive={},$parseOptions={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0,expensiveChecks:!1};this.unwrapPromises=function(value){return isDefined(value)?($parseOptions.unwrapPromises=!!value,this):$parseOptions.unwrapPromises},this.logPromiseWarnings=function(value){return isDefined(value)?($parseOptions.logPromiseWarnings=value,this):$parseOptions.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function($filter,$sniffer,$log){$parseOptions.csp=$sniffer.csp;var $parseOptionsExpensive={csp:$parseOptions.csp,unwrapPromises:$parseOptions.unwrapPromises,logPromiseWarnings:$parseOptions.logPromiseWarnings,expensiveChecks:!0};return promiseWarning=function(fullExp){$parseOptions.logPromiseWarnings&&!promiseWarningCache.hasOwnProperty(fullExp)&&(promiseWarningCache[fullExp]=!0,$log.warn("[$parse] Promise found in the expression `"+fullExp+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))},function(exp,expensiveChecks){var parsedExpression;switch(typeof exp){case"string":var cache=expensiveChecks?cacheExpensive:cacheDefault;if(cache.hasOwnProperty(exp))return cache[exp];var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);return parsedExpression=parser.parse(exp),"hasOwnProperty"!==exp&&(cache[exp]=parsedExpression),parsedExpression;case"function":return exp;default:return noop}}}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function defaultCallback(value){return value}function defaultErrback(reason){return reject(reason)}function all(promises){var deferred=defer(),counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,ref(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}var defer=function(){var value,deferred,pending=[];return deferred={resolve:function(val){if(pending){var callbacks=pending;pending=undefined,value=ref(val),callbacks.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],value.then(callback[0],callback[1],callback[2])})}},reject:function(reason){deferred.resolve(createInternalRejectedPromise(reason))},notify:function(progress){if(pending){var callbacks=pending;pending.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],callback[2](progress)})}},promise:{then:function(callback,errback,progressback){var result=defer(),wrappedCallback=function(value){try{result.resolve((isFunction(callback)?callback:defaultCallback)(value))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedErrback=function(reason){try{result.resolve((isFunction(errback)?errback:defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedProgressback=function(progress){try{result.notify((isFunction(progressback)?progressback:defaultCallback)(progress))}catch(e){exceptionHandler(e)}};return pending?pending.push([wrappedCallback,wrappedErrback,wrappedProgressback]):value.then(wrappedCallback,wrappedErrback,wrappedProgressback),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback){function makePromise(value,resolved){var result=defer();return resolved?result.resolve(value):result.reject(value),result.promise}function handleCallback(value,isResolved){var callbackOutput=null;try{callbackOutput=(callback||defaultCallback)()}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)}return this.then(function(value){return handleCallback(value,!0)},function(error){return handleCallback(error,!1)})}}}},ref=function(value){return isPromiseLike(value)?value:{then:function(callback){var result=defer();return nextTick(function(){result.resolve(callback(value))}),result.promise}}},reject=function(reason){var result=defer();return result.reject(reason),result.promise},createInternalRejectedPromise=function(reason){return{then:function(callback,errback){var result=defer();return nextTick(function(){try{result.resolve((isFunction(errback)?errback:defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}}),result.promise}}},when=function(value,callback,errback,progressback){var done,result=defer(),wrappedCallback=function(value){try{return(isFunction(callback)?callback:defaultCallback)(value)}catch(e){return exceptionHandler(e),reject(e)}},wrappedErrback=function(reason){try{return(isFunction(errback)?errback:defaultErrback)(reason)}catch(e){return exceptionHandler(e),reject(e)}},wrappedProgressback=function(progress){try{return(isFunction(progressback)?progressback:defaultCallback)(progress)}catch(e){exceptionHandler(e)}};return nextTick(function(){ref(value).then(function(value){done||(done=!0,result.resolve(ref(value).then(wrappedCallback,wrappedErrback,wrappedProgressback)))},function(reason){done||(done=!0,result.resolve(wrappedErrback(reason)))},function(progress){done||result.notify(wrappedProgressback(progress))})}),result.promise};return{defer:defer,reject:reject,when:when,all:all}}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame||$window.mozRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.mozCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse","$browser",function($injector,$exceptionHandler,$parse,$browser){function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this["this"]=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function compileToFn(exp,name){var fn=$parse(exp);return assertArgFn(fn,name),fn}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}Scope.prototype={constructor:Scope,$new:function(isolate){var child;return isolate?(child=new Scope,child.$root=this.$root,child.$$asyncQueue=this.$$asyncQueue,child.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=nextUid(),this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),child=new this.$$childScopeClass),child["this"]=child,child.$parent=this,child.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=child,this.$$childTail=child):this.$$childHead=this.$$childTail=child,child},$watch:function(watchExp,listener,objectEquality){var scope=this,get=compileToFn(watchExp,"watch"),array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:watchExp,eq:!!objectEquality};if(lastDirtyWatch=null,!isFunction(listener)){var listenFn=compileToFn(listener||noop,"listener");watcher.fn=function(newVal,oldVal,scope){listenFn(scope)}}if("string"==typeof watchExp&&get.constant){var originalFn=watcher.fn;watcher.fn=function(newVal,oldVal,scope){originalFn.call(this,newVal,oldVal,scope),arrayRemove(array,watcher)}}return array||(array=scope.$$watchers=[]),array.unshift(watcher),function(){arrayRemove(array,watcher),lastDirtyWatch=null}},$watchCollection:function(obj,listener){function $watchCollectionWatch(){newValue=objGetter(self);var newLength,key,bothNaN;if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++)bothNaN=oldValue[i]!==oldValue[i]&&newValue[i]!==newValue[i],bothNaN||oldValue[i]===newValue[i]||(changeDetected++,oldValue[i]=newValue[i])}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)newValue.hasOwnProperty(key)&&(newLength++,oldValue.hasOwnProperty(key)?(bothNaN=oldValue[key]!==oldValue[key]&&newValue[key]!==newValue[key],bothNaN||oldValue[key]===newValue[key]||(changeDetected++,oldValue[key]=newValue[key])):(oldLength++,oldValue[key]=newValue[key],changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)oldValue.hasOwnProperty(key)&&!newValue.hasOwnProperty(key)&&(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,objGetter=$parse(obj),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch($watchCollectionWatch,$watchCollectionAction)},$digest:function(){var watch,value,last,watchers,length,dirty,next,current,logIdx,logMsg,asyncTask,asyncQueue=this.$$asyncQueue,postDigestQueue=this.$$postDigestQueue,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),lastDirtyWatch=null;do{for(dirty=!1,current=target;asyncQueue.length;){try{asyncTask=asyncQueue.shift(),asyncTask.scope.$eval(asyncTask.expression)}catch(e){clearPhase(),$exceptionHandler(e)}lastDirtyWatch=null}traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if((value=watch.get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,watch.fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),logMsg=isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,logMsg+="; newVal: "+toJson(value)+"; oldVal: "+toJson(last),watchLog[logIdx].push(logMsg))}catch(e){clearPhase(),$exceptionHandler(e)}if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,toJson(watchLog))}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueue.length;)try{postDigestQueue.shift()()}catch(e){$exceptionHandler(e)}},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==$rootScope&&(forEach(this.$$listenerCount,bind(null,decrementListenerCount,this)),parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=noop,this.$on=this.$watch=function(){return noop})}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr){$rootScope.$$phase||$rootScope.$$asyncQueue.length||$browser.defer(function(){$rootScope.$$asyncQueue.length&&$rootScope.$digest()}),this.$$asyncQueue.push({scope:this,expression:expr})},$$postDigest:function(fn){this.$$postDigestQueue.push(fn)},$apply:function(expr){try{return beginPhase("$apply"),this.$eval(expr)}catch(e){$exceptionHandler(e)}finally{clearPhase();try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=indexOf(namedListeners,listener);-1!==indexOfListener&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event;scope=scope.$parent}while(scope);return event},$broadcast:function(name){for(var listeners,i,length,target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event}};var $rootScope=new Scope;return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return msie&&!(msie>=8)||(normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex))?uri:"unsafe:"+normalizedVal}}}function escapeForRegexp(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||trustedValue===undefined||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||maybeTrusted===undefined||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sniffer","$sceDelegate",function($parse,$sniffer,$sceDelegate){if(enabled&&$sniffer.msie&&$sniffer.msieDocumentMode<8)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 9 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:function(self,locals){return sce.getTrusted(type,parsed(self,locals))}};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},android=int((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},documentMode=document.documentMode,vendorRegex=/^(Moz|webkit|O|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix.substr(0,1).toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(document.body.style.webkitTransition),animations=isString(document.body.style.webkitAnimation))}return{history:!(!$window.history||!$window.history.pushState||4>android||boxee),hashchange:"onhashchange"in $window&&(!documentMode||documentMode>7),hasEvent:function(event){if("input"==event&&9==msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android,msie:msie,msieDocumentMode:documentMode}}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function($rootScope,$browser,$q,$exceptionHandler){function timeout(fn,delay,invokeApply){var timeoutId,deferred=$q.defer(),promise=deferred.promise,skipApply=isDefined(invokeApply)&&!invokeApply;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn())}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator){if(!isArray(array))return array;var comparatorType=typeof comparator,predicates=[];predicates.check=function(value){for(var j=0;j<predicates.length;j++)if(!predicates[j](value))return!1;return!0},"function"!==comparatorType&&(comparator="boolean"===comparatorType&&comparator?function(obj,text){return angular.equals(obj,text)}:function(obj,text){if(obj&&text&&"object"==typeof obj&&"object"==typeof text){for(var objKey in obj)if("$"!==objKey.charAt(0)&&hasOwnProperty.call(obj,objKey)&&comparator(obj[objKey],text[objKey]))return!0;return!1}return text=(""+text).toLowerCase(),(""+obj).toLowerCase().indexOf(text)>-1});var search=function(obj,text){if("string"==typeof text&&"!"===text.charAt(0))return!search(obj,text.substr(1));switch(typeof obj){case"boolean":case"number":case"string":return comparator(obj,text);case"object":switch(typeof text){case"object":return comparator(obj,text);default:for(var objKey in obj)if("$"!==objKey.charAt(0)&&search(obj[objKey],text))return!0}return!1;case"array":for(var i=0;i<obj.length;i++)if(search(obj[i],text))return!0;return!1;default:return!1}};switch(typeof expression){case"boolean":case"number":case"string":expression={$:expression};case"object":for(var key in expression)!function(path){"undefined"!=typeof expression[path]&&predicates.push(function(value){return search("$"==path?value:value&&value[path],expression[path])})}(key);break;case"function":predicates.push(expression);break;default:return array}for(var filtered=[],j=0;j<array.length;j++){var value=array[j];predicates.check(value)&&filtered.push(value)}return filtered}}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,2).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(null==number||!isFinite(number)||isObject(number))return"";var isNegative=0>number;number=Math.abs(number);var numStr=number+"",formatedText="",parts=[],hasExponent=!1;if(-1!==numStr.indexOf("e")){var match=numStr.match(/([\d\.]+)e(-?)(\d+)/);match&&"-"==match[2]&&match[3]>fractionSize+1?(numStr="0",number=0):(formatedText=numStr,hasExponent=!0)}if(hasExponent)fractionSize>0&&number>-1&&1>number&&(formatedText=number.toFixed(fractionSize));else{var fractionLen=(numStr.split(DECIMAL_SEP)[1]||"").length;isUndefined(fractionSize)&&(fractionSize=Math.min(Math.max(pattern.minFrac,fractionLen),pattern.maxFrac)),number=+(Math.round(+(number.toString()+"e"+fractionSize)).toString()+"e"+-fractionSize),0===number&&(isNegative=!1);var fraction=(""+number).split(DECIMAL_SEP),whole=fraction[0];fraction=fraction[1]||"";var i,pos=0,lgroup=pattern.lgSize,group=pattern.gSize;if(whole.length>=lgroup+group)for(pos=whole.length-lgroup,i=0;pos>i;i++)(pos-i)%group===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(i=pos;i<whole.length;i++)(whole.length-i)%lgroup===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(;fraction.length<fractionSize;)fraction+="0";fractionSize&&"0"!==fractionSize&&(formatedText+=decimalSep+fraction.substr(0,fractionSize))}return parts.push(isNegative?pattern.negPre:pattern.posPre),parts.push(formatedText),parts.push(isNegative?pattern.negSuf:pattern.posSuf),parts.join("")
}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset(),paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),dateSetter.call(date,int(match[1]),int(match[2])-1,int(match[3]));var h=int(match[4]||0)-tzHour,m=int(match[5]||0)-tzMin,s=int(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?int(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);return forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object){return toJson(object,!0)}}function limitToFilter(){return function(input,limit){if(!isArray(input)&&!isString(input))return input;if(limit=1/0===Math.abs(Number(limit))?Number(limit):int(limit),isString(input))return limit?limit>=0?input.slice(0,limit):input.slice(limit,input.length):"";var i,n,out=[];for(limit>input.length?limit=input.length:limit<-input.length&&(limit=-input.length),limit>0?(i=0,n=limit):(i=input.length+limit,n=input.length);n>i;i++)out.push(input[i]);return out}}function orderByFilter($parse){return function(array,sortPredicate,reverseOrder){function comparator(o1,o2){for(var i=0;i<sortPredicate.length;i++){var comp=sortPredicate[i](o1,o2);if(0!==comp)return comp}return 0}function reverseComparator(comp,descending){return toBoolean(descending)?function(a,b){return comp(b,a)}:comp}function compare(v1,v2){var t1=typeof v1,t2=typeof v2;return t1==t2?(isDate(v1)&&isDate(v2)&&(v1=v1.valueOf(),v2=v2.valueOf()),"string"==t1&&(v1=v1.toLowerCase(),v2=v2.toLowerCase()),v1===v2?0:v2>v1?-1:1):t2>t1?-1:1}return isArrayLike(array)?(sortPredicate=isArray(sortPredicate)?sortPredicate:[sortPredicate],0===sortPredicate.length&&(sortPredicate=["+"]),sortPredicate=map(sortPredicate,function(predicate){var descending=!1,get=predicate||identity;if(isString(predicate)){if(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0),predicate=predicate.substring(1)),""===predicate)return reverseComparator(function(a,b){return compare(a,b)},descending);if(get=$parse(predicate),get.constant){var key=get();return reverseComparator(function(a,b){return compare(a[key],b[key])},descending)}}return reverseComparator(function(a,b){return compare(get(a),get(b))},descending)}),slice.call(array).sort(reverseComparator(comparator,reverseOrder))):array}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function FormController(element,attrs,$scope,$animate){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$animate.setClass(element,(isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey,(isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey)}var form=this,parentForm=element.parent().controller("form")||nullFormCtrl,invalidCount=0,errors=form.$error={},controls=[];form.$name=attrs.name||attrs.ngForm,form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,parentForm.$addControl(form),element.addClass(PRISTINE_CLASS),toggleValidCss(!0),form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control)},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(errors,function(queue,validationToken){form.$setValidity(validationToken,!0,control)}),arrayRemove(controls,control)},form.$setValidity=function(validationToken,isValid,control){var queue=errors[validationToken];if(isValid)queue&&(arrayRemove(queue,control),queue.length||(invalidCount--,invalidCount||(toggleValidCss(isValid),form.$valid=!0,form.$invalid=!1),errors[validationToken]=!1,toggleValidCss(!0,validationToken),parentForm.$setValidity(validationToken,!0,form)));else{if(invalidCount||toggleValidCss(isValid),queue){if(includes(queue,control))return}else errors[validationToken]=queue=[],invalidCount++,toggleValidCss(!1,validationToken),parentForm.$setValidity(validationToken,!1,form);queue.push(control),form.$valid=!1,form.$invalid=!0}},form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,parentForm.$setDirty()},form.$setPristine=function(){$animate.removeClass(element,DIRTY_CLASS),$animate.addClass(element,PRISTINE_CLASS),form.$dirty=!1,form.$pristine=!0,forEach(controls,function(control){control.$setPristine()})}}function validate(ctrl,validatorName,validity,value){return ctrl.$setValidity(validatorName,validity),validity?value:undefined}function testFlags(validity,flags){var i,flag;if(flags)for(i=0;i<flags.length;++i)if(flag=flags[i],validity[flag])return!0;return!1}function addNativeHtml5Validators(ctrl,validatorName,badFlags,ignoreFlags,validity){if(isObject(validity)){ctrl.$$hasNativeValidators=!0;var validator=function(value){return ctrl.$error[validatorName]||testFlags(validity,ignoreFlags)||!testFlags(validity,badFlags)?value:void ctrl.$setValidity(validatorName,!1)};ctrl.$parsers.push(validator)}}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){var validity=element.prop(VALIDITY_STATE_PROPERTY),placeholder=element[0].placeholder,noevent={},type=lowercase(element[0].type);if(ctrl.$$validityState=validity,!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var listener=function(ev){if(!composing){var value=element.val();if(msie&&"input"===(ev||noevent).type&&element[0].placeholder!==placeholder)return void(placeholder=element[0].placeholder);"password"!==type&&toBoolean(attr.ngTrim||"T")&&(value=trim(value));var revalidate=validity&&ctrl.$$hasNativeValidators;(ctrl.$viewValue!==value||""===value&&revalidate)&&(scope.$root.$$phase?ctrl.$setViewValue(value):scope.$apply(function(){ctrl.$setViewValue(value)}))}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var timeout,deferListener=function(){timeout||(timeout=$browser.defer(function(){listener(),timeout=null}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener()}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),ctrl.$render=function(){element.val(ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue)};var patternValidator,match,pattern=attr.ngPattern;if(pattern){var validateRegex=function(regexp,value){return validate(ctrl,"pattern",ctrl.$isEmpty(value)||regexp.test(value),value)};match=pattern.match(/^\/(.*)\/([gim]*)$/),match?(pattern=new RegExp(match[1],match[2]),patternValidator=function(value){return validateRegex(pattern,value)}):patternValidator=function(value){var patternObj=scope.$eval(pattern);if(!patternObj||!patternObj.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",pattern,patternObj,startingTag(element));return validateRegex(patternObj,value)},ctrl.$formatters.push(patternValidator),ctrl.$parsers.push(patternValidator)}if(attr.ngMinlength){var minlength=int(attr.ngMinlength),minLengthValidator=function(value){return validate(ctrl,"minlength",ctrl.$isEmpty(value)||value.length>=minlength,value)};ctrl.$parsers.push(minLengthValidator),ctrl.$formatters.push(minLengthValidator)}if(attr.ngMaxlength){var maxlength=int(attr.ngMaxlength),maxLengthValidator=function(value){return validate(ctrl,"maxlength",ctrl.$isEmpty(value)||value.length<=maxlength,value)};ctrl.$parsers.push(maxLengthValidator),ctrl.$formatters.push(maxLengthValidator)}}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(textInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$parsers.push(function(value){var empty=ctrl.$isEmpty(value);return empty||NUMBER_REGEXP.test(value)?(ctrl.$setValidity("number",!0),""===value?null:empty?value:parseFloat(value)):(ctrl.$setValidity("number",!1),undefined)}),addNativeHtml5Validators(ctrl,"number",numberBadFlags,null,ctrl.$$validityState),ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?"":""+value}),attr.min){var minValidator=function(value){var min=parseFloat(attr.min);return validate(ctrl,"min",ctrl.$isEmpty(value)||value>=min,value)};ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}if(attr.max){var maxValidator=function(value){var max=parseFloat(attr.max);return validate(ctrl,"max",ctrl.$isEmpty(value)||max>=value,value)};ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}ctrl.$formatters.push(function(value){return validate(ctrl,"number",ctrl.$isEmpty(value)||isNumber(value),value)})}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var urlValidator=function(value){return validate(ctrl,"url",ctrl.$isEmpty(value)||URL_REGEXP.test(value),value)};ctrl.$formatters.push(urlValidator),ctrl.$parsers.push(urlValidator)}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var emailValidator=function(value){return validate(ctrl,"email",ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value),value)};ctrl.$formatters.push(emailValidator),ctrl.$parsers.push(emailValidator)}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid()),element.on("click",function(){element[0].checked&&scope.$apply(function(){ctrl.$setViewValue(attr.value)})}),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function checkboxInputType(scope,element,attr,ctrl){var trueValue=attr.ngTrueValue,falseValue=attr.ngFalseValue;isString(trueValue)||(trueValue=!0),isString(falseValue)||(falseValue=!1),element.on("click",function(){scope.$apply(function(){ctrl.$setViewValue(element[0].checked)})}),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value!==trueValue},ctrl.$formatters.push(function(value){return value===trueValue}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){if(isArray(classVal))return classVal;if(isString(classVal))return classVal.split(" ");if(isObject(classVal)){var classes=[];return forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes}return classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||{},classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toRemove=digestClassCounts(toRemove,-1),toAdd=digestClassCounts(toAdd,1),0===toAdd.length?$animate.removeClass(element,toRemove):0===toRemove.length?$animate.addClass(element,toAdd):$animate.setClass(element,toAdd,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||scope.$index%2===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}var VALIDITY_STATE_PROPERTY="validity",lowercase=function(string){return isString(string)?string.toLowerCase():string},hasOwnProperty=Object.prototype.hasOwnProperty,uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,nodeName_,slice=[].slice,push=[].push,toString=Object.prototype.toString,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=["0","0","0"];msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]),isNaN(msie)&&(msie=int((/trident\/.*; rv:(\d+)/.exec(lowercase(navigator.userAgent))||[])[1])),noop.$inject=[],identity.$inject=[];var isArray=function(){return isFunction(Array.isArray)?Array.isArray:function(value){return"[object Array]"===toString.call(value)}}(),trim=function(){return String.prototype.trim?function(value){return isString(value)?value.trim():value}:function(value){return isString(value)?value.replace(/^\s\s*/,"").replace(/\s\s*$/,""):value}}();nodeName_=9>msie?function(element){return element=element.nodeName?element:element[0],element.scopeName&&"HTML"!=element.scopeName?uppercase(element.scopeName+":"+element.nodeName):element.nodeName}:function(element){return element.nodeName?element.nodeName:element[0].nodeName};var csp=function(){if(isDefined(csp.isActive_))return csp.isActive_;var active=!(!document.querySelector("[ng-csp]")&&!document.querySelector("[data-ng-csp]"));if(!active)try{new Function("")}catch(e){active=!0}return csp.isActive_=active},SNAKE_CASE_REGEXP=/[A-Z]/g,version={full:"1.2.28",major:1,minor:2,dot:28,codeName:"finnish-disembarkation"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=window.document.addEventListener?function(element,type,fn){element.addEventListener(type,fn,!1)}:function(element,type,fn){element.attachEvent("on"+type,fn)},removeEventListenerFn=window.document.removeEventListener?function(element,type,fn){element.removeEventListener(type,fn,!1)}:function(element,type,fn){element.detachEvent("on"+type,fn)},SPECIAL_CHARS_REGEXP=(JQLite._data=function(node){return this.cache[node[this.expando]]||{}},/([\:\-\_]+(.))/g),MOZ_HACK_REGEXP=/^moz([A-Z])/,jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===document.readyState?setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[uppercase(value)]=!0}),forEach({data:jqLiteData,removeData:jqLiteRemoveData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){if(name=camelCase(name),!isDefined(value)){var val;return 8>=msie&&(val=element.currentStyle&&element.currentStyle[name],""===val&&(val="auto")),val=val||element.style[name],8>=msie&&(val=""===val?undefined:val),val}element.style[name]=value},attr:function(element,name,value){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){var textProp=NODE_TYPE_TEXT_PROPERTY[element.nodeType];return isUndefined(value)?textProp?element[textProp]:"":void(element[textProp]=value)}var NODE_TYPE_TEXT_PROPERTY=[];return 9>msie?(NODE_TYPE_TEXT_PROPERTY[1]="innerText",NODE_TYPE_TEXT_PROPERTY[3]="nodeValue"):NODE_TYPE_TEXT_PROPERTY[1]=NODE_TYPE_TEXT_PROPERTY[3]="textContent",getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if("SELECT"===nodeName_(element)&&element.multiple){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){if(isUndefined(value))return element.innerHTML;for(var i=0,childNodes=element.childNodes;i<childNodes.length;i++)jqLiteDealoc(childNodes[i]);element.innerHTML=value},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)===undefined){if(isObject(arg1)){for(i=0;nodeCount>i;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=value===undefined?Math.min(nodeCount,1):nodeCount,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;nodeCount>i;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,dealoc:jqLiteDealoc,on:function onFn(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");var events=jqLiteExpandoStore(element,"events"),handle=jqLiteExpandoStore(element,"handle");events||jqLiteExpandoStore(element,"events",events={}),handle||jqLiteExpandoStore(element,"handle",handle=createEventHandler(element,events)),forEach(type.split(" "),function(type){var eventFns=events[type];if(!eventFns){if("mouseenter"==type||"mouseleave"==type){var contains=document.body.contains||document.body.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};events[type]=[];var eventmap={mouseleave:"mouseout",mouseenter:"mouseover"};onFn(element,eventmap[type],function(event){var target=this,related=event.relatedTarget;(!related||related!==target&&!contains(target,related))&&handle(event,type)})}else addEventListenerFn(element,type,handle),events[type]=[];eventFns=events[type]}eventFns.push(fn)})},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){1===element.nodeType&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){forEach(new JQLite(node),function(child){(1===element.nodeType||11===element.nodeType)&&element.appendChild(child)})},prepend:function(element,node){if(1===element.nodeType){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){wrapNode=jqLite(wrapNode)[0];var parent=element.parentNode;parent&&parent.replaceChild(wrapNode,element),wrapNode.appendChild(element)},remove:function(element){jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)},after:function(element,newElement){var index=element,parent=element.parentNode;forEach(new JQLite(newElement),function(node){parent.insertBefore(node,index.nextSibling),index=node})},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&11!==parent.nodeType?parent:null},next:function(element){if(element.nextElementSibling)return element.nextElementSibling;for(var elm=element.nextSibling;null!=elm&&1!==elm.nodeType;)elm=elm.nextSibling;return elm},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,eventFns=(jqLiteExpandoStore(element,"events")||{})[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0;i<this.length;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var FN_ARGS=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector"),$animateMinErr=minErr("$animate"),$AnimateProvider=["$provide",function($provide){this.$$selectors={},this.register=function(name,factory){var key=name+"-animation";if(name&&"."!=name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);this.$$selectors[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){return 1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function($timeout,$$asyncCallback){function async(fn){fn&&$$asyncCallback(fn)}return{enter:function(element,parent,after,done){after?after.after(element):(parent&&parent[0]||(parent=after.parent()),parent.append(element)),async(done)},leave:function(element,done){element.remove(),async(done)},move:function(element,parent,after,done){this.enter(element,parent,after,done)},addClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteAddClass(element,className)}),async(done)},removeClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteRemoveClass(element,className)}),async(done)},setClass:function(element,add,remove,done){forEach(element,function(element){jqLiteAddClass(element,add),jqLiteRemoveClass(element,remove)}),async(done)},enabled:noop}}]}],$compileMinErr=minErr("$compile");$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"];var PREFIX_REGEXP=/^(x[\:\-_]|data[\:\-_])/i,$interpolateMinErr=minErr("$interpolate"),PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location");LocationHashbangInHtml5Url.prototype=LocationHashbangUrl.prototype=LocationHtml5Url.prototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return match[1]&&this.path(decodeURIComponent(match[1])),(match[2]||match[1])&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};var promiseWarning,$parseMinErr=minErr("$parse"),promiseWarningCache={},CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,OPERATORS={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:noop,"+":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),isDefined(a)?isDefined(b)?a+b:a:isDefined(b)?b:undefined},"-":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),(isDefined(a)?a:0)-(isDefined(b)?b:0)},"*":function(self,locals,a,b){return a(self,locals)*b(self,locals)},"/":function(self,locals,a,b){return a(self,locals)/b(self,locals)},"%":function(self,locals,a,b){return a(self,locals)%b(self,locals)},"^":function(self,locals,a,b){return a(self,locals)^b(self,locals)},"=":noop,"===":function(self,locals,a,b){return a(self,locals)===b(self,locals)},"!==":function(self,locals,a,b){return a(self,locals)!==b(self,locals)},"==":function(self,locals,a,b){return a(self,locals)==b(self,locals)},"!=":function(self,locals,a,b){return a(self,locals)!=b(self,locals)},"<":function(self,locals,a,b){return a(self,locals)<b(self,locals)},">":function(self,locals,a,b){return a(self,locals)>b(self,locals)},"<=":function(self,locals,a,b){return a(self,locals)<=b(self,locals)},">=":function(self,locals,a,b){return a(self,locals)>=b(self,locals)},"&&":function(self,locals,a,b){return a(self,locals)&&b(self,locals)},"||":function(self,locals,a,b){return a(self,locals)||b(self,locals)},"&":function(self,locals,a,b){return a(self,locals)&b(self,locals)},"|":function(self,locals,a,b){return b(self,locals)(self,locals,a(self,locals))},"!":function(self,locals,a){return!a(self,locals)}},ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.ch=undefined,this.lastCh=":",this.tokens=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var ch2=this.ch+this.peek(),ch3=ch2+this.peek(2),fn=OPERATORS[this.ch],fn2=OPERATORS[ch2],fn3=OPERATORS[ch3];fn3?(this.tokens.push({index:this.index,text:ch3,fn:fn3}),this.index+=3):fn2?(this.tokens.push({index:this.index,text:ch2,fn:fn2}),this.index+=2):fn?(this.tokens.push({index:this.index,text:this.ch,fn:fn}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(chars){return-1!==chars.indexOf(this.ch)},was:function(chars){return-1!==chars.indexOf(this.lastCh)},peek:function(i){var num=i||1;return this.index+num<this.text.length?this.text.charAt(this.index+num):!1},isNumber:function(ch){return ch>="0"&&"9">=ch
},isWhitespace:function(ch){return" "===ch||"\r"===ch||"	"===ch||"\n"===ch||""===ch||""===ch},isIdent:function(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"===ch||"$"===ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}number=1*number,this.tokens.push({index:start,text:number,literal:!0,constant:!0,fn:function(){return number}})},readIdent:function(){for(var lastDot,peekIndex,methodName,ch,parser=this,ident="",start=this.index;this.index<this.text.length&&(ch=this.text.charAt(this.index),"."===ch||this.isIdent(ch)||this.isNumber(ch));)"."===ch&&(lastDot=this.index),ident+=ch,this.index++;if(lastDot)for(peekIndex=this.index;peekIndex<this.text.length;){if(ch=this.text.charAt(peekIndex),"("===ch){methodName=ident.substr(lastDot-start+1),ident=ident.substr(0,lastDot-start),this.index=peekIndex;break}if(!this.isWhitespace(ch))break;peekIndex++}var token={index:start,text:ident};if(OPERATORS.hasOwnProperty(ident))token.fn=OPERATORS[ident],token.literal=!0,token.constant=!0;else{var getter=getterFn(ident,this.options,this.text);token.fn=extend(function(self,locals){return getter(self,locals)},{assign:function(self,value){return setter(self,ident,value,parser.text,parser.options)}})}this.tokens.push(token),methodName&&(this.tokens.push({index:lastDot,text:"."}),this.tokens.push({index:lastDot+1,text:methodName}))},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,string:string,literal:!0,constant:!0,fn:function(){return string}});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options};Parser.ZERO=extend(function(){return 0},{constant:!0}),Parser.prototype={constructor:Parser,parse:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value.literal=!!value.literal,value.constant=!!value.constant,value},primary:function(){var primary;if(this.expect("("))primary=this.filterChain(),this.consume(")");else if(this.expect("["))primary=this.arrayDeclaration();else if(this.expect("{"))primary=this.object();else{var token=this.expect();primary=token.fn,primary||this.throwError("not a primary expression",token),primary.literal=!!token.literal,primary.constant=!!token.constant}for(var next,context;next=this.expect("(","[",".");)"("===next.text?(primary=this.functionCall(primary,context),context=null):"["===next.text?(context=primary,primary=this.objectIndex(primary)):"."===next.text?(context=primary,primary=this.fieldAccess(primary)):this.throwError("IMPOSSIBLE");return primary},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){if(this.tokens.length>0){var token=this.tokens[0],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return token?(this.tokens.shift(),token):!1},consume:function(e1){this.expect(e1)||this.throwError("is unexpected, expecting ["+e1+"]",this.peek())},unaryFn:function(fn,right){return extend(function(self,locals){return fn(self,locals,right)},{constant:right.constant})},ternaryFn:function(left,middle,right){return extend(function(self,locals){return left(self,locals)?middle(self,locals):right(self,locals)},{constant:left.constant&&middle.constant&&right.constant})},binaryFn:function(left,fn,right){return extend(function(self,locals){return fn(self,locals,left,right)},{constant:left.constant&&right.constant})},statements:function(){for(var statements=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&statements.push(this.filterChain()),!this.expect(";"))return 1===statements.length?statements[0]:function(self,locals){for(var value,i=0;i<statements.length;i++){var statement=statements[i];statement&&(value=statement(self,locals))}return value}},filterChain:function(){for(var token,left=this.expression();;){if(!(token=this.expect("|")))return left;left=this.binaryFn(left,token.fn,this.filter())}},filter:function(){for(var token=this.expect(),fn=this.$filter(token.text),argsFn=[];;){if(!(token=this.expect(":"))){var fnInvoke=function(self,locals,input){for(var args=[input],i=0;i<argsFn.length;i++)args.push(argsFn[i](self,locals));return fn.apply(self,args)};return function(){return fnInvoke}}argsFn.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var right,token,left=this.ternary();return(token=this.expect("="))?(left.assign||this.throwError("implies assignment but ["+this.text.substring(0,token.index)+"] can not be assigned to",token),right=this.ternary(),function(scope,locals){return left.assign(scope,right(scope,locals),locals)}):left},ternary:function(){var middle,token,left=this.logicalOR();return(token=this.expect("?"))?(middle=this.assignment(),(token=this.expect(":"))?this.ternaryFn(left,middle,this.assignment()):void this.throwError("expected :",token)):left},logicalOR:function(){for(var token,left=this.logicalAND();;){if(!(token=this.expect("||")))return left;left=this.binaryFn(left,token.fn,this.logicalAND())}},logicalAND:function(){var token,left=this.equality();return(token=this.expect("&&"))&&(left=this.binaryFn(left,token.fn,this.logicalAND())),left},equality:function(){var token,left=this.relational();return(token=this.expect("==","!=","===","!=="))&&(left=this.binaryFn(left,token.fn,this.equality())),left},relational:function(){var token,left=this.additive();return(token=this.expect("<",">","<=",">="))&&(left=this.binaryFn(left,token.fn,this.relational())),left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left=this.binaryFn(left,token.fn,this.multiplicative());return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left=this.binaryFn(left,token.fn,this.unary());return left},unary:function(){var token;return this.expect("+")?this.primary():(token=this.expect("-"))?this.binaryFn(Parser.ZERO,token.fn,this.unary()):(token=this.expect("!"))?this.unaryFn(token.fn,this.unary()):this.primary()},fieldAccess:function(object){var parser=this,field=this.expect().text,getter=getterFn(field,this.options,this.text);return extend(function(scope,locals,self){return getter(self||object(scope,locals))},{assign:function(scope,value,locals){var o=object(scope,locals);return o||object.assign(scope,o={}),setter(o,field,value,parser.text,parser.options)}})},objectIndex:function(obj){var parser=this,indexFn=this.expression();return this.consume("]"),extend(function(self,locals){var v,p,o=obj(self,locals),i=indexFn(self,locals);return ensureSafeMemberName(i,parser.text),o?(v=ensureSafeObject(o[i],parser.text),v&&v.then&&parser.options.unwrapPromises&&(p=v,"$$v"in v||(p.$$v=undefined,p.then(function(val){p.$$v=val})),v=v.$$v),v):undefined},{assign:function(self,value,locals){var key=ensureSafeMemberName(indexFn(self,locals),parser.text),o=ensureSafeObject(obj(self,locals),parser.text);return o||obj.assign(self,o={}),o[key]=value}})},functionCall:function(fn,contextGetter){var argsFn=[];if(")"!==this.peekToken().text)do argsFn.push(this.expression());while(this.expect(","));this.consume(")");var parser=this;return function(scope,locals){for(var args=[],context=contextGetter?contextGetter(scope,locals):scope,i=0;i<argsFn.length;i++)args.push(ensureSafeObject(argsFn[i](scope,locals),parser.text));var fnPtr=fn(scope,locals,context)||noop;ensureSafeObject(context,parser.text),ensureSafeFunction(fnPtr,parser.text);var v=fnPtr.apply?fnPtr.apply(context,args):fnPtr(args[0],args[1],args[2],args[3],args[4]);return ensureSafeObject(v,parser.text)}},arrayDeclaration:function(){var elementFns=[],allConstant=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var elementFn=this.expression();elementFns.push(elementFn),elementFn.constant||(allConstant=!1)}while(this.expect(","));return this.consume("]"),extend(function(self,locals){for(var array=[],i=0;i<elementFns.length;i++)array.push(elementFns[i](self,locals));return array},{literal:!0,constant:allConstant})},object:function(){var keyValues=[],allConstant=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var token=this.expect(),key=token.string||token.text;this.consume(":");var value=this.expression();keyValues.push({key:key,value:value}),value.constant||(allConstant=!1)}while(this.expect(","));return this.consume("}"),extend(function(self,locals){for(var object={},i=0;i<keyValues.length;i++){var keyValue=keyValues[i];object[keyValue.key]=keyValue.value(self,locals)}return object},{literal:!0,constant:allConstant})}};var getterFnCacheDefault={},getterFnCacheExpensive={},$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},urlParsingNode=document.createElement("a"),originUrl=urlResolve(window.location.href,!0);$FilterProvider.$inject=["$provide"],currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DECIMAL_SEP=".",DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return 8>=msie&&(attr.href||attr.name||attr.$set("href",""),element.append(document.createComment("IE fix"))),attr.href||attr.xlinkHref||attr.name?void 0:function(scope,element){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:100,link:function(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),void(msie&&propName&&element.prop(propName,attr[name]))):void("href"===attrName&&attr.$set(name,null))})}}}});var nullFormCtrl={$addControl:noop,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop};FormController.$inject=["$element","$attrs","$scope","$animate"];var formDirectiveFactory=function(isNgForm){return["$timeout",function($timeout){var formDirective={name:"form",restrict:isNgForm?"EAC":"E",controller:FormController,compile:function(){return{pre:function(scope,formElement,attr,controller){if(!attr.action){var preventDefaultListener=function(event){event.preventDefault?event.preventDefault():event.returnValue=!1};addEventListenerFn(formElement[0],"submit",preventDefaultListener),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",preventDefaultListener)},0,!1)})}var parentFormCtrl=formElement.parent().controller("form"),alias=attr.name||attr.ngForm;alias&&setter(scope,alias,controller,alias),parentFormCtrl&&formElement.on("$destroy",function(){parentFormCtrl.$removeControl(controller),alias&&setter(scope,alias,undefined,alias),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),URL_REGEXP=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,inputType={text:textInputType,number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},numberBadFlags=["badInput"],inputDirective=["$browser","$sniffer",function($browser,$sniffer){return{restrict:"E",require:"?ngModel",link:function(scope,element,attr,ctrl){ctrl&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrl,$sniffer,$browser)}}}],VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$animate.removeClass($element,(isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey),$animate.addClass($element,(isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=$attr.name;var ngModelGet=$parse($attr.ngModel),ngModelSet=ngModelGet.assign;if(!ngModelSet)throw minErr("ngModel")("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element));this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value};var parentForm=$element.inheritedData("$formController")||nullFormCtrl,invalidCount=0,$error=this.$error={};$element.addClass(PRISTINE_CLASS),toggleValidCss(!0),this.$setValidity=function(validationErrorKey,isValid){$error[validationErrorKey]!==!isValid&&(isValid?($error[validationErrorKey]&&invalidCount--,invalidCount||(toggleValidCss(!0),this.$valid=!0,this.$invalid=!1)):(toggleValidCss(!1),this.$invalid=!0,this.$valid=!1,invalidCount++),$error[validationErrorKey]=!isValid,toggleValidCss(isValid,validationErrorKey),parentForm.$setValidity(validationErrorKey,isValid,this))},this.$setPristine=function(){this.$dirty=!1,this.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setViewValue=function(value){this.$viewValue=value,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),parentForm.$setDirty()),forEach(this.$parsers,function(fn){value=fn(value)}),this.$modelValue!==value&&(this.$modelValue=value,ngModelSet($scope,value),forEach(this.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}}))};var ctrl=this;$scope.$watch(function(){var value=ngModelGet($scope);if(ctrl.$modelValue!==value){var formatters=ctrl.$formatters,idx=formatters.length;for(ctrl.$modelValue=value;idx--;)value=formatters[idx](value);ctrl.$viewValue!==value&&(ctrl.$viewValue=value,ctrl.$render())}return value})}],ngModelDirective=function(){return{require:["ngModel","^?form"],controller:NgModelController,link:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||nullFormCtrl;formCtrl.$addControl(modelCtrl),scope.$on("$destroy",function(){formCtrl.$removeControl(modelCtrl)})}}},ngChangeDirective=valueFn({require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),requiredDirective=function(){return{require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){attr.required=!0;var validator=function(value){return attr.required&&ctrl.$isEmpty(value)?void ctrl.$setValidity("required",!1):(ctrl.$setValidity("required",!0),value)};ctrl.$formatters.push(validator),ctrl.$parsers.unshift(validator),attr.$observe("required",function(){validator(ctrl.$viewValue)})}}}},ngListDirective=function(){return{require:"ngModel",link:function(scope,element,attr,ctrl){var match=/\/(.*)\//.exec(attr.ngList),separator=match&&new RegExp(match[1])||attr.ngList||",",parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trim(value))}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(", "):undefined}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=ngDirective({compile:function(templateElement){return templateElement.addClass("ng-binding"),function(scope,element,attr){element.data("$binding",attr.ngBind),scope.$watch(attr.ngBind,function(value){element.text(value==undefined?"":value)})}}}),ngBindTemplateDirective=["$interpolate",function($interpolate){return function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));element.addClass("ng-binding").data("$binding",interpolateFn),attr.$observe("ngBindTemplate",function(value){element.text(value)})}}],ngBindHtmlDirective=["$sce","$parse",function($sce,$parse){return{compile:function(tElement){return tElement.addClass("ng-binding"),function(scope,element,attr){function getStringValue(){return(parsed(scope)||"").toString()}element.data("$binding",attr.ngBindHtml);var parsed=$parse(attr.ngBindHtml);scope.$watch(getStringValue,function(){element.html($sce.getTrustedHtml(parsed(scope))||"")})}}}}],ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{compile:function($element,attr){var fn=$parse(attr[directiveName],!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate",function($animate){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){toBoolean(value)?childScope||(childScope=$scope.$new(),$transclude(childScope,function(clone){clone[clone.length++]=document.createComment(" end ngIf: "+$attr.ngIf+" "),block={clone:clone},$animate.enter(clone,$element.parent(),$element)})):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockElements(block.clone),$animate.leave(previousElements,function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$http","$templateCache","$anchorScroll","$animate","$sce",function($http,$templateCache,$anchorScroll,$animate,$sce){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement,function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch($sce.parseAsResourceUrl(srcExp),function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($http.get(src,{cache:$templateCache}).success(function(response){if(thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element,afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded"),scope.$eval(onloadExp)}}).error(function(){thisChangeId===changeCounter&&cleanupLastIncludeContent()}),scope.$emit("$includeContentRequested")):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){$element.html(ctrl.template),$compile($element.contents())(scope)}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngPluralizeDirective=["$locale","$interpolate",function($locale,$interpolate){var BRACE=/{}/g;return{restrict:"EA",link:function(scope,element,attr){var numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),isWhen=/^when(Minus)?(.+)$/;forEach(attr,function(expression,attributeName){isWhen.test(attributeName)&&(whens[lowercase(attributeName.replace("when","").replace("Minus","-"))]=element.attr(attr.$attr[attributeName]))}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,startSymbol+numberExp+"-"+offset+endSymbol))}),scope.$watch(function(){var value=parseFloat(scope.$eval(numberExp));return isNaN(value)?"":(value in whens||(value=$locale.pluralCat(value-offset)),whensExpFns[value](scope,element,!0))},function(newVal){element.text(newVal)})}}}],ngRepeatDirective=["$parse","$animate",function($parse,$animate){function getBlockStart(block){return block.clone[0]}function getBlockEnd(block){return block.clone[block.clone.length-1]}var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var trackByExp,trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,lhs,rhs,valueIdentifier,keyIdentifier,expression=$attr.ngRepeat,match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),hashFnLocals={$id:hashKey};if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);if(lhs=match[1],rhs=match[2],trackByExp=match[3],trackByExp?(trackByExpGetter=$parse(trackByExp),trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)}):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),match=lhs.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);valueIdentifier=match[3]||match[1],keyIdentifier=match[2];var lastBlockMap={};$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,arrayLength,childScope,key,value,trackById,trackByIdFn,collectionKeys,block,elementsToRemove,previousNode=$element[0],nextBlockMap={},nextBlockOrder=[];if(isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(key in collection)collection.hasOwnProperty(key)&&"$"!=key.charAt(0)&&collectionKeys.push(key);collectionKeys.sort()}for(arrayLength=collectionKeys.length,length=nextBlockOrder.length=collectionKeys.length,index=0;length>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),assertNotHasOwnProperty(trackById,"`track by` id"),lastBlockMap.hasOwnProperty(trackById))block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap.hasOwnProperty(trackById))throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,toJson(value));nextBlockOrder[index]={id:trackById},nextBlockMap[trackById]=!1}for(key in lastBlockMap)lastBlockMap.hasOwnProperty(key)&&(block=lastBlockMap[key],elementsToRemove=getBlockElements(block.clone),$animate.leave(elementsToRemove),forEach(elementsToRemove,function(element){element[NG_REMOVED]=!0}),block.scope.$destroy());for(index=0,length=collectionKeys.length;length>index;index++){if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],nextBlockOrder[index-1]&&(previousNode=getBlockEnd(nextBlockOrder[index-1])),block.scope){childScope=block.scope,nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockElements(block.clone),null,jqLite(previousNode)),previousNode=getBlockEnd(block)}else childScope=$scope.$new();childScope[valueIdentifier]=value,keyIdentifier&&(childScope[keyIdentifier]=key),childScope.$index=index,childScope.$first=0===index,childScope.$last=index===arrayLength-1,childScope.$middle=!(childScope.$first||childScope.$last),childScope.$odd=!(childScope.$even=0===(1&index)),block.scope||$transclude(childScope,function(clone){clone[clone.length++]=document.createComment(" end ngRepeat: "+expression+" "),$animate.enter(clone,null,jqLite(previousNode)),previousNode=clone,block.scope=childScope,block.clone=clone,nextBlockMap[block.id]=block})}lastBlockMap=nextBlockMap})}}}],ngShowDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[toBoolean(value)?"removeClass":"addClass"](element,"ng-hide")})}}],ngHideDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[toBoolean(value)?"addClass":"removeClass"](element,"ng-hide")})}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate",function($animate){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousElements=[],selectedScopes=[];scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousElements.length;ii>i;++i)previousElements[i].remove();for(previousElements.length=0,i=0,ii=selectedScopes.length;ii>i;++i){var selected=selectedElements[i];selectedScopes[i].$destroy(),previousElements[i]=selected,$animate.leave(selected,function(){previousElements.splice(i,1)})}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&(scope.$eval(attr.change),forEach(selectedTranscludes,function(selectedTransclude){var selectedScope=scope.$new();selectedScopes.push(selectedScope),selectedTransclude.transclude(selectedScope,function(caseElement){var anchor=selectedTransclude.element;selectedElements.push(caseElement),$animate.enter(caseElement,anchor.parent(),anchor)})}))})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:800,require:"^ngSwitch",link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:800,require:"^ngSwitch",link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeDirective=ngDirective({link:function($scope,$element,$attrs,controller,$transclude){if(!$transclude)throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$transclude(function(clone){$element.empty(),$element.append(clone)})}}),scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],ngOptionsMinErr=minErr("ngOptions"),ngOptionsDirective=valueFn({terminal:!0}),selectDirective=["$compile","$parse",function($compile,$parse){var NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,nullModelCtrl={$setViewValue:noop};
return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function($element,$scope,$attrs){var nullOption,unknownOption,self=this,optionsMap={},ngModelCtrl=nullModelCtrl;self.databound=$attrs.ngModel,self.init=function(ngModelCtrl_,nullOption_,unknownOption_){ngModelCtrl=ngModelCtrl_,nullOption=nullOption_,unknownOption=unknownOption_},self.addOption=function(value){assertNotHasOwnProperty(value,'"option value"'),optionsMap[value]=!0,ngModelCtrl.$viewValue==value&&($element.val(value),unknownOption.parent()&&unknownOption.remove())},self.removeOption=function(value){this.hasOption(value)&&(delete optionsMap[value],ngModelCtrl.$viewValue==value&&this.renderUnknownOption(value))},self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";unknownOption.val(unknownVal),$element.prepend(unknownOption),$element.val(unknownVal),unknownOption.prop("selected",!0)},self.hasOption=function(value){return optionsMap.hasOwnProperty(value)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop})}],link:function(scope,element,attr,ctrls){function setupAsSingle(scope,selectElement,ngModelCtrl,selectCtrl){ngModelCtrl.$render=function(){var viewValue=ngModelCtrl.$viewValue;selectCtrl.hasOption(viewValue)?(unknownOption.parent()&&unknownOption.remove(),selectElement.val(viewValue),""===viewValue&&emptyOption.prop("selected",!0)):isUndefined(viewValue)&&emptyOption?selectElement.val(""):selectCtrl.renderUnknownOption(viewValue)},selectElement.on("change",function(){scope.$apply(function(){unknownOption.parent()&&unknownOption.remove(),ngModelCtrl.$setViewValue(selectElement.val())})})}function setupAsMultiple(scope,selectElement,ctrl){var lastView;ctrl.$render=function(){var items=new HashMap(ctrl.$viewValue);forEach(selectElement.find("option"),function(option){option.selected=isDefined(items.get(option.value))})},scope.$watch(function(){equals(lastView,ctrl.$viewValue)||(lastView=shallowCopy(ctrl.$viewValue),ctrl.$render())}),selectElement.on("change",function(){scope.$apply(function(){var array=[];forEach(selectElement.find("option"),function(option){option.selected&&array.push(option.value)}),ctrl.$setViewValue(array)})})}function setupAsOptions(scope,selectElement,ctrl){function getSelectedSet(){var selectedSet=!1;if(multiple){var modelValue=ctrl.$modelValue;if(trackFn&&isArray(modelValue)){selectedSet=new HashMap([]);for(var locals={},trackIndex=0;trackIndex<modelValue.length;trackIndex++)locals[valueName]=modelValue[trackIndex],selectedSet.put(trackFn(scope,locals),modelValue[trackIndex])}else selectedSet=new HashMap(modelValue)}return selectedSet}function render(){var optionGroupName,optionGroup,option,existingParent,existingOptions,existingOption,key,groupLength,length,groupIndex,index,selected,lastElement,element,label,optionGroups={"":[]},optionGroupNames=[""],modelValue=ctrl.$modelValue,values=valuesFn(scope)||[],keys=keyName?sortedKeys(values):values,locals={},selectedSet=getSelectedSet();for(index=0;length=keys.length,length>index;index++){if(key=index,keyName){if(key=keys[index],"$"===key.charAt(0))continue;locals[keyName]=key}if(locals[valueName]=values[key],optionGroupName=groupByFn(scope,locals)||"",(optionGroup=optionGroups[optionGroupName])||(optionGroup=optionGroups[optionGroupName]=[],optionGroupNames.push(optionGroupName)),multiple)selected=isDefined(selectedSet.remove(trackFn?trackFn(scope,locals):valueFn(scope,locals)));else{if(trackFn){var modelCast={};modelCast[valueName]=modelValue,selected=trackFn(scope,modelCast)===trackFn(scope,locals)}else selected=modelValue===valueFn(scope,locals);selectedSet=selectedSet||selected}label=displayFn(scope,locals),label=isDefined(label)?label:"",optionGroup.push({id:trackFn?trackFn(scope,locals):keyName?keys[index]:index,label:label,selected:selected})}for(multiple||(nullOption||null===modelValue?optionGroups[""].unshift({id:"",label:"",selected:!selectedSet}):selectedSet||optionGroups[""].unshift({id:"?",label:"",selected:!0})),groupIndex=0,groupLength=optionGroupNames.length;groupLength>groupIndex;groupIndex++){for(optionGroupName=optionGroupNames[groupIndex],optionGroup=optionGroups[optionGroupName],optionGroupsCache.length<=groupIndex?(existingParent={element:optGroupTemplate.clone().attr("label",optionGroupName),label:optionGroup.label},existingOptions=[existingParent],optionGroupsCache.push(existingOptions),selectElement.append(existingParent.element)):(existingOptions=optionGroupsCache[groupIndex],existingParent=existingOptions[0],existingParent.label!=optionGroupName&&existingParent.element.attr("label",existingParent.label=optionGroupName)),lastElement=null,index=0,length=optionGroup.length;length>index;index++)option=optionGroup[index],(existingOption=existingOptions[index+1])?(lastElement=existingOption.element,existingOption.label!==option.label&&(lastElement.text(existingOption.label=option.label),lastElement.prop("label",existingOption.label)),existingOption.id!==option.id&&lastElement.val(existingOption.id=option.id),lastElement[0].selected!==option.selected&&(lastElement.prop("selected",existingOption.selected=option.selected),msie&&lastElement.prop("selected",existingOption.selected))):(""===option.id&&nullOption?element=nullOption:(element=optionTemplate.clone()).val(option.id).prop("selected",option.selected).attr("selected",option.selected).prop("label",option.label).text(option.label),existingOptions.push(existingOption={element:element,label:option.label,id:option.id,selected:option.selected}),selectCtrl.addOption(option.label,element),lastElement?lastElement.after(element):existingParent.element.append(element),lastElement=element);for(index++;existingOptions.length>index;)option=existingOptions.pop(),selectCtrl.removeOption(option.label),option.element.remove()}for(;optionGroupsCache.length>groupIndex;)optionGroupsCache.pop()[0].element.remove()}var match;if(!(match=optionsExp.match(NG_OPTIONS_REGEXP)))throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var displayFn=$parse(match[2]||match[1]),valueName=match[4]||match[6],keyName=match[5],groupByFn=$parse(match[3]||""),valueFn=$parse(match[2]?match[1]:valueName),valuesFn=$parse(match[7]),track=match[8],trackFn=track?$parse(match[8]):null,optionGroupsCache=[[{element:selectElement,label:""}]];nullOption&&($compile(nullOption)(scope),nullOption.removeClass("ng-scope"),nullOption.remove()),selectElement.empty(),selectElement.on("change",function(){scope.$apply(function(){var optionGroup,key,value,optionElement,index,groupIndex,length,groupLength,trackIndex,collection=valuesFn(scope)||[],locals={};if(multiple){for(value=[],groupIndex=0,groupLength=optionGroupsCache.length;groupLength>groupIndex;groupIndex++)for(optionGroup=optionGroupsCache[groupIndex],index=1,length=optionGroup.length;length>index;index++)if((optionElement=optionGroup[index].element)[0].selected){if(key=optionElement.val(),keyName&&(locals[keyName]=key),trackFn)for(trackIndex=0;trackIndex<collection.length&&(locals[valueName]=collection[trackIndex],trackFn(scope,locals)!=key);trackIndex++);else locals[valueName]=collection[key];value.push(valueFn(scope,locals))}}else if(key=selectElement.val(),"?"==key)value=undefined;else if(""===key)value=null;else if(trackFn){for(trackIndex=0;trackIndex<collection.length;trackIndex++)if(locals[valueName]=collection[trackIndex],trackFn(scope,locals)==key){value=valueFn(scope,locals);break}}else locals[valueName]=collection[key],keyName&&(locals[keyName]=key),value=valueFn(scope,locals);ctrl.$setViewValue(value),render()})}),ctrl.$render=render,scope.$watchCollection(valuesFn,render),scope.$watchCollection(function(){var locals={},values=valuesFn(scope);if(values){for(var toDisplay=new Array(values.length),i=0,ii=values.length;ii>i;i++)locals[valueName]=values[i],toDisplay[i]=displayFn(scope,locals);return toDisplay}},render),multiple&&scope.$watchCollection(function(){return ctrl.$modelValue},render)}if(ctrls[1]){for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,optionsExp=attr.ngOptions,nullOption=!1,optionTemplate=jqLite(document.createElement("option")),optGroupTemplate=jqLite(document.createElement("optgroup")),unknownOption=optionTemplate.clone(),i=0,children=element.children(),ii=children.length;ii>i;i++)if(""===children[i].value){emptyOption=nullOption=children.eq(i);break}selectCtrl.init(ngModelCtrl,nullOption,unknownOption),multiple&&(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}),optionsExp?setupAsOptions(scope,element,ngModelCtrl):multiple?setupAsMultiple(scope,element,ngModelCtrl):setupAsSingle(scope,element,ngModelCtrl,selectCtrl)}}}}],optionDirective=["$interpolate",function($interpolate){var nullSelectCtrl={addOption:noop,removeOption:noop};return{restrict:"E",priority:100,compile:function(element,attr){if(isUndefined(attr.value)){var interpolateFn=$interpolate(element.text(),!0);interpolateFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.databound?element.prop("selected",!1):selectCtrl=nullSelectCtrl,interpolateFn?scope.$watch(interpolateFn,function(newVal,oldVal){attr.$set("value",newVal),newVal!==oldVal&&selectCtrl.removeOption(oldVal),selectCtrl.addOption(newVal)}):selectCtrl.addOption(attr.value),element.on("$destroy",function(){selectCtrl.removeOption(attr.value)})}}}}],styleDirective=valueFn({restrict:"E",terminal:!0});return window.angular.bootstrap?void console.log("WARNING: Tried to load angular more than once."):(bindJQuery(),publishExternalAPI(angular),void jqLite(document).ready(function(){angularInit(document,bootstrap)}))}(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>'),function(window,angular,undefined){"use strict";function jsonStringToDate(string){var match;if(match=string.match(R_ISO8061_STR)){var date=new Date(0),tzHour=0,tzMin=0;return match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),date.setUTCFullYear(int(match[1]),int(match[2])-1,int(match[3])),date.setUTCHours(int(match[4]||0)-tzHour,int(match[5]||0)-tzMin,int(match[6]||0),int(match[7]||0)),date}return string}function int(str){return parseInt(str,10)}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function createHttpBackendMock($rootScope,$delegate,$browser){function createResponse(status,data,headers,statusText){return angular.isFunction(status)?status:function(){return angular.isNumber(status)?[status,data,headers,statusText]:[200,status,data]}}function $httpBackend(method,url,data,callback,headers,timeout,withCredentials){function prettyPrint(data){return angular.isString(data)||angular.isFunction(data)||data instanceof RegExp?data:angular.toJson(data)}function wrapResponse(wrapped){function handleResponse(){var response=wrapped.response(method,url,data,headers);xhr.$$respHeaders=response[2],callback(copy(response[0]),copy(response[1]),xhr.getAllResponseHeaders(),copy(response[3]||""))}function handleTimeout(){for(var i=0,ii=responses.length;ii>i;i++)if(responses[i]===handleResponse){responses.splice(i,1),callback(-1,undefined,"");break}}return!$browser&&timeout&&timeout.then&&timeout.then(handleTimeout),handleResponse}var xhr=new MockXhr,expectation=expectations[0],wasExpected=!1;if(expectation&&expectation.match(method,url)){if(!expectation.matchData(data))throw new Error("Expected "+expectation+" with different data\nEXPECTED: "+prettyPrint(expectation.data)+"\nGOT:      "+data);if(!expectation.matchHeaders(headers))throw new Error("Expected "+expectation+" with different headers\nEXPECTED: "+prettyPrint(expectation.headers)+"\nGOT:      "+prettyPrint(headers));if(expectations.shift(),expectation.response)return void responses.push(wrapResponse(expectation));wasExpected=!0}for(var definition,i=-1;definition=definitions[++i];)if(definition.match(method,url,data,headers||{})){if(definition.response)($browser?$browser.defer:responsesPush)(wrapResponse(definition));else{if(!definition.passThrough)throw new Error("No response defined !");$delegate(method,url,data,callback,headers,timeout,withCredentials)}return}throw new Error(wasExpected?"No response defined !":"Unexpected request: "+method+" "+url+"\n"+(expectation?"Expected "+expectation:"No more request expected"))}function createShortMethods(prefix){angular.forEach(["GET","DELETE","JSONP","HEAD"],function(method){$httpBackend[prefix+method]=function(url,headers){return $httpBackend[prefix](method,url,undefined,headers)}}),angular.forEach(["PUT","POST","PATCH"],function(method){$httpBackend[prefix+method]=function(url,data,headers){return $httpBackend[prefix](method,url,data,headers)}})}var definitions=[],expectations=[],responses=[],responsesPush=angular.bind(responses,responses.push),copy=angular.copy;return $httpBackend.when=function(method,url,data,headers){var definition=new MockHttpExpectation(method,url,data,headers),chain={respond:function(status,data,headers,statusText){definition.response=createResponse(status,data,headers,statusText)}};return $browser&&(chain.passThrough=function(){definition.passThrough=!0}),definitions.push(definition),chain},createShortMethods("when"),$httpBackend.expect=function(method,url,data,headers){var expectation=new MockHttpExpectation(method,url,data,headers);return expectations.push(expectation),{respond:function(status,data,headers,statusText){expectation.response=createResponse(status,data,headers,statusText)}}},createShortMethods("expect"),$httpBackend.flush=function(count){if($rootScope.$digest(),!responses.length)throw new Error("No pending request to flush !");if(angular.isDefined(count))for(;count--;){if(!responses.length)throw new Error("No more pending request to flush !");responses.shift()()}else for(;responses.length;)responses.shift()();$httpBackend.verifyNoOutstandingExpectation()},$httpBackend.verifyNoOutstandingExpectation=function(){if($rootScope.$digest(),expectations.length)throw new Error("Unsatisfied requests: "+expectations.join(", "))},$httpBackend.verifyNoOutstandingRequest=function(){if(responses.length)throw new Error("Unflushed requests: "+responses.length)},$httpBackend.resetExpectations=function(){expectations.length=0,responses.length=0},$httpBackend}function MockHttpExpectation(method,url,data,headers){this.data=data,this.headers=headers,this.match=function(m,u,d,h){return method!=m?!1:this.matchUrl(u)?angular.isDefined(d)&&!this.matchData(d)?!1:angular.isDefined(h)&&!this.matchHeaders(h)?!1:!0:!1},this.matchUrl=function(u){return url?angular.isFunction(url.test)?url.test(u):url==u:!0},this.matchHeaders=function(h){return angular.isUndefined(headers)?!0:angular.isFunction(headers)?headers(h):angular.equals(headers,h)},this.matchData=function(d){return angular.isUndefined(data)?!0:data&&angular.isFunction(data.test)?data.test(d):data&&angular.isFunction(data)?data(d):data&&!angular.isString(data)?angular.equals(angular.fromJson(angular.toJson(data)),angular.fromJson(d)):data==d},this.toString=function(){return method+" "+url}}function MockXhr(){MockXhr.$$lastInstance=this,this.open=function(method,url,async){this.$$method=method,this.$$url=url,this.$$async=async,this.$$reqHeaders={},this.$$respHeaders={}},this.send=function(data){this.$$data=data},this.setRequestHeader=function(key,value){this.$$reqHeaders[key]=value},this.getResponseHeader=function(name){var header=this.$$respHeaders[name];return header?header:(name=angular.lowercase(name),(header=this.$$respHeaders[name])?header:(header=undefined,angular.forEach(this.$$respHeaders,function(headerVal,headerName){header||angular.lowercase(headerName)!=name||(header=headerVal)}),header))},this.getAllResponseHeaders=function(){var lines=[];return angular.forEach(this.$$respHeaders,function(value,key){lines.push(key+": "+value)}),lines.join("\n")},this.abort=angular.noop}angular.mock={},angular.mock.$BrowserProvider=function(){this.$get=function(){return new angular.mock.$Browser}},angular.mock.$Browser=function(){var self=this;this.isMock=!0,self.$$url="http://server/",self.$$lastUrl=self.$$url,self.pollFns=[],self.$$completeOutstandingRequest=angular.noop,self.$$incOutstandingRequestCount=angular.noop,self.onUrlChange=function(listener){return self.pollFns.push(function(){self.$$lastUrl!=self.$$url&&(self.$$lastUrl=self.$$url,listener(self.$$url))}),listener},self.$$checkUrlChange=angular.noop,self.cookieHash={},self.lastCookieHash={},self.deferredFns=[],self.deferredNextId=0,self.defer=function(fn,delay){return delay=delay||0,self.deferredFns.push({time:self.defer.now+delay,fn:fn,id:self.deferredNextId}),self.deferredFns.sort(function(a,b){return a.time-b.time}),self.deferredNextId++},self.defer.now=0,self.defer.cancel=function(deferId){var fnIndex;return angular.forEach(self.deferredFns,function(fn,index){fn.id===deferId&&(fnIndex=index)}),fnIndex!==undefined?(self.deferredFns.splice(fnIndex,1),!0):!1},self.defer.flush=function(delay){if(angular.isDefined(delay))self.defer.now+=delay;else{if(!self.deferredFns.length)throw new Error("No deferred tasks to be flushed");self.defer.now=self.deferredFns[self.deferredFns.length-1].time}for(;self.deferredFns.length&&self.deferredFns[0].time<=self.defer.now;)self.deferredFns.shift().fn()},self.$$baseHref="",self.baseHref=function(){return this.$$baseHref}},angular.mock.$Browser.prototype={poll:function(){angular.forEach(this.pollFns,function(pollFn){pollFn()})},addPollFn:function(pollFn){return this.pollFns.push(pollFn),pollFn},url:function(url){return url?(this.$$url=url,this):this.$$url},cookies:function(name,value){return name?void(angular.isUndefined(value)?delete this.cookieHash[name]:angular.isString(value)&&value.length<=4096&&(this.cookieHash[name]=value)):(angular.equals(this.cookieHash,this.lastCookieHash)||(this.lastCookieHash=angular.copy(this.cookieHash),this.cookieHash=angular.copy(this.cookieHash)),this.cookieHash)},notifyWhenNoOutstandingRequests:function(fn){fn()}},angular.mock.$ExceptionHandlerProvider=function(){var handler;this.mode=function(mode){switch(mode){case"rethrow":handler=function(e){throw e};break;case"log":var errors=[];handler=function(e){errors.push(1==arguments.length?e:[].slice.call(arguments,0))},handler.errors=errors;break;default:throw new Error("Unknown mode '"+mode+"', only 'log'/'rethrow' modes are allowed!")}},this.$get=function(){return handler},this.mode("rethrow")},angular.mock.$LogProvider=function(){function concat(array1,array2,index){return array1.concat(Array.prototype.slice.call(array2,index))}var debug=!0;this.debugEnabled=function(flag){return angular.isDefined(flag)?(debug=flag,this):debug},this.$get=function(){var $log={log:function(){$log.log.logs.push(concat([],arguments,0))},warn:function(){$log.warn.logs.push(concat([],arguments,0))},info:function(){$log.info.logs.push(concat([],arguments,0))},error:function(){$log.error.logs.push(concat([],arguments,0))},debug:function(){debug&&$log.debug.logs.push(concat([],arguments,0))}};return $log.reset=function(){$log.log.logs=[],$log.info.logs=[],$log.warn.logs=[],$log.error.logs=[],$log.debug.logs=[]},$log.assertEmpty=function(){var errors=[];if(angular.forEach(["error","warn","info","log","debug"],function(logLevel){angular.forEach($log[logLevel].logs,function(log){angular.forEach(log,function(logItem){errors.push("MOCK $log ("+logLevel+"): "+String(logItem)+"\n"+(logItem.stack||""))})})}),errors.length)throw errors.unshift("Expected $log to be empty! Either a message was logged unexpectedly, or an expected log message was not checked and removed:"),errors.push(""),new Error(errors.join("\n---------\n"))},$log.reset(),$log}},angular.mock.$IntervalProvider=function(){this.$get=["$rootScope","$q",function($rootScope,$q){var repeatFns=[],nextRepeatId=0,now=0,$interval=function(fn,delay,count,invokeApply){function tick(){if(deferred.notify(iteration++),count>0&&iteration>=count){var fnIndex;deferred.resolve(iteration),angular.forEach(repeatFns,function(fn,index){fn.id===promise.$$intervalId&&(fnIndex=index)}),fnIndex!==undefined&&repeatFns.splice(fnIndex,1)}skipApply||$rootScope.$apply()}var deferred=$q.defer(),promise=deferred.promise,iteration=0,skipApply=angular.isDefined(invokeApply)&&!invokeApply;return count=angular.isDefined(count)?count:0,promise.then(null,null,fn),promise.$$intervalId=nextRepeatId,repeatFns.push({nextTime:now+delay,delay:delay,fn:tick,id:nextRepeatId,deferred:deferred}),repeatFns.sort(function(a,b){return a.nextTime-b.nextTime}),nextRepeatId++,promise};return $interval.cancel=function(promise){if(!promise)return!1;var fnIndex;return angular.forEach(repeatFns,function(fn,index){fn.id===promise.$$intervalId&&(fnIndex=index)}),fnIndex!==undefined?(repeatFns[fnIndex].deferred.reject("canceled"),repeatFns.splice(fnIndex,1),!0):!1},$interval.flush=function(millis){for(now+=millis;repeatFns.length&&repeatFns[0].nextTime<=now;){var task=repeatFns[0];task.fn(),task.nextTime+=task.delay,repeatFns.sort(function(a,b){return a.nextTime-b.nextTime})}return millis},$interval}]};var R_ISO8061_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?:\:?(\d\d)(?:\:?(\d\d)(?:\.(\d{3}))?)?)?(Z|([+-])(\d\d):?(\d\d)))?$/;if(angular.mock.TzDate=function(offset,timestamp){var self=new Date(0);if(angular.isString(timestamp)){var tsStr=timestamp;if(self.origDate=jsonStringToDate(timestamp),timestamp=self.origDate.getTime(),isNaN(timestamp))throw{name:"Illegal Argument",message:"Arg '"+tsStr+"' passed into TzDate constructor is not a valid date string"}}else self.origDate=new Date(timestamp);var localOffset=new Date(timestamp).getTimezoneOffset();self.offsetDiff=60*localOffset*1e3-1e3*offset*60*60,self.date=new Date(timestamp+self.offsetDiff),self.getTime=function(){return self.date.getTime()-self.offsetDiff},self.toLocaleDateString=function(){return self.date.toLocaleDateString()},self.getFullYear=function(){return self.date.getFullYear()},self.getMonth=function(){return self.date.getMonth()},self.getDate=function(){return self.date.getDate()},self.getHours=function(){return self.date.getHours()},self.getMinutes=function(){return self.date.getMinutes()},self.getSeconds=function(){return self.date.getSeconds()},self.getMilliseconds=function(){return self.date.getMilliseconds()},self.getTimezoneOffset=function(){return 60*offset},self.getUTCFullYear=function(){return self.origDate.getUTCFullYear()},self.getUTCMonth=function(){return self.origDate.getUTCMonth()},self.getUTCDate=function(){return self.origDate.getUTCDate()},self.getUTCHours=function(){return self.origDate.getUTCHours()},self.getUTCMinutes=function(){return self.origDate.getUTCMinutes()},self.getUTCSeconds=function(){return self.origDate.getUTCSeconds()},self.getUTCMilliseconds=function(){return self.origDate.getUTCMilliseconds()},self.getDay=function(){return self.date.getDay()},self.toISOString&&(self.toISOString=function(){return padNumber(self.origDate.getUTCFullYear(),4)+"-"+padNumber(self.origDate.getUTCMonth()+1,2)+"-"+padNumber(self.origDate.getUTCDate(),2)+"T"+padNumber(self.origDate.getUTCHours(),2)+":"+padNumber(self.origDate.getUTCMinutes(),2)+":"+padNumber(self.origDate.getUTCSeconds(),2)+"."+padNumber(self.origDate.getUTCMilliseconds(),3)+"Z"});var unimplementedMethods=["getUTCDay","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toGMTString","toJSON","toLocaleFormat","toLocaleString","toLocaleTimeString","toSource","toString","toTimeString","toUTCString","valueOf"];return angular.forEach(unimplementedMethods,function(methodName){self[methodName]=function(){throw new Error("Method '"+methodName+"' is not implemented in the TzDate mock")}}),self},angular.mock.TzDate.prototype=Date.prototype,angular.mock.animate=angular.module("ngAnimateMock",["ng"]).config(["$provide",function($provide){var reflowQueue=[];$provide.value("$$animateReflow",function(fn){var index=reflowQueue.length;return reflowQueue.push(fn),function(){reflowQueue.splice(index,1)}}),$provide.decorator("$animate",function($delegate,$$asyncCallback){var animate={queue:[],enabled:$delegate.enabled,triggerCallbacks:function(){$$asyncCallback.flush()},triggerReflow:function(){angular.forEach(reflowQueue,function(fn){fn()}),reflowQueue=[]}};return angular.forEach(["enter","leave","move","addClass","removeClass","setClass"],function(method){animate[method]=function(){animate.queue.push({event:method,element:arguments[0],args:arguments}),$delegate[method].apply($delegate,arguments)}}),animate})}]),angular.mock.dump=function(object){function serialize(object){var out;return angular.isElement(object)?(object=angular.element(object),out=angular.element("<div></div>"),angular.forEach(object,function(element){out.append(angular.element(element).clone())}),out=out.html()):angular.isArray(object)?(out=[],angular.forEach(object,function(o){out.push(serialize(o))}),out="[ "+out.join(", ")+" ]"):out=angular.isObject(object)?angular.isFunction(object.$eval)&&angular.isFunction(object.$apply)?serializeScope(object):object instanceof Error?object.stack||""+object.name+": "+object.message:angular.toJson(object,!0):String(object),out}function serializeScope(scope,offset){offset=offset||"  ";var log=[offset+"Scope("+scope.$id+"): {"];for(var key in scope)Object.prototype.hasOwnProperty.call(scope,key)&&!key.match(/^(\$|this)/)&&log.push("  "+key+": "+angular.toJson(scope[key]));for(var child=scope.$$childHead;child;)log.push(serializeScope(child,offset+"  ")),child=child.$$nextSibling;return log.push("}"),log.join("\n"+offset)}return serialize(object)},angular.mock.$HttpBackendProvider=function(){this.$get=["$rootScope",createHttpBackendMock]},angular.mock.$TimeoutDecorator=function($delegate,$browser){function formatPendingTasksAsString(tasks){var result=[];return angular.forEach(tasks,function(task){result.push("{id: "+task.id+", time: "+task.time+"}")}),result.join(", ")}return $delegate.flush=function(delay){$browser.defer.flush(delay)},$delegate.verifyNoPendingTasks=function(){if($browser.deferredFns.length)throw new Error("Deferred tasks to flush ("+$browser.deferredFns.length+"): "+formatPendingTasksAsString($browser.deferredFns))},$delegate},angular.mock.$RAFDecorator=function($delegate){var queue=[],rafFn=function(fn){var index=queue.length;return queue.push(fn),function(){queue.splice(index,1)}};return rafFn.supported=$delegate.supported,rafFn.flush=function(){if(0===queue.length)throw new Error("No rAF callbacks present");for(var length=queue.length,i=0;length>i;i++)queue[i]();queue=[]},rafFn},angular.mock.$AsyncCallbackDecorator=function(){var callbacks=[],addFn=function(fn){callbacks.push(fn)};return addFn.flush=function(){angular.forEach(callbacks,function(fn){fn()}),callbacks=[]},addFn},angular.mock.$RootElementProvider=function(){this.$get=function(){return angular.element("<div ng-app></div>")}},angular.module("ngMock",["ng"]).provider({$browser:angular.mock.$BrowserProvider,$exceptionHandler:angular.mock.$ExceptionHandlerProvider,$log:angular.mock.$LogProvider,$interval:angular.mock.$IntervalProvider,$httpBackend:angular.mock.$HttpBackendProvider,$rootElement:angular.mock.$RootElementProvider}).config(["$provide",function($provide){$provide.decorator("$timeout",angular.mock.$TimeoutDecorator),$provide.decorator("$$rAF",angular.mock.$RAFDecorator),$provide.decorator("$$asyncCallback",angular.mock.$AsyncCallbackDecorator)}]),angular.module("ngMockE2E",["ng"]).config(["$provide",function($provide){$provide.decorator("$httpBackend",angular.mock.e2e.$httpBackendDecorator)}]),angular.mock.e2e={},angular.mock.e2e.$httpBackendDecorator=["$rootScope","$delegate","$browser",createHttpBackendMock],angular.mock.clearDataCache=function(){var key,cache=angular.element.cache;for(key in cache)if(Object.prototype.hasOwnProperty.call(cache,key)){var handle=cache[key].handle;handle&&angular.element(handle.elem).off(),delete cache[key]}},window.jasmine||window.mocha){var currentSpec=null,isSpecRunning=function(){return!!currentSpec};(window.beforeEach||window.setup)(function(){currentSpec=this}),(window.afterEach||window.teardown)(function(){var injector=currentSpec.$injector;angular.forEach(currentSpec.$modules,function(module){module&&module.$$hashKey&&(module.$$hashKey=undefined)}),currentSpec.$injector=null,currentSpec.$modules=null,currentSpec=null,injector&&(injector.get("$rootElement").off(),injector.get("$browser").pollFns.length=0),angular.mock.clearDataCache(),angular.forEach(angular.element.fragments,function(val,key){delete angular.element.fragments[key]}),MockXhr.$$lastInstance=null,angular.forEach(angular.callbacks,function(val,key){delete angular.callbacks[key]}),angular.callbacks.counter=0}),window.module=angular.mock.module=function(){function workFn(){if(currentSpec.$injector)throw new Error("Injector already created, can not register a module!");var modules=currentSpec.$modules||(currentSpec.$modules=[]);angular.forEach(moduleFns,function(module){modules.push(angular.isObject(module)&&!angular.isArray(module)?function($provide){angular.forEach(module,function(value,key){$provide.value(key,value)})}:module)})}var moduleFns=Array.prototype.slice.call(arguments,0);return isSpecRunning()?workFn():workFn};var ErrorAddingDeclarationLocationStack=function(e,errorForStack){this.message=e.message,this.name=e.name,e.line&&(this.line=e.line),e.sourceId&&(this.sourceId=e.sourceId),e.stack&&errorForStack&&(this.stack=e.stack+"\n"+errorForStack.stack),e.stackArray&&(this.stackArray=e.stackArray)};ErrorAddingDeclarationLocationStack.prototype.toString=Error.prototype.toString,window.inject=angular.mock.inject=function(){function workFn(){var modules=currentSpec.$modules||[];modules.unshift("ngMock"),modules.unshift("ng");var injector=currentSpec.$injector;injector||(injector=currentSpec.$injector=angular.injector(modules));for(var i=0,ii=blockFns.length;ii>i;i++)try{injector.invoke(blockFns[i]||angular.noop,this)}catch(e){if(e.stack&&errorForStack)throw new ErrorAddingDeclarationLocationStack(e,errorForStack);throw e}finally{errorForStack=null}}var blockFns=Array.prototype.slice.call(arguments,0),errorForStack=new Error("Declaration Location");return isSpecRunning()?workFn.call(currentSpec):workFn}}}(window,window.angular);var TrNgGrid;if(function(n){function ot(t){t.get(n.cellHeaderTemplateId)||t.put(n.cellHeaderTemplateId,'<div class="'+n.headerCellCssClass+'" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>    <div class="'+n.columnTitleCssClass+'">      {{columnTitle |'+n.translateFilter+":gridOptions.locale}}       <div "+n.columnSortDirectiveAttribute+'=""></div>    </div>    <div '+n.columnFilterDirectiveAttribute+'=""></div>  </div></div>'),t.get(n.cellBodyTemplateId)||t.put(n.cellBodyTemplateId,'<div ng-attr-class="'+n.bodyCellCssClass+' text-{{columnOptions.displayAlign}}" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>{{gridDisplayItem[columnOptions.displayFieldName]}}</div></div>'),t.get(n.columnFilterTemplateId)||t.put(n.columnFilterTemplateId,'<div ng-show="(gridOptions.enableFiltering&&columnOptions.enableFiltering!==false)||columnOptions.enableFiltering" class="'+n.columnFilterCssClass+'"> <div class="'+n.columnFilterInputWrapperCssClass+'">   <input class="form-control input-sm" type="text" ng-model="columnOptions.filter" ng-keypress="speedUpAsyncDataRetrieval($event)"></input> </div></div>'),t.get(n.columnSortTemplateId)||t.put(n.columnSortTemplateId,"<div ng-attr-title=\"{{'Sort'|"+n.translateFilter+':gridOptions.locale}}" ng-show="(gridOptions.enableSorting&&columnOptions.enableSorting!==false)||columnOptions.enableSorting" ng-click="toggleSorting(columnOptions.fieldName)" class="'+n.columnSortCssClass+'" >   <div ng-class="{\''+n.columnSortActiveCssClass+"':gridOptions.orderBy==columnOptions.fieldName,'"+n.columnSortInactiveCssClass+"':gridOptions.orderBy!=columnOptions.fieldName,'"+n.columnSortNormalOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&!gridOptions.orderByReverse,'"+n.columnSortReverseOrderCssClass+"':gridOptions.orderBy==columnOptions.fieldName&&gridOptions.orderByReverse}\" >  </div></div>"),t.put(n.cellFooterTemplateId)||t.put(n.cellFooterTemplateId,'<div class="'+n.footerCssClass+'" ng-switch="isCustomized">  <div ng-switch-when="true">    <div ng-transclude=""></div>  </div>  <div ng-switch-default>    <span '+n.globalFilterDirectiveAttribute+'=""></span>    <span '+n.pagerDirectiveAttribute+'=""></span>  </div></div>'),t.get(n.footerGlobalFilterTemplateId)||t.put(n.footerGlobalFilterTemplateId,'<span ng-show="gridOptions.enableFiltering" class="pull-left form-group">  <input class="form-control" type="text" ng-model="gridOptions.filterBy" ng-keypress="speedUpAsyncDataRetrieval($event)" ng-attr-placeholder="{{\'Search\'|'+n.translateFilter+':gridOptions.locale}}"></input></span>'),t.get(n.footerPagerTemplateId)||t.put(n.footerPagerTemplateId,'<span class="pull-right form-group"> <ul class="pagination">   <li ng-class="{disabled:!pageCanGoBack}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoBack&&navigateToPage(0)" ng-attr-title="{{\'First Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&laquo;</span>     </a>   </li>   <li ng-class="{disabled:!pageCanGoBack}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoBack&&navigateToPage(gridOptions.currentPage - 1)" ng-attr-title="{{\'Previous Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&lsaquo;</span>     </a>   </li>   <li ng-if="pageSelectionActive" ng-repeat="pageIndex in pageIndexes track by $index" ng-class="{disabled:pageIndex===null, active:pageIndex===gridOptions.currentPage}">      <span ng-if="pageIndex===null">...</span>      <a href="" ng-click="navigateToPage(pageIndex)" ng-if="pageIndex!==null" ng-attr-title="{{\'Page\'|'+n.translateFilter+':gridOptions.locale}}">{{pageIndex+1}}</a>   </li>   <li ng-class="{disabled:!pageCanGoForward}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoForward&&navigateToPage(gridOptions.currentPage + 1)" ng-attr-title="{{\'Next Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&rsaquo;</span>     </a>   </li>   <li ng-class="{disabled:!pageCanGoForward}" ng-if="extendedControlsActive">     <a href="" ng-click="pageCanGoForward&&navigateToPage(lastPageIndex)" ng-attr-title="{{\'Last Page\'|'+n.translateFilter+':gridOptions.locale}}">         <span>&raquo;</span>     </a>   </li>   <li class="disabled" style="white-space: nowrap;">     <span ng-hide="totalItemsCount">{{\'No items to display\'|'+n.translateFilter+":gridOptions.locale}}</span>     <span ng-show=\"totalItemsCount\">       {{startItemIndex+1}} - {{endItemIndex+1}} {{'displayed'|"+n.translateFilter+":gridOptions.locale}}       <span>, {{totalItemsCount}} {{'in total'|"+n.translateFilter+":gridOptions.locale}}</span>     </span >    </li> </ul></span>")
}var i,u,t,f,e,o,s;!function(n){n[n.None=0]="None",n[n.SingleRow=1]="SingleRow",n[n.MultiRow=2]="MultiRow",n[n.MultiRowWithKeyModifiers=3]="MultiRowWithKeyModifiers"}(n.SelectionMode||(n.SelectionMode={})),i=n.SelectionMode,n.defaultColumnOptions={cellWidth:null,cellHeight:null,displayAlign:null,displayFormat:null,displayName:null,filter:null,enableFiltering:null,enableSorting:null},n.translations={},n.debugMode=!1,u=!1,t="trNgGrid",n.sortFilter=t+"SortFilter",n.dataPagingFilter=t+"DataPagingFilter",n.translateFilter=t+"TranslateFilter",n.translationDateFormat=t+"DateFormat",n.dataFormattingFilter=t+"DataFormatFilter";var l="tr-ng-grid-body",a="field-name",d="is-customized",g="tr-ng-grid-footer-cell",v="trNgGridFooterCellTemplate",nt="tr-ng-grid-footer-cell-template";n.cellFooterTemplateId=v+".html",f="trNgGridGlobalFilter",n.globalFilterDirectiveAttribute="tr-ng-grid-global-filter",n.footerGlobalFilterTemplateId=f+".html",e="trNgGridPager",n.pagerDirectiveAttribute="tr-ng-grid-pager",n.footerPagerTemplateId=e+".html";var y="trNgGridHeaderCell",tt="tr-ng-grid-header-cell",p="trNgGridHeaderCellTemplate",it="tr-ng-grid-header-cell-template";n.cellHeaderTemplateId=p+".html";var w="trNgGridBodyCell",rt="tr-ng-grid-body-cell",b="trNgGridBodyCellTemplate",ut="tr-ng-grid-body-cell-template";n.cellBodyTemplateId=b+".html",o="trNgGridColumnSort",n.columnSortDirectiveAttribute="tr-ng-grid-column-sort",n.columnSortTemplateId=o+".html",s="trNgGridColumnFilter",n.columnFilterDirectiveAttribute="tr-ng-grid-column-filter",n.columnFilterTemplateId=s+".html";var k=function(n,t){var r,i,u;for(t=t.toUpperCase(),r=n.children(),i=0;i<r.length;i++)if(u=r[i],u.tagName==t)return angular.element(u);return null},r=function(n,t,i,r){var u=[],f=t.slice(0);return angular.forEach(n,function(n){for(var t=null,i=0;!t&&i<f.length;i++)t=f[i],t.fieldName===n.fieldName?f.splice(i,1):t=null;u.push(t?t:n)}),(i||r)&&angular.forEach(f,function(n){(i&&n.fieldName||r&&!n.fieldName)&&u.push(n)}),u},h=function(n,t,i,r){var u,e,f;i?(u=n.children(),e=angular.element(u[0]),1===u.length&&e.attr(r)||(n.empty(),f=angular.element("<div></div>").attr(r,""),n.append(f),angular.forEach(u,function(n){f.append(angular.element(n))}))):(n.empty(),n.append(angular.element("<div></div>").attr(r,"")))},ft=function(){function n(n,t){this.parent=n,this.cellElement=t,this.fieldName=t.attr(a);var i=t.children();this.isStandardColumn=0===i.length}return n}(),c=function(){function n(n,t,i,r,u){this.sectionTagName=n,this.sectionDirectiveAttribute=t,this.rowDirectiveAttribute=i,this.cellTagName=r,this.cellDirectiveAttribute=u,this.cellTagName=this.cellTagName.toUpperCase(),this.cells=null}return n.prototype.configureSection=function(n,t){var f,e,i=this,u=this.getSectionElement(n,!0);return u.empty(),u.removeAttr("ng-non-bindable"),f=r(t,this.cells,!1,!1),e=this.getTemplatedRowElement(u,!0),angular.forEach(f,function(n,t){var r,u=n;r=u.parent===i&&u.cellElement?u.cellElement.clone(!0):angular.element("<table><"+i.cellTagName+"></"+i.cellTagName+"></table>").find(i.cellTagName),i.cellDirectiveAttribute&&r.attr(i.cellDirectiveAttribute,t),n.isStandardColumn||r.attr(d,"true"),n.fieldName&&r.attr(a,n.fieldName),r.attr("ng-style","{'width':columnOptions.cellWidth,'height':columnOptions.cellHeight}"),e.append(r)}),u},n.prototype.extractPartialColumnDefinitions=function(){return this.cells},n.prototype.discoverCells=function(n){var i,t=this;this.cells=[],i=this.getTemplatedRowElement(this.getSectionElement(n,!1),!1),i&&angular.forEach(i.children(),function(n){if(n=angular.element(n),n[0].tagName===t.cellTagName.toUpperCase()){var i=n.clone(!0);t.cells.push(new ft(t,i))}})},n.prototype.getSectionElement=function(n,t){var i=null;return n&&(i=k(n,this.sectionTagName)),!i&&t&&(i=angular.element("<table><"+this.sectionTagName+"></"+this.sectionTagName+"></table>").find(this.sectionTagName),n&&n.append(i)),t&&this.sectionDirectiveAttribute&&i.attr(this.sectionDirectiveAttribute,""),i},n.prototype.getTemplatedRowElement=function(n,t){var i=null;return n&&(i=k(n,"tr")),!i&&t&&(i=angular.element("<table><tr></tr></table>").find("tr"),n&&n.append(i)),t&&this.rowDirectiveAttribute&&i.attr(this.rowDirectiveAttribute,""),i},n}(),et=function(){function f(n,t,i,r){this.$compile=n,this.$parse=t,this.$timeout=i,u||(ot(r),u=!0)}return f.prototype.setupScope=function(t,r,u){var o,s,f=this,e=angular.element(r).scope().$new();return this.gridOptions={immediateDataRetrieval:!0,items:[],fields:null,locale:"en",selectedItems:[],filterBy:null,filterByFields:{},orderBy:null,orderByReverse:!1,pageItems:null,currentPage:0,totalItems:null,enableFiltering:!0,enableSorting:!0,selectionMode:i[2],onDataRequiredDelay:1e3,onDataRequired:u.onDataRequired?t.onDataRequired:null,gridColumnDefs:[]},e.gridOptions=this.gridOptions,e.TrNgGrid=n,this.linkScope(e,t,"gridOptions",u),this.gridOptions.onDataRequired&&(o=function(){f.dataRequestPromise=null,f.gridOptions.immediateDataRetrieval=!1,f.gridOptions.onDataRequired(f.gridOptions)},s=function(){f.dataRequestPromise&&(f.$timeout.cancel(f.dataRequestPromise),f.dataRequestPromise=null),f.gridOptions.immediateDataRetrieval?o():f.dataRequestPromise=f.$timeout(function(){o()},f.gridOptions.onDataRequiredDelay,!0)},e.$watch("gridOptions.currentPage",function(n,t){n!==t&&s()}),e.$watchCollection("[gridOptions.filterBy, gridOptions.filterByFields, gridOptions.orderBy, gridOptions.orderByReverse, gridOptions.pageItems, ]",function(){return 0!==f.gridOptions.currentPage?void(f.gridOptions.currentPage=0):void s()}),e.$watch("gridOptions.immediateDataRetrieval",function(n){n&&f.dataRequestPromise&&(f.$timeout.cancel(f.dataRequestPromise),o())})),e.$watch("gridOptions.selectionMode",function(n,t){if(n!==t)switch(n){case i[0]:f.gridOptions.selectedItems.splice(0);break;case i[1]:f.gridOptions.selectedItems.length>1&&f.gridOptions.selectedItems.splice(1)}}),e},f.prototype.speedUpAsyncDataRetrieval=function(n){n&&13!=n.keyCode||(this.gridOptions.immediateDataRetrieval=!0)},f.prototype.setColumnOptions=function(n,t){var i=this.gridOptions.gridColumnDefs[n];if(!i)throw"Invalid grid column options found for column index "+n+". Please report this error.";t=angular.extend(t,i),this.gridOptions.gridColumnDefs[n]=t},f.prototype.toggleSorting=function(n){this.gridOptions.orderBy!=n?this.gridOptions.orderBy=n:this.gridOptions.orderByReverse=!this.gridOptions.orderByReverse,this.speedUpAsyncDataRetrieval()},f.prototype.getFormattedFieldName=function(n){return n.replace(/[\.\[\]]/g,"_")},f.prototype.setFilter=function(n,t){t?this.gridOptions.filterByFields[n]=t:delete this.gridOptions.filterByFields[n],this.gridOptions.filterByFields=angular.extend({},this.gridOptions.filterByFields)},f.prototype.toggleItemSelection=function(n,t,r){var h,f,c,e,l,o,s,u;if(this.gridOptions.selectionMode!==i[0])switch(this.gridOptions.selectionMode){case i[3]:if(r.ctrlKey||r.shiftKey||r.metaKey){if(r.ctrlKey||r.metaKey)u=this.gridOptions.selectedItems.indexOf(t),u>=0?this.gridOptions.selectedItems.splice(u,1):this.gridOptions.selectedItems.push(t);else if(r.shiftKey){for(document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&(h=window.getSelection(),h.removeAllRanges()),c=this.gridOptions.selectedItems[this.gridOptions.selectedItems.length-1],f=0;f<n.length&&n[f].$$_gridItem!==c;f++);for(f>=n.length&&(f=0),e=0;e<n.length&&n[e].$$_gridItem!==t;e++);if(e>=n.length)throw"Invalid selection on a key modifier selection mode";for(f>e&&(l=f,f=e,e=l),o=f;e>=o;o++)s=n[o].$$_gridItem,this.gridOptions.selectedItems.indexOf(s)<0&&this.gridOptions.selectedItems.push(s)}}else u=this.gridOptions.selectedItems.indexOf(t),this.gridOptions.selectedItems.splice(0),0>u&&this.gridOptions.selectedItems.push(t);break;case i[1]:u=this.gridOptions.selectedItems.indexOf(t),this.gridOptions.selectedItems.splice(0),0>u&&this.gridOptions.selectedItems.push(t);break;case i[2]:u=this.gridOptions.selectedItems.indexOf(t),u>=0?this.gridOptions.selectedItems.splice(u,1):this.gridOptions.selectedItems.push(t)}},f.prototype.discoverTemplates=function(n){this.templatedHeader=new c("thead",null,null,"th",tt),this.templatedBody=new c("tbody",l,null,"td",rt),this.templatedFooter=new c("tfoot",null,null,"td",g),this.templatedHeader.discoverCells(n),this.templatedFooter.discoverCells(n),this.templatedBody.discoverCells(n)},f.prototype.configureTableStructure=function(t,i,u){var y,h=this,e=t.$new();i.empty(),this.columnDefsItemsWatcherDeregistration&&(this.columnDefsItemsWatcherDeregistration(),this.columnDefsItemsWatcherDeregistration=null),this.columnDefsFieldsWatcherDeregistration&&(this.columnDefsFieldsWatcherDeregistration(),this.columnDefsFieldsWatcherDeregistration=null),this.columnDefsFieldsWatcherDeregistration=e.$watch("gridOptions.fields",function(n,r){angular.equals(n,r)||h.configureTableStructure(t,i,e)},!0);var c=this.templatedHeader.extractPartialColumnDefinitions(),a=this.templatedBody.extractPartialColumnDefinitions(),v=this.templatedFooter.extractPartialColumnDefinitions(),f=[],b=this.gridOptions.fields;if(b)angular.forEach(this.gridOptions.fields,function(n){n&&f.push({isStandardColumn:!0,fieldName:n})}),f=r(f,c,!1,!0),f=r(f,a,!1,!0);else if(c.length>0)f=r(c,a,!0,!0);else{if(!this.gridOptions.items||0==this.gridOptions.items.length)return void(this.columnDefsItemsWatcherDeregistration=e.$watch("gridOptions.items.length",function(n){n&&h.configureTableStructure(t,i,e)}));for(y in this.gridOptions.items[0])y.match(/^[_\$]/g)||f.push({isStandardColumn:!0,fieldName:y});f=r(f,a,!0,!0)}0==v.length&&v.push({isStandardColumn:!0}),angular.forEach(f,function(n){n.fieldName&&(n.displayFieldName=h.getFormattedFieldName(n.fieldName))}),this.gridOptions.gridColumnDefs=f;{var p=this.templatedHeader.configureSection(i,f),w=this.templatedFooter.configureSection(i,v),o=this.templatedBody.configureSection(i,f),s=this.templatedBody.getTemplatedRowElement(o);this.templatedHeader.getTemplatedRowElement(p)}o.attr(l,""),s.attr("ng-click","toggleItemSelection(gridItem, $event)"),s.attr("ng-repeat","gridDisplayItem in filteredItems"),s.attr("ng-init","gridItem=gridDisplayItem.$$_gridItem"),s.attr("ng-class","{'"+n.rowSelectedCssClass+"':gridOptions.selectedItems.indexOf(gridItem)>=0}"),p.replaceWith(this.$compile(p)(e)),w.replaceWith(this.$compile(w)(e)),o.replaceWith(this.$compile(o)(e)),u&&this.$timeout(function(){return u.$destroy()})},f.prototype.computeFormattedItems=function(t){var i,l,r,o,u,a,c,s,h,e,f=t.gridOptions.items||[];for(n.debugMode&&this.log("formatting items of length "+f.length),i=t.formattedItems=t.formattedItems||[],t.gridOptions.onDataRequired?t.filteredItems=i:t.requiresReFilteringTrigger=!t.requiresReFilteringTrigger,l=t.gridOptions.gridColumnDefs,r=0;r<f.length;r++){for(o=f[r],a={gridItem:o};i.length>f.length&&(u=i[r]).$$_gridItem!==o;)i.splice(r,1);for(r<i.length?(u=i[r],u.$$_gridItem!==o&&(u={$$_gridItem:o},i[r]=u)):(u={$$_gridItem:o},i.push(u)),c=0;c<l.length;c++)try{s=l[c],h=s.fieldName,h&&(e=s.displayFormat,e?("."!=e[0]&&"|"!=e[0]&&(e=" | "+e),u[s.displayFieldName]=t.$eval("gridItem."+h+e,a)):u[s.displayFieldName]=t.$eval("gridItem."+h,a))}catch(v){n.debugMode&&this.log("Field evaluation failed for <"+h+"> with error "+v)}}i.length>f.length&&i.splice(f.length,i.length-f.length)},f.prototype.computeFilteredItems=function(t){if(t.filterByDisplayFields={},t.gridOptions.filterByFields)for(var i in t.gridOptions.filterByFields)t.filterByDisplayFields[this.getFormattedFieldName(i)]=t.gridOptions.filterByFields[i];n.debugMode&&this.log("filtering items of length "+(t.formattedItems?t.formattedItems.length:0)),t.filteredItems=t.$eval("formattedItems | filter:gridOptions.filterBy | filter:filterByDisplayFields | "+n.sortFilter+":gridOptions | "+n.dataPagingFilter+":gridOptions")},f.prototype.setupDisplayItemsArray=function(t){var r=this,i="[gridOptions.items,gridOptions.gridColumnDefs.length";angular.forEach(t.gridOptions.gridColumnDefs,function(n){if(n.displayFormat&&"."!=n.displayFormat[0]){var t=n.displayFormat.split("|");angular.forEach(t,function(n){var t=n.split(":");t.length>1&&angular.forEach(t.slice(1),function(n){n=n.trim(),n&&"gridItem"!==n&&"gridDisplayItem"!==n&&(i+=","+n)})})}}),i+="]",n.debugMode&&this.log("re-formatting is set to watch for changes in "+i),t.$watch(i,function(){return r.computeFormattedItems(t)},!0),t.gridOptions.onDataRequired||(i="[requiresReFilteringTrigger, gridOptions.filterBy, gridOptions.filterByFields, gridOptions.orderBy, gridOptions.orderByReverse, gridOptions.currentPage, gridOptions.pageItems]",t.$watch(i,function(){r.computeFilteredItems(t)},!0))},f.prototype.linkAttrs=function(n,t){var r=function(n,i){if("undefined"!=typeof i){switch(i){case"true":i=!0;break;case"false":i=!1}t[n]=i}};for(var i in t)r(i,n[i]),function(t){n.$observe(t,function(n){return r(t,n)})}(i)},f.prototype.linkScope=function(t,i,r,u){var f,s,h,o,c=this,e=t[r];for(f in e)if(s="undefined"!=typeof u[f]&&null!=u[f]){h=!1,"undefined"!=typeof i[f]&&null!=i[f]&&(e[f]=i[f],h=e[f]instanceof Array),o=null;try{o=this.$parse(u[f])}catch(l){}!function(u,f){f&&f.constant||i.$watch(u,function(n){e[u]=n});var o=f&&f.assign?f.assign:null;o&&t.$watch(r+"."+u,function(t){try{i[u]=t}catch(r){if(n.debugMode)throw c.log("Mirroring the property on the external scope failed with "+r),r}})}(f,o)}},f.prototype.log=function(n){console.log(t+"("+(new Date).getTime()+"): "+n)},f}();angular.module("trNgGrid",[]).directive(t,[function(){return{restrict:"A",scope:{items:"=",selectedItems:"=?",filterBy:"=?",filterByFields:"=?",orderBy:"=?",orderByReverse:"=?",pageItems:"=?",currentPage:"=?",totalItems:"=?",enableFiltering:"=?",enableSorting:"=?",enableSelections:"=?",enableMultiRowSelections:"=?",selectionMode:"@",locale:"@",onDataRequired:"&",onDataRequiredDelay:"=?",fields:"=?"},template:function(t){t.addClass(n.tableCssClass),angular.forEach(t.children(),function(n){n=angular.element(n),n.attr("ng-non-bindable","")})},controller:["$compile","$parse","$timeout","$templateCache",et],compile:function(){return{pre:function(n,t,i,r){r.discoverTemplates(t)},post:function(n,t,i,r){var u=r.setupScope(n,t,i);u.speedUpAsyncDataRetrieval=function(n){return r.speedUpAsyncDataRetrieval(n)},r.configureTableStructure(u,t),r.setupDisplayItemsArray(u)}}}}}]).directive(y,[function(){var i=function(n){if(n.columnOptions.displayName)n.columnTitle=n.columnOptions.displayName;else if(n.columnOptions.fieldName){var t=n.columnOptions.fieldName.match(/^[^\.\[\]]*/);t=t[0].split(/(?=[A-Z])/),t.length&&t[0].length&&(t[0]=t[0][0].toLocaleUpperCase()+t[0].substr(1)),n.columnTitle=t.join(" ")}else n.columnTitle="[Invalid Field Name]"};return{restrict:"A",require:"^"+t,scope:!0,compile:function(t,r){var u="true"==r.isCustomized;return h(t,r,u,it),{pre:function(t,r,f,e){var s=parseInt(f[y]),o=angular.extend(t.gridOptions.gridColumnDefs[s],n.defaultColumnOptions);e.linkAttrs(f,o),t.columnOptions=o,t.isCustomized=u,t.toggleSorting=function(n){e.toggleSorting(n)},i(t),t.$watch("columnOptions.filter",function(n,t){n!==t&&e.setFilter(o.fieldName,n)})}}}}}]).directive(p,[function(){return{restrict:"A",templateUrl:n.cellHeaderTemplateId,transclude:!0,replace:!0}}]).directive("trNgGridBody",[function(){return{restrict:"A",require:"^"+t,scope:!0,compile:function(){return{pre:function(n,t,i,r){n.toggleItemSelection=function(t,i){r.toggleItemSelection(n.filteredItems,t,i)}}}}}}]).directive(w,[function(){return{restrict:"A",require:"^"+t,scope:!0,compile:function(n,t){var i="true"==t.isCustomized;return h(n,t,i,ut),{pre:function(n,t,r){n.columnOptions=n.gridOptions.gridColumnDefs[parseInt(r[w])],n.gridItem=n.gridDisplayItem.$$_gridItem,n.isCustomized=i}}}}}]).directive(b,[function(){return{restrict:"A",templateUrl:n.cellBodyTemplateId,transclude:!0,replace:!0}}]).directive("trNgGridFooterCell",[function(){return{restrict:"A",require:"^"+t,scope:!0,compile:function(n,t){var i="true"==t.isCustomized;return h(n,t,i,nt),{pre:function(n,t){n.isCustomized=i,t.attr("colspan",n.gridOptions.gridColumnDefs.length)}}}}}]).directive(v,[function(){return{restrict:"A",templateUrl:n.cellFooterTemplateId,transclude:!0,replace:!0}}]).directive(o,[function(){return{restrict:"A",replace:!0,templateUrl:n.columnSortTemplateId}}]).directive(s,[function(){return{restrict:"A",replace:!0,templateUrl:n.columnFilterTemplateId}}]).directive(f,[function(){return{restrict:"A",scope:!1,templateUrl:n.footerGlobalFilterTemplateId}}]).directive(e,[function(){var i=function(t){var f,i;if(t.totalItemsCount="undefined"!=typeof t.gridOptions.totalItems&&null!=t.gridOptions.totalItems?t.gridOptions.totalItems:t.gridOptions.items?t.gridOptions.items.length:0,t.isPaged=!!t.gridOptions.pageItems&&t.gridOptions.pageItems<t.totalItemsCount,t.extendedControlsActive=!1,t.lastPageIndex=t.totalItemsCount&&t.isPaged?Math.floor(t.totalItemsCount/t.gridOptions.pageItems)+(t.totalItemsCount%t.gridOptions.pageItems?0:-1):0,t.gridOptions.currentPage>t.lastPageIndex&&(t.gridOptions.currentPage=t.lastPageIndex),t.startItemIndex=t.isPaged?t.gridOptions.pageItems*t.gridOptions.currentPage:0,t.endItemIndex=t.isPaged?t.startItemIndex+t.gridOptions.pageItems-1:t.totalItemsCount-1,t.endItemIndex>=t.totalItemsCount&&(t.endItemIndex=t.totalItemsCount-1),t.endItemIndex<t.startItemIndex&&(t.endItemIndex=t.startItemIndex),t.pageCanGoBack=t.isPaged&&t.gridOptions.currentPage>0,t.pageCanGoForward=t.isPaged&&t.gridOptions.currentPage<t.lastPageIndex,t.pageIndexes=t.pageIndexes||[],t.pageIndexes.splice(0),t.isPaged)if(t.lastPageIndex+1>n.defaultPagerMinifiedPageCountThreshold){t.extendedControlsActive=!0;var e=Math.floor(n.defaultPagerMinifiedPageCountThreshold/2),r=t.gridOptions.currentPage-e,u=t.gridOptions.currentPage+e;for(0>r?(u+=-r,r=0):u>t.lastPageIndex&&(r-=u-t.lastPageIndex,u=t.lastPageIndex),r>0&&(t.pageIndexes.push(null),r++),f=!1,u<t.lastPageIndex&&(f=!0,u--),i=r;u>=i;i++)t.pageIndexes.push(i);f&&t.pageIndexes.push(null)}else for(t.extendedControlsActive=!1,i=0;i<=t.lastPageIndex;i++)t.pageIndexes.push(i);t.pageSelectionActive=t.pageIndexes.length>1,t.navigateToPage=function(n){t.gridOptions.currentPage=n,t.speedUpAsyncDataRetrieval()},t.switchPageSelection=function(n,i){t.pageSelectionActive=i,n&&(n.preventDefault(),n.stopPropagation())}};return{restrict:"A",scope:!0,require:"^"+t,templateUrl:n.footerPagerTemplateId,replace:!0,compile:function(){return{pre:function(n,t,r,u){i(n,u)},post:function(n,t,r,u){n.$watchCollection("[gridOptions.currentPage, gridOptions.items.length, gridOptions.totalItems, gridOptions.pageItems]",function(){i(n,u)})}}}}}]).filter(n.sortFilter,["$filter","$parse",function(n,t){return function(i,r){var u,f;if(!r.orderBy||!r.gridColumnDefs)return i;for(u=null,f=0;f<r.gridColumnDefs.length&&(u=r.gridColumnDefs[f]).fieldName!==r.orderBy;u=null,f++);return u?n("orderBy")(i,function(n){var i=void 0;try{i=t("item.$$_gridItem."+u.fieldName)({item:n})}catch(r){}if(void 0===i)try{i=t("item."+u.displayFieldName)({item:n})}catch(r){}return i},r.orderByReverse):i}}]).filter(n.dataPagingFilter,function(){return function(n,t){var i,r;return n&&(t.totalItems=n.length),t.pageItems&&n&&0!=n.length?(t.currentPage||(t.currentPage=0),i=t.currentPage*t.pageItems,i>=n.length&&(t.currentPage=0,i=0),r=t.currentPage*t.pageItems+t.pageItems,n.slice(i,r)):n}}).filter(n.translateFilter,["$filter",function(t){return function(i,r){var u,f,o,e,c,s,h;if(i instanceof Date)return f=t(n.translateFilter)(n.translationDateFormat,r),f&&f!==n.translationDateFormat?t("date")(i,f):i;if(!u)for(o=r.split(/[-_]/),e=o.length;e>0&&!u;e--)c=o.slice(0,e).join("-"),s=n.translations[c],s&&(u=s[i]);if(!u)try{h=t("translate"),h&&(u=h(i))}catch(l){}return u||(u=i),u}}]).run(function(){n.tableCssClass="tr-ng-grid table table-bordered table-hover",n.cellCssClass="tr-ng-cell",n.headerCellCssClass="tr-ng-column-header "+n.cellCssClass,n.bodyCellCssClass=n.cellCssClass,n.columnTitleCssClass="tr-ng-title",n.columnSortCssClass="tr-ng-sort",n.columnFilterCssClass="tr-ng-column-filter",n.columnFilterInputWrapperCssClass="",n.columnSortActiveCssClass="tr-ng-sort-active text-info",n.columnSortInactiveCssClass="tr-ng-sort-inactive text-muted glyphicon glyphicon-chevron-down",n.columnSortReverseOrderCssClass="tr-ng-sort-order-reverse glyphicon glyphicon-chevron-down",n.columnSortNormalOrderCssClass="tr-ng-sort-order-normal glyphicon glyphicon-chevron-up",n.rowSelectedCssClass="active",n.footerCssClass="tr-ng-grid-footer form-inline"}).run(function(){n.defaultColumnOptions.displayAlign="left",n.defaultPagerMinifiedPageCountThreshold=3})}(TrNgGrid||(TrNgGrid={})),function(window,angular){"use strict";function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}]}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}"string"!=typeof html&&(html=null===html||"undefined"==typeof html?"":""+html);var index,chars,match,text,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(text="",chars=!0,stack.last()&&specialElements[stack.last()]?(html=html.replace(new RegExp("(.*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last())):(0===html.indexOf("<!--")?(index=html.indexOf("--",4),index>=0&&html.lastIndexOf("-->",index)===index&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):DOCTYPE_REGEXP.test(html)?(match=html.match(DOCTYPE_REGEXP),match&&(html=html.replace(match[0],""),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match?(match[4]&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag)),chars=!1):(text+="<",html=html.substring(1))),chars&&(index=html.indexOf("<"),text+=0>index?html:html.substring(0,index),html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text)))),html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){if(!value)return"";var parts=spaceRe.exec(value),spaceBefore=parts[1],spaceAfter=parts[3],content=parts[2];return content&&(hiddenPre.innerHTML=content.replace(/</g,"&lt;"),content="textContent"in hiddenPre?hiddenPre.textContent:hiddenPre.innerText),spaceBefore+content+spaceAfter}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||validElements[tag]!==!0||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),START_TAG_REGEXP=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,END_TAG_REGEXP=/^<\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),svgElements=makeMap("animate,animateColor,animateMotion,animateTransform,circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,set,stop,svg,switch,text,title,tspan,use"),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements,svgElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap,xlink:href"),htmlAttrs=makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width"),svgAttrs=makeMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,attributeName,attributeType,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan"),validAttrs=angular.extend({},uriAttrs,svgAttrs,htmlAttrs),hiddenPre=document.createElement("pre"),spaceRe=/^(\s*)([\s\S]*?)(\s*)$/;angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/,MAILTO_REGEXP=/^mailto:/;return function(text,target){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){html.push("<a "),angular.isDefined(target)&&html.push('target="',target,'" '),html.push('href="',url.replace(/"/g,"&quot;"),'">'),addText(text),html.push("</a>")}if(!text)return text;for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]||match[4]||(url=(match[3]?"http://":"mailto:")+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular),angular.module("ui.alias",[]).config(["$compileProvider","uiAliasConfig",function($compileProvider,uiAliasConfig){uiAliasConfig=uiAliasConfig||{},angular.forEach(uiAliasConfig,function(config,alias){angular.isString(config)&&(config={replace:!0,template:config}),$compileProvider.directive(alias,function(){return config})})}]),angular.module("ui.event",[]).directive("uiEvent",["$parse",function($parse){return function($scope,elm,attrs){var events=$scope.$eval(attrs.uiEvent);angular.forEach(events,function(uiEvent,eventName){var fn=$parse(uiEvent);elm.bind(eventName,function(evt){var params=Array.prototype.slice.call(arguments);params=params.splice(1),fn($scope,{$event:evt,$params:params}),$scope.$$phase||$scope.$apply()})})}}]),angular.module("ui.format",[]).filter("format",function(){return function(value,replace){var target=value;if(angular.isString(target)&&void 0!==replace)if(angular.isArray(replace)||angular.isObject(replace)||(replace=[replace]),angular.isArray(replace)){var rlen=replace.length,rfx=function(str,i){return i=parseInt(i,10),i>=0&&rlen>i?replace[i]:str};target=target.replace(/\$([0-9]+)/g,rfx)}else angular.forEach(replace,function(value,key){target=target.split(":"+key).join(value)});return target}}),angular.module("ui.highlight",[]).filter("highlight",function(){return function(text,search,caseSensitive){return search||angular.isNumber(search)?(text=text.toString(),search=search.toString(),caseSensitive?text.split(search).join('<span class="ui-match">'+search+"</span>"):text.replace(new RegExp(search,"gi"),'<span class="ui-match">$&</span>')):text}}),angular.module("ui.include",[]).directive("uiInclude",["$http","$templateCache","$anchorScroll","$compile",function($http,$templateCache,$anchorScroll,$compile){return{restrict:"ECA",terminal:!0,compile:function(element,attr){var srcExp=attr.uiInclude||attr.src,fragExp=attr.fragment||"",onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,element){function ngIncludeWatchAction(){var thisChangeId=++changeCounter,src=scope.$eval(srcExp),fragment=scope.$eval(fragExp);src?$http.get(src,{cache:$templateCache}).success(function(response){if(thisChangeId===changeCounter){childScope&&childScope.$destroy(),childScope=scope.$new();var contents;contents=fragment?angular.element("<div/>").html(response).find(fragment):angular.element("<div/>").html(response).contents(),element.html(contents),$compile(contents)(childScope),!angular.isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll(),childScope.$emit("$includeContentLoaded"),scope.$eval(onloadExp)}}).error(function(){thisChangeId===changeCounter&&clearContent()
}):clearContent()}var childScope,changeCounter=0,clearContent=function(){childScope&&(childScope.$destroy(),childScope=null),element.html("")};scope.$watch(fragExp,ngIncludeWatchAction),scope.$watch(srcExp,ngIncludeWatchAction)}}}}]),angular.module("ui.indeterminate",[]).directive("uiIndeterminate",[function(){return{compile:function(tElm,tAttrs){return tAttrs.type&&"checkbox"===tAttrs.type.toLowerCase()?function($scope,elm,attrs){$scope.$watch(attrs.uiIndeterminate,function(newVal){elm[0].indeterminate=!!newVal})}:angular.noop}}}]),angular.module("ui.inflector",[]).filter("inflector",function(){function ucwords(text){return text.replace(/^([a-z])|\s+([a-z])/g,function($1){return $1.toUpperCase()})}function breakup(text,separator){return text.replace(/[A-Z]/g,function(match){return separator+match})}var inflectors={humanize:function(value){return ucwords(breakup(value," ").split("_").join(" "))},underscore:function(value){return value.substr(0,1).toLowerCase()+breakup(value.substr(1),"_").toLowerCase().split(" ").join("_")},variable:function(value){return value=value.substr(0,1).toLowerCase()+ucwords(value.split("_").join(" ")).substr(1).split(" ").join("")}};return function(text,inflector){return inflector!==!1&&angular.isString(text)?(inflector=inflector||"humanize",inflectors[inflector](text)):text}}),angular.module("ui.jq",[]).value("uiJqConfig",{}).directive("uiJq",["uiJqConfig","$timeout",function(uiJqConfig,$timeout){return{restrict:"A",compile:function(tElm,tAttrs){if(!angular.isFunction(tElm[tAttrs.uiJq]))throw new Error('ui-jq: The "'+tAttrs.uiJq+'" function does not exist');var options=uiJqConfig&&uiJqConfig[tAttrs.uiJq];return function(scope,elm,attrs){function callPlugin(){$timeout(function(){elm[attrs.uiJq].apply(elm,linkOptions)},0,!1)}var linkOptions=[];attrs.uiOptions?(linkOptions=scope.$eval("["+attrs.uiOptions+"]"),angular.isObject(options)&&angular.isObject(linkOptions[0])&&(linkOptions[0]=angular.extend({},options,linkOptions[0]))):options&&(linkOptions=[options]),attrs.ngModel&&elm.is("select,input,textarea")&&elm.bind("change",function(){elm.trigger("input")}),attrs.uiRefresh&&scope.$watch(attrs.uiRefresh,function(){callPlugin()}),callPlugin()}}}}]),angular.module("ui.keypress",[]).factory("keypressHelper",["$parse",function($parse){var keysByCode={8:"backspace",9:"tab",13:"enter",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete"},capitaliseFirstLetter=function(string){return string.charAt(0).toUpperCase()+string.slice(1)};return function(mode,scope,elm,attrs){var params,combinations=[];params=scope.$eval(attrs["ui"+capitaliseFirstLetter(mode)]),angular.forEach(params,function(v,k){var combination,expression;expression=$parse(v),angular.forEach(k.split(" "),function(variation){combination={expression:expression,keys:{}},angular.forEach(variation.split("-"),function(value){combination.keys[value]=!0}),combinations.push(combination)})}),elm.bind(mode,function(event){var metaPressed=!(!event.metaKey||event.ctrlKey),altPressed=!!event.altKey,ctrlPressed=!!event.ctrlKey,shiftPressed=!!event.shiftKey,keyCode=event.keyCode;"keypress"===mode&&!shiftPressed&&keyCode>=97&&122>=keyCode&&(keyCode-=32),angular.forEach(combinations,function(combination){var mainKeyPressed=combination.keys[keysByCode[keyCode]]||combination.keys[keyCode.toString()],metaRequired=!!combination.keys.meta,altRequired=!!combination.keys.alt,ctrlRequired=!!combination.keys.ctrl,shiftRequired=!!combination.keys.shift;mainKeyPressed&&metaRequired===metaPressed&&altRequired===altPressed&&ctrlRequired===ctrlPressed&&shiftRequired===shiftPressed&&scope.$apply(function(){combination.expression(scope,{$event:event})})})})}}]),angular.module("ui.keypress").directive("uiKeydown",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keydown",scope,elm,attrs)}}}]),angular.module("ui.keypress").directive("uiKeypress",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keypress",scope,elm,attrs)}}}]),angular.module("ui.keypress").directive("uiKeyup",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keyup",scope,elm,attrs)}}}]),angular.module("ui.mask",[]).value("uiMaskConfig",{maskDefinitions:{9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/}}).directive("uiMask",["uiMaskConfig",function(maskConfig){return{priority:100,require:"ngModel",restrict:"A",compile:function(){var options=maskConfig;return function(scope,iElement,iAttrs,controller){function initialize(maskAttr){return angular.isDefined(maskAttr)?(processRawMask(maskAttr),maskProcessed?(initializeElement(),bindEventListeners(),!0):uninitialize()):uninitialize()}function initPlaceholder(placeholderAttr){angular.isDefined(placeholderAttr)&&(maskPlaceholder=placeholderAttr,maskProcessed&&eventHandler())}function formatter(fromModelValue){return maskProcessed?(value=unmaskValue(fromModelValue||""),isValid=validateValue(value),controller.$setValidity("mask",isValid),isValid&&value.length?maskValue(value):void 0):fromModelValue}function parser(fromViewValue){return maskProcessed?(value=unmaskValue(fromViewValue||""),isValid=validateValue(value),controller.$viewValue=value.length?maskValue(value):"",controller.$setValidity("mask",isValid),""===value&&void 0!==controller.$error.required&&controller.$setValidity("required",!1),isValid?value:void 0):fromViewValue}function uninitialize(){return maskProcessed=!1,unbindEventListeners(),angular.isDefined(originalPlaceholder)?iElement.attr("placeholder",originalPlaceholder):iElement.removeAttr("placeholder"),angular.isDefined(originalMaxlength)?iElement.attr("maxlength",originalMaxlength):iElement.removeAttr("maxlength"),iElement.val(controller.$modelValue),controller.$viewValue=controller.$modelValue,!1}function initializeElement(){value=oldValueUnmasked=unmaskValue(controller.$modelValue||""),valueMasked=oldValue=maskValue(value),isValid=validateValue(value);var viewValue=isValid&&value.length?valueMasked:"";iAttrs.maxlength&&iElement.attr("maxlength",2*maskCaretMap[maskCaretMap.length-1]),iElement.attr("placeholder",maskPlaceholder),iElement.val(viewValue),controller.$viewValue=viewValue}function bindEventListeners(){eventsBound||(iElement.bind("blur",blurHandler),iElement.bind("mousedown mouseup",mouseDownUpHandler),iElement.bind("input keyup click focus",eventHandler),eventsBound=!0)}function unbindEventListeners(){eventsBound&&(iElement.unbind("blur",blurHandler),iElement.unbind("mousedown",mouseDownUpHandler),iElement.unbind("mouseup",mouseDownUpHandler),iElement.unbind("input",eventHandler),iElement.unbind("keyup",eventHandler),iElement.unbind("click",eventHandler),iElement.unbind("focus",eventHandler),eventsBound=!1)}function validateValue(value){return value.length?value.length>=minRequiredLength:!0}function unmaskValue(value){var valueUnmasked="",maskPatternsCopy=maskPatterns.slice();return value=value.toString(),angular.forEach(maskComponents,function(component){value=value.replace(component,"")}),angular.forEach(value.split(""),function(chr){maskPatternsCopy.length&&maskPatternsCopy[0].test(chr)&&(valueUnmasked+=chr,maskPatternsCopy.shift())}),valueUnmasked}function maskValue(unmaskedValue){var valueMasked="",maskCaretMapCopy=maskCaretMap.slice();return angular.forEach(maskPlaceholder.split(""),function(chr,i){unmaskedValue.length&&i===maskCaretMapCopy[0]?(valueMasked+=unmaskedValue.charAt(0)||"_",unmaskedValue=unmaskedValue.substr(1),maskCaretMapCopy.shift()):valueMasked+=chr}),valueMasked}function getPlaceholderChar(i){var placeholder=iAttrs.placeholder;return"undefined"!=typeof placeholder&&placeholder[i]?placeholder[i]:"_"}function getMaskComponents(){return maskPlaceholder.replace(/[_]+/g,"_").replace(/([^_]+)([a-zA-Z0-9])([^_])/g,"$1$2_$3").split("_")}function processRawMask(mask){var characterCount=0;if(maskCaretMap=[],maskPatterns=[],maskPlaceholder="","string"==typeof mask){minRequiredLength=0;var isOptional=!1,splitMask=mask.split("");angular.forEach(splitMask,function(chr,i){linkOptions.maskDefinitions[chr]?(maskCaretMap.push(characterCount),maskPlaceholder+=getPlaceholderChar(i),maskPatterns.push(linkOptions.maskDefinitions[chr]),characterCount++,isOptional||minRequiredLength++):"?"===chr?isOptional=!0:(maskPlaceholder+=chr,characterCount++)})}maskCaretMap.push(maskCaretMap.slice().pop()+1),maskComponents=getMaskComponents(),maskProcessed=maskCaretMap.length>1?!0:!1}function blurHandler(){oldCaretPosition=0,oldSelectionLength=0,isValid&&0!==value.length||(valueMasked="",iElement.val(""),scope.$apply(function(){controller.$setViewValue("")}))}function mouseDownUpHandler(e){"mousedown"===e.type?iElement.bind("mouseout",mouseoutHandler):iElement.unbind("mouseout",mouseoutHandler)}function mouseoutHandler(){oldSelectionLength=getSelectionLength(this),iElement.unbind("mouseout",mouseoutHandler)}function eventHandler(e){e=e||{};var eventWhich=e.which,eventType=e.type;if(16!==eventWhich&&91!==eventWhich){var valMasked,val=iElement.val(),valOld=oldValue,valUnmasked=unmaskValue(val),valUnmaskedOld=oldValueUnmasked,valAltered=!1,caretPos=getCaretPosition(this)||0,caretPosOld=oldCaretPosition||0,caretPosDelta=caretPos-caretPosOld,caretPosMin=maskCaretMap[0],caretPosMax=maskCaretMap[valUnmasked.length]||maskCaretMap.slice().shift(),selectionLenOld=oldSelectionLength||0,isSelected=getSelectionLength(this)>0,wasSelected=selectionLenOld>0,isAddition=val.length>valOld.length||selectionLenOld&&val.length>valOld.length-selectionLenOld,isDeletion=val.length<valOld.length||selectionLenOld&&val.length===valOld.length-selectionLenOld,isSelection=eventWhich>=37&&40>=eventWhich&&e.shiftKey,isKeyLeftArrow=37===eventWhich,isKeyBackspace=8===eventWhich||"keyup"!==eventType&&isDeletion&&-1===caretPosDelta,isKeyDelete=46===eventWhich||"keyup"!==eventType&&isDeletion&&0===caretPosDelta&&!wasSelected,caretBumpBack=(isKeyLeftArrow||isKeyBackspace||"click"===eventType)&&caretPos>caretPosMin;if(oldSelectionLength=getSelectionLength(this),!isSelection&&(!isSelected||"click"!==eventType&&"keyup"!==eventType)){if("input"===eventType&&isDeletion&&!wasSelected&&valUnmasked===valUnmaskedOld){for(;isKeyBackspace&&caretPos>caretPosMin&&!isValidCaretPosition(caretPos);)caretPos--;for(;isKeyDelete&&caretPosMax>caretPos&&-1===maskCaretMap.indexOf(caretPos);)caretPos++;var charIndex=maskCaretMap.indexOf(caretPos);valUnmasked=valUnmasked.substring(0,charIndex)+valUnmasked.substring(charIndex+1),valAltered=!0}for(valMasked=maskValue(valUnmasked),oldValue=valMasked,oldValueUnmasked=valUnmasked,iElement.val(valMasked),valAltered&&scope.$apply(function(){controller.$setViewValue(valUnmasked)}),isAddition&&caretPosMin>=caretPos&&(caretPos=caretPosMin+1),caretBumpBack&&caretPos--,caretPos=caretPos>caretPosMax?caretPosMax:caretPosMin>caretPos?caretPosMin:caretPos;!isValidCaretPosition(caretPos)&&caretPos>caretPosMin&&caretPosMax>caretPos;)caretPos+=caretBumpBack?-1:1;(caretBumpBack&&caretPosMax>caretPos||isAddition&&!isValidCaretPosition(caretPosOld))&&caretPos++,oldCaretPosition=caretPos,setCaretPosition(this,caretPos)}}}function isValidCaretPosition(pos){return maskCaretMap.indexOf(pos)>-1}function getCaretPosition(input){if(!input)return 0;if(void 0!==input.selectionStart)return input.selectionStart;if(document.selection){input.focus();var selection=document.selection.createRange();return selection.moveStart("character",-input.value.length),selection.text.length}return 0}function setCaretPosition(input,pos){if(!input)return 0;if(0!==input.offsetWidth&&0!==input.offsetHeight)if(input.setSelectionRange)input.focus(),input.setSelectionRange(pos,pos);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}function getSelectionLength(input){return input?void 0!==input.selectionStart?input.selectionEnd-input.selectionStart:document.selection?document.selection.createRange().text.length:0:0}var maskCaretMap,maskPatterns,maskPlaceholder,maskComponents,minRequiredLength,value,valueMasked,isValid,oldValue,oldValueUnmasked,oldCaretPosition,oldSelectionLength,maskProcessed=!1,eventsBound=!1,originalPlaceholder=iAttrs.placeholder,originalMaxlength=iAttrs.maxlength,linkOptions={};iAttrs.uiOptions?(linkOptions=scope.$eval("["+iAttrs.uiOptions+"]"),angular.isObject(linkOptions[0])&&(linkOptions=function(original,current){for(var i in original)Object.prototype.hasOwnProperty.call(original,i)&&(current[i]?angular.extend(current[i],original[i]):current[i]=angular.copy(original[i]));return current}(options,linkOptions[0]))):linkOptions=options,iAttrs.$observe("uiMask",initialize),iAttrs.$observe("placeholder",initPlaceholder),controller.$formatters.push(formatter),controller.$parsers.push(parser),iElement.bind("mousedown mouseup",mouseDownUpHandler),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&1/0!==n&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);len>k;k++)if(k in t&&t[k]===searchElement)return k;return-1})}}}}]),angular.module("ui.reset",[]).value("uiResetConfig",null).directive("uiReset",["uiResetConfig",function(uiResetConfig){var resetValue=null;return void 0!==uiResetConfig&&(resetValue=uiResetConfig),{require:"ngModel",link:function(scope,elm,attrs,ctrl){var aElement;aElement=angular.element('<a class="ui-reset" />'),elm.wrap('<span class="ui-resetwrap" />').after(aElement),aElement.bind("click",function(e){e.preventDefault(),scope.$apply(function(){ctrl.$setViewValue(attrs.uiReset?scope.$eval(attrs.uiReset):resetValue),ctrl.$render()})})}}}]),angular.module("ui.route",[]).directive("uiRoute",["$location","$parse",function($location,$parse){return{restrict:"AC",scope:!0,compile:function(tElement,tAttrs){var useProperty;if(tAttrs.uiRoute)useProperty="uiRoute";else if(tAttrs.ngHref)useProperty="ngHref";else{if(!tAttrs.href)throw new Error("uiRoute missing a route or href property on "+tElement[0]);useProperty="href"}return function($scope,elm,attrs){function staticWatcher(newVal){var hash=newVal.indexOf("#");hash>-1&&(newVal=newVal.substr(hash+1)),(watcher=function(){modelSetter($scope,$location.path().indexOf(newVal)>-1)})()}function regexWatcher(newVal){var hash=newVal.indexOf("#");hash>-1&&(newVal=newVal.substr(hash+1)),(watcher=function(){var regexp=new RegExp("^"+newVal+"$",["i"]);modelSetter($scope,regexp.test($location.path()))})()}var modelSetter=$parse(attrs.ngModel||attrs.routeModel||"$uiRoute").assign,watcher=angular.noop;switch(useProperty){case"uiRoute":attrs.uiRoute?regexWatcher(attrs.uiRoute):attrs.$observe("uiRoute",regexWatcher);break;case"ngHref":attrs.ngHref?staticWatcher(attrs.ngHref):attrs.$observe("ngHref",staticWatcher);break;case"href":staticWatcher(attrs.href)}$scope.$on("$routeChangeSuccess",function(){watcher()}),$scope.$on("$stateChangeSuccess",function(){watcher()})}}}}]),angular.module("ui.scroll.jqlite",["ui.scroll"]).service("jqLiteExtras",["$log","$window",function(console,window){return{registerFor:function(element){var convertToPx,css,getMeasurements,getStyle,getWidthHeight,isWindow,scrollTo;return css=angular.element.prototype.css,element.prototype.css=function(name,value){var elem,self;return self=this,elem=self[0],elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style?css.call(self,name,value):void 0},isWindow=function(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval},scrollTo=function(self,direction,value){var elem,method,preserve,prop,_ref;return elem=self[0],_ref={top:["scrollTop","pageYOffset","scrollLeft"],left:["scrollLeft","pageXOffset","scrollTop"]}[direction],method=_ref[0],prop=_ref[1],preserve=_ref[2],isWindow(elem)?angular.isDefined(value)?elem.scrollTo(self[preserve].call(self),value):prop in elem?elem[prop]:elem.document.documentElement[method]:angular.isDefined(value)?elem[method]=value:elem[method]},window.getComputedStyle?(getStyle=function(elem){return window.getComputedStyle(elem,null)},convertToPx=function(elem,value){return parseFloat(value)}):(getStyle=function(elem){return elem.currentStyle},convertToPx=function(elem,value){var core_pnum,left,result,rnumnonpx,rs,rsLeft,style;return core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rnumnonpx.test(value)?(style=elem.style,left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rs&&(rs.left=style.left),style.left=value,result=style.pixelLeft,style.left=left,rsLeft&&(rs.left=rsLeft),result):parseFloat(value)}),getMeasurements=function(elem,measure){var base,borderA,borderB,computedMarginA,computedMarginB,computedStyle,dirA,dirB,marginA,marginB,paddingA,paddingB,_ref;return isWindow(elem)?(base=document.documentElement[{height:"clientHeight",width:"clientWidth"}[measure]],{base:base,padding:0,border:0,margin:0}):(_ref={width:[elem.offsetWidth,"Left","Right"],height:[elem.offsetHeight,"Top","Bottom"]}[measure],base=_ref[0],dirA=_ref[1],dirB=_ref[2],computedStyle=getStyle(elem),paddingA=convertToPx(elem,computedStyle["padding"+dirA])||0,paddingB=convertToPx(elem,computedStyle["padding"+dirB])||0,borderA=convertToPx(elem,computedStyle["border"+dirA+"Width"])||0,borderB=convertToPx(elem,computedStyle["border"+dirB+"Width"])||0,computedMarginA=computedStyle["margin"+dirA],computedMarginB=computedStyle["margin"+dirB],marginA=convertToPx(elem,computedMarginA)||0,marginB=convertToPx(elem,computedMarginB)||0,{base:base,padding:paddingA+paddingB,border:borderA+borderB,margin:marginA+marginB})},getWidthHeight=function(elem,direction,measure){var computedStyle,measurements,result;return measurements=getMeasurements(elem,direction),measurements.base>0?{base:measurements.base-measurements.padding-measurements.border,outer:measurements.base,outerfull:measurements.base+measurements.margin}[measure]:(computedStyle=getStyle(elem),result=computedStyle[direction],(0>result||null===result)&&(result=elem.style[direction]||0),result=parseFloat(result)||0,{base:result-measurements.padding-measurements.border,outer:result,outerfull:result+measurements.padding+measurements.border+measurements.margin}[measure])},angular.forEach({before:function(newElem){var children,elem,i,parent,self,_i,_ref;if(self=this,elem=self[0],parent=self.parent(),children=parent.contents(),children[0]===elem)return parent.prepend(newElem);for(i=_i=1,_ref=children.length-1;_ref>=1?_ref>=_i:_i>=_ref;i=_ref>=1?++_i:--_i)if(children[i]===elem)return void angular.element(children[i-1]).after(newElem);throw new Error("invalid DOM structure "+elem.outerHTML)},height:function(value){var self;return self=this,angular.isDefined(value)?(angular.isNumber(value)&&(value+="px"),css.call(self,"height",value)):getWidthHeight(this[0],"height","base")},outerHeight:function(option){return getWidthHeight(this[0],"height",option?"outerfull":"outer")},offset:function(value){var box,doc,docElem,elem,self,win;return self=this,arguments.length?void 0===value?self:value:(box={top:0,left:0},elem=self[0],(doc=elem&&elem.ownerDocument)?(docElem=doc.documentElement,elem.getBoundingClientRect&&(box=elem.getBoundingClientRect()),win=doc.defaultView||doc.parentWindow,{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):void 0)},scrollTop:function(value){return scrollTo(this,"top",value)},scrollLeft:function(value){return scrollTo(this,"left",value)}},function(value,key){return element.prototype[key]?void 0:element.prototype[key]=value})}}}]).run(["$log","$window","jqLiteExtras",function(console,window,jqLiteExtras){return window.jQuery?void 0:jqLiteExtras.registerFor(angular.element)}]),angular.module("ui.scroll",[]).directive("ngScrollViewport",["$log",function(){return{controller:["$scope","$element",function(scope,element){return element}]}}]).directive("ngScroll",["$log","$injector","$rootScope","$timeout",function(console,$injector,$rootScope,$timeout){return{require:["?^ngScrollViewport"],transclude:"element",priority:1e3,terminal:!0,compile:function(element,attr,linker){return function($scope,$element,$attr,controllers){var adapter,adjustBuffer,adjustRowHeight,bof,bottomVisiblePos,buffer,bufferPadding,bufferSize,clipBottom,clipTop,datasource,datasourceName,enqueueFetch,eof,eventListener,fetch,finalize,first,insert,isDatasource,isLoading,itemName,loading,match,next,pending,reload,removeFromBuffer,resizeHandler,scrollHandler,scrollHeight,shouldLoadBottom,shouldLoadTop,tempScope,topVisiblePos,viewport;if(match=$attr.ngScroll.match(/^\s*(\w+)\s+in\s+(\w+)\s*$/),!match)throw new Error('Expected ngScroll in form of "item_ in _datasource_" but got "'+$attr.ngScroll+'"');if(itemName=match[1],datasourceName=match[2],isDatasource=function(datasource){return angular.isObject(datasource)&&datasource.get&&angular.isFunction(datasource.get)},datasource=$scope[datasourceName],!isDatasource(datasource)&&(datasource=$injector.get(datasourceName),!isDatasource(datasource)))throw new Error(datasourceName+" is not a valid datasource");return bufferSize=Math.max(3,+$attr.bufferSize||10),bufferPadding=function(){return viewport.height()*Math.max(.1,+$attr.padding||.1)},scrollHeight=function(elem){return elem[0].scrollHeight||elem[0].document.documentElement.scrollHeight},adapter=null,linker(tempScope=$scope.$new(),function(template){var bottomPadding,createPadding,padding,repeaterType,topPadding,viewport;if(repeaterType=template[0].localName,"dl"===repeaterType)throw new Error("ng-scroll directive does not support <"+template[0].localName+"> as a repeating tag: "+template[0].outerHTML);return"li"!==repeaterType&&"tr"!==repeaterType&&(repeaterType="div"),viewport=controllers[0]||angular.element(window),viewport.css({"overflow-y":"auto",display:"block"}),padding=function(repeaterType){var div,result,table;switch(repeaterType){case"tr":return table=angular.element("<table><tr><td><div></div></td></tr></table>"),div=table.find("div"),result=table.find("tr"),result.paddingHeight=function(){return div.height.apply(div,arguments)},result;default:return result=angular.element("<"+repeaterType+"></"+repeaterType+">"),result.paddingHeight=result.height,result}},createPadding=function(padding,element,direction){return element[{top:"before",bottom:"after"}[direction]](padding),{paddingHeight:function(){return padding.paddingHeight.apply(padding,arguments)},insert:function(element){return padding[{top:"after",bottom:"before"}[direction]](element)}}},topPadding=createPadding(padding(repeaterType),element,"top"),bottomPadding=createPadding(padding(repeaterType),element,"bottom"),tempScope.$destroy(),adapter={viewport:viewport,topPadding:topPadding.paddingHeight,bottomPadding:bottomPadding.paddingHeight,append:bottomPadding.insert,prepend:topPadding.insert,bottomDataPos:function(){return scrollHeight(viewport)-bottomPadding.paddingHeight()},topDataPos:function(){return topPadding.paddingHeight()}}}),viewport=adapter.viewport,first=1,next=1,buffer=[],pending=[],eof=!1,bof=!1,loading=datasource.loading||function(){},isLoading=!1,removeFromBuffer=function(start,stop){var i,_i;for(i=_i=start;stop>=start?stop>_i:_i>stop;i=stop>=start?++_i:--_i)buffer[i].scope.$destroy(),buffer[i].element.remove();return buffer.splice(start,stop-start)},reload=function(){return first=1,next=1,removeFromBuffer(0,buffer.length),adapter.topPadding(0),adapter.bottomPadding(0),pending=[],eof=!1,bof=!1,adjustBuffer(!1)},bottomVisiblePos=function(){return viewport.scrollTop()+viewport.height()},topVisiblePos=function(){return viewport.scrollTop()},shouldLoadBottom=function(){return!eof&&adapter.bottomDataPos()<bottomVisiblePos()+bufferPadding()},clipBottom=function(){var bottomHeight,i,itemHeight,overage,_i,_ref;for(bottomHeight=0,overage=0,i=_i=_ref=buffer.length-1;(0>=_ref?0>=_i:_i>=0)&&(itemHeight=buffer[i].element.outerHeight(!0),adapter.bottomDataPos()-bottomHeight-itemHeight>bottomVisiblePos()+bufferPadding());i=0>=_ref?++_i:--_i)bottomHeight+=itemHeight,overage++,eof=!1;return overage>0?(adapter.bottomPadding(adapter.bottomPadding()+bottomHeight),removeFromBuffer(buffer.length-overage,buffer.length),next-=overage,console.log("clipped off bottom "+overage+" bottom padding "+adapter.bottomPadding())):void 0},shouldLoadTop=function(){return!bof&&adapter.topDataPos()>topVisiblePos()-bufferPadding()},clipTop=function(){var item,itemHeight,overage,topHeight,_i,_len;for(topHeight=0,overage=0,_i=0,_len=buffer.length;_len>_i&&(item=buffer[_i],itemHeight=item.element.outerHeight(!0),adapter.topDataPos()+topHeight+itemHeight<topVisiblePos()-bufferPadding());_i++)topHeight+=itemHeight,overage++,bof=!1;return overage>0?(adapter.topPadding(adapter.topPadding()+topHeight),removeFromBuffer(0,overage),first+=overage,console.log("clipped off top "+overage+" top padding "+adapter.topPadding())):void 0},enqueueFetch=function(direction,scrolling){return isLoading||(isLoading=!0,loading(!0)),1===pending.push(direction)?fetch(scrolling):void 0},insert=function(index,item){var itemScope,toBeAppended,wrapper;return itemScope=$scope.$new(),itemScope[itemName]=item,toBeAppended=index>first,itemScope.$index=index,toBeAppended&&itemScope.$index--,wrapper={scope:itemScope},linker(itemScope,function(clone){return wrapper.element=clone,toBeAppended?index===next?(adapter.append(clone),buffer.push(wrapper)):(buffer[index-first].element.after(clone),buffer.splice(index-first+1,0,wrapper)):(adapter.prepend(clone),buffer.unshift(wrapper))}),{appended:toBeAppended,wrapper:wrapper}},adjustRowHeight=function(appended,wrapper){var newHeight;return appended?adapter.bottomPadding(Math.max(0,adapter.bottomPadding()-wrapper.element.outerHeight(!0))):(newHeight=adapter.topPadding()-wrapper.element.outerHeight(!0),newHeight>=0?adapter.topPadding(newHeight):viewport.scrollTop(viewport.scrollTop()+wrapper.element.outerHeight(!0)))},adjustBuffer=function(scrolling,newItems,finalize){var doAdjustment;return doAdjustment=function(){return console.log("top {actual="+adapter.topDataPos()+" visible from="+topVisiblePos()+" bottom {visible through="+bottomVisiblePos()+" actual="+adapter.bottomDataPos()+"}"),shouldLoadBottom()?enqueueFetch(!0,scrolling):shouldLoadTop()&&enqueueFetch(!1,scrolling),finalize?finalize():void 0},newItems?$timeout(function(){var row,_i,_len;for(_i=0,_len=newItems.length;_len>_i;_i++)row=newItems[_i],adjustRowHeight(row.appended,row.wrapper);return doAdjustment()}):doAdjustment()},finalize=function(scrolling,newItems){return adjustBuffer(scrolling,newItems,function(){return pending.shift(),0===pending.length?(isLoading=!1,loading(!1)):fetch(scrolling)})},fetch=function(scrolling){var direction;return direction=pending[0],direction?buffer.length&&!shouldLoadBottom()?finalize(scrolling):datasource.get(next,bufferSize,function(result){var item,newItems,_i,_len;if(newItems=[],0===result.length)eof=!0,adapter.bottomPadding(0),console.log("appended: requested "+bufferSize+" records starting from "+next+" recieved: eof");else{for(clipTop(),_i=0,_len=result.length;_len>_i;_i++)item=result[_i],newItems.push(insert(++next,item));console.log("appended: requested "+bufferSize+" received "+result.length+" buffer size "+buffer.length+" first "+first+" next "+next)}return finalize(scrolling,newItems)}):buffer.length&&!shouldLoadTop()?finalize(scrolling):datasource.get(first-bufferSize,bufferSize,function(result){var i,newItems,_i,_ref;if(newItems=[],0===result.length)bof=!0,adapter.topPadding(0),console.log("prepended: requested "+bufferSize+" records starting from "+(first-bufferSize)+" recieved: bof");else{for(clipBottom(),i=_i=_ref=result.length-1;0>=_ref?0>=_i:_i>=0;i=0>=_ref?++_i:--_i)newItems.unshift(insert(--first,result[i]));console.log("prepended: requested "+bufferSize+" received "+result.length+" buffer size "+buffer.length+" first "+first+" next "+next)}return finalize(scrolling,newItems)})},resizeHandler=function(){return $rootScope.$$phase||isLoading?void 0:(adjustBuffer(!1),$scope.$apply())},viewport.bind("resize",resizeHandler),scrollHandler=function(){return $rootScope.$$phase||isLoading?void 0:(adjustBuffer(!0),$scope.$apply())},viewport.bind("scroll",scrollHandler),$scope.$watch(datasource.revision,function(){return reload()}),eventListener=datasource.scope?datasource.scope.$new():$scope.$new(),$scope.$on("$destroy",function(){return eventListener.$destroy(),viewport.unbind("resize",resizeHandler),viewport.unbind("scroll",scrollHandler)}),eventListener.$on("update.items",function(event,locator,newItem){var wrapper,_fn,_i,_len,_ref;if(angular.isFunction(locator))for(_fn=function(wrapper){return locator(wrapper.scope)},_i=0,_len=buffer.length;_len>_i;_i++)wrapper=buffer[_i],_fn(wrapper);else 0<=(_ref=locator-first-1)&&_ref<buffer.length&&(buffer[locator-first-1].scope[itemName]=newItem);return null}),eventListener.$on("delete.items",function(event,locator){var i,item,temp,wrapper,_fn,_i,_j,_k,_len,_len1,_len2,_ref;if(angular.isFunction(locator)){for(temp=[],_i=0,_len=buffer.length;_len>_i;_i++)item=buffer[_i],temp.unshift(item);for(_fn=function(wrapper){return locator(wrapper.scope)?(removeFromBuffer(temp.length-1-i,temp.length-i),next--):void 0},i=_j=0,_len1=temp.length;_len1>_j;i=++_j)wrapper=temp[i],_fn(wrapper)}else 0<=(_ref=locator-first-1)&&_ref<buffer.length&&(removeFromBuffer(locator-first-1,locator-first),next--);for(i=_k=0,_len2=buffer.length;_len2>_k;i=++_k)item=buffer[i],item.scope.$index=first+i;return adjustBuffer(!1)}),eventListener.$on("insert.item",function(event,locator,item){var i,inserted,temp,wrapper,_fn,_i,_j,_k,_len,_len1,_len2,_ref;if(inserted=[],angular.isFunction(locator)){for(temp=[],_i=0,_len=buffer.length;_len>_i;_i++)item=buffer[_i],temp.unshift(item);for(_fn=function(wrapper){var j,newItems,_k,_len2,_results;if(newItems=locator(wrapper.scope)){if(insert=function(index,newItem){return insert(index,newItem),next++},angular.isArray(newItems)){for(_results=[],j=_k=0,_len2=newItems.length;_len2>_k;j=++_k)item=newItems[j],_results.push(inserted.push(insert(i+j,item)));return _results}return inserted.push(insert(i,newItems))}},i=_j=0,_len1=temp.length;_len1>_j;i=++_j)wrapper=temp[i],_fn(wrapper)}else 0<=(_ref=locator-first-1)&&_ref<buffer.length&&(inserted.push(insert(locator,item)),next++);for(i=_k=0,_len2=buffer.length;_len2>_k;i=++_k)item=buffer[i],item.scope.$index=first+i;return adjustBuffer(!1,inserted)})}}}}]),angular.module("ui.scrollfix",[]).directive("uiScrollfix",["$window",function($window){return{require:"^?uiScrollfixTarget",link:function(scope,elm,attrs,uiScrollfixTarget){function onScroll(){var offset;if(angular.isDefined($window.pageYOffset))offset=$window.pageYOffset;else{var iebody=document.compatMode&&"BackCompat"!==document.compatMode?document.documentElement:document.body;offset=iebody.scrollTop}!elm.hasClass("ui-scrollfix")&&offset>attrs.uiScrollfix?elm.addClass("ui-scrollfix"):elm.hasClass("ui-scrollfix")&&offset<attrs.uiScrollfix&&elm.removeClass("ui-scrollfix")}var top=elm[0].offsetTop,$target=uiScrollfixTarget&&uiScrollfixTarget.$element||angular.element($window);attrs.uiScrollfix?"string"==typeof attrs.uiScrollfix&&("-"===attrs.uiScrollfix.charAt(0)?attrs.uiScrollfix=top-parseFloat(attrs.uiScrollfix.substr(1)):"+"===attrs.uiScrollfix.charAt(0)&&(attrs.uiScrollfix=top+parseFloat(attrs.uiScrollfix.substr(1)))):attrs.uiScrollfix=top,$target.on("scroll",onScroll),scope.$on("$destroy",function(){$target.off("scroll",onScroll)})}}}]).directive("uiScrollfixTarget",[function(){return{controller:["$element",function($element){this.$element=$element}]}}]),angular.module("ui.showhide",[]).directive("uiShow",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiShow,function(newVal){newVal?elm.addClass("ui-show"):elm.removeClass("ui-show")
})}}]).directive("uiHide",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiHide,function(newVal){newVal?elm.addClass("ui-hide"):elm.removeClass("ui-hide")})}}]).directive("uiToggle",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiToggle,function(newVal){newVal?elm.removeClass("ui-hide").addClass("ui-show"):elm.removeClass("ui-show").addClass("ui-hide")})}}]),angular.module("ui.unique",[]).filter("unique",["$parse",function($parse){return function(items,filterOn){if(filterOn===!1)return items;if((filterOn||angular.isUndefined(filterOn))&&angular.isArray(items)){var newItems=[],get=angular.isString(filterOn)?$parse(filterOn):function(item){return item},extractValueToCompare=function(item){return angular.isObject(item)?get(item):item};angular.forEach(items,function(item){for(var isDuplicate=!1,i=0;i<newItems.length;i++)if(angular.equals(extractValueToCompare(newItems[i]),extractValueToCompare(item))){isDuplicate=!0;break}isDuplicate||newItems.push(item)}),items=newItems}return items}}]),angular.module("ui.validate",[]).directive("uiValidate",function(){return{restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ctrl){function apply_watch(watch){return angular.isString(watch)?void scope.$watch(watch,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue)})}):angular.isArray(watch)?void angular.forEach(watch,function(expression){scope.$watch(expression,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue)})})}):void(angular.isObject(watch)&&angular.forEach(watch,function(expression,validatorKey){angular.isString(expression)&&scope.$watch(expression,function(){validators[validatorKey](ctrl.$modelValue)}),angular.isArray(expression)&&angular.forEach(expression,function(intExpression){scope.$watch(intExpression,function(){validators[validatorKey](ctrl.$modelValue)})})}))}var validateFn,validators={},validateExpr=scope.$eval(attrs.uiValidate);validateExpr&&(angular.isString(validateExpr)&&(validateExpr={validator:validateExpr}),angular.forEach(validateExpr,function(exprssn,key){validateFn=function(valueToValidate){var expression=scope.$eval(exprssn,{$value:valueToValidate});return angular.isObject(expression)&&angular.isFunction(expression.then)?(expression.then(function(){ctrl.$setValidity(key,!0)},function(){ctrl.$setValidity(key,!1)}),valueToValidate):expression?(ctrl.$setValidity(key,!0),valueToValidate):(ctrl.$setValidity(key,!1),valueToValidate)},validators[key]=validateFn,ctrl.$formatters.push(validateFn),ctrl.$parsers.push(validateFn)}),attrs.uiValidateWatch&&apply_watch(scope.$eval(attrs.uiValidateWatch)))}}}),angular.module("ui.utils",["ui.event","ui.format","ui.highlight","ui.include","ui.indeterminate","ui.inflector","ui.jq","ui.keypress","ui.mask","ui.reset","ui.route","ui.scrollfix","ui.scroll","ui.scroll.jqlite","ui.showhide","ui.unique","ui.validate"]),function(window,angular,undefined){"use strict";function isValidDottedPath(path){return null!=path&&""!==path&&"hasOwnProperty"!==path&&MEMBER_NAME_REGEX.test("."+path)}function lookupDottedPath(obj,path){if(!isValidDottedPath(path))throw $resourceMinErr("badmember",'Dotted member path "@{0}" is invalid.',path);for(var keys=path.split("."),i=0,ii=keys.length;ii>i&&obj!==undefined;i++){var key=keys[i];obj=null!==obj?obj[key]:undefined}return obj}function shallowClearAndCopy(src,dst){dst=dst||{},angular.forEach(dst,function(value,key){delete dst[key]});for(var key in src)!src.hasOwnProperty(key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst}var $resourceMinErr=angular.$$minErr("$resource"),MEMBER_NAME_REGEX=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;angular.module("ngResource",["ng"]).provider("$resource",function(){var provider=this;this.defaults={stripTrailingSlashes:!0,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}},this.$get=["$http","$q",function($http,$q){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template,this.defaults=extend({},provider.defaults,defaults),this.urlParams={}}function resourceFactory(url,paramDefaults,actions,options){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){isFunction(value)&&(value=value()),ids[key]=value&&value.charAt&&"@"==value.charAt(0)?lookupDottedPath(data,value.substr(1)):value}),ids}function defaultResponseInterceptor(response){return response.resource}function Resource(value){shallowClearAndCopy(value||{},this)}var route=new Route(url,options);return actions=extend({},provider.defaults.actions,actions),Resource.prototype.toJSON=function(){var data=extend({},this);return delete data.$promise,delete data.$resolved,data},forEach(actions,function(action,name){var hasBody=/^(POST|PUT|PATCH)$/i.test(action.method);Resource[name]=function(a1,a2,a3,a4){var data,success,error,params={};switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var isInstanceCall=this instanceof Resource,value=isInstanceCall?data:action.isArray?[]:new Resource(data),httpConfig={},responseInterceptor=action.interceptor&&action.interceptor.response||defaultResponseInterceptor,responseErrorInterceptor=action.interceptor&&action.interceptor.responseError||undefined;forEach(action,function(value,key){"params"!=key&&"isArray"!=key&&"interceptor"!=key&&(httpConfig[key]=copy(value))}),hasBody&&(httpConfig.data=data),route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url);var promise=$http(httpConfig).then(function(response){var data=response.data,promise=value.$promise;if(data){if(angular.isArray(data)!==!!action.isArray)throw $resourceMinErr("badcfg","Error in resource configuration for action `{0}`. Expected response to contain an {1} but got an {2}",name,action.isArray?"array":"object",angular.isArray(data)?"array":"object");action.isArray?(value.length=0,forEach(data,function(item){value.push("object"==typeof item?new Resource(item):item)})):(shallowClearAndCopy(data,value),value.$promise=promise)}return value.$resolved=!0,response.resource=value,response},function(response){return value.$resolved=!0,(error||noop)(response),$q.reject(response)});return promise=promise.then(function(response){var value=responseInterceptor(response);return(success||noop)(value,response.headers),value},responseErrorInterceptor),isInstanceCall?promise:(value.$promise=promise,value.$resolved=!1,value)},Resource.prototype["$"+name]=function(params,success,error){isFunction(params)&&(error=success,success=params,params={});var result=Resource[name].call(this,params,this,success,error);return result.$promise||result}}),Resource.bind=function(additionalParamDefaults){return resourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction;return Route.prototype={setUrlParams:function(config,params,actionUrl){var val,encodedVal,self=this,url=actionUrl||self.template,urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){if("hasOwnProperty"===param)throw $resourceMinErr("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(param)&&param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)&&(urlParams[param]=!0)}),url=url.replace(/\\:/g,":"),params=params||{},forEach(self.urlParams,function(_,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),function(match,p1){return encodedVal+p1})):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){return"/"==tail.charAt(0)?tail:leadingSlashes+tail})}),self.defaults.stripTrailingSlashes&&(url=url.replace(/\/+$/,"")||"/"),url=url.replace(/\/\.(?=\w+($|\?))/,"."),config.url=url.replace(/\/\\\./,"/."),forEach(params,function(value,key){self.urlParams[key]||(config.params=config.params||{},config.params[key]=value)})}},resourceFactory}]})}(window,window.angular),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function($q,$timeout,$rootScope){function findEndEventName(endEventNames){for(var name in endEventNames)if(void 0!==transElement.style[name])return endEventNames[name]}var $transition=function(element,trigger,options){options=options||{};var deferred=$q.defer(),endEventName=$transition[options.animation?"animationEndEventName":"transitionEndEventName"],transitionEndHandler=function(){$rootScope.$apply(function(){element.unbind(endEventName,transitionEndHandler),deferred.resolve(element)})};return endEventName&&element.bind(endEventName,transitionEndHandler),$timeout(function(){angular.isString(trigger)?element.addClass(trigger):angular.isFunction(trigger)?trigger(element):angular.isObject(trigger)&&element.css(trigger),endEventName||deferred.resolve(element)}),deferred.promise.cancel=function(){endEventName&&element.unbind(endEventName,transitionEndHandler),deferred.reject("Transition cancelled")},deferred.promise},transElement=document.createElement("trans"),transitionEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},animationEndEventNames={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return $transition.transitionEndEventName=findEndEventName(transitionEndEventNames),$transition.animationEndEventName=findEndEventName(animationEndEventNames),$transition}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function($transition){return{link:function(scope,element,attrs){function doTransition(change){function newTransitionDone(){currentTransition===newTransition&&(currentTransition=void 0)}var newTransition=$transition(element,change);return currentTransition&&currentTransition.cancel(),currentTransition=newTransition,newTransition.then(newTransitionDone,newTransitionDone),newTransition}function expand(){initialAnimSkip?(initialAnimSkip=!1,expandDone()):(element.removeClass("collapse").addClass("collapsing"),doTransition({height:element[0].scrollHeight+"px"}).then(expandDone))}function expandDone(){element.removeClass("collapsing"),element.addClass("collapse in"),element.css({height:"auto"})}function collapse(){if(initialAnimSkip)initialAnimSkip=!1,collapseDone(),element.css({height:0});else{element.css({height:element[0].scrollHeight+"px"});{element[0].offsetWidth}element.removeClass("collapse in").addClass("collapsing"),doTransition({height:0}).then(collapseDone)}}function collapseDone(){element.removeClass("collapsing"),element.addClass("collapse")}var currentTransition,initialAnimSkip=!0;scope.$watch(attrs.collapse,function(shouldCollapse){shouldCollapse?collapse():expand()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function($scope,$attrs,accordionConfig){this.groups=[],this.closeOthers=function(openGroup){var closeOthers=angular.isDefined($attrs.closeOthers)?$scope.$eval($attrs.closeOthers):accordionConfig.closeOthers;closeOthers&&angular.forEach(this.groups,function(group){group!==openGroup&&(group.isOpen=!1)})},this.addGroup=function(groupScope){var that=this;this.groups.push(groupScope),groupScope.$on("$destroy",function(){that.removeGroup(groupScope)})},this.removeGroup=function(group){var index=this.groups.indexOf(group);-1!==index&&this.groups.splice(index,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(element){this.heading=element}},link:function(scope,element,attrs,accordionCtrl){accordionCtrl.addGroup(scope),scope.$watch("isOpen",function(value){value&&accordionCtrl.closeOthers(scope)}),scope.toggleOpen=function(){scope.isDisabled||(scope.isOpen=!scope.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(scope,element,attr,accordionGroupCtrl,transclude){accordionGroupCtrl.setHeading(transclude(scope,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(scope,element,attr,controller){scope.$watch(function(){return controller[attr.accordionTransclude]},function(heading){heading&&(element.html(""),element.append(heading))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function($scope,$attrs){$scope.closeable="close"in $attrs,this.close=$scope.close}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}).directive("dismissOnTimeout",["$timeout",function($timeout){return{require:"alert",link:function(scope,element,attrs,alertCtrl){$timeout(function(){alertCtrl.close()},parseInt(attrs.dismissOnTimeout,10))}}}]),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.bindHtmlUnsafe),scope.$watch(attr.bindHtmlUnsafe,function(value){element.html(value||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(buttonConfig){this.activeClass=buttonConfig.activeClass||"active",this.toggleEvent=buttonConfig.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(scope,element,attrs,ctrls){var buttonsCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl.$render=function(){element.toggleClass(buttonsCtrl.activeClass,angular.equals(ngModelCtrl.$modelValue,scope.$eval(attrs.btnRadio)))},element.bind(buttonsCtrl.toggleEvent,function(){var isActive=element.hasClass(buttonsCtrl.activeClass);(!isActive||angular.isDefined(attrs.uncheckable))&&scope.$apply(function(){ngModelCtrl.$setViewValue(isActive?null:scope.$eval(attrs.btnRadio)),ngModelCtrl.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(scope,element,attrs,ctrls){function getTrueValue(){return getCheckboxValue(attrs.btnCheckboxTrue,!0)}function getFalseValue(){return getCheckboxValue(attrs.btnCheckboxFalse,!1)}function getCheckboxValue(attributeValue,defaultValue){var val=scope.$eval(attributeValue);return angular.isDefined(val)?val:defaultValue}var buttonsCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl.$render=function(){element.toggleClass(buttonsCtrl.activeClass,angular.equals(ngModelCtrl.$modelValue,getTrueValue()))},element.bind(buttonsCtrl.toggleEvent,function(){scope.$apply(function(){ngModelCtrl.$setViewValue(element.hasClass(buttonsCtrl.activeClass)?getFalseValue():getTrueValue()),ngModelCtrl.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$interval","$transition",function($scope,$timeout,$interval,$transition){function restartTimer(){resetTimer();var interval=+$scope.interval;!isNaN(interval)&&interval>0&&(currentInterval=$interval(timerFn,interval))}function resetTimer(){currentInterval&&($interval.cancel(currentInterval),currentInterval=null)}function timerFn(){var interval=+$scope.interval;isPlaying&&!isNaN(interval)&&interval>0?$scope.next():$scope.pause()}var currentInterval,isPlaying,self=this,slides=self.slides=$scope.slides=[],currentIndex=-1;self.currentSlide=null;var destroyed=!1;self.select=$scope.select=function(nextSlide,direction){function goNext(){if(!destroyed){if(self.currentSlide&&angular.isString(direction)&&!$scope.noTransition&&nextSlide.$element){nextSlide.$element.addClass(direction);{nextSlide.$element[0].offsetWidth}angular.forEach(slides,function(slide){angular.extend(slide,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(nextSlide,{direction:direction,active:!0,entering:!0}),angular.extend(self.currentSlide||{},{direction:direction,leaving:!0}),$scope.$currentTransition=$transition(nextSlide.$element,{}),function(next,current){$scope.$currentTransition.then(function(){transitionDone(next,current)},function(){transitionDone(next,current)})}(nextSlide,self.currentSlide)}else transitionDone(nextSlide,self.currentSlide);self.currentSlide=nextSlide,currentIndex=nextIndex,restartTimer()}}function transitionDone(next,current){angular.extend(next,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(current||{},{direction:"",active:!1,leaving:!1,entering:!1}),$scope.$currentTransition=null}var nextIndex=slides.indexOf(nextSlide);void 0===direction&&(direction=nextIndex>currentIndex?"next":"prev"),nextSlide&&nextSlide!==self.currentSlide&&($scope.$currentTransition?($scope.$currentTransition.cancel(),$timeout(goNext)):goNext())},$scope.$on("$destroy",function(){destroyed=!0}),self.indexOfSlide=function(slide){return slides.indexOf(slide)},$scope.next=function(){var newIndex=(currentIndex+1)%slides.length;return $scope.$currentTransition?void 0:self.select(slides[newIndex],"next")},$scope.prev=function(){var newIndex=0>currentIndex-1?slides.length-1:currentIndex-1;return $scope.$currentTransition?void 0:self.select(slides[newIndex],"prev")},$scope.isActive=function(slide){return self.currentSlide===slide},$scope.$watch("interval",restartTimer),$scope.$on("$destroy",resetTimer),$scope.play=function(){isPlaying||(isPlaying=!0,restartTimer())},$scope.pause=function(){$scope.noPause||(isPlaying=!1,resetTimer())},self.addSlide=function(slide,element){slide.$element=element,slides.push(slide),1===slides.length||slide.active?(self.select(slides[slides.length-1]),1==slides.length&&$scope.play()):slide.active=!1},self.removeSlide=function(slide){var index=slides.indexOf(slide);slides.splice(index,1),slides.length>0&&slide.active?self.select(index>=slides.length?slides[index-1]:slides[index]):currentIndex>index&&currentIndex--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(scope,element,attrs,carouselCtrl){carouselCtrl.addSlide(scope,element),scope.$on("$destroy",function(){carouselCtrl.removeSlide(scope)}),scope.$watch("active",function(active){active&&carouselCtrl.select(scope)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function($locale,orderByFilter){function createParser(format){var map=[],regex=format.split("");return angular.forEach(formatCodeToRegex,function(data,code){var index=format.indexOf(code);if(index>-1){format=format.split(""),regex[index]="("+data.regex+")",format[index]="$";for(var i=index+1,n=index+code.length;n>i;i++)regex[i]="",format[i]="$";format=format.join(""),map.push({index:index,apply:data.apply})}}),{regex:new RegExp("^"+regex.join("")+"$"),map:orderByFilter(map,"index")}}function isValid(year,month,date){return 1===month&&date>28?29===date&&(year%4===0&&year%100!==0||year%400===0):3===month||5===month||8===month||10===month?31>date:!0}this.parsers={};var formatCodeToRegex={yyyy:{regex:"\\d{4}",apply:function(value){this.year=+value}},yy:{regex:"\\d{2}",apply:function(value){this.year=+value+2e3}},y:{regex:"\\d{1,4}",apply:function(value){this.year=+value}},MMMM:{regex:$locale.DATETIME_FORMATS.MONTH.join("|"),apply:function(value){this.month=$locale.DATETIME_FORMATS.MONTH.indexOf(value)}},MMM:{regex:$locale.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(value){this.month=$locale.DATETIME_FORMATS.SHORTMONTH.indexOf(value)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(value){this.month=value-1}},M:{regex:"[1-9]|1[0-2]",apply:function(value){this.month=value-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(value){this.date=+value}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(value){this.date=+value}},EEEE:{regex:$locale.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:$locale.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(input,format){if(!angular.isString(input)||!format)return input;format=$locale.DATETIME_FORMATS[format]||format,this.parsers[format]||(this.parsers[format]=createParser(format));var parser=this.parsers[format],regex=parser.regex,map=parser.map,results=input.match(regex);if(results&&results.length){for(var dt,fields={year:1900,month:0,date:1,hours:0},i=1,n=results.length;n>i;i++){var mapper=map[i-1];mapper.apply&&mapper.apply.call(fields,results[i])}return isValid(fields.year,fields.month,fields.date)&&(dt=new Date(fields.year,fields.month,fields.date,fields.hours)),dt}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function($document,$window){function getStyle(el,cssprop){return el.currentStyle?el.currentStyle[cssprop]:$window.getComputedStyle?$window.getComputedStyle(el)[cssprop]:el.style[cssprop]}function isStaticPositioned(element){return"static"===(getStyle(element,"position")||"static")}var parentOffsetEl=function(element){for(var docDomEl=$document[0],offsetParent=element.offsetParent||docDomEl;offsetParent&&offsetParent!==docDomEl&&isStaticPositioned(offsetParent);)offsetParent=offsetParent.offsetParent;return offsetParent||docDomEl};return{position:function(element){var elBCR=this.offset(element),offsetParentBCR={top:0,left:0},offsetParentEl=parentOffsetEl(element[0]);offsetParentEl!=$document[0]&&(offsetParentBCR=this.offset(angular.element(offsetParentEl)),offsetParentBCR.top+=offsetParentEl.clientTop-offsetParentEl.scrollTop,offsetParentBCR.left+=offsetParentEl.clientLeft-offsetParentEl.scrollLeft);var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:elBCR.top-offsetParentBCR.top,left:elBCR.left-offsetParentBCR.left}},offset:function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].documentElement.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].documentElement.scrollLeft)}},positionElements:function(hostEl,targetEl,positionStr,appendToBody){var hostElPos,targetElWidth,targetElHeight,targetElPos,positionStrParts=positionStr.split("-"),pos0=positionStrParts[0],pos1=positionStrParts[1]||"center";hostElPos=appendToBody?this.offset(hostEl):this.position(hostEl),targetElWidth=targetEl.prop("offsetWidth"),targetElHeight=targetEl.prop("offsetHeight");var shiftWidth={center:function(){return hostElPos.left+hostElPos.width/2-targetElWidth/2},left:function(){return hostElPos.left},right:function(){return hostElPos.left+hostElPos.width}},shiftHeight={center:function(){return hostElPos.top+hostElPos.height/2-targetElHeight/2},top:function(){return hostElPos.top},bottom:function(){return hostElPos.top+hostElPos.height}};switch(pos0){case"right":targetElPos={top:shiftHeight[pos1](),left:shiftWidth[pos0]()};break;case"left":targetElPos={top:shiftHeight[pos1](),left:hostElPos.left-targetElWidth};break;case"bottom":targetElPos={top:shiftHeight[pos0](),left:shiftWidth[pos1]()};break;default:targetElPos={top:hostElPos.top-targetElHeight,left:shiftWidth[pos1]()}}return targetElPos}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function($scope,$attrs,$parse,$interpolate,$timeout,$log,dateFilter,datepickerConfig){var self=this,ngModelCtrl={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(key,index){self[key]=angular.isDefined($attrs[key])?8>index?$interpolate($attrs[key])($scope.$parent):$scope.$parent.$eval($attrs[key]):datepickerConfig[key]}),angular.forEach(["minDate","maxDate"],function(key){$attrs[key]?$scope.$parent.$watch($parse($attrs[key]),function(value){self[key]=value?new Date(value):null,self.refreshView()}):self[key]=datepickerConfig[key]?new Date(datepickerConfig[key]):null}),$scope.datepickerMode=$scope.datepickerMode||datepickerConfig.datepickerMode,$scope.uniqueId="datepicker-"+$scope.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined($attrs.initDate)?$scope.$parent.$eval($attrs.initDate):new Date,$scope.isActive=function(dateObject){return 0===self.compare(dateObject.date,self.activeDate)?($scope.activeDateId=dateObject.uid,!0):!1},this.init=function(ngModelCtrl_){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=function(){self.render()}},this.render=function(){if(ngModelCtrl.$modelValue){var date=new Date(ngModelCtrl.$modelValue),isValid=!isNaN(date);isValid?this.activeDate=date:$log.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),ngModelCtrl.$setValidity("date",isValid)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var date=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;ngModelCtrl.$setValidity("date-disabled",!date||this.element&&!this.isDisabled(date))}},this.createDateObject=function(date,format){var model=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;return{date:date,label:dateFilter(date,format),selected:model&&0===this.compare(date,model),disabled:this.isDisabled(date),current:0===this.compare(date,new Date)}},this.isDisabled=function(date){return this.minDate&&this.compare(date,this.minDate)<0||this.maxDate&&this.compare(date,this.maxDate)>0||$attrs.dateDisabled&&$scope.dateDisabled({date:date,mode:$scope.datepickerMode})},this.split=function(arr,size){for(var arrays=[];arr.length>0;)arrays.push(arr.splice(0,size));return arrays},$scope.select=function(date){if($scope.datepickerMode===self.minMode){var dt=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):new Date(0,0,0,0,0,0,0);dt.setFullYear(date.getFullYear(),date.getMonth(),date.getDate()),ngModelCtrl.$setViewValue(dt),ngModelCtrl.$render()}else self.activeDate=date,$scope.datepickerMode=self.modes[self.modes.indexOf($scope.datepickerMode)-1]},$scope.move=function(direction){var year=self.activeDate.getFullYear()+direction*(self.step.years||0),month=self.activeDate.getMonth()+direction*(self.step.months||0);self.activeDate.setFullYear(year,month,1),self.refreshView()},$scope.toggleMode=function(direction){direction=direction||1,$scope.datepickerMode===self.maxMode&&1===direction||$scope.datepickerMode===self.minMode&&-1===direction||($scope.datepickerMode=self.modes[self.modes.indexOf($scope.datepickerMode)+direction])},$scope.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var focusElement=function(){$timeout(function(){self.element[0].focus()},0,!1)};$scope.$on("datepicker.focus",focusElement),$scope.keydown=function(evt){var key=$scope.keys[evt.which];if(key&&!evt.shiftKey&&!evt.altKey)if(evt.preventDefault(),evt.stopPropagation(),"enter"===key||"space"===key){if(self.isDisabled(self.activeDate))return;$scope.select(self.activeDate),focusElement()}else!evt.ctrlKey||"up"!==key&&"down"!==key?(self.handleKeyDown(key,evt),self.refreshView()):($scope.toggleMode("up"===key?1:-1),focusElement())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(scope,element,attrs,ctrls){var datepickerCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&datepickerCtrl.init(ngModelCtrl)}}}).directive("daypicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){function getDaysInMonth(year,month){return 1!==month||year%4!==0||year%100===0&&year%400!==0?DAYS_IN_MONTH[month]:29}function getDates(startDate,n){var dates=new Array(n),current=new Date(startDate),i=0;for(current.setHours(12);n>i;)dates[i++]=new Date(current),current.setDate(current.getDate()+1);return dates}function getISO8601WeekNumber(date){var checkDate=new Date(date);checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();return checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1
}scope.showWeeks=ctrl.showWeeks,ctrl.step={months:1},ctrl.element=element;var DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];ctrl._refreshView=function(){var year=ctrl.activeDate.getFullYear(),month=ctrl.activeDate.getMonth(),firstDayOfMonth=new Date(year,month,1),difference=ctrl.startingDay-firstDayOfMonth.getDay(),numDisplayedFromPreviousMonth=difference>0?7-difference:-difference,firstDate=new Date(firstDayOfMonth);numDisplayedFromPreviousMonth>0&&firstDate.setDate(-numDisplayedFromPreviousMonth+1);for(var days=getDates(firstDate,42),i=0;42>i;i++)days[i]=angular.extend(ctrl.createDateObject(days[i],ctrl.formatDay),{secondary:days[i].getMonth()!==month,uid:scope.uniqueId+"-"+i});scope.labels=new Array(7);for(var j=0;7>j;j++)scope.labels[j]={abbr:dateFilter(days[j].date,ctrl.formatDayHeader),full:dateFilter(days[j].date,"EEEE")};if(scope.title=dateFilter(ctrl.activeDate,ctrl.formatDayTitle),scope.rows=ctrl.split(days,7),scope.showWeeks){scope.weekNumbers=[];for(var weekNumber=getISO8601WeekNumber(scope.rows[0][0].date),numWeeks=scope.rows.length;scope.weekNumbers.push(weekNumber++)<numWeeks;);}},ctrl.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth(),date1.getDate())-new Date(date2.getFullYear(),date2.getMonth(),date2.getDate())},ctrl.handleKeyDown=function(key){var date=ctrl.activeDate.getDate();if("left"===key)date-=1;else if("up"===key)date-=7;else if("right"===key)date+=1;else if("down"===key)date+=7;else if("pageup"===key||"pagedown"===key){var month=ctrl.activeDate.getMonth()+("pageup"===key?-1:1);ctrl.activeDate.setMonth(month,1),date=Math.min(getDaysInMonth(ctrl.activeDate.getFullYear(),ctrl.activeDate.getMonth()),date)}else"home"===key?date=1:"end"===key&&(date=getDaysInMonth(ctrl.activeDate.getFullYear(),ctrl.activeDate.getMonth()));ctrl.activeDate.setDate(date)},ctrl.refreshView()}}}]).directive("monthpicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){ctrl.step={years:1},ctrl.element=element,ctrl._refreshView=function(){for(var months=new Array(12),year=ctrl.activeDate.getFullYear(),i=0;12>i;i++)months[i]=angular.extend(ctrl.createDateObject(new Date(year,i,1),ctrl.formatMonth),{uid:scope.uniqueId+"-"+i});scope.title=dateFilter(ctrl.activeDate,ctrl.formatMonthTitle),scope.rows=ctrl.split(months,3)},ctrl.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth())-new Date(date2.getFullYear(),date2.getMonth())},ctrl.handleKeyDown=function(key){var date=ctrl.activeDate.getMonth();if("left"===key)date-=1;else if("up"===key)date-=3;else if("right"===key)date+=1;else if("down"===key)date+=3;else if("pageup"===key||"pagedown"===key){var year=ctrl.activeDate.getFullYear()+("pageup"===key?-1:1);ctrl.activeDate.setFullYear(year)}else"home"===key?date=0:"end"===key&&(date=11);ctrl.activeDate.setMonth(date)},ctrl.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){function getStartingYear(year){return parseInt((year-1)/range,10)*range+1}var range=ctrl.yearRange;ctrl.step={years:range},ctrl.element=element,ctrl._refreshView=function(){for(var years=new Array(range),i=0,start=getStartingYear(ctrl.activeDate.getFullYear());range>i;i++)years[i]=angular.extend(ctrl.createDateObject(new Date(start+i,0,1),ctrl.formatYear),{uid:scope.uniqueId+"-"+i});scope.title=[years[0].label,years[range-1].label].join(" - "),scope.rows=ctrl.split(years,5)},ctrl.compare=function(date1,date2){return date1.getFullYear()-date2.getFullYear()},ctrl.handleKeyDown=function(key){var date=ctrl.activeDate.getFullYear();"left"===key?date-=1:"up"===key?date-=5:"right"===key?date+=1:"down"===key?date+=5:"pageup"===key||"pagedown"===key?date+=("pageup"===key?-1:1)*ctrl.step.years:"home"===key?date=getStartingYear(ctrl.activeDate.getFullYear()):"end"===key&&(date=getStartingYear(ctrl.activeDate.getFullYear())+range-1),ctrl.activeDate.setFullYear(date)},ctrl.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function($compile,$parse,$document,$position,dateFilter,dateParser,datepickerPopupConfig){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(scope,element,attrs,ngModel){function cameltoDash(string){return string.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})}function parseDate(viewValue){if(viewValue){if(angular.isDate(viewValue)&&!isNaN(viewValue))return ngModel.$setValidity("date",!0),viewValue;if(angular.isString(viewValue)){var date=dateParser.parse(viewValue,dateFormat)||new Date(viewValue);return isNaN(date)?void ngModel.$setValidity("date",!1):(ngModel.$setValidity("date",!0),date)}return void ngModel.$setValidity("date",!1)}return ngModel.$setValidity("date",!0),null}var dateFormat,closeOnDateSelection=angular.isDefined(attrs.closeOnDateSelection)?scope.$parent.$eval(attrs.closeOnDateSelection):datepickerPopupConfig.closeOnDateSelection,appendToBody=angular.isDefined(attrs.datepickerAppendToBody)?scope.$parent.$eval(attrs.datepickerAppendToBody):datepickerPopupConfig.appendToBody;scope.showButtonBar=angular.isDefined(attrs.showButtonBar)?scope.$parent.$eval(attrs.showButtonBar):datepickerPopupConfig.showButtonBar,scope.getText=function(key){return scope[key+"Text"]||datepickerPopupConfig[key+"Text"]},attrs.$observe("datepickerPopup",function(value){dateFormat=value||datepickerPopupConfig.datepickerPopup,ngModel.$render()});var popupEl=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");popupEl.attr({"ng-model":"date","ng-change":"dateSelection()"});var datepickerEl=angular.element(popupEl.children()[0]);attrs.datepickerOptions&&angular.forEach(scope.$parent.$eval(attrs.datepickerOptions),function(value,option){datepickerEl.attr(cameltoDash(option),value)}),scope.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(key){if(attrs[key]){var getAttribute=$parse(attrs[key]);if(scope.$parent.$watch(getAttribute,function(value){scope.watchData[key]=value}),datepickerEl.attr(cameltoDash(key),"watchData."+key),"datepickerMode"===key){var setAttribute=getAttribute.assign;scope.$watch("watchData."+key,function(value,oldvalue){value!==oldvalue&&setAttribute(scope.$parent,value)})}}}),attrs.dateDisabled&&datepickerEl.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),ngModel.$parsers.unshift(parseDate),scope.dateSelection=function(dt){angular.isDefined(dt)&&(scope.date=dt),ngModel.$setViewValue(scope.date),ngModel.$render(),closeOnDateSelection&&(scope.isOpen=!1,element[0].focus())},element.bind("input change keyup",function(){scope.$apply(function(){scope.date=ngModel.$modelValue})}),ngModel.$render=function(){var date=ngModel.$viewValue?dateFilter(ngModel.$viewValue,dateFormat):"";element.val(date),scope.date=parseDate(ngModel.$modelValue)};var documentClickBind=function(event){scope.isOpen&&event.target!==element[0]&&scope.$apply(function(){scope.isOpen=!1})},keydown=function(evt){scope.keydown(evt)};element.bind("keydown",keydown),scope.keydown=function(evt){27===evt.which?(evt.preventDefault(),evt.stopPropagation(),scope.close()):40!==evt.which||scope.isOpen||(scope.isOpen=!0)},scope.$watch("isOpen",function(value){value?(scope.$broadcast("datepicker.focus"),scope.position=appendToBody?$position.offset(element):$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),$document.bind("click",documentClickBind)):$document.unbind("click",documentClickBind)}),scope.select=function(date){if("today"===date){var today=new Date;angular.isDate(ngModel.$modelValue)?(date=new Date(ngModel.$modelValue),date.setFullYear(today.getFullYear(),today.getMonth(),today.getDate())):date=new Date(today.setHours(0,0,0,0))}scope.dateSelection(date)},scope.close=function(){scope.isOpen=!1,element[0].focus()};var $popup=$compile(popupEl)(scope);popupEl.remove(),appendToBody?$document.find("body").append($popup):element.after($popup),scope.$on("$destroy",function(){$popup.remove(),element.unbind("keydown",keydown),$document.unbind("click",documentClickBind)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(scope,element){element.bind("click",function(event){event.preventDefault(),event.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function($document){var openScope=null;this.open=function(dropdownScope){openScope||($document.bind("click",closeDropdown),$document.bind("keydown",escapeKeyBind)),openScope&&openScope!==dropdownScope&&(openScope.isOpen=!1),openScope=dropdownScope},this.close=function(dropdownScope){openScope===dropdownScope&&(openScope=null,$document.unbind("click",closeDropdown),$document.unbind("keydown",escapeKeyBind))};var closeDropdown=function(evt){if(openScope){var toggleElement=openScope.getToggleElement();evt&&toggleElement&&toggleElement[0].contains(evt.target)||openScope.$apply(function(){openScope.isOpen=!1})}},escapeKeyBind=function(evt){27===evt.which&&(openScope.focusToggleElement(),closeDropdown())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function($scope,$attrs,$parse,dropdownConfig,dropdownService,$animate){var getIsOpen,self=this,scope=$scope.$new(),openClass=dropdownConfig.openClass,setIsOpen=angular.noop,toggleInvoker=$attrs.onToggle?$parse($attrs.onToggle):angular.noop;this.init=function(element){self.$element=element,$attrs.isOpen&&(getIsOpen=$parse($attrs.isOpen),setIsOpen=getIsOpen.assign,$scope.$watch(getIsOpen,function(value){scope.isOpen=!!value}))},this.toggle=function(open){return scope.isOpen=arguments.length?!!open:!scope.isOpen},this.isOpen=function(){return scope.isOpen},scope.getToggleElement=function(){return self.toggleElement},scope.focusToggleElement=function(){self.toggleElement&&self.toggleElement[0].focus()},scope.$watch("isOpen",function(isOpen,wasOpen){$animate[isOpen?"addClass":"removeClass"](self.$element,openClass),isOpen?(scope.focusToggleElement(),dropdownService.open(scope)):dropdownService.close(scope),setIsOpen($scope,isOpen),angular.isDefined(isOpen)&&isOpen!==wasOpen&&toggleInvoker($scope,{open:!!isOpen})}),$scope.$on("$locationChangeSuccess",function(){scope.isOpen=!1}),$scope.$on("$destroy",function(){scope.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(scope,element,attrs,dropdownCtrl){dropdownCtrl.init(element)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(scope,element,attrs,dropdownCtrl){if(dropdownCtrl){dropdownCtrl.toggleElement=element;var toggleDropdown=function(event){event.preventDefault(),element.hasClass("disabled")||attrs.disabled||scope.$apply(function(){dropdownCtrl.toggle()})};element.bind("click",toggleDropdown),element.attr({"aria-haspopup":!0,"aria-expanded":!1}),scope.$watch(dropdownCtrl.isOpen,function(isOpen){element.attr("aria-expanded",!!isOpen)}),scope.$on("$destroy",function(){element.unbind("click",toggleDropdown)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var stack=[];return{add:function(key,value){stack.push({key:key,value:value})},get:function(key){for(var i=0;i<stack.length;i++)if(key==stack[i].key)return stack[i]},keys:function(){for(var keys=[],i=0;i<stack.length;i++)keys.push(stack[i].key);return keys},top:function(){return stack[stack.length-1]},remove:function(key){for(var idx=-1,i=0;i<stack.length;i++)if(key==stack[i].key){idx=i;break}return stack.splice(idx,1)[0]},removeTop:function(){return stack.splice(stack.length-1,1)[0]},length:function(){return stack.length}}}}}).directive("modalBackdrop",["$timeout",function($timeout){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(scope,element,attrs){scope.backdropClass=attrs.backdropClass||"",scope.animate=!1,$timeout(function(){scope.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function($modalStack,$timeout){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(tElement,tAttrs){return tAttrs.templateUrl||"template/modal/window.html"},link:function(scope,element,attrs){element.addClass(attrs.windowClass||""),scope.size=attrs.size,$timeout(function(){scope.animate=!0,element[0].querySelectorAll("[autofocus]").length||element[0].focus()}),scope.close=function(evt){var modal=$modalStack.getTop();modal&&modal.value.backdrop&&"static"!=modal.value.backdrop&&evt.target===evt.currentTarget&&(evt.preventDefault(),evt.stopPropagation(),$modalStack.dismiss(modal.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function($scope,$element,$attrs,controller,$transclude){$transclude($scope.$parent,function(clone){$element.empty(),$element.append(clone)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function($transition,$timeout,$document,$compile,$rootScope,$$stackedMap){function backdropIndex(){for(var topBackdropIndex=-1,opened=openedWindows.keys(),i=0;i<opened.length;i++)openedWindows.get(opened[i]).value.backdrop&&(topBackdropIndex=i);return topBackdropIndex}function removeModalWindow(modalInstance){var body=$document.find("body").eq(0),modalWindow=openedWindows.get(modalInstance).value;openedWindows.remove(modalInstance),removeAfterAnimate(modalWindow.modalDomEl,modalWindow.modalScope,300,function(){modalWindow.modalScope.$destroy(),body.toggleClass(OPENED_MODAL_CLASS,openedWindows.length()>0),checkRemoveBackdrop()})}function checkRemoveBackdrop(){if(backdropDomEl&&-1==backdropIndex()){var backdropScopeRef=backdropScope;removeAfterAnimate(backdropDomEl,backdropScope,150,function(){backdropScopeRef.$destroy(),backdropScopeRef=null}),backdropDomEl=void 0,backdropScope=void 0}}function removeAfterAnimate(domEl,scope,emulateTime,done){function afterAnimating(){afterAnimating.done||(afterAnimating.done=!0,domEl.remove(),done&&done())}scope.animate=!1;var transitionEndEventName=$transition.transitionEndEventName;if(transitionEndEventName){var timeout=$timeout(afterAnimating,emulateTime);domEl.bind(transitionEndEventName,function(){$timeout.cancel(timeout),afterAnimating(),scope.$apply()})}else $timeout(afterAnimating)}var backdropDomEl,backdropScope,OPENED_MODAL_CLASS="modal-open",openedWindows=$$stackedMap.createNew(),$modalStack={};return $rootScope.$watch(backdropIndex,function(newBackdropIndex){backdropScope&&(backdropScope.index=newBackdropIndex)}),$document.bind("keydown",function(evt){var modal;27===evt.which&&(modal=openedWindows.top(),modal&&modal.value.keyboard&&(evt.preventDefault(),$rootScope.$apply(function(){$modalStack.dismiss(modal.key,"escape key press")})))}),$modalStack.open=function(modalInstance,modal){openedWindows.add(modalInstance,{deferred:modal.deferred,modalScope:modal.scope,backdrop:modal.backdrop,keyboard:modal.keyboard});var body=$document.find("body").eq(0),currBackdropIndex=backdropIndex();if(currBackdropIndex>=0&&!backdropDomEl){backdropScope=$rootScope.$new(!0),backdropScope.index=currBackdropIndex;var angularBackgroundDomEl=angular.element("<div modal-backdrop></div>");angularBackgroundDomEl.attr("backdrop-class",modal.backdropClass),backdropDomEl=$compile(angularBackgroundDomEl)(backdropScope),body.append(backdropDomEl)}var angularDomEl=angular.element("<div modal-window></div>");angularDomEl.attr({"template-url":modal.windowTemplateUrl,"window-class":modal.windowClass,size:modal.size,index:openedWindows.length()-1,animate:"animate"}).html(modal.content);var modalDomEl=$compile(angularDomEl)(modal.scope);openedWindows.top().value.modalDomEl=modalDomEl,body.append(modalDomEl),body.addClass(OPENED_MODAL_CLASS)},$modalStack.close=function(modalInstance,result){var modalWindow=openedWindows.get(modalInstance);modalWindow&&(modalWindow.value.deferred.resolve(result),removeModalWindow(modalInstance))},$modalStack.dismiss=function(modalInstance,reason){var modalWindow=openedWindows.get(modalInstance);modalWindow&&(modalWindow.value.deferred.reject(reason),removeModalWindow(modalInstance))},$modalStack.dismissAll=function(reason){for(var topModal=this.getTop();topModal;)this.dismiss(topModal.key,reason),topModal=this.getTop()},$modalStack.getTop=function(){return openedWindows.top()},$modalStack}]).provider("$modal",function(){var $modalProvider={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function($injector,$rootScope,$q,$http,$templateCache,$controller,$modalStack){function getTemplatePromise(options){return options.template?$q.when(options.template):$http.get(angular.isFunction(options.templateUrl)?options.templateUrl():options.templateUrl,{cache:$templateCache}).then(function(result){return result.data})}function getResolvePromises(resolves){var promisesArr=[];return angular.forEach(resolves,function(value){(angular.isFunction(value)||angular.isArray(value))&&promisesArr.push($q.when($injector.invoke(value)))}),promisesArr}var $modal={};return $modal.open=function(modalOptions){var modalResultDeferred=$q.defer(),modalOpenedDeferred=$q.defer(),modalInstance={result:modalResultDeferred.promise,opened:modalOpenedDeferred.promise,close:function(result){$modalStack.close(modalInstance,result)},dismiss:function(reason){$modalStack.dismiss(modalInstance,reason)}};if(modalOptions=angular.extend({},$modalProvider.options,modalOptions),modalOptions.resolve=modalOptions.resolve||{},!modalOptions.template&&!modalOptions.templateUrl)throw new Error("One of template or templateUrl options is required.");var templateAndResolvePromise=$q.all([getTemplatePromise(modalOptions)].concat(getResolvePromises(modalOptions.resolve)));return templateAndResolvePromise.then(function(tplAndVars){var modalScope=(modalOptions.scope||$rootScope).$new();modalScope.$close=modalInstance.close,modalScope.$dismiss=modalInstance.dismiss;var ctrlInstance,ctrlLocals={},resolveIter=1;modalOptions.controller&&(ctrlLocals.$scope=modalScope,ctrlLocals.$modalInstance=modalInstance,angular.forEach(modalOptions.resolve,function(value,key){ctrlLocals[key]=tplAndVars[resolveIter++]}),ctrlInstance=$controller(modalOptions.controller,ctrlLocals),modalOptions.controllerAs&&(modalScope[modalOptions.controllerAs]=ctrlInstance)),$modalStack.open(modalInstance,{scope:modalScope,deferred:modalResultDeferred,content:tplAndVars[0],backdrop:modalOptions.backdrop,keyboard:modalOptions.keyboard,backdropClass:modalOptions.backdropClass,windowClass:modalOptions.windowClass,windowTemplateUrl:modalOptions.windowTemplateUrl,size:modalOptions.size})},function(reason){modalResultDeferred.reject(reason)}),templateAndResolvePromise.then(function(){modalOpenedDeferred.resolve(!0)},function(){modalOpenedDeferred.reject(!1)}),modalInstance},$modal}]};return $modalProvider}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function($scope,$attrs,$parse){var self=this,ngModelCtrl={$setViewValue:angular.noop},setNumPages=$attrs.numPages?$parse($attrs.numPages).assign:angular.noop;this.init=function(ngModelCtrl_,config){ngModelCtrl=ngModelCtrl_,this.config=config,ngModelCtrl.$render=function(){self.render()},$attrs.itemsPerPage?$scope.$parent.$watch($parse($attrs.itemsPerPage),function(value){self.itemsPerPage=parseInt(value,10),$scope.totalPages=self.calculateTotalPages()}):this.itemsPerPage=config.itemsPerPage},this.calculateTotalPages=function(){var totalPages=this.itemsPerPage<1?1:Math.ceil($scope.totalItems/this.itemsPerPage);return Math.max(totalPages||0,1)},this.render=function(){$scope.page=parseInt(ngModelCtrl.$viewValue,10)||1},$scope.selectPage=function(page){$scope.page!==page&&page>0&&page<=$scope.totalPages&&(ngModelCtrl.$setViewValue(page),ngModelCtrl.$render())},$scope.getText=function(key){return $scope[key+"Text"]||self.config[key+"Text"]},$scope.noPrevious=function(){return 1===$scope.page},$scope.noNext=function(){return $scope.page===$scope.totalPages},$scope.$watch("totalItems",function(){$scope.totalPages=self.calculateTotalPages()}),$scope.$watch("totalPages",function(value){setNumPages($scope.$parent,value),$scope.page>value?$scope.selectPage(value):ngModelCtrl.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function($parse,paginationConfig){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(scope,element,attrs,ctrls){function makePage(number,text,isActive){return{number:number,text:text,active:isActive}}function getPages(currentPage,totalPages){var pages=[],startPage=1,endPage=totalPages,isMaxSized=angular.isDefined(maxSize)&&totalPages>maxSize;isMaxSized&&(rotate?(startPage=Math.max(currentPage-Math.floor(maxSize/2),1),endPage=startPage+maxSize-1,endPage>totalPages&&(endPage=totalPages,startPage=endPage-maxSize+1)):(startPage=(Math.ceil(currentPage/maxSize)-1)*maxSize+1,endPage=Math.min(startPage+maxSize-1,totalPages)));for(var number=startPage;endPage>=number;number++){var page=makePage(number,number,number===currentPage);pages.push(page)}if(isMaxSized&&!rotate){if(startPage>1){var previousPageSet=makePage(startPage-1,"...",!1);pages.unshift(previousPageSet)}if(totalPages>endPage){var nextPageSet=makePage(endPage+1,"...",!1);pages.push(nextPageSet)}}return pages}var paginationCtrl=ctrls[0],ngModelCtrl=ctrls[1];if(ngModelCtrl){var maxSize=angular.isDefined(attrs.maxSize)?scope.$parent.$eval(attrs.maxSize):paginationConfig.maxSize,rotate=angular.isDefined(attrs.rotate)?scope.$parent.$eval(attrs.rotate):paginationConfig.rotate;scope.boundaryLinks=angular.isDefined(attrs.boundaryLinks)?scope.$parent.$eval(attrs.boundaryLinks):paginationConfig.boundaryLinks,scope.directionLinks=angular.isDefined(attrs.directionLinks)?scope.$parent.$eval(attrs.directionLinks):paginationConfig.directionLinks,paginationCtrl.init(ngModelCtrl,paginationConfig),attrs.maxSize&&scope.$parent.$watch($parse(attrs.maxSize),function(value){maxSize=parseInt(value,10),paginationCtrl.render()});var originalRender=paginationCtrl.render;paginationCtrl.render=function(){originalRender(),scope.page>0&&scope.page<=scope.totalPages&&(scope.pages=getPages(scope.page,scope.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:" Previous",nextText:"Next ",align:!0}).directive("pager",["pagerConfig",function(pagerConfig){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(scope,element,attrs,ctrls){var paginationCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&(scope.align=angular.isDefined(attrs.align)?scope.$parent.$eval(attrs.align):pagerConfig.align,paginationCtrl.init(ngModelCtrl,pagerConfig))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function snake_case(name){var regexp=/[A-Z]/g,separator="-";return name.replace(regexp,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}var defaultOptions={placement:"top",animation:!0,popupDelay:0},triggerMap={mouseenter:"mouseleave",click:"click",focus:"blur"},globalOptions={};this.options=function(value){angular.extend(globalOptions,value)},this.setTriggers=function(triggers){angular.extend(triggerMap,triggers)},this.$get=["$window","$compile","$timeout","$document","$position","$interpolate",function($window,$compile,$timeout,$document,$position,$interpolate){return function(type,prefix,defaultTriggerShow){function getTriggers(trigger){var show=trigger||options.trigger||defaultTriggerShow,hide=triggerMap[show]||show;return{show:show,hide:hide}}var options=angular.extend({},defaultOptions,globalOptions),directiveName=snake_case(type),startSym=$interpolate.startSymbol(),endSym=$interpolate.endSymbol(),template="<div "+directiveName+'-popup title="'+startSym+"title"+endSym+'" content="'+startSym+"content"+endSym+'" placement="'+startSym+"placement"+endSym+'" animation="animation" is-open="isOpen"></div>';return{restrict:"EA",compile:function(){var tooltipLinker=$compile(template);return function(scope,element,attrs){function toggleTooltipBind(){ttScope.isOpen?hideTooltipBind():showTooltipBind()}function showTooltipBind(){(!hasEnableExp||scope.$eval(attrs[prefix+"Enable"]))&&(prepareTooltip(),ttScope.popupDelay?popupTimeout||(popupTimeout=$timeout(show,ttScope.popupDelay,!1),popupTimeout.then(function(reposition){reposition()})):show()())}function hideTooltipBind(){scope.$apply(function(){hide()})}function show(){return popupTimeout=null,transitionTimeout&&($timeout.cancel(transitionTimeout),transitionTimeout=null),ttScope.content?(createTooltip(),tooltip.css({top:0,left:0,display:"block"}),appendToBody?$document.find("body").append(tooltip):element.after(tooltip),positionTooltip(),ttScope.isOpen=!0,ttScope.$digest(),positionTooltip):angular.noop}function hide(){ttScope.isOpen=!1,$timeout.cancel(popupTimeout),popupTimeout=null,ttScope.animation?transitionTimeout||(transitionTimeout=$timeout(removeTooltip,500)):removeTooltip()}function createTooltip(){tooltip&&removeTooltip(),tooltipLinkedScope=ttScope.$new(),tooltip=tooltipLinker(tooltipLinkedScope,angular.noop)}function removeTooltip(){transitionTimeout=null,tooltip&&(tooltip.remove(),tooltip=null),tooltipLinkedScope&&(tooltipLinkedScope.$destroy(),tooltipLinkedScope=null)}function prepareTooltip(){prepPlacement(),prepPopupDelay()}function prepPlacement(){var val=attrs[prefix+"Placement"];ttScope.placement=angular.isDefined(val)?val:options.placement}function prepPopupDelay(){var val=attrs[prefix+"PopupDelay"],delay=parseInt(val,10);ttScope.popupDelay=isNaN(delay)?options.popupDelay:delay}function prepTriggers(){var val=attrs[prefix+"Trigger"];unregisterTriggers(),triggers=getTriggers(val),triggers.show===triggers.hide?element.bind(triggers.show,toggleTooltipBind):(element.bind(triggers.show,showTooltipBind),element.bind(triggers.hide,hideTooltipBind))}var tooltip,tooltipLinkedScope,transitionTimeout,popupTimeout,appendToBody=angular.isDefined(options.appendToBody)?options.appendToBody:!1,triggers=getTriggers(void 0),hasEnableExp=angular.isDefined(attrs[prefix+"Enable"]),ttScope=scope.$new(!0),positionTooltip=function(){var ttPosition=$position.positionElements(element,tooltip,ttScope.placement,appendToBody);ttPosition.top+="px",ttPosition.left+="px",tooltip.css(ttPosition)};ttScope.isOpen=!1,attrs.$observe(type,function(val){ttScope.content=val,!val&&ttScope.isOpen&&hide()}),attrs.$observe(prefix+"Title",function(val){ttScope.title=val});var unregisterTriggers=function(){element.unbind(triggers.show,showTooltipBind),element.unbind(triggers.hide,hideTooltipBind)};prepTriggers();var animation=scope.$eval(attrs[prefix+"Animation"]);ttScope.animation=angular.isDefined(animation)?!!animation:options.animation;var appendToBodyVal=scope.$eval(attrs[prefix+"AppendToBody"]);appendToBody=angular.isDefined(appendToBodyVal)?appendToBodyVal:appendToBody,appendToBody&&scope.$on("$locationChangeSuccess",function(){ttScope.isOpen&&hide()}),scope.$on("$destroy",function(){$timeout.cancel(transitionTimeout),$timeout.cancel(popupTimeout),unregisterTriggers(),removeTooltip(),ttScope=null})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function($tooltip){return $tooltip("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function($tooltip){return $tooltip("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function($tooltip){return $tooltip("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function($scope,$attrs,progressConfig){var self=this,animate=angular.isDefined($attrs.animate)?$scope.$parent.$eval($attrs.animate):progressConfig.animate;this.bars=[],$scope.max=angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):progressConfig.max,this.addBar=function(bar,element){animate||element.css({transition:"none"}),this.bars.push(bar),bar.$watch("value",function(value){bar.percent=+(100*value/$scope.max).toFixed(2)}),bar.$on("$destroy",function(){element=null,self.removeBar(bar)})},this.removeBar=function(bar){this.bars.splice(this.bars.indexOf(bar),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(scope,element,attrs,progressCtrl){progressCtrl.addBar(scope,element)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(scope,element,attrs,progressCtrl){progressCtrl.addBar(scope,angular.element(element.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function($scope,$attrs,ratingConfig){var ngModelCtrl={$setViewValue:angular.noop};this.init=function(ngModelCtrl_){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=this.render,this.stateOn=angular.isDefined($attrs.stateOn)?$scope.$parent.$eval($attrs.stateOn):ratingConfig.stateOn,this.stateOff=angular.isDefined($attrs.stateOff)?$scope.$parent.$eval($attrs.stateOff):ratingConfig.stateOff;var ratingStates=angular.isDefined($attrs.ratingStates)?$scope.$parent.$eval($attrs.ratingStates):new Array(angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):ratingConfig.max);$scope.range=this.buildTemplateObjects(ratingStates)},this.buildTemplateObjects=function(states){for(var i=0,n=states.length;n>i;i++)states[i]=angular.extend({index:i},{stateOn:this.stateOn,stateOff:this.stateOff},states[i]);return states},$scope.rate=function(value){!$scope.readonly&&value>=0&&value<=$scope.range.length&&(ngModelCtrl.$setViewValue(value),ngModelCtrl.$render())},$scope.enter=function(value){$scope.readonly||($scope.value=value),$scope.onHover({value:value})},$scope.reset=function(){$scope.value=ngModelCtrl.$viewValue,$scope.onLeave()},$scope.onKeydown=function(evt){/(37|38|39|40)/.test(evt.which)&&(evt.preventDefault(),evt.stopPropagation(),$scope.rate($scope.value+(38===evt.which||39===evt.which?1:-1)))
},this.render=function(){$scope.value=ngModelCtrl.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(scope,element,attrs,ctrls){var ratingCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&ratingCtrl.init(ngModelCtrl)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function($scope){var ctrl=this,tabs=ctrl.tabs=$scope.tabs=[];ctrl.select=function(selectedTab){angular.forEach(tabs,function(tab){tab.active&&tab!==selectedTab&&(tab.active=!1,tab.onDeselect())}),selectedTab.active=!0,selectedTab.onSelect()},ctrl.addTab=function(tab){tabs.push(tab),1===tabs.length?tab.active=!0:tab.active&&ctrl.select(tab)},ctrl.removeTab=function(tab){var index=tabs.indexOf(tab);if(tab.active&&tabs.length>1&&!destroyed){var newActiveIndex=index==tabs.length-1?index-1:index+1;ctrl.select(tabs[newActiveIndex])}tabs.splice(index,1)};var destroyed;$scope.$on("$destroy",function(){destroyed=!0})}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(scope,element,attrs){scope.vertical=angular.isDefined(attrs.vertical)?scope.$parent.$eval(attrs.vertical):!1,scope.justified=angular.isDefined(attrs.justified)?scope.$parent.$eval(attrs.justified):!1}}}).directive("tab",["$parse",function($parse){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(elm,attrs,transclude){return function(scope,elm,attrs,tabsetCtrl){scope.$watch("active",function(active){active&&tabsetCtrl.select(scope)}),scope.disabled=!1,attrs.disabled&&scope.$parent.$watch($parse(attrs.disabled),function(value){scope.disabled=!!value}),scope.select=function(){scope.disabled||(scope.active=!0)},tabsetCtrl.addTab(scope),scope.$on("$destroy",function(){tabsetCtrl.removeTab(scope)}),scope.$transcludeFn=transclude}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(scope,elm){scope.$watch("headingElement",function(heading){heading&&(elm.html(""),elm.append(heading))})}}}]).directive("tabContentTransclude",function(){function isTabHeading(node){return node.tagName&&(node.hasAttribute("tab-heading")||node.hasAttribute("data-tab-heading")||"tab-heading"===node.tagName.toLowerCase()||"data-tab-heading"===node.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(scope,elm,attrs){var tab=scope.$eval(attrs.tabContentTransclude);tab.$transcludeFn(tab.$parent,function(contents){angular.forEach(contents,function(node){isTabHeading(node)?tab.headingElement=node:elm.append(node)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function($scope,$attrs,$parse,$log,$locale,timepickerConfig){function getHoursFromTemplate(){var hours=parseInt($scope.hours,10),valid=$scope.showMeridian?hours>0&&13>hours:hours>=0&&24>hours;return valid?($scope.showMeridian&&(12===hours&&(hours=0),$scope.meridian===meridians[1]&&(hours+=12)),hours):void 0}function getMinutesFromTemplate(){var minutes=parseInt($scope.minutes,10);return minutes>=0&&60>minutes?minutes:void 0}function pad(value){return angular.isDefined(value)&&value.toString().length<2?"0"+value:value}function refresh(keyboardChange){makeValid(),ngModelCtrl.$setViewValue(new Date(selected)),updateTemplate(keyboardChange)}function makeValid(){ngModelCtrl.$setValidity("time",!0),$scope.invalidHours=!1,$scope.invalidMinutes=!1}function updateTemplate(keyboardChange){var hours=selected.getHours(),minutes=selected.getMinutes();$scope.showMeridian&&(hours=0===hours||12===hours?12:hours%12),$scope.hours="h"===keyboardChange?hours:pad(hours),$scope.minutes="m"===keyboardChange?minutes:pad(minutes),$scope.meridian=selected.getHours()<12?meridians[0]:meridians[1]}function addMinutes(minutes){var dt=new Date(selected.getTime()+6e4*minutes);selected.setHours(dt.getHours(),dt.getMinutes()),refresh()}var selected=new Date,ngModelCtrl={$setViewValue:angular.noop},meridians=angular.isDefined($attrs.meridians)?$scope.$parent.$eval($attrs.meridians):timepickerConfig.meridians||$locale.DATETIME_FORMATS.AMPMS;this.init=function(ngModelCtrl_,inputs){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=this.render;var hoursInputEl=inputs.eq(0),minutesInputEl=inputs.eq(1),mousewheel=angular.isDefined($attrs.mousewheel)?$scope.$parent.$eval($attrs.mousewheel):timepickerConfig.mousewheel;mousewheel&&this.setupMousewheelEvents(hoursInputEl,minutesInputEl),$scope.readonlyInput=angular.isDefined($attrs.readonlyInput)?$scope.$parent.$eval($attrs.readonlyInput):timepickerConfig.readonlyInput,this.setupInputEvents(hoursInputEl,minutesInputEl)};var hourStep=timepickerConfig.hourStep;$attrs.hourStep&&$scope.$parent.$watch($parse($attrs.hourStep),function(value){hourStep=parseInt(value,10)});var minuteStep=timepickerConfig.minuteStep;$attrs.minuteStep&&$scope.$parent.$watch($parse($attrs.minuteStep),function(value){minuteStep=parseInt(value,10)}),$scope.showMeridian=timepickerConfig.showMeridian,$attrs.showMeridian&&$scope.$parent.$watch($parse($attrs.showMeridian),function(value){if($scope.showMeridian=!!value,ngModelCtrl.$error.time){var hours=getHoursFromTemplate(),minutes=getMinutesFromTemplate();angular.isDefined(hours)&&angular.isDefined(minutes)&&(selected.setHours(hours),refresh())}else updateTemplate()}),this.setupMousewheelEvents=function(hoursInputEl,minutesInputEl){var isScrollingUp=function(e){e.originalEvent&&(e=e.originalEvent);var delta=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||delta>0};hoursInputEl.bind("mousewheel wheel",function(e){$scope.$apply(isScrollingUp(e)?$scope.incrementHours():$scope.decrementHours()),e.preventDefault()}),minutesInputEl.bind("mousewheel wheel",function(e){$scope.$apply(isScrollingUp(e)?$scope.incrementMinutes():$scope.decrementMinutes()),e.preventDefault()})},this.setupInputEvents=function(hoursInputEl,minutesInputEl){if($scope.readonlyInput)return $scope.updateHours=angular.noop,void($scope.updateMinutes=angular.noop);var invalidate=function(invalidHours,invalidMinutes){ngModelCtrl.$setViewValue(null),ngModelCtrl.$setValidity("time",!1),angular.isDefined(invalidHours)&&($scope.invalidHours=invalidHours),angular.isDefined(invalidMinutes)&&($scope.invalidMinutes=invalidMinutes)};$scope.updateHours=function(){var hours=getHoursFromTemplate();angular.isDefined(hours)?(selected.setHours(hours),refresh("h")):invalidate(!0)},hoursInputEl.bind("blur",function(){!$scope.invalidHours&&$scope.hours<10&&$scope.$apply(function(){$scope.hours=pad($scope.hours)})}),$scope.updateMinutes=function(){var minutes=getMinutesFromTemplate();angular.isDefined(minutes)?(selected.setMinutes(minutes),refresh("m")):invalidate(void 0,!0)},minutesInputEl.bind("blur",function(){!$scope.invalidMinutes&&$scope.minutes<10&&$scope.$apply(function(){$scope.minutes=pad($scope.minutes)})})},this.render=function(){var date=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;isNaN(date)?(ngModelCtrl.$setValidity("time",!1),$log.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(date&&(selected=date),makeValid(),updateTemplate())},$scope.incrementHours=function(){addMinutes(60*hourStep)},$scope.decrementHours=function(){addMinutes(60*-hourStep)},$scope.incrementMinutes=function(){addMinutes(minuteStep)},$scope.decrementMinutes=function(){addMinutes(-minuteStep)},$scope.toggleMeridian=function(){addMinutes(720*(selected.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(scope,element,attrs,ctrls){var timepickerCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&timepickerCtrl.init(ngModelCtrl,element.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function($parse){var TYPEAHEAD_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(input){var match=input.match(TYPEAHEAD_REGEXP);if(!match)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+input+'".');return{itemName:match[3],source:$parse(match[4]),viewMapper:$parse(match[2]||match[1]),modelMapper:$parse(match[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function($compile,$parse,$q,$timeout,$document,$position,typeaheadParser){var HOT_KEYS=[9,13,27,38,40];return{require:"ngModel",link:function(originalScope,element,attrs,modelCtrl){var hasFocus,minSearch=originalScope.$eval(attrs.typeaheadMinLength)||1,waitTime=originalScope.$eval(attrs.typeaheadWaitMs)||0,isEditable=originalScope.$eval(attrs.typeaheadEditable)!==!1,isLoadingSetter=$parse(attrs.typeaheadLoading).assign||angular.noop,onSelectCallback=$parse(attrs.typeaheadOnSelect),inputFormatter=attrs.typeaheadInputFormatter?$parse(attrs.typeaheadInputFormatter):void 0,appendToBody=attrs.typeaheadAppendToBody?originalScope.$eval(attrs.typeaheadAppendToBody):!1,focusFirst=originalScope.$eval(attrs.typeaheadFocusFirst)!==!1,$setModelValue=$parse(attrs.ngModel).assign,parserResult=typeaheadParser.parse(attrs.typeahead),scope=originalScope.$new();originalScope.$on("$destroy",function(){scope.$destroy()});var popupId="typeahead-"+scope.$id+"-"+Math.floor(1e4*Math.random());element.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":popupId});var popUpEl=angular.element("<div typeahead-popup></div>");popUpEl.attr({id:popupId,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(attrs.typeaheadTemplateUrl)&&popUpEl.attr("template-url",attrs.typeaheadTemplateUrl);var resetMatches=function(){scope.matches=[],scope.activeIdx=-1,element.attr("aria-expanded",!1)},getMatchId=function(index){return popupId+"-option-"+index};scope.$watch("activeIdx",function(index){0>index?element.removeAttr("aria-activedescendant"):element.attr("aria-activedescendant",getMatchId(index))});var getMatchesAsync=function(inputValue){var locals={$viewValue:inputValue};isLoadingSetter(originalScope,!0),$q.when(parserResult.source(originalScope,locals)).then(function(matches){var onCurrentRequest=inputValue===modelCtrl.$viewValue;if(onCurrentRequest&&hasFocus)if(matches.length>0){scope.activeIdx=focusFirst?0:-1,scope.matches.length=0;for(var i=0;i<matches.length;i++)locals[parserResult.itemName]=matches[i],scope.matches.push({id:getMatchId(i),label:parserResult.viewMapper(scope,locals),model:matches[i]});scope.query=inputValue,scope.position=appendToBody?$position.offset(element):$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),element.attr("aria-expanded",!0)}else resetMatches();onCurrentRequest&&isLoadingSetter(originalScope,!1)},function(){resetMatches(),isLoadingSetter(originalScope,!1)})};resetMatches(),scope.query=void 0;var timeoutPromise,scheduleSearchWithTimeout=function(inputValue){timeoutPromise=$timeout(function(){getMatchesAsync(inputValue)},waitTime)},cancelPreviousTimeout=function(){timeoutPromise&&$timeout.cancel(timeoutPromise)};modelCtrl.$parsers.unshift(function(inputValue){return hasFocus=!0,inputValue&&inputValue.length>=minSearch?waitTime>0?(cancelPreviousTimeout(),scheduleSearchWithTimeout(inputValue)):getMatchesAsync(inputValue):(isLoadingSetter(originalScope,!1),cancelPreviousTimeout(),resetMatches()),isEditable?inputValue:inputValue?void modelCtrl.$setValidity("editable",!1):(modelCtrl.$setValidity("editable",!0),inputValue)}),modelCtrl.$formatters.push(function(modelValue){var candidateViewValue,emptyViewValue,locals={};return inputFormatter?(locals.$model=modelValue,inputFormatter(originalScope,locals)):(locals[parserResult.itemName]=modelValue,candidateViewValue=parserResult.viewMapper(originalScope,locals),locals[parserResult.itemName]=void 0,emptyViewValue=parserResult.viewMapper(originalScope,locals),candidateViewValue!==emptyViewValue?candidateViewValue:modelValue)}),scope.select=function(activeIdx){var model,item,locals={};locals[parserResult.itemName]=item=scope.matches[activeIdx].model,model=parserResult.modelMapper(originalScope,locals),$setModelValue(originalScope,model),modelCtrl.$setValidity("editable",!0),onSelectCallback(originalScope,{$item:item,$model:model,$label:parserResult.viewMapper(originalScope,locals)}),resetMatches(),$timeout(function(){element[0].focus()},0,!1)},element.bind("keydown",function(evt){0!==scope.matches.length&&-1!==HOT_KEYS.indexOf(evt.which)&&(-1!=scope.activeIdx||13!==evt.which&&9!==evt.which)&&(evt.preventDefault(),40===evt.which?(scope.activeIdx=(scope.activeIdx+1)%scope.matches.length,scope.$digest()):38===evt.which?(scope.activeIdx=(scope.activeIdx>0?scope.activeIdx:scope.matches.length)-1,scope.$digest()):13===evt.which||9===evt.which?scope.$apply(function(){scope.select(scope.activeIdx)}):27===evt.which&&(evt.stopPropagation(),resetMatches(),scope.$digest()))}),element.bind("blur",function(){hasFocus=!1});var dismissClickHandler=function(evt){element[0]!==evt.target&&(resetMatches(),scope.$digest())};$document.bind("click",dismissClickHandler),originalScope.$on("$destroy",function(){$document.unbind("click",dismissClickHandler),appendToBody&&$popup.remove()});var $popup=$compile(popUpEl)(scope);appendToBody?$document.find("body").append($popup):element.after($popup)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(scope,element,attrs){scope.templateUrl=attrs.templateUrl,scope.isOpen=function(){return scope.matches.length>0},scope.isActive=function(matchIdx){return scope.active==matchIdx},scope.selectActive=function(matchIdx){scope.active=matchIdx},scope.selectMatch=function(activeIdx){scope.select({activeIdx:activeIdx})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function($http,$templateCache,$compile,$parse){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(scope,element,attrs){var tplUrl=$parse(attrs.templateUrl)(scope.$parent)||"template/typeahead/typeahead-match.html";$http.get(tplUrl,{cache:$templateCache}).success(function(tplContent){element.replaceWith($compile(tplContent.trim())(scope))})}}}]).filter("typeaheadHighlight",function(){function escapeRegexp(queryToEscape){return queryToEscape.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(matchItem,query){return query?(""+matchItem).replace(new RegExp(escapeRegexp(query),"gi"),"<strong>$&</strong>"):matchItem}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a href class="accordion-toggle" ng-click="toggleOpen()" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n	  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>\n')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item text-center\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group pull-left">\n			<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n		</span>\n		<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/backdrop.html",'<div class="modal-backdrop fade {{ backdropClass }}"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" modal-transclude></div></div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a href ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/timepicker/timepicker.html",'<table>\n	<tbody>\n		<tr class="text-center">\n			<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n		<tr>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}">\n				<input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td>:</td>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n				<input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n		</tr>\n		<tr class="text-center">\n			<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n	</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')
}]),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(window,angular,undefined){"use strict";function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function merge(dst){return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst.hasOwnProperty(key)||(dst[key]=value)})}),dst}function ancestors(first,second){var path=[];for(var n in first.path){if(first.path[n]!==second.path[n])break;path.push(first.path[n])}return path}function objectKeys(object){if(Object.keys)return Object.keys(object);var result=[];return angular.forEach(object,function(val,key){result.push(key)}),result}function indexOf(array,value){if(Array.prototype.indexOf)return array.indexOf(value,Number(arguments[2])||0);var len=array.length>>>0,from=Number(arguments[2])||0;for(from=0>from?Math.ceil(from):Math.floor(from),0>from&&(from+=len);len>from;from++)if(from in array&&array[from]===value)return from;return-1}function inheritParams(currentParams,newParams,$current,$to){var parentParams,parents=ancestors($current,$to),inherited={},inheritList=[];for(var i in parents)if(parents[i].params&&(parentParams=objectKeys(parents[i].params),parentParams.length))for(var j in parentParams)indexOf(inheritList,parentParams[j])>=0||(inheritList.push(parentParams[j]),inherited[parentParams[j]]=currentParams[parentParams[j]]);return extend({},inherited,newParams)}function equalForKeys(a,b,keys){if(!keys){keys=[];for(var n in a)keys.push(n)}for(var i=0;i<keys.length;i++){var k=keys[i];if(a[k]!=b[k])return!1}return!0}function filterByKeys(keys,values){var filtered={};return forEach(keys,function(name){filtered[name]=values[name]}),filtered}function omit(obj){var copy={},keys=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));for(var key in obj)-1==indexOf(keys,key)&&(copy[key]=obj[key]);return copy}function filter(collection,callback){var array=isArray(collection),result=array?[]:{};return forEach(collection,function(val,i){callback(val,i)&&(result[array?result.length:i]=val)}),result}function map(collection,callback){var result=isArray(collection)?[]:{};return forEach(collection,function(val,i){result[i]=callback(val,i)}),result}function $Resolve($q,$injector){var VISIT_IN_PROGRESS=1,VISIT_DONE=2,NOTHING={},NO_DEPENDENCIES=[],NO_LOCALS=NOTHING,NO_PARENT=extend($q.when(NOTHING),{$$promises:NOTHING,$$values:NOTHING});this.study=function(invocables){function visit(value,key){if(visited[key]!==VISIT_DONE){if(cycle.push(key),visited[key]===VISIT_IN_PROGRESS)throw cycle.splice(0,indexOf(cycle,key)),new Error("Cyclic dependency: "+cycle.join(" -> "));if(visited[key]=VISIT_IN_PROGRESS,isString(value))plan.push(key,[function(){return $injector.get(value)}],NO_DEPENDENCIES);else{var params=$injector.annotate(value);forEach(params,function(param){param!==key&&invocables.hasOwnProperty(param)&&visit(invocables[param],param)}),plan.push(key,value,params)}cycle.pop(),visited[key]=VISIT_DONE}}function isResolve(value){return isObject(value)&&value.then&&value.$$promises}if(!isObject(invocables))throw new Error("'invocables' must be an object");var invocableKeys=objectKeys(invocables||{}),plan=[],cycle=[],visited={};return forEach(invocables,visit),invocables=cycle=visited=null,function(locals,parent,self){function done(){--wait||(merged||merge(values,parent.$$values),result.$$values=values,result.$$promises=result.$$promises||!0,delete result.$$inheritedValues,resolution.resolve(values))}function fail(reason){result.$$failure=reason,resolution.reject(reason)}function invoke(key,invocable,params){function onfailure(reason){invocation.reject(reason),fail(reason)}function proceed(){if(!isDefined(result.$$failure))try{invocation.resolve($injector.invoke(invocable,self,values)),invocation.promise.then(function(result){values[key]=result,done()},onfailure)}catch(e){onfailure(e)}}var invocation=$q.defer(),waitParams=0;forEach(params,function(dep){promises.hasOwnProperty(dep)&&!locals.hasOwnProperty(dep)&&(waitParams++,promises[dep].then(function(result){values[dep]=result,--waitParams||proceed()},onfailure))}),waitParams||proceed(),promises[key]=invocation.promise}if(isResolve(locals)&&self===undefined&&(self=parent,parent=locals,locals=null),locals){if(!isObject(locals))throw new Error("'locals' must be an object")}else locals=NO_LOCALS;if(parent){if(!isResolve(parent))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else parent=NO_PARENT;var resolution=$q.defer(),result=resolution.promise,promises=result.$$promises={},values=extend({},locals),wait=1+plan.length/3,merged=!1;if(isDefined(parent.$$failure))return fail(parent.$$failure),result;parent.$$inheritedValues&&merge(values,omit(parent.$$inheritedValues,invocableKeys)),extend(promises,parent.$$promises),parent.$$values?(merged=merge(values,omit(parent.$$values,invocableKeys)),result.$$inheritedValues=omit(parent.$$values,invocableKeys),done()):(parent.$$inheritedValues&&(result.$$inheritedValues=omit(parent.$$inheritedValues,invocableKeys)),parent.then(done,fail));for(var i=0,ii=plan.length;ii>i;i+=3)locals.hasOwnProperty(plan[i])?done():invoke(plan[i],plan[i+1],plan[i+2]);return result}},this.resolve=function(invocables,locals,parent,self){return this.study(invocables)(locals,parent,self)}}function $TemplateFactory($http,$templateCache,$injector){this.fromConfig=function(config,params,locals){return isDefined(config.template)?this.fromString(config.template,params):isDefined(config.templateUrl)?this.fromUrl(config.templateUrl,params):isDefined(config.templateProvider)?this.fromProvider(config.templateProvider,params,locals):null},this.fromString=function(template,params){return isFunction(template)?template(params):template},this.fromUrl=function(url,params){return isFunction(url)&&(url=url(params)),null==url?null:$http.get(url,{cache:$templateCache,headers:{Accept:"text/html"}}).then(function(response){return response.data})},this.fromProvider=function(provider,params,locals){return $injector.invoke(provider,null,locals||{params:params})}}function UrlMatcher(pattern,config,parentMatcher){function addParameter(id,type,config,location){if(paramNames.push(id),parentParams[id])return parentParams[id];if(!/^\w+(-+\w+)*(?:\[\])?$/.test(id))throw new Error("Invalid parameter name '"+id+"' in pattern '"+pattern+"'");if(params[id])throw new Error("Duplicate parameter name '"+id+"' in pattern '"+pattern+"'");return params[id]=new $$UMFP.Param(id,type,config,location),params[id]}function quoteRegExp(string,pattern,squash){var surroundPattern=["",""],result=string.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!pattern)return result;switch(squash){case!1:surroundPattern=["(",")"];break;case!0:surroundPattern=["?(",")?"];break;default:surroundPattern=["("+squash+"|",")?"]}return result+surroundPattern[0]+pattern+surroundPattern[1]}function matchDetails(m,isSearch){var id,regexp,segment,type,cfg;return id=m[2]||m[3],cfg=config.params[id],segment=pattern.substring(last,m.index),regexp=isSearch?m[4]:m[4]||("*"==m[1]?".*":null),type=$$UMFP.type(regexp||"string")||inherit($$UMFP.type("string"),{pattern:new RegExp(regexp)}),{id:id,regexp:regexp,segment:segment,type:type,cfg:cfg}}config=extend({params:{}},isObject(config)?config:{});var m,placeholder=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,searchPlaceholder=/([:]?)([\w\[\]-]+)|\{([\w\[\]-]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,compiled="^",last=0,segments=this.segments=[],parentParams=parentMatcher?parentMatcher.params:{},params=this.params=parentMatcher?parentMatcher.params.$$new():new $$UMFP.ParamSet,paramNames=[];this.source=pattern;for(var p,param,segment;(m=placeholder.exec(pattern))&&(p=matchDetails(m,!1),!(p.segment.indexOf("?")>=0));)param=addParameter(p.id,p.type,p.cfg,"path"),compiled+=quoteRegExp(p.segment,param.type.pattern.source,param.squash),segments.push(p.segment),last=placeholder.lastIndex;segment=pattern.substring(last);var i=segment.indexOf("?");if(i>=0){var search=this.sourceSearch=segment.substring(i);if(segment=segment.substring(0,i),this.sourcePath=pattern.substring(0,last+i),search.length>0)for(last=0;m=searchPlaceholder.exec(search);)p=matchDetails(m,!0),param=addParameter(p.id,p.type,p.cfg,"search"),last=placeholder.lastIndex}else this.sourcePath=pattern,this.sourceSearch="";compiled+=quoteRegExp(segment)+(config.strict===!1?"/?":"")+"$",segments.push(segment),this.regexp=new RegExp(compiled,config.caseInsensitive?"i":undefined),this.prefix=segments[0],this.$$paramNames=paramNames}function Type(config){extend(this,config)}function $UrlMatcherFactory(){function valToString(val){return null!=val?val.toString().replace(/\//g,"%2F"):val}function valFromString(val){return null!=val?val.toString().replace(/%2F/g,"/"):val}function regexpMatches(val){return this.pattern.test(val)}function getDefaultConfig(){return{strict:isStrictMode,caseInsensitive:isCaseInsensitive}}function isInjectable(value){return isFunction(value)||isArray(value)&&isFunction(value[value.length-1])}function flushTypeQueue(){for(;typeQueue.length;){var type=typeQueue.shift();if(type.pattern)throw new Error("You cannot override a type's .pattern at runtime.");angular.extend($types[type.name],injector.invoke(type.def))}}function ParamSet(params){extend(this,params||{})}$$UMFP=this;var injector,isCaseInsensitive=!1,isStrictMode=!0,defaultSquashPolicy=!1,$types={},enqueue=!0,typeQueue=[],defaultTypes={string:{encode:valToString,decode:valFromString,is:regexpMatches,pattern:/[^/]*/},"int":{encode:valToString,decode:function(val){return parseInt(val,10)},is:function(val){return isDefined(val)&&this.decode(val.toString())===val},pattern:/\d+/},bool:{encode:function(val){return val?1:0},decode:function(val){return 0!==parseInt(val,10)},is:function(val){return val===!0||val===!1},pattern:/0|1/},date:{encode:function(val){return this.is(val)?[val.getFullYear(),("0"+(val.getMonth()+1)).slice(-2),("0"+val.getDate()).slice(-2)].join("-"):undefined},decode:function(val){if(this.is(val))return val;var match=this.capture.exec(val);return match?new Date(match[1],match[2]-1,match[3]):undefined},is:function(val){return val instanceof Date&&!isNaN(val.valueOf())},equals:function(a,b){return this.is(a)&&this.is(b)&&a.toISOString()===b.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:angular.toJson,decode:angular.fromJson,is:angular.isObject,equals:angular.equals,pattern:/[^/]*/},any:{encode:angular.identity,decode:angular.identity,is:angular.identity,equals:angular.equals,pattern:/.*/}};$UrlMatcherFactory.$$getDefaultValue=function(config){if(!isInjectable(config.value))return config.value;if(!injector)throw new Error("Injectable functions cannot be called at configuration time");return injector.invoke(config.value)},this.caseInsensitive=function(value){return isDefined(value)&&(isCaseInsensitive=value),isCaseInsensitive},this.strictMode=function(value){return isDefined(value)&&(isStrictMode=value),isStrictMode},this.defaultSquashPolicy=function(value){if(!isDefined(value))return defaultSquashPolicy;if(value!==!0&&value!==!1&&!isString(value))throw new Error("Invalid squash policy: "+value+". Valid policies: false, true, arbitrary-string");return defaultSquashPolicy=value,value},this.compile=function(pattern,config){return new UrlMatcher(pattern,extend(getDefaultConfig(),config))},this.isMatcher=function(o){if(!isObject(o))return!1;var result=!0;return forEach(UrlMatcher.prototype,function(val,name){isFunction(val)&&(result=result&&isDefined(o[name])&&isFunction(o[name]))}),result},this.type=function(name,definition,definitionFn){if(!isDefined(definition))return $types[name];if($types.hasOwnProperty(name))throw new Error("A type named '"+name+"' has already been defined.");return $types[name]=new Type(extend({name:name},definition)),definitionFn&&(typeQueue.push({name:name,def:definitionFn}),enqueue||flushTypeQueue()),this},forEach(defaultTypes,function(type,name){$types[name]=new Type(extend({name:name},type))}),$types=inherit($types,{}),this.$get=["$injector",function($injector){return injector=$injector,enqueue=!1,flushTypeQueue(),forEach(defaultTypes,function(type,name){$types[name]||($types[name]=new Type(type))}),this}],this.Param=function(id,type,config,location){function unwrapShorthand(config){var keys=isObject(config)?objectKeys(config):[],isShorthand=-1===indexOf(keys,"value")&&-1===indexOf(keys,"type")&&-1===indexOf(keys,"squash")&&-1===indexOf(keys,"array");return isShorthand&&(config={value:config}),config.$$fn=isInjectable(config.value)?config.value:function(){return config.value},config}function getType(config,urlType,location){if(config.type&&urlType)throw new Error("Param '"+id+"' has two type configurations.");return urlType?urlType:config.type?config.type instanceof Type?config.type:new Type(config.type):"config"===location?$types.any:$types.string}function getArrayMode(){var arrayDefaults={array:"search"===location?"auto":!1},arrayParamNomenclature=id.match(/\[\]$/)?{array:!0}:{};return extend(arrayDefaults,arrayParamNomenclature,config).array}function getSquashPolicy(config,isOptional){var squash=config.squash;if(!isOptional||squash===!1)return!1;if(!isDefined(squash)||null==squash)return defaultSquashPolicy;if(squash===!0||isString(squash))return squash;throw new Error("Invalid squash policy: '"+squash+"'. Valid policies: false, true, or arbitrary string")}function getReplace(config,arrayMode,isOptional,squash){var replace,configuredKeys,defaultPolicy=[{from:"",to:isOptional||arrayMode?undefined:""},{from:null,to:isOptional||arrayMode?undefined:""}];return replace=isArray(config.replace)?config.replace:[],isString(squash)&&replace.push({from:squash,to:undefined}),configuredKeys=map(replace,function(item){return item.from}),filter(defaultPolicy,function(item){return-1===indexOf(configuredKeys,item.from)}).concat(replace)}function $$getDefaultValue(){if(!injector)throw new Error("Injectable functions cannot be called at configuration time");return injector.invoke(config.$$fn)}function $value(value){function hasReplaceVal(val){return function(obj){return obj.from===val}}function $replace(value){var replacement=map(filter(self.replace,hasReplaceVal(value)),function(obj){return obj.to});return replacement.length?replacement[0]:value}return value=$replace(value),isDefined(value)?self.type.decode(value):$$getDefaultValue()}function toString(){return"{Param:"+id+" "+type+" squash: '"+squash+"' optional: "+isOptional+"}"}var self=this;config=unwrapShorthand(config),type=getType(config,type,location);var arrayMode=getArrayMode();type=arrayMode?type.$asArray(arrayMode,"search"===location):type,"string"!==type.name||arrayMode||"path"!==location||config.value!==undefined||(config.value="");var isOptional=config.value!==undefined,squash=getSquashPolicy(config,isOptional),replace=getReplace(config,arrayMode,isOptional,squash);extend(this,{id:id,type:type,location:location,array:arrayMode,squash:squash,replace:replace,isOptional:isOptional,value:$value,dynamic:undefined,config:config,toString:toString})},ParamSet.prototype={$$new:function(){return inherit(this,extend(new ParamSet,{$$parent:this}))},$$keys:function(){for(var keys=[],chain=[],parent=this,ignore=objectKeys(ParamSet.prototype);parent;)chain.push(parent),parent=parent.$$parent;return chain.reverse(),forEach(chain,function(paramset){forEach(objectKeys(paramset),function(key){-1===indexOf(keys,key)&&-1===indexOf(ignore,key)&&keys.push(key)})}),keys},$$values:function(paramValues){var values={},self=this;return forEach(self.$$keys(),function(key){values[key]=self[key].value(paramValues&&paramValues[key])}),values},$$equals:function(paramValues1,paramValues2){var equal=!0,self=this;return forEach(self.$$keys(),function(key){var left=paramValues1&&paramValues1[key],right=paramValues2&&paramValues2[key];self[key].type.equals(left,right)||(equal=!1)}),equal},$$validates:function(paramValues){var isOptional,val,param,result=!0,self=this;return forEach(this.$$keys(),function(key){param=self[key],val=paramValues[key],isOptional=!val&&param.isOptional,result=result&&(isOptional||!!param.type.is(val))}),result},$$parent:undefined},this.ParamSet=ParamSet}function $UrlRouterProvider($locationProvider,$urlMatcherFactory){function regExpPrefix(re){var prefix=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);return null!=prefix?prefix[1].replace(/\\(.)/g,"$1"):""}function interpolate(pattern,match){return pattern.replace(/\$(\$|\d{1,2})/,function(m,what){return match["$"===what?0:Number(what)]})}function handleIfMatch($injector,handler,match){if(!match)return!1;var result=$injector.invoke(handler,handler,{$match:match});return isDefined(result)?result:!0}function $get($location,$rootScope,$injector,$browser){function appendBasePath(url,isHtml5,absolute){return"/"===baseHref?url:isHtml5?baseHref.slice(0,-1)+url:absolute?baseHref.slice(1)+url:url}function update(evt){function check(rule){var handled=rule($injector,$location);return handled?(isString(handled)&&$location.replace().url(handled),!0):!1}if(!evt||!evt.defaultPrevented){var ignoreUpdate=lastPushedUrl&&$location.url()===lastPushedUrl;if(lastPushedUrl=undefined,ignoreUpdate)return!0;var i,n=rules.length;for(i=0;n>i;i++)if(check(rules[i]))return;otherwise&&check(otherwise)}}function listen(){return listener=listener||$rootScope.$on("$locationChangeSuccess",update)}var lastPushedUrl,baseHref=$browser.baseHref(),location=$location.url();return interceptDeferred||listen(),{sync:function(){update()},listen:function(){return listen()},update:function(read){return read?void(location=$location.url()):void($location.url()!==location&&($location.url(location),$location.replace()))},push:function(urlMatcher,params,options){$location.url(urlMatcher.format(params||{})),lastPushedUrl=options&&options.$$avoidResync?$location.url():undefined,options&&options.replace&&$location.replace()},href:function(urlMatcher,params,options){if(!urlMatcher.validates(params))return null;var isHtml5=$locationProvider.html5Mode();angular.isObject(isHtml5)&&(isHtml5=isHtml5.enabled);var url=urlMatcher.format(params);if(options=options||{},isHtml5||null===url||(url="#"+$locationProvider.hashPrefix()+url),url=appendBasePath(url,isHtml5,options.absolute),!options.absolute||!url)return url;var slash=!isHtml5&&url?"/":"",port=$location.port();return port=80===port||443===port?"":":"+port,[$location.protocol(),"://",$location.host(),port,slash,url].join("")}}}var listener,rules=[],otherwise=null,interceptDeferred=!1;this.rule=function(rule){if(!isFunction(rule))throw new Error("'rule' must be a function");return rules.push(rule),this},this.otherwise=function(rule){if(isString(rule)){var redirect=rule;rule=function(){return redirect}}else if(!isFunction(rule))throw new Error("'rule' must be a function");return otherwise=rule,this},this.when=function(what,handler){var redirect,handlerIsString=isString(handler);if(isString(what)&&(what=$urlMatcherFactory.compile(what)),!handlerIsString&&!isFunction(handler)&&!isArray(handler))throw new Error("invalid 'handler' in when()");var strategies={matcher:function(what,handler){return handlerIsString&&(redirect=$urlMatcherFactory.compile(handler),handler=["$match",function($match){return redirect.format($match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path(),$location.search()))},{prefix:isString(what.prefix)?what.prefix:""})},regex:function(what,handler){if(what.global||what.sticky)throw new Error("when() RegExp must not be global or sticky");return handlerIsString&&(redirect=handler,handler=["$match",function($match){return interpolate(redirect,$match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path()))},{prefix:regExpPrefix(what)})}},check={matcher:$urlMatcherFactory.isMatcher(what),regex:what instanceof RegExp};for(var n in check)if(check[n])return this.rule(strategies[n](what,handler));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(defer){defer===undefined&&(defer=!0),interceptDeferred=defer},this.$get=$get,$get.$inject=["$location","$rootScope","$injector","$browser"]}function $StateProvider($urlRouterProvider,$urlMatcherFactory){function isRelative(stateName){return 0===stateName.indexOf(".")||0===stateName.indexOf("^")}function findState(stateOrName,base){if(!stateOrName)return undefined;var isStr=isString(stateOrName),name=isStr?stateOrName:stateOrName.name,path=isRelative(name);if(path){if(!base)throw new Error("No reference point given for path '"+name+"'");base=findState(base);for(var rel=name.split("."),i=0,pathLength=rel.length,current=base;pathLength>i;i++)if(""!==rel[i]||0!==i){if("^"!==rel[i])break;if(!current.parent)throw new Error("Path '"+name+"' not valid for state '"+base.name+"'");current=current.parent}else current=base;rel=rel.slice(i).join("."),name=current.name+(current.name&&rel?".":"")+rel}var state=states[name];return!state||!isStr&&(isStr||state!==stateOrName&&state.self!==stateOrName)?undefined:state}function queueState(parentName,state){queue[parentName]||(queue[parentName]=[]),queue[parentName].push(state)}function flushQueuedChildren(parentName){for(var queued=queue[parentName]||[];queued.length;)registerState(queued.shift())}function registerState(state){state=inherit(state,{self:state,resolve:state.resolve||{},toString:function(){return this.name}});var name=state.name;if(!isString(name)||name.indexOf("@")>=0)throw new Error("State must have a valid name");if(states.hasOwnProperty(name))throw new Error("State '"+name+"'' is already defined");var parentName=-1!==name.indexOf(".")?name.substring(0,name.lastIndexOf(".")):isString(state.parent)?state.parent:isObject(state.parent)&&isString(state.parent.name)?state.parent.name:"";if(parentName&&!states[parentName])return queueState(parentName,state.self);for(var key in stateBuilder)isFunction(stateBuilder[key])&&(state[key]=stateBuilder[key](state,stateBuilder.$delegates[key]));return states[name]=state,!state[abstractKey]&&state.url&&$urlRouterProvider.when(state.url,["$match","$stateParams",function($match,$stateParams){$state.$current.navigable==state&&equalForKeys($match,$stateParams)||$state.transitionTo(state,$match,{inherit:!0,location:!1})}]),flushQueuedChildren(name),state}function isGlob(text){return text.indexOf("*")>-1}function doesStateMatchGlob(glob){var globSegments=glob.split("."),segments=$state.$current.name.split(".");if("**"===globSegments[0]&&(segments=segments.slice(indexOf(segments,globSegments[1])),segments.unshift("**")),"**"===globSegments[globSegments.length-1]&&(segments.splice(indexOf(segments,globSegments[globSegments.length-2])+1,Number.MAX_VALUE),segments.push("**")),globSegments.length!=segments.length)return!1;for(var i=0,l=globSegments.length;l>i;i++)"*"===globSegments[i]&&(segments[i]="*");return segments.join("")===globSegments.join("")}function decorator(name,func){return isString(name)&&!isDefined(func)?stateBuilder[name]:isFunction(func)&&isString(name)?(stateBuilder[name]&&!stateBuilder.$delegates[name]&&(stateBuilder.$delegates[name]=stateBuilder[name]),stateBuilder[name]=func,this):this}function state(name,definition){return isObject(name)?definition=name:definition.name=name,registerState(definition),this}function $get($rootScope,$q,$view,$injector,$resolve,$stateParams,$urlRouter){function handleRedirect(redirect,state,params,options){var evt=$rootScope.$broadcast("$stateNotFound",redirect,state,params);if(evt.defaultPrevented)return $urlRouter.update(),TransitionAborted;if(!evt.retry)return null;if(options.$retry)return $urlRouter.update(),TransitionFailed;var retryTransition=$state.transition=$q.when(evt.retry);return retryTransition.then(function(){return retryTransition!==$state.transition?TransitionSuperseded:(redirect.options.$retry=!0,$state.transitionTo(redirect.to,redirect.toParams,redirect.options))},function(){return TransitionAborted}),$urlRouter.update(),retryTransition}function resolveState(state,params,paramsAreFiltered,inherited,dst,options){var $stateParams=paramsAreFiltered?params:filterByKeys(state.params.$$keys(),params),locals={$stateParams:$stateParams};dst.resolve=$resolve.resolve(state.resolve,locals,dst.resolve,state);var promises=[dst.resolve.then(function(globals){dst.globals=globals})];return inherited&&promises.push(inherited),forEach(state.views,function(view,name){var injectables=view.resolve&&view.resolve!==state.resolve?view.resolve:{};injectables.$template=[function(){return $view.load(name,{view:view,locals:locals,params:$stateParams,notify:options.notify})||""}],promises.push($resolve.resolve(injectables,locals,dst.resolve,state).then(function(result){if(isFunction(view.controllerProvider)||isArray(view.controllerProvider)){var injectLocals=angular.extend({},injectables,locals);result.$$controller=$injector.invoke(view.controllerProvider,null,injectLocals)}else result.$$controller=view.controller;result.$$state=state,result.$$controllerAs=view.controllerAs,dst[name]=result}))}),$q.all(promises).then(function(){return dst})}var TransitionSuperseded=$q.reject(new Error("transition superseded")),TransitionPrevented=$q.reject(new Error("transition prevented")),TransitionAborted=$q.reject(new Error("transition aborted")),TransitionFailed=$q.reject(new Error("transition failed"));return root.locals={resolve:null,globals:{$stateParams:{}}},$state={params:{},current:root.self,$current:root,transition:null},$state.reload=function(){return $state.transitionTo($state.current,$stateParams,{reload:!0,inherit:!1,notify:!0})},$state.go=function(to,params,options){return $state.transitionTo(to,params,extend({inherit:!0,relative:$state.$current},options))},$state.transitionTo=function(to,toParams,options){toParams=toParams||{},options=extend({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},options||{});var evt,from=$state.$current,fromParams=$state.params,fromPath=from.path,toState=findState(to,options.relative);if(!isDefined(toState)){var redirect={to:to,toParams:toParams,options:options},redirectResult=handleRedirect(redirect,from.self,fromParams,options);if(redirectResult)return redirectResult;if(to=redirect.to,toParams=redirect.toParams,options=redirect.options,toState=findState(to,options.relative),!isDefined(toState)){if(!options.relative)throw new Error("No such state '"+to+"'");throw new Error("Could not resolve '"+to+"' from state '"+options.relative+"'")}}if(toState[abstractKey])throw new Error("Cannot transition to abstract state '"+to+"'");if(options.inherit&&(toParams=inheritParams($stateParams,toParams||{},$state.$current,toState)),!toState.params.$$validates(toParams))return TransitionFailed;toParams=toState.params.$$values(toParams),to=toState;var toPath=to.path,keep=0,state=toPath[keep],locals=root.locals,toLocals=[];if(!options.reload)for(;state&&state===fromPath[keep]&&state.ownParams.$$equals(toParams,fromParams);)locals=toLocals[keep]=state.locals,keep++,state=toPath[keep];if(shouldTriggerReload(to,from,locals,options))return to.self.reloadOnSearch!==!1&&$urlRouter.update(),$state.transition=null,$q.when($state.current);if(toParams=filterByKeys(to.params.$$keys(),toParams||{}),options.notify&&$rootScope.$broadcast("$stateChangeStart",to.self,toParams,from.self,fromParams).defaultPrevented)return $urlRouter.update(),TransitionPrevented;for(var resolved=$q.when(locals),l=keep;l<toPath.length;l++,state=toPath[l])locals=toLocals[l]=inherit(locals),resolved=resolveState(state,toParams,state===to,resolved,locals,options);var transition=$state.transition=resolved.then(function(){var l,entering,exiting;if($state.transition!==transition)return TransitionSuperseded;for(l=fromPath.length-1;l>=keep;l--)exiting=fromPath[l],exiting.self.onExit&&$injector.invoke(exiting.self.onExit,exiting.self,exiting.locals.globals),exiting.locals=null;for(l=keep;l<toPath.length;l++)entering=toPath[l],entering.locals=toLocals[l],entering.self.onEnter&&$injector.invoke(entering.self.onEnter,entering.self,entering.locals.globals);return $state.transition!==transition?TransitionSuperseded:($state.$current=to,$state.current=to.self,$state.params=toParams,copy($state.params,$stateParams),$state.transition=null,options.location&&to.navigable&&$urlRouter.push(to.navigable.url,to.navigable.locals.globals.$stateParams,{$$avoidResync:!0,replace:"replace"===options.location}),options.notify&&$rootScope.$broadcast("$stateChangeSuccess",to.self,toParams,from.self,fromParams),$urlRouter.update(!0),$state.current)},function(error){return $state.transition!==transition?TransitionSuperseded:($state.transition=null,evt=$rootScope.$broadcast("$stateChangeError",to.self,toParams,from.self,fromParams,error),evt.defaultPrevented||$urlRouter.update(),$q.reject(error))});return transition},$state.is=function(stateOrName,params,options){options=extend({relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);return isDefined(state)?$state.$current!==state?!1:params?equalForKeys(state.params.$$values(params),$stateParams):!0:undefined},$state.includes=function(stateOrName,params,options){if(options=extend({relative:$state.$current},options||{}),isString(stateOrName)&&isGlob(stateOrName)){if(!doesStateMatchGlob(stateOrName))return!1;stateOrName=$state.$current.name}var state=findState(stateOrName,options.relative);return isDefined(state)?isDefined($state.$current.includes[state.name])?params?equalForKeys(state.params.$$values(params),$stateParams,objectKeys(params)):!0:!1:undefined},$state.href=function(stateOrName,params,options){options=extend({lossy:!0,inherit:!0,absolute:!1,relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);if(!isDefined(state))return null;options.inherit&&(params=inheritParams($stateParams,params||{},$state.$current,state));var nav=state&&options.lossy?state.navigable:state;return nav&&nav.url!==undefined&&null!==nav.url?$urlRouter.href(nav.url,filterByKeys(state.params.$$keys(),params||{}),{absolute:options.absolute}):null},$state.get=function(stateOrName,context){if(0===arguments.length)return map(objectKeys(states),function(name){return states[name].self});var state=findState(stateOrName,context||$state.$current);return state&&state.self?state.self:null},$state}function shouldTriggerReload(to,from,locals,options){return to!==from||(locals!==from.locals||options.reload)&&to.self.reloadOnSearch!==!1?void 0:!0}var root,$state,states={},queue={},abstractKey="abstract",stateBuilder={parent:function(state){if(isDefined(state.parent)&&state.parent)return findState(state.parent);var compositeName=/^(.+)\.[^.]+$/.exec(state.name);return compositeName?findState(compositeName[1]):root},data:function(state){return state.parent&&state.parent.data&&(state.data=state.self.data=extend({},state.parent.data,state.data)),state.data},url:function(state){var url=state.url,config={params:state.params||{}};if(isString(url))return"^"==url.charAt(0)?$urlMatcherFactory.compile(url.substring(1),config):(state.parent.navigable||root).url.concat(url,config);if(!url||$urlMatcherFactory.isMatcher(url))return url;throw new Error("Invalid url '"+url+"' in state '"+state+"'")},navigable:function(state){return state.url?state:state.parent?state.parent.navigable:null},ownParams:function(state){var params=state.url&&state.url.params||new $$UMFP.ParamSet;return forEach(state.params||{},function(config,id){params[id]||(params[id]=new $$UMFP.Param(id,null,config,"config"))}),params},params:function(state){return state.parent&&state.parent.params?extend(state.parent.params.$$new(),state.ownParams):new $$UMFP.ParamSet},views:function(state){var views={};return forEach(isDefined(state.views)?state.views:{"":state},function(view,name){name.indexOf("@")<0&&(name+="@"+state.parent.name),views[name]=view
}),views},path:function(state){return state.parent?state.parent.path.concat(state):[]},includes:function(state){var includes=state.parent?extend({},state.parent.includes):{};return includes[state.name]=!0,includes},$delegates:{}};root=registerState({name:"",url:"^",views:null,"abstract":!0}),root.navigable=null,this.decorator=decorator,this.state=state,this.$get=$get,$get.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter","$location","$urlMatcherFactory"]}function $ViewProvider(){function $get($rootScope,$templateFactory){return{load:function(name,options){var result,defaults={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return options=extend(defaults,options),options.view&&(result=$templateFactory.fromConfig(options.view,options.params,options.locals)),result&&options.notify&&$rootScope.$broadcast("$viewContentLoading",options),result}}}this.$get=$get,$get.$inject=["$rootScope","$templateFactory"]}function $ViewScrollProvider(){var useAnchorScroll=!1;this.useAnchorScroll=function(){useAnchorScroll=!0},this.$get=["$anchorScroll","$timeout",function($anchorScroll,$timeout){return useAnchorScroll?$anchorScroll:function($element){$timeout(function(){$element[0].scrollIntoView()},0,!1)}}]}function $ViewDirective($state,$injector,$uiViewScroll,$interpolate){function getService(){return $injector.has?function(service){return $injector.has(service)?$injector.get(service):null}:function(service){try{return $injector.get(service)}catch(e){return null}}}function getRenderer(attrs,scope){var statics=function(){return{enter:function(element,target,cb){target.after(element),cb()},leave:function(element,cb){element.remove(),cb()}}};if($animate)return{enter:function(element,target,cb){var promise=$animate.enter(element,null,target,cb);promise&&promise.then&&promise.then(cb)},leave:function(element,cb){var promise=$animate.leave(element,cb);promise&&promise.then&&promise.then(cb)}};if($animator){var animate=$animator&&$animator(scope,attrs);return{enter:function(element,target,cb){animate.enter(element,null,target),cb()},leave:function(element,cb){animate.leave(element),cb()}}}return statics()}var service=getService(),$animator=service("$animator"),$animate=service("$animate"),directive={restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(tElement,tAttrs,$transclude){return function(scope,$element,attrs){function cleanupLastView(){previousEl&&(previousEl.remove(),previousEl=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentEl&&(renderer.leave(currentEl,function(){previousEl=null}),previousEl=currentEl,currentEl=null)}function updateView(firstTime){var newScope,name=getUiViewName(scope,attrs,$element,$interpolate),previousLocals=name&&$state.$current&&$state.$current.locals[name];if(firstTime||previousLocals!==latestLocals){newScope=scope.$new(),latestLocals=$state.$current.locals[name];var clone=$transclude(newScope,function(clone){renderer.enter(clone,$element,function(){currentScope&&currentScope.$emit("$viewContentAnimationEnded"),(angular.isDefined(autoScrollExp)&&!autoScrollExp||scope.$eval(autoScrollExp))&&$uiViewScroll(clone)}),cleanupLastView()});currentEl=clone,currentScope=newScope,currentScope.$emit("$viewContentLoaded"),currentScope.$eval(onloadExp)}}var previousEl,currentEl,currentScope,latestLocals,onloadExp=attrs.onload||"",autoScrollExp=attrs.autoscroll,renderer=getRenderer(attrs,scope);scope.$on("$stateChangeSuccess",function(){updateView(!1)}),scope.$on("$viewContentLoading",function(){updateView(!1)}),updateView(!0)}}};return directive}function $ViewDirectiveFill($compile,$controller,$state,$interpolate){return{restrict:"ECA",priority:-400,compile:function(tElement){var initial=tElement.html();return function(scope,$element,attrs){var current=$state.$current,name=getUiViewName(scope,attrs,$element,$interpolate),locals=current&&current.locals[name];if(locals){$element.data("$uiView",{name:name,state:locals.$$state}),$element.html(locals.$template?locals.$template:initial);var link=$compile($element.contents());if(locals.$$controller){locals.$scope=scope;var controller=$controller(locals.$$controller,locals);locals.$$controllerAs&&(scope[locals.$$controllerAs]=controller),$element.data("$ngControllerController",controller),$element.children().data("$ngControllerController",controller)}link(scope)}}}}}function getUiViewName(scope,attrs,element,$interpolate){var name=$interpolate(attrs.uiView||attrs.name||"")(scope),inherited=element.inheritedData("$uiView");return name.indexOf("@")>=0?name:name+"@"+(inherited?inherited.state.name:"")}function parseStateRef(ref,current){var parsed,preparsed=ref.match(/^\s*({[^}]*})\s*$/);if(preparsed&&(ref=current+"("+preparsed[1]+")"),parsed=ref.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/),!parsed||4!==parsed.length)throw new Error("Invalid state ref '"+ref+"'");return{state:parsed[1],paramExpr:parsed[3]||null}}function stateContext(el){var stateData=el.parent().inheritedData("$uiView");return stateData&&stateData.state&&stateData.state.name?stateData.state:void 0}function $StateRefDirective($state,$timeout){var allowedOptions=["location","inherit","reload"];return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(scope,element,attrs,uiSrefActive){var ref=parseStateRef(attrs.uiSref,$state.current.name),params=null,base=stateContext(element)||$state.$current,newHref=null,isAnchor="A"===element.prop("tagName"),isForm="FORM"===element[0].nodeName,attr=isForm?"action":"href",nav=!0,options={relative:base,inherit:!0},optionsOverride=scope.$eval(attrs.uiSrefOpts)||{};angular.forEach(allowedOptions,function(option){option in optionsOverride&&(options[option]=optionsOverride[option])});var update=function(newVal){if(newVal&&(params=angular.copy(newVal)),nav){newHref=$state.href(ref.state,params,options);var activeDirective=uiSrefActive[1]||uiSrefActive[0];return activeDirective&&activeDirective.$$setStateInfo(ref.state,params),null===newHref?(nav=!1,!1):void attrs.$set(attr,newHref)}};ref.paramExpr&&(scope.$watch(ref.paramExpr,function(newVal){newVal!==params&&update(newVal)},!0),params=angular.copy(scope.$eval(ref.paramExpr))),update(),isForm||element.bind("click",function(e){var button=e.which||e.button;if(!(button>1||e.ctrlKey||e.metaKey||e.shiftKey||element.attr("target"))){var transition=$timeout(function(){$state.go(ref.state,params,options)});e.preventDefault();var ignorePreventDefaultCount=isAnchor&&!newHref?1:0;e.preventDefault=function(){ignorePreventDefaultCount--<=0&&$timeout.cancel(transition)}}})}}}function $StateRefActiveDirective($state,$stateParams,$interpolate){return{restrict:"A",controller:["$scope","$element","$attrs",function($scope,$element,$attrs){function update(){isMatch()?$element.addClass(activeClass):$element.removeClass(activeClass)}function isMatch(){return"undefined"!=typeof $attrs.uiSrefActiveEq?state&&$state.is(state.name,params):state&&$state.includes(state.name,params)}var state,params,activeClass;activeClass=$interpolate($attrs.uiSrefActiveEq||$attrs.uiSrefActive||"",!1)($scope),this.$$setStateInfo=function(newState,newParams){state=$state.get(newState,stateContext($element)),params=newParams,update()},$scope.$on("$stateChangeSuccess",update)}]}}function $IsStateFilter($state){var isFilter=function(state){return $state.is(state)};return isFilter.$stateful=!0,isFilter}function $IncludedByStateFilter($state){var includesFilter=function(state){return $state.includes(state)};return includesFilter.$stateful=!0,includesFilter}var isDefined=angular.isDefined,isFunction=angular.isFunction,isString=angular.isString,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy;angular.module("ui.router.util",["ng"]),angular.module("ui.router.router",["ui.router.util"]),angular.module("ui.router.state",["ui.router.router","ui.router.util"]),angular.module("ui.router",["ui.router.state"]),angular.module("ui.router.compat",["ui.router"]),$Resolve.$inject=["$q","$injector"],angular.module("ui.router.util").service("$resolve",$Resolve),$TemplateFactory.$inject=["$http","$templateCache","$injector"],angular.module("ui.router.util").service("$templateFactory",$TemplateFactory);var $$UMFP;UrlMatcher.prototype.concat=function(pattern,config){var defaultConfig={caseInsensitive:$$UMFP.caseInsensitive(),strict:$$UMFP.strictMode(),squash:$$UMFP.defaultSquashPolicy()};return new UrlMatcher(this.sourcePath+pattern+this.sourceSearch,extend(defaultConfig,config),this)},UrlMatcher.prototype.toString=function(){return this.source},UrlMatcher.prototype.exec=function(path,searchParams){function decodePathArray(string){function reverseString(str){return str.split("").reverse().join("")}function unquoteDashes(str){return str.replace(/\\-/,"-")}var split=reverseString(string).split(/-(?!\\)/),allReversed=map(split,reverseString);return map(allReversed,unquoteDashes).reverse()}var m=this.regexp.exec(path);if(!m)return null;searchParams=searchParams||{};var i,j,paramName,paramNames=this.parameters(),nTotal=paramNames.length,nPath=this.segments.length-1,values={};if(nPath!==m.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(i=0;nPath>i;i++){paramName=paramNames[i];var param=this.params[paramName],paramVal=m[i+1];for(j=0;j<param.replace;j++)param.replace[j].from===paramVal&&(paramVal=param.replace[j].to);paramVal&&param.array===!0&&(paramVal=decodePathArray(paramVal)),values[paramName]=param.value(paramVal)}for(;nTotal>i;i++)paramName=paramNames[i],values[paramName]=this.params[paramName].value(searchParams[paramName]);return values},UrlMatcher.prototype.parameters=function(param){return isDefined(param)?this.params[param]||null:this.$$paramNames},UrlMatcher.prototype.validates=function(params){return this.params.$$validates(params)},UrlMatcher.prototype.format=function(values){function encodeDashes(str){return encodeURIComponent(str).replace(/-/g,function(c){return"%5C%"+c.charCodeAt(0).toString(16).toUpperCase()})}values=values||{};var segments=this.segments,params=this.parameters(),paramset=this.params;if(!this.validates(values))return null;var i,search=!1,nPath=segments.length-1,nTotal=params.length,result=segments[0];for(i=0;nTotal>i;i++){var isPathParam=nPath>i,name=params[i],param=paramset[name],value=param.value(values[name]),isDefaultValue=param.isOptional&&param.type.equals(param.value(),value),squash=isDefaultValue?param.squash:!1,encoded=param.type.encode(value);if(isPathParam){var nextSegment=segments[i+1];if(squash===!1)null!=encoded&&(result+=isArray(encoded)?map(encoded,encodeDashes).join("-"):encodeURIComponent(encoded)),result+=nextSegment;else if(squash===!0){var capture=result.match(/\/$/)?/\/?(.*)/:/(.*)/;result+=nextSegment.match(capture)[1]}else isString(squash)&&(result+=squash+nextSegment)}else{if(null==encoded||isDefaultValue&&squash!==!1)continue;isArray(encoded)||(encoded=[encoded]),encoded=map(encoded,encodeURIComponent).join("&"+name+"="),result+=(search?"&":"?")+(name+"="+encoded),search=!0}}return result},Type.prototype.is=function(){return!0},Type.prototype.encode=function(val){return val},Type.prototype.decode=function(val){return val},Type.prototype.equals=function(a,b){return a==b},Type.prototype.$subPattern=function(){var sub=this.pattern.toString();return sub.substr(1,sub.length-2)},Type.prototype.pattern=/.*/,Type.prototype.toString=function(){return"{Type:"+this.name+"}"},Type.prototype.$asArray=function(mode,isSearch){function ArrayType(type,mode){function bindTo(type,callbackName){return function(){return type[callbackName].apply(type,arguments)}}function arrayWrap(val){return isArray(val)?val:isDefined(val)?[val]:[]}function arrayUnwrap(val){switch(val.length){case 0:return undefined;case 1:return"auto"===mode?val[0]:val;default:return val}}function falsey(val){return!val}function arrayHandler(callback,allTruthyMode){return function(val){val=arrayWrap(val);var result=map(val,callback);return allTruthyMode===!0?0===filter(result,falsey).length:arrayUnwrap(result)}}function arrayEqualsHandler(callback){return function(val1,val2){var left=arrayWrap(val1),right=arrayWrap(val2);if(left.length!==right.length)return!1;for(var i=0;i<left.length;i++)if(!callback(left[i],right[i]))return!1;return!0}}this.encode=arrayHandler(bindTo(type,"encode")),this.decode=arrayHandler(bindTo(type,"decode")),this.is=arrayHandler(bindTo(type,"is"),!0),this.equals=arrayEqualsHandler(bindTo(type,"equals")),this.pattern=type.pattern,this.$arrayMode=mode}if(!mode)return this;if("auto"===mode&&!isSearch)throw new Error("'auto' array mode is for query parameters only");return new ArrayType(this,mode)},angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory),angular.module("ui.router.util").run(["$urlMatcherFactory",function(){}]),$UrlRouterProvider.$inject=["$locationProvider","$urlMatcherFactoryProvider"],angular.module("ui.router.router").provider("$urlRouter",$UrlRouterProvider),$StateProvider.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],angular.module("ui.router.state").value("$stateParams",{}).provider("$state",$StateProvider),$ViewProvider.$inject=[],angular.module("ui.router.state").provider("$view",$ViewProvider),angular.module("ui.router.state").provider("$uiViewScroll",$ViewScrollProvider),$ViewDirective.$inject=["$state","$injector","$uiViewScroll","$interpolate"],$ViewDirectiveFill.$inject=["$compile","$controller","$state","$interpolate"],angular.module("ui.router.state").directive("uiView",$ViewDirective),angular.module("ui.router.state").directive("uiView",$ViewDirectiveFill),$StateRefDirective.$inject=["$state","$timeout"],$StateRefActiveDirective.$inject=["$state","$stateParams","$interpolate"],angular.module("ui.router.state").directive("uiSref",$StateRefDirective).directive("uiSrefActive",$StateRefActiveDirective).directive("uiSrefActiveEq",$StateRefActiveDirective),$IsStateFilter.$inject=["$state"],$IncludedByStateFilter.$inject=["$state"],angular.module("ui.router.state").filter("isState",$IsStateFilter).filter("includedByState",$IncludedByStateFilter)}(window,window.angular),angular.module("pascalprecht.translate",["ng"]).run(["$translate",function($translate){var key=$translate.storageKey(),storage=$translate.storage();storage?storage.get(key)?$translate.use(storage.get(key)):angular.isString($translate.preferredLanguage())?$translate.use($translate.preferredLanguage()):storage.set(key,$translate.use()):angular.isString($translate.preferredLanguage())&&$translate.use($translate.preferredLanguage())}]),angular.module("pascalprecht.translate").provider("$translate",["$STORAGE_KEY",function($STORAGE_KEY){var $preferredLanguage,$languageKeyAliases,$fallbackLanguage,$fallbackWasString,$uses,$nextLang,$storageFactory,$storagePrefix,$missingTranslationHandlerFactory,$interpolationFactory,$loaderFactory,$loaderOptions,$notFoundIndicatorLeft,$notFoundIndicatorRight,loaderCache,$translationTable={},$availableLanguageKeys=[],$storageKey=$STORAGE_KEY,$interpolatorFactories=[],$interpolationSanitizationStrategy=!1,$cloakClassName="translate-cloak",$postCompilingEnabled=!1,NESTED_OBJECT_DELIMITER=".",version="2.4.2",getLocale=function(){var nav=window.navigator;return((angular.isArray(nav.languages)?nav.languages[0]:nav.language||nav.browserLanguage||nav.systemLanguage||nav.userLanguage)||"").split("-").join("_")},indexOf=function(array,searchElement){for(var i=0,len=array.length;len>i;i++)if(array[i]===searchElement)return i;return-1},trim=function(){return this.replace(/^\s+|\s+$/g,"")},negotiateLocale=function(preferred){for(var avail=[],locale=angular.lowercase(preferred),i=0,n=$availableLanguageKeys.length;n>i;i++)avail.push(angular.lowercase($availableLanguageKeys[i]));if(indexOf(avail,locale)>-1)return preferred;if($languageKeyAliases){var alias;for(var langKeyAlias in $languageKeyAliases){var hasWildcardKey=!1,hasExactKey=Object.prototype.hasOwnProperty.call($languageKeyAliases,langKeyAlias)&&angular.lowercase(langKeyAlias)===angular.lowercase(preferred);if("*"===langKeyAlias.slice(-1)&&(hasWildcardKey=langKeyAlias.slice(0,-1)===preferred.slice(0,langKeyAlias.length-1)),(hasExactKey||hasWildcardKey)&&(alias=$languageKeyAliases[langKeyAlias],indexOf(avail,angular.lowercase(alias))>-1))return alias}}var parts=preferred.split("_");return parts.length>1&&indexOf(avail,angular.lowercase(parts[0]))>-1?parts[0]:preferred},translations=function(langKey,translationTable){if(!langKey&&!translationTable)return $translationTable;if(langKey&&!translationTable){if(angular.isString(langKey))return $translationTable[langKey]}else angular.isObject($translationTable[langKey])||($translationTable[langKey]={}),angular.extend($translationTable[langKey],flatObject(translationTable));return this};this.translations=translations,this.cloakClassName=function(name){return name?($cloakClassName=name,this):$cloakClassName};var flatObject=function(data,path,result,prevKey){var key,keyWithPath,keyWithShortPath,val;path||(path=[]),result||(result={});for(key in data)Object.prototype.hasOwnProperty.call(data,key)&&(val=data[key],angular.isObject(val)?flatObject(val,path.concat(key),result,key):(keyWithPath=path.length?""+path.join(NESTED_OBJECT_DELIMITER)+NESTED_OBJECT_DELIMITER+key:key,path.length&&key===prevKey&&(keyWithShortPath=""+path.join(NESTED_OBJECT_DELIMITER),result[keyWithShortPath]="@:"+keyWithPath),result[keyWithPath]=val));return result};this.addInterpolation=function(factory){return $interpolatorFactories.push(factory),this},this.useMessageFormatInterpolation=function(){return this.useInterpolation("$translateMessageFormatInterpolation")},this.useInterpolation=function(factory){return $interpolationFactory=factory,this},this.useSanitizeValueStrategy=function(value){return $interpolationSanitizationStrategy=value,this},this.preferredLanguage=function(langKey){return setupPreferredLanguage(langKey),this};var setupPreferredLanguage=function(langKey){return langKey&&($preferredLanguage=langKey),$preferredLanguage};this.translationNotFoundIndicator=function(indicator){return this.translationNotFoundIndicatorLeft(indicator),this.translationNotFoundIndicatorRight(indicator),this},this.translationNotFoundIndicatorLeft=function(indicator){return indicator?($notFoundIndicatorLeft=indicator,this):$notFoundIndicatorLeft},this.translationNotFoundIndicatorRight=function(indicator){return indicator?($notFoundIndicatorRight=indicator,this):$notFoundIndicatorRight},this.fallbackLanguage=function(langKey){return fallbackStack(langKey),this};var fallbackStack=function(langKey){return langKey?(angular.isString(langKey)?($fallbackWasString=!0,$fallbackLanguage=[langKey]):angular.isArray(langKey)&&($fallbackWasString=!1,$fallbackLanguage=langKey),angular.isString($preferredLanguage)&&indexOf($fallbackLanguage,$preferredLanguage)<0&&$fallbackLanguage.push($preferredLanguage),this):$fallbackWasString?$fallbackLanguage[0]:$fallbackLanguage};this.use=function(langKey){if(langKey){if(!$translationTable[langKey]&&!$loaderFactory)throw new Error("$translateProvider couldn't find translationTable for langKey: '"+langKey+"'");return $uses=langKey,this}return $uses};var storageKey=function(key){return key?void($storageKey=key):$storagePrefix?$storagePrefix+$storageKey:$storageKey};this.storageKey=storageKey,this.useUrlLoader=function(url,options){return this.useLoader("$translateUrlLoader",angular.extend({url:url},options))},this.useStaticFilesLoader=function(options){return this.useLoader("$translateStaticFilesLoader",options)},this.useLoader=function(loaderFactory,options){return $loaderFactory=loaderFactory,$loaderOptions=options||{},this},this.useLocalStorage=function(){return this.useStorage("$translateLocalStorage")},this.useCookieStorage=function(){return this.useStorage("$translateCookieStorage")},this.useStorage=function(storageFactory){return $storageFactory=storageFactory,this},this.storagePrefix=function(prefix){return prefix?($storagePrefix=prefix,this):prefix},this.useMissingTranslationHandlerLog=function(){return this.useMissingTranslationHandler("$translateMissingTranslationHandlerLog")},this.useMissingTranslationHandler=function(factory){return $missingTranslationHandlerFactory=factory,this},this.usePostCompiling=function(value){return $postCompilingEnabled=!!value,this},this.determinePreferredLanguage=function(fn){var locale=fn&&angular.isFunction(fn)?fn():getLocale();return $preferredLanguage=$availableLanguageKeys.length?negotiateLocale(locale):locale,this},this.registerAvailableLanguageKeys=function(languageKeys,aliases){return languageKeys?($availableLanguageKeys=languageKeys,aliases&&($languageKeyAliases=aliases),this):$availableLanguageKeys},this.useLoaderCache=function(cache){return cache===!1?loaderCache=void 0:cache===!0?loaderCache=!0:"undefined"==typeof cache?loaderCache="$translationCache":cache&&(loaderCache=cache),this},this.$get=["$log","$injector","$rootScope","$q",function($log,$injector,$rootScope,$q){var Storage,fallbackIndex,startFallbackIteration,defaultInterpolator=$injector.get($interpolationFactory||"$translateDefaultInterpolation"),pendingLoader=!1,interpolatorHashMap={},langPromises={},$translate=function(translationId,interpolateParams,interpolationId){if(angular.isArray(translationId)){var translateAll=function(translationIds){for(var results={},promises=[],translate=function(translationId){var deferred=$q.defer(),regardless=function(value){results[translationId]=value,deferred.resolve([translationId,value])};return $translate(translationId,interpolateParams,interpolationId).then(regardless,regardless),deferred.promise},i=0,c=translationIds.length;c>i;i++)promises.push(translate(translationIds[i]));return $q.all(promises).then(function(){return results})};return translateAll(translationId)}var deferred=$q.defer();translationId&&(translationId=trim.apply(translationId));var promiseToWaitFor=function(){var promise=$preferredLanguage?langPromises[$preferredLanguage]:langPromises[$uses];if(fallbackIndex=0,$storageFactory&&!promise){var langKey=Storage.get($storageKey);if(promise=langPromises[langKey],$fallbackLanguage&&$fallbackLanguage.length){var index=indexOf($fallbackLanguage,langKey);fallbackIndex=0===index?1:0,indexOf($fallbackLanguage,$preferredLanguage)<0&&$fallbackLanguage.push($preferredLanguage)}}return promise}();return promiseToWaitFor?promiseToWaitFor.then(function(){determineTranslation(translationId,interpolateParams,interpolationId).then(deferred.resolve,deferred.reject)},deferred.reject):determineTranslation(translationId,interpolateParams,interpolationId).then(deferred.resolve,deferred.reject),deferred.promise},applyNotFoundIndicators=function(translationId){return $notFoundIndicatorLeft&&(translationId=[$notFoundIndicatorLeft,translationId].join(" ")),$notFoundIndicatorRight&&(translationId=[translationId,$notFoundIndicatorRight].join(" ")),translationId},useLanguage=function(key){$uses=key,$rootScope.$emit("$translateChangeSuccess",{language:key}),$storageFactory&&Storage.set($translate.storageKey(),$uses),defaultInterpolator.setLocale($uses),angular.forEach(interpolatorHashMap,function(interpolator,id){interpolatorHashMap[id].setLocale($uses)}),$rootScope.$emit("$translateChangeEnd",{language:key})},loadAsync=function(key){if(!key)throw"No language key specified for loading.";var deferred=$q.defer();$rootScope.$emit("$translateLoadingStart",{language:key}),pendingLoader=!0;var cache=loaderCache;"string"==typeof cache&&(cache=$injector.get(cache));var loaderOptions=angular.extend({},$loaderOptions,{key:key,$http:angular.extend({},{cache:cache},$loaderOptions.$http)});return $injector.get($loaderFactory)(loaderOptions).then(function(data){var translationTable={};$rootScope.$emit("$translateLoadingSuccess",{language:key}),angular.isArray(data)?angular.forEach(data,function(table){angular.extend(translationTable,flatObject(table))}):angular.extend(translationTable,flatObject(data)),pendingLoader=!1,deferred.resolve({key:key,table:translationTable}),$rootScope.$emit("$translateLoadingEnd",{language:key})},function(key){$rootScope.$emit("$translateLoadingError",{language:key}),deferred.reject(key),$rootScope.$emit("$translateLoadingEnd",{language:key})}),deferred.promise};if($storageFactory&&(Storage=$injector.get($storageFactory),!Storage.get||!Storage.set))throw new Error("Couldn't use storage '"+$storageFactory+"', missing get() or set() method!");angular.isFunction(defaultInterpolator.useSanitizeValueStrategy)&&defaultInterpolator.useSanitizeValueStrategy($interpolationSanitizationStrategy),$interpolatorFactories.length&&angular.forEach($interpolatorFactories,function(interpolatorFactory){var interpolator=$injector.get(interpolatorFactory);interpolator.setLocale($preferredLanguage||$uses),angular.isFunction(interpolator.useSanitizeValueStrategy)&&interpolator.useSanitizeValueStrategy($interpolationSanitizationStrategy),interpolatorHashMap[interpolator.getInterpolationIdentifier()]=interpolator});var getTranslationTable=function(langKey){var deferred=$q.defer();return Object.prototype.hasOwnProperty.call($translationTable,langKey)?deferred.resolve($translationTable[langKey]):langPromises[langKey]?langPromises[langKey].then(function(data){translations(data.key,data.table),deferred.resolve(data.table)},deferred.reject):deferred.reject(),deferred.promise},getFallbackTranslation=function(langKey,translationId,interpolateParams,Interpolator){var deferred=$q.defer();return getTranslationTable(langKey).then(function(translationTable){Object.prototype.hasOwnProperty.call(translationTable,translationId)?(Interpolator.setLocale(langKey),deferred.resolve(Interpolator.interpolate(translationTable[translationId],interpolateParams)),Interpolator.setLocale($uses)):deferred.reject()},deferred.reject),deferred.promise},getFallbackTranslationInstant=function(langKey,translationId,interpolateParams,Interpolator){var result,translationTable=$translationTable[langKey];return Object.prototype.hasOwnProperty.call(translationTable,translationId)&&(Interpolator.setLocale(langKey),result=Interpolator.interpolate(translationTable[translationId],interpolateParams),Interpolator.setLocale($uses)),result},translateByHandler=function(translationId){if($missingTranslationHandlerFactory){var resultString=$injector.get($missingTranslationHandlerFactory)(translationId,$uses);return void 0!==resultString?resultString:translationId}return translationId},resolveForFallbackLanguage=function(fallbackLanguageIndex,translationId,interpolateParams,Interpolator){var deferred=$q.defer();if(fallbackLanguageIndex<$fallbackLanguage.length){var langKey=$fallbackLanguage[fallbackLanguageIndex];getFallbackTranslation(langKey,translationId,interpolateParams,Interpolator).then(deferred.resolve,function(){resolveForFallbackLanguage(fallbackLanguageIndex+1,translationId,interpolateParams,Interpolator).then(deferred.resolve)})}else deferred.resolve(translateByHandler(translationId));return deferred.promise},resolveForFallbackLanguageInstant=function(fallbackLanguageIndex,translationId,interpolateParams,Interpolator){var result;if(fallbackLanguageIndex<$fallbackLanguage.length){var langKey=$fallbackLanguage[fallbackLanguageIndex];result=getFallbackTranslationInstant(langKey,translationId,interpolateParams,Interpolator),result||(result=resolveForFallbackLanguageInstant(fallbackLanguageIndex+1,translationId,interpolateParams,Interpolator))}return result},fallbackTranslation=function(translationId,interpolateParams,Interpolator){return resolveForFallbackLanguage(startFallbackIteration>0?startFallbackIteration:fallbackIndex,translationId,interpolateParams,Interpolator)},fallbackTranslationInstant=function(translationId,interpolateParams,Interpolator){return resolveForFallbackLanguageInstant(startFallbackIteration>0?startFallbackIteration:fallbackIndex,translationId,interpolateParams,Interpolator)},determineTranslation=function(translationId,interpolateParams,interpolationId){var deferred=$q.defer(),table=$uses?$translationTable[$uses]:$translationTable,Interpolator=interpolationId?interpolatorHashMap[interpolationId]:defaultInterpolator;if(table&&Object.prototype.hasOwnProperty.call(table,translationId)){var translation=table[translationId];"@:"===translation.substr(0,2)?$translate(translation.substr(2),interpolateParams,interpolationId).then(deferred.resolve,deferred.reject):deferred.resolve(Interpolator.interpolate(translation,interpolateParams))}else{var missingTranslationHandlerTranslation;$missingTranslationHandlerFactory&&!pendingLoader&&(missingTranslationHandlerTranslation=translateByHandler(translationId)),$uses&&$fallbackLanguage&&$fallbackLanguage.length?fallbackTranslation(translationId,interpolateParams,Interpolator).then(function(translation){deferred.resolve(translation)},function(_translationId){deferred.reject(applyNotFoundIndicators(_translationId))}):$missingTranslationHandlerFactory&&!pendingLoader&&missingTranslationHandlerTranslation?deferred.resolve(missingTranslationHandlerTranslation):deferred.reject(applyNotFoundIndicators(translationId))}return deferred.promise},determineTranslationInstant=function(translationId,interpolateParams,interpolationId){var result,table=$uses?$translationTable[$uses]:$translationTable,Interpolator=interpolationId?interpolatorHashMap[interpolationId]:defaultInterpolator;if(table&&Object.prototype.hasOwnProperty.call(table,translationId)){var translation=table[translationId];result="@:"===translation.substr(0,2)?determineTranslationInstant(translation.substr(2),interpolateParams,interpolationId):Interpolator.interpolate(translation,interpolateParams)}else{var missingTranslationHandlerTranslation;$missingTranslationHandlerFactory&&!pendingLoader&&(missingTranslationHandlerTranslation=translateByHandler(translationId)),$uses&&$fallbackLanguage&&$fallbackLanguage.length?(fallbackIndex=0,result=fallbackTranslationInstant(translationId,interpolateParams,Interpolator)):result=$missingTranslationHandlerFactory&&!pendingLoader&&missingTranslationHandlerTranslation?missingTranslationHandlerTranslation:applyNotFoundIndicators(translationId)}return result};if($translate.preferredLanguage=function(langKey){return langKey&&setupPreferredLanguage(langKey),$preferredLanguage},$translate.cloakClassName=function(){return $cloakClassName},$translate.fallbackLanguage=function(langKey){if(void 0!==langKey&&null!==langKey){if(fallbackStack(langKey),$loaderFactory&&$fallbackLanguage&&$fallbackLanguage.length)for(var i=0,len=$fallbackLanguage.length;len>i;i++)langPromises[$fallbackLanguage[i]]||(langPromises[$fallbackLanguage[i]]=loadAsync($fallbackLanguage[i]));$translate.use($translate.use())}return $fallbackWasString?$fallbackLanguage[0]:$fallbackLanguage},$translate.useFallbackLanguage=function(langKey){if(void 0!==langKey&&null!==langKey)if(langKey){var langKeyPosition=indexOf($fallbackLanguage,langKey);langKeyPosition>-1&&(startFallbackIteration=langKeyPosition)}else startFallbackIteration=0},$translate.proposedLanguage=function(){return $nextLang},$translate.storage=function(){return Storage},$translate.use=function(key){if(!key)return $uses;var deferred=$q.defer();$rootScope.$emit("$translateChangeStart",{language:key});var aliasedKey=negotiateLocale(key);return aliasedKey&&(key=aliasedKey),$translationTable[key]||!$loaderFactory||langPromises[key]?(deferred.resolve(key),useLanguage(key)):($nextLang=key,langPromises[key]=loadAsync(key).then(function(translation){translations(translation.key,translation.table),deferred.resolve(translation.key),useLanguage(translation.key),$nextLang===key&&($nextLang=void 0)},function(key){$nextLang===key&&($nextLang=void 0),$rootScope.$emit("$translateChangeError",{language:key}),deferred.reject(key),$rootScope.$emit("$translateChangeEnd",{language:key})})),deferred.promise},$translate.storageKey=function(){return storageKey()},$translate.isPostCompilingEnabled=function(){return $postCompilingEnabled},$translate.refresh=function(langKey){function resolve(){deferred.resolve(),$rootScope.$emit("$translateRefreshEnd",{language:langKey})
}function reject(){deferred.reject(),$rootScope.$emit("$translateRefreshEnd",{language:langKey})}if(!$loaderFactory)throw new Error("Couldn't refresh translation table, no loader registered!");var deferred=$q.defer();if($rootScope.$emit("$translateRefreshStart",{language:langKey}),langKey)$translationTable[langKey]?loadAsync(langKey).then(function(data){translations(data.key,data.table),langKey===$uses&&useLanguage($uses),resolve()},reject):reject();else{var tables=[],loadingKeys={};if($fallbackLanguage&&$fallbackLanguage.length)for(var i=0,len=$fallbackLanguage.length;len>i;i++)tables.push(loadAsync($fallbackLanguage[i])),loadingKeys[$fallbackLanguage[i]]=!0;$uses&&!loadingKeys[$uses]&&tables.push(loadAsync($uses)),$q.all(tables).then(function(tableData){angular.forEach(tableData,function(data){$translationTable[data.key]&&delete $translationTable[data.key],translations(data.key,data.table)}),$uses&&useLanguage($uses),resolve()})}return deferred.promise},$translate.instant=function(translationId,interpolateParams,interpolationId){if(null===translationId||angular.isUndefined(translationId))return translationId;if(angular.isArray(translationId)){for(var results={},i=0,c=translationId.length;c>i;i++)results[translationId[i]]=$translate.instant(translationId[i],interpolateParams,interpolationId);return results}if(angular.isString(translationId)&&translationId.length<1)return translationId;translationId&&(translationId=trim.apply(translationId));var result,possibleLangKeys=[];$preferredLanguage&&possibleLangKeys.push($preferredLanguage),$uses&&possibleLangKeys.push($uses),$fallbackLanguage&&$fallbackLanguage.length&&(possibleLangKeys=possibleLangKeys.concat($fallbackLanguage));for(var j=0,d=possibleLangKeys.length;d>j;j++){var possibleLangKey=possibleLangKeys[j];if($translationTable[possibleLangKey]&&"undefined"!=typeof $translationTable[possibleLangKey][translationId]&&(result=determineTranslationInstant(translationId,interpolateParams,interpolationId)),"undefined"!=typeof result)break}return result||""===result||(result=defaultInterpolator.interpolate(translationId,interpolateParams),$missingTranslationHandlerFactory&&!pendingLoader&&(result=translateByHandler(translationId))),result},$translate.versionInfo=function(){return version},$translate.loaderCache=function(){return loaderCache},$loaderFactory&&(angular.equals($translationTable,{})&&$translate.use($translate.use()),$fallbackLanguage&&$fallbackLanguage.length))for(var processAsyncResult=function(translation){translations(translation.key,translation.table),$rootScope.$emit("$translateChangeEnd",{language:translation.key})},i=0,len=$fallbackLanguage.length;len>i;i++)langPromises[$fallbackLanguage[i]]=loadAsync($fallbackLanguage[i]).then(processAsyncResult);return $translate}]}]),angular.module("pascalprecht.translate").factory("$translateDefaultInterpolation",["$interpolate",function($interpolate){var $locale,$translateInterpolator={},$identifier="default",$sanitizeValueStrategy=null,sanitizeValueStrategies={escaped:function(params){var result={};for(var key in params)Object.prototype.hasOwnProperty.call(params,key)&&(result[key]=angular.element("<div></div>").text(params[key]).html());return result}},sanitizeParams=function(params){var result;return result=angular.isFunction(sanitizeValueStrategies[$sanitizeValueStrategy])?sanitizeValueStrategies[$sanitizeValueStrategy](params):params};return $translateInterpolator.setLocale=function(locale){$locale=locale},$translateInterpolator.getInterpolationIdentifier=function(){return $identifier},$translateInterpolator.useSanitizeValueStrategy=function(value){return $sanitizeValueStrategy=value,this},$translateInterpolator.interpolate=function(string,interpolateParams){return $sanitizeValueStrategy&&(interpolateParams=sanitizeParams(interpolateParams)),$interpolate(string)(interpolateParams||{})},$translateInterpolator}]),angular.module("pascalprecht.translate").constant("$STORAGE_KEY","NG_TRANSLATE_LANG_KEY"),angular.module("pascalprecht.translate").directive("translate",["$translate","$q","$interpolate","$compile","$parse","$rootScope",function($translate,$q,$interpolate,$compile,$parse,$rootScope){return{restrict:"AE",scope:!0,compile:function(tElement,tAttr){var translateValuesExist=tAttr.translateValues?tAttr.translateValues:void 0,translateInterpolation=tAttr.translateInterpolation?tAttr.translateInterpolation:void 0,translateValueExist=tElement[0].outerHTML.match(/translate-value-+/i),interpolateRegExp="^(.*)("+$interpolate.startSymbol()+".*"+$interpolate.endSymbol()+")(.*)";return function(scope,iElement,iAttr){if(scope.interpolateParams={},scope.preText="",scope.postText="",iAttr.$observe("translate",function(translationId){if(angular.equals(translationId,"")||!angular.isDefined(translationId)){var interpolateMatches=iElement.text().match(interpolateRegExp);angular.isArray(interpolateMatches)?(scope.preText=interpolateMatches[1],scope.postText=interpolateMatches[3],scope.translationId=$interpolate(interpolateMatches[2])(scope.$parent)):scope.translationId=iElement.text().replace(/^\s+|\s+$/g,"")}else scope.translationId=translationId}),iAttr.$observe("translateDefault",function(value){scope.defaultText=value}),translateValuesExist&&iAttr.$observe("translateValues",function(interpolateParams){interpolateParams&&scope.$parent.$watch(function(){angular.extend(scope.interpolateParams,$parse(interpolateParams)(scope.$parent))})}),translateValueExist){var fn=function(attrName){iAttr.$observe(attrName,function(value){scope.interpolateParams[angular.lowercase(attrName.substr(14,1))+attrName.substr(15)]=value})};for(var attr in iAttr)Object.prototype.hasOwnProperty.call(iAttr,attr)&&"translateValue"===attr.substr(0,14)&&"translateValues"!==attr&&fn(attr)}var applyElementContent=function(value,scope,successful){successful||"undefined"==typeof scope.defaultText||(value=scope.defaultText),iElement.html(scope.preText+value+scope.postText);var globallyEnabled=$translate.isPostCompilingEnabled(),locallyDefined="undefined"!=typeof tAttr.translateCompile,locallyEnabled=locallyDefined&&"false"!==tAttr.translateCompile;(globallyEnabled&&!locallyDefined||locallyEnabled)&&$compile(iElement.contents())(scope)},updateTranslationFn=function(){return translateValuesExist||translateValueExist?function(){var updateTranslations=function(){scope.translationId&&scope.interpolateParams&&$translate(scope.translationId,scope.interpolateParams,translateInterpolation).then(function(translation){applyElementContent(translation,scope,!0)},function(translationId){applyElementContent(translationId,scope,!1)})};scope.$watch("interpolateParams",updateTranslations,!0),scope.$watch("translationId",updateTranslations)}:function(){var unwatch=scope.$watch("translationId",function(value){scope.translationId&&value&&$translate(value,{},translateInterpolation).then(function(translation){applyElementContent(translation,scope,!0),unwatch()},function(translationId){applyElementContent(translationId,scope,!1),unwatch()})},!0)}}(),unbind=$rootScope.$on("$translateChangeSuccess",updateTranslationFn);updateTranslationFn(),scope.$on("$destroy",unbind)}}}}]),angular.module("pascalprecht.translate").directive("translateCloak",["$rootScope","$translate",function($rootScope,$translate){return{compile:function(tElement){var applyCloak=function(){tElement.addClass($translate.cloakClassName())},removeCloak=function(){tElement.removeClass($translate.cloakClassName())},removeListener=$rootScope.$on("$translateChangeEnd",function(){removeCloak(),removeListener(),removeListener=null});return applyCloak(),function(scope,iElement,iAttr){iAttr.translateCloak&&iAttr.translateCloak.length&&iAttr.$observe("translateCloak",function(translationId){$translate(translationId).then(removeCloak,applyCloak)})}}}}]),angular.module("pascalprecht.translate").filter("translate",["$parse","$translate",function($parse,$translate){var translateFilter=function(translationId,interpolateParams,interpolation){return angular.isObject(interpolateParams)||(interpolateParams=$parse(interpolateParams)(this)),$translate.instant(translationId,interpolateParams,interpolation)};return translateFilter.$stateful=!0,translateFilter}]),function(global,factory){"function"==typeof define&&define.amd?define([],factory):"undefined"!=typeof module&&module.exports?module.exports=factory():global.tv4=factory()}(this,function(){function recursiveCompare(A,B){if(A===B)return!0;if("object"==typeof A&&"object"==typeof B){if(Array.isArray(A)!==Array.isArray(B))return!1;if(Array.isArray(A)){if(A.length!==B.length)return!1;for(var i=0;i<A.length;i++)if(!recursiveCompare(A[i],B[i]))return!1}else{var key;for(key in A)if(void 0===B[key]&&void 0!==A[key])return!1;for(key in B)if(void 0===A[key]&&void 0!==B[key])return!1;for(key in A)if(!recursiveCompare(A[key],B[key]))return!1}return!0}return!1}function parseURI(url){var m=String(url).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return m?{href:m[0]||"",protocol:m[1]||"",authority:m[2]||"",host:m[3]||"",hostname:m[4]||"",port:m[5]||"",pathname:m[6]||"",search:m[7]||"",hash:m[8]||""}:null}function resolveUrl(base,href){function removeDotSegments(input){var output=[];return input.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(p){"/.."===p?output.pop():output.push(p)}),output.join("").replace(/^\//,"/"===input.charAt(0)?"/":"")}return href=parseURI(href||""),base=parseURI(base||""),href&&base?(href.protocol||base.protocol)+(href.protocol||href.authority?href.authority:base.authority)+removeDotSegments(href.protocol||href.authority||"/"===href.pathname.charAt(0)?href.pathname:href.pathname?(base.authority&&!base.pathname?"/":"")+base.pathname.slice(0,base.pathname.lastIndexOf("/")+1)+href.pathname:base.pathname)+(href.protocol||href.authority||href.pathname?href.search:href.search||base.search)+href.hash:null}function getDocumentUri(uri){return uri.split("#")[0]}function normSchema(schema,baseUri){if(schema&&"object"==typeof schema)if(void 0===baseUri?baseUri=schema.id:"string"==typeof schema.id&&(baseUri=resolveUrl(baseUri,schema.id),schema.id=baseUri),Array.isArray(schema))for(var i=0;i<schema.length;i++)normSchema(schema[i],baseUri);else{"string"==typeof schema.$ref&&(schema.$ref=resolveUrl(baseUri,schema.$ref));for(var key in schema)"enum"!==key&&normSchema(schema[key],baseUri)}}function ValidationError(code,message,dataPath,schemaPath,subErrors){if(Error.call(this),void 0===code)throw new Error("No code supplied for error: "+message);this.message=message,this.code=code,this.dataPath=dataPath||"",this.schemaPath=schemaPath||"",this.subErrors=subErrors||null;var err=new Error(this.message);if(this.stack=err.stack||err.stacktrace,!this.stack)try{throw err}catch(err){this.stack=err.stack||err.stacktrace}}function isTrustedUrl(baseUrl,testUrl){if(testUrl.substring(0,baseUrl.length)===baseUrl){var remainder=testUrl.substring(baseUrl.length);if(testUrl.length>0&&"/"===testUrl.charAt(baseUrl.length-1)||"#"===remainder.charAt(0)||"?"===remainder.charAt(0))return!0}return!1}function createApi(language){var globalContext=new ValidatorContext,currentLanguage=language||"en",api={addFormat:function(){globalContext.addFormat.apply(globalContext,arguments)},language:function(code){return code?(languages[code]||(code=code.split("-")[0]),languages[code]?(currentLanguage=code,code):!1):currentLanguage},addLanguage:function(code,messageMap){var key;for(key in ErrorCodes)messageMap[key]&&!messageMap[ErrorCodes[key]]&&(messageMap[ErrorCodes[key]]=messageMap[key]);var rootCode=code.split("-")[0];if(languages[rootCode]){languages[code]=Object.create(languages[rootCode]);for(key in messageMap)"undefined"==typeof languages[rootCode][key]&&(languages[rootCode][key]=messageMap[key]),languages[code][key]=messageMap[key]}else languages[code]=messageMap,languages[rootCode]=messageMap;return this},freshApi:function(language){var result=createApi();return language&&result.language(language),result},validate:function(data,schema,checkRecursive,banUnknownProperties){var context=new ValidatorContext(globalContext,!1,languages[currentLanguage],checkRecursive,banUnknownProperties);"string"==typeof schema&&(schema={$ref:schema}),context.addSchema("",schema);var error=context.validateAll(data,schema,null,null,"");return!error&&banUnknownProperties&&(error=context.banUnknownProperties()),this.error=error,this.missing=context.missing,this.valid=null===error,this.valid},validateResult:function(){var result={};return this.validate.apply(result,arguments),result},validateMultiple:function(data,schema,checkRecursive,banUnknownProperties){var context=new ValidatorContext(globalContext,!0,languages[currentLanguage],checkRecursive,banUnknownProperties);"string"==typeof schema&&(schema={$ref:schema}),context.addSchema("",schema),context.validateAll(data,schema,null,null,""),banUnknownProperties&&context.banUnknownProperties();var result={};return result.errors=context.errors,result.missing=context.missing,result.valid=0===result.errors.length,result},addSchema:function(){return globalContext.addSchema.apply(globalContext,arguments)},getSchema:function(){return globalContext.getSchema.apply(globalContext,arguments)},getSchemaMap:function(){return globalContext.getSchemaMap.apply(globalContext,arguments)},getSchemaUris:function(){return globalContext.getSchemaUris.apply(globalContext,arguments)},getMissingUris:function(){return globalContext.getMissingUris.apply(globalContext,arguments)},dropSchemas:function(){globalContext.dropSchemas.apply(globalContext,arguments)},defineKeyword:function(){globalContext.defineKeyword.apply(globalContext,arguments)},defineError:function(codeName,codeNumber,defaultMessage){if("string"!=typeof codeName||!/^[A-Z]+(_[A-Z]+)*$/.test(codeName))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof codeNumber||codeNumber%1!==0||1e4>codeNumber)throw new Error("Code number must be an integer > 10000");if("undefined"!=typeof ErrorCodes[codeName])throw new Error("Error already defined: "+codeName+" as "+ErrorCodes[codeName]);if("undefined"!=typeof ErrorCodeLookup[codeNumber])throw new Error("Error code already used: "+ErrorCodeLookup[codeNumber]+" as "+codeNumber);ErrorCodes[codeName]=codeNumber,ErrorCodeLookup[codeNumber]=codeName,ErrorMessagesDefault[codeName]=ErrorMessagesDefault[codeNumber]=defaultMessage;for(var langCode in languages){var language=languages[langCode];language[codeName]&&(language[codeNumber]=language[codeNumber]||language[codeName])}},reset:function(){globalContext.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:normSchema,resolveUrl:resolveUrl,getDocumentUri:getDocumentUri,errorCodes:ErrorCodes};return api}Object.keys||(Object.keys=function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;return function(obj){if("object"!=typeof obj&&"function"!=typeof obj||null===obj)throw new TypeError("Object.keys called on non-object");var result=[];for(var prop in obj)hasOwnProperty.call(obj,prop)&&result.push(prop);if(hasDontEnumBug)for(var i=0;dontEnumsLength>i;i++)hasOwnProperty.call(obj,dontEnums[i])&&result.push(dontEnums[i]);return result}}()),Object.create||(Object.create=function(){function F(){}return function(o){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return F.prototype=o,new F}}()),Array.isArray||(Array.isArray=function(vArg){return"[object Array]"===Object.prototype.toString.call(vArg)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&1/0!==n&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);len>k;k++)if(k in t&&t[k]===searchElement)return k;return-1}),Object.isFrozen||(Object.isFrozen=function(obj){for(var key="tv4_test_frozen_key";obj.hasOwnProperty(key);)key+=Math.random();try{return obj[key]=!0,delete obj[key],!1}catch(e){return!0}});var ValidatorContext=function(parent,collectMultiple,errorMessages,checkRecursive,trackUnknownProperties){if(this.missing=[],this.missingMap={},this.formatValidators=parent?Object.create(parent.formatValidators):{},this.schemas=parent?Object.create(parent.schemas):{},this.collectMultiple=collectMultiple,this.errors=[],this.handleError=collectMultiple?this.collectError:this.returnError,checkRecursive&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),trackUnknownProperties&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorMessages=errorMessages,this.definedKeywords={},parent)for(var key in parent.definedKeywords)this.definedKeywords[key]=parent.definedKeywords[key].slice(0)};ValidatorContext.prototype.defineKeyword=function(keyword,keywordFunction){this.definedKeywords[keyword]=this.definedKeywords[keyword]||[],this.definedKeywords[keyword].push(keywordFunction)},ValidatorContext.prototype.createError=function(code,messageParams,dataPath,schemaPath,subErrors){var messageTemplate=this.errorMessages[code]||ErrorMessagesDefault[code];if("string"!=typeof messageTemplate)return new ValidationError(code,"Unknown error code "+code+": "+JSON.stringify(messageParams),dataPath,schemaPath,subErrors);var message=messageTemplate.replace(/\{([^{}]*)\}/g,function(whole,varName){var subValue=messageParams[varName];return"string"==typeof subValue||"number"==typeof subValue?subValue:whole});return new ValidationError(code,message,dataPath,schemaPath,subErrors)},ValidatorContext.prototype.returnError=function(error){return error},ValidatorContext.prototype.collectError=function(error){return error&&this.errors.push(error),null},ValidatorContext.prototype.prefixErrors=function(startIndex,dataPath,schemaPath){for(var i=startIndex;i<this.errors.length;i++)this.errors[i]=this.errors[i].prefixWith(dataPath,schemaPath);return this},ValidatorContext.prototype.banUnknownProperties=function(){for(var unknownPath in this.unknownPropertyPaths){var error=this.createError(ErrorCodes.UNKNOWN_PROPERTY,{path:unknownPath},unknownPath,""),result=this.handleError(error);if(result)return result}return null},ValidatorContext.prototype.addFormat=function(format,validator){if("object"==typeof format){for(var key in format)this.addFormat(key,format[key]);return this}this.formatValidators[format]=validator},ValidatorContext.prototype.resolveRefs=function(schema,urlHistory){if(void 0!==schema.$ref){if(urlHistory=urlHistory||{},urlHistory[schema.$ref])return this.createError(ErrorCodes.CIRCULAR_REFERENCE,{urls:Object.keys(urlHistory).join(", ")},"","");urlHistory[schema.$ref]=!0,schema=this.getSchema(schema.$ref,urlHistory)}return schema},ValidatorContext.prototype.getSchema=function(url,urlHistory){var schema;if(void 0!==this.schemas[url])return schema=this.schemas[url],this.resolveRefs(schema,urlHistory);var baseUrl=url,fragment="";if(-1!==url.indexOf("#")&&(fragment=url.substring(url.indexOf("#")+1),baseUrl=url.substring(0,url.indexOf("#"))),"object"==typeof this.schemas[baseUrl]){schema=this.schemas[baseUrl];var pointerPath=decodeURIComponent(fragment);if(""===pointerPath)return this.resolveRefs(schema,urlHistory);if("/"!==pointerPath.charAt(0))return void 0;for(var parts=pointerPath.split("/").slice(1),i=0;i<parts.length;i++){var component=parts[i].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===schema[component]){schema=void 0;break}schema=schema[component]}if(void 0!==schema)return this.resolveRefs(schema,urlHistory)}void 0===this.missing[baseUrl]&&(this.missing.push(baseUrl),this.missing[baseUrl]=baseUrl,this.missingMap[baseUrl]=baseUrl)},ValidatorContext.prototype.searchSchemas=function(schema,url){if(schema&&"object"==typeof schema){"string"==typeof schema.id&&isTrustedUrl(url,schema.id)&&void 0===this.schemas[schema.id]&&(this.schemas[schema.id]=schema);for(var key in schema)if("enum"!==key)if("object"==typeof schema[key])this.searchSchemas(schema[key],url);else if("$ref"===key){var uri=getDocumentUri(schema[key]);uri&&void 0===this.schemas[uri]&&void 0===this.missingMap[uri]&&(this.missingMap[uri]=uri)}}},ValidatorContext.prototype.addSchema=function(url,schema){if("string"!=typeof url||"undefined"==typeof schema){if("object"!=typeof url||"string"!=typeof url.id)return;schema=url,url=schema.id}(url=getDocumentUri(url)+"#")&&(url=getDocumentUri(url)),this.schemas[url]=schema,delete this.missingMap[url],normSchema(schema,url),this.searchSchemas(schema,url)},ValidatorContext.prototype.getSchemaMap=function(){var map={};for(var key in this.schemas)map[key]=this.schemas[key];return map},ValidatorContext.prototype.getSchemaUris=function(filterRegExp){var list=[];for(var key in this.schemas)(!filterRegExp||filterRegExp.test(key))&&list.push(key);return list},ValidatorContext.prototype.getMissingUris=function(filterRegExp){var list=[];for(var key in this.missingMap)(!filterRegExp||filterRegExp.test(key))&&list.push(key);return list},ValidatorContext.prototype.dropSchemas=function(){this.schemas={},this.reset()},ValidatorContext.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},ValidatorContext.prototype.validateAll=function(data,schema,dataPathParts,schemaPathParts,dataPointerPath){var topLevel;if(schema=this.resolveRefs(schema),!schema)return null;if(schema instanceof ValidationError)return this.errors.push(schema),schema;var frozenIndex,startErrorCount=this.errors.length,scannedFrozenSchemaIndex=null,scannedSchemasIndex=null;if(this.checkRecursive&&data&&"object"==typeof data){if(topLevel=!this.scanned.length,data[this.validatedSchemasKey]){var schemaIndex=data[this.validatedSchemasKey].indexOf(schema);if(-1!==schemaIndex)return this.errors=this.errors.concat(data[this.validationErrorsKey][schemaIndex]),null}if(Object.isFrozen(data)&&(frozenIndex=this.scannedFrozen.indexOf(data),-1!==frozenIndex)){var frozenSchemaIndex=this.scannedFrozenSchemas[frozenIndex].indexOf(schema);if(-1!==frozenSchemaIndex)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[frozenIndex][frozenSchemaIndex]),null}if(this.scanned.push(data),Object.isFrozen(data))-1===frozenIndex&&(frozenIndex=this.scannedFrozen.length,this.scannedFrozen.push(data),this.scannedFrozenSchemas.push([])),scannedFrozenSchemaIndex=this.scannedFrozenSchemas[frozenIndex].length,this.scannedFrozenSchemas[frozenIndex][scannedFrozenSchemaIndex]=schema,this.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex]=[];else{if(!data[this.validatedSchemasKey])try{Object.defineProperty(data,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(data,this.validationErrorsKey,{value:[],configurable:!0})}catch(e){data[this.validatedSchemasKey]=[],data[this.validationErrorsKey]=[]}scannedSchemasIndex=data[this.validatedSchemasKey].length,data[this.validatedSchemasKey][scannedSchemasIndex]=schema,data[this.validationErrorsKey][scannedSchemasIndex]=[]}}var errorCount=this.errors.length,error=this.validateBasic(data,schema,dataPointerPath)||this.validateNumeric(data,schema,dataPointerPath)||this.validateString(data,schema,dataPointerPath)||this.validateArray(data,schema,dataPointerPath)||this.validateObject(data,schema,dataPointerPath)||this.validateCombinations(data,schema,dataPointerPath)||this.validateFormat(data,schema,dataPointerPath)||this.validateDefinedKeywords(data,schema,dataPointerPath)||null;if(topLevel){for(;this.scanned.length;){var item=this.scanned.pop();delete item[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(error||errorCount!==this.errors.length)for(;dataPathParts&&dataPathParts.length||schemaPathParts&&schemaPathParts.length;){var dataPart=dataPathParts&&dataPathParts.length?""+dataPathParts.pop():null,schemaPart=schemaPathParts&&schemaPathParts.length?""+schemaPathParts.pop():null;error&&(error=error.prefixWith(dataPart,schemaPart)),this.prefixErrors(errorCount,dataPart,schemaPart)}return null!==scannedFrozenSchemaIndex?this.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex]=this.errors.slice(startErrorCount):null!==scannedSchemasIndex&&(data[this.validationErrorsKey][scannedSchemasIndex]=this.errors.slice(startErrorCount)),this.handleError(error)},ValidatorContext.prototype.validateFormat=function(data,schema){if("string"!=typeof schema.format||!this.formatValidators[schema.format])return null;var errorMessage=this.formatValidators[schema.format].call(null,data,schema);return"string"==typeof errorMessage||"number"==typeof errorMessage?this.createError(ErrorCodes.FORMAT_CUSTOM,{message:errorMessage}).prefixWith(null,"format"):errorMessage&&"object"==typeof errorMessage?this.createError(ErrorCodes.FORMAT_CUSTOM,{message:errorMessage.message||"?"},errorMessage.dataPath||null,errorMessage.schemaPath||"/format"):null},ValidatorContext.prototype.validateDefinedKeywords=function(data,schema){for(var key in this.definedKeywords)for(var validationFunctions=this.definedKeywords[key],i=0;i<validationFunctions.length;i++){var func=validationFunctions[i],result=func(data,schema[key],schema);if("string"==typeof result||"number"==typeof result)return this.createError(ErrorCodes.KEYWORD_CUSTOM,{key:key,message:result}).prefixWith(null,"format");if(result&&"object"==typeof result){var code=result.code||ErrorCodes.KEYWORD_CUSTOM;if("string"==typeof code){if(!ErrorCodes[code])throw new Error("Undefined error code (use defineError): "+code);code=ErrorCodes[code]}var messageParams="object"==typeof result.message?result.message:{key:key,message:result.message||"?"},schemaPath=result.schemaPath||"/"+key.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(code,messageParams,result.dataPath||null,schemaPath)}}return null},ValidatorContext.prototype.validateBasic=function(data,schema,dataPointerPath){var error;return(error=this.validateType(data,schema,dataPointerPath))?error.prefixWith(null,"type"):(error=this.validateEnum(data,schema,dataPointerPath))?error.prefixWith(null,"type"):null},ValidatorContext.prototype.validateType=function(data,schema){if(void 0===schema.type)return null;var dataType=typeof data;null===data?dataType="null":Array.isArray(data)&&(dataType="array");var allowedTypes=schema.type;"object"!=typeof allowedTypes&&(allowedTypes=[allowedTypes]);for(var i=0;i<allowedTypes.length;i++){var type=allowedTypes[i];if(type===dataType||"integer"===type&&"number"===dataType&&data%1===0)return null}return this.createError(ErrorCodes.INVALID_TYPE,{type:dataType,expected:allowedTypes.join("/")})},ValidatorContext.prototype.validateEnum=function(data,schema){if(void 0===schema["enum"])return null;for(var i=0;i<schema["enum"].length;i++){var enumVal=schema["enum"][i];if(recursiveCompare(data,enumVal))return null}return this.createError(ErrorCodes.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(data):data})},ValidatorContext.prototype.validateNumeric=function(data,schema,dataPointerPath){return this.validateMultipleOf(data,schema,dataPointerPath)||this.validateMinMax(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateMultipleOf=function(data,schema){var multipleOf=schema.multipleOf||schema.divisibleBy;return void 0===multipleOf?null:"number"==typeof data&&data%multipleOf!==0?this.createError(ErrorCodes.NUMBER_MULTIPLE_OF,{value:data,multipleOf:multipleOf}):null},ValidatorContext.prototype.validateMinMax=function(data,schema){if("number"!=typeof data)return null;if(void 0!==schema.minimum){if(data<schema.minimum)return this.createError(ErrorCodes.NUMBER_MINIMUM,{value:data,minimum:schema.minimum}).prefixWith(null,"minimum");if(schema.exclusiveMinimum&&data===schema.minimum)return this.createError(ErrorCodes.NUMBER_MINIMUM_EXCLUSIVE,{value:data,minimum:schema.minimum}).prefixWith(null,"exclusiveMinimum")}if(void 0!==schema.maximum){if(data>schema.maximum)return this.createError(ErrorCodes.NUMBER_MAXIMUM,{value:data,maximum:schema.maximum}).prefixWith(null,"maximum");if(schema.exclusiveMaximum&&data===schema.maximum)return this.createError(ErrorCodes.NUMBER_MAXIMUM_EXCLUSIVE,{value:data,maximum:schema.maximum}).prefixWith(null,"exclusiveMaximum")}return null},ValidatorContext.prototype.validateString=function(data,schema,dataPointerPath){return this.validateStringLength(data,schema,dataPointerPath)||this.validateStringPattern(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateStringLength=function(data,schema){return"string"!=typeof data?null:void 0!==schema.minLength&&data.length<schema.minLength?this.createError(ErrorCodes.STRING_LENGTH_SHORT,{length:data.length,minimum:schema.minLength}).prefixWith(null,"minLength"):void 0!==schema.maxLength&&data.length>schema.maxLength?this.createError(ErrorCodes.STRING_LENGTH_LONG,{length:data.length,maximum:schema.maxLength}).prefixWith(null,"maxLength"):null},ValidatorContext.prototype.validateStringPattern=function(data,schema){if("string"!=typeof data||void 0===schema.pattern)return null;var regexp=new RegExp(schema.pattern);return regexp.test(data)?null:this.createError(ErrorCodes.STRING_PATTERN,{pattern:schema.pattern}).prefixWith(null,"pattern")},ValidatorContext.prototype.validateArray=function(data,schema,dataPointerPath){return Array.isArray(data)?this.validateArrayLength(data,schema,dataPointerPath)||this.validateArrayUniqueItems(data,schema,dataPointerPath)||this.validateArrayItems(data,schema,dataPointerPath)||null:null},ValidatorContext.prototype.validateArrayLength=function(data,schema){var error;return void 0!==schema.minItems&&data.length<schema.minItems&&(error=this.createError(ErrorCodes.ARRAY_LENGTH_SHORT,{length:data.length,minimum:schema.minItems}).prefixWith(null,"minItems"),this.handleError(error))?error:void 0!==schema.maxItems&&data.length>schema.maxItems&&(error=this.createError(ErrorCodes.ARRAY_LENGTH_LONG,{length:data.length,maximum:schema.maxItems}).prefixWith(null,"maxItems"),this.handleError(error))?error:null},ValidatorContext.prototype.validateArrayUniqueItems=function(data,schema){if(schema.uniqueItems)for(var i=0;i<data.length;i++)for(var j=i+1;j<data.length;j++)if(recursiveCompare(data[i],data[j])){var error=this.createError(ErrorCodes.ARRAY_UNIQUE,{match1:i,match2:j}).prefixWith(null,"uniqueItems");if(this.handleError(error))return error}return null},ValidatorContext.prototype.validateArrayItems=function(data,schema,dataPointerPath){if(void 0===schema.items)return null;var error,i;if(Array.isArray(schema.items)){for(i=0;i<data.length;i++)if(i<schema.items.length){if(error=this.validateAll(data[i],schema.items[i],[i],["items",i],dataPointerPath+"/"+i))return error}else if(void 0!==schema.additionalItems)if("boolean"==typeof schema.additionalItems){if(!schema.additionalItems&&(error=this.createError(ErrorCodes.ARRAY_ADDITIONAL_ITEMS,{}).prefixWith(""+i,"additionalItems"),this.handleError(error)))return error}else if(error=this.validateAll(data[i],schema.additionalItems,[i],["additionalItems"],dataPointerPath+"/"+i))return error}else for(i=0;i<data.length;i++)if(error=this.validateAll(data[i],schema.items,[i],["items"],dataPointerPath+"/"+i))return error;return null},ValidatorContext.prototype.validateObject=function(data,schema,dataPointerPath){return"object"!=typeof data||null===data||Array.isArray(data)?null:this.validateObjectMinMaxProperties(data,schema,dataPointerPath)||this.validateObjectRequiredProperties(data,schema,dataPointerPath)||this.validateObjectProperties(data,schema,dataPointerPath)||this.validateObjectDependencies(data,schema,dataPointerPath)||null
},ValidatorContext.prototype.validateObjectMinMaxProperties=function(data,schema){var error,keys=Object.keys(data);return void 0!==schema.minProperties&&keys.length<schema.minProperties&&(error=this.createError(ErrorCodes.OBJECT_PROPERTIES_MINIMUM,{propertyCount:keys.length,minimum:schema.minProperties}).prefixWith(null,"minProperties"),this.handleError(error))?error:void 0!==schema.maxProperties&&keys.length>schema.maxProperties&&(error=this.createError(ErrorCodes.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:keys.length,maximum:schema.maxProperties}).prefixWith(null,"maxProperties"),this.handleError(error))?error:null},ValidatorContext.prototype.validateObjectRequiredProperties=function(data,schema){if(void 0!==schema.required)for(var i=0;i<schema.required.length;i++){var key=schema.required[i];if(void 0===data[key]){var error=this.createError(ErrorCodes.OBJECT_REQUIRED,{key:key}).prefixWith(null,""+i).prefixWith(null,"required");if(this.handleError(error))return error}}return null},ValidatorContext.prototype.validateObjectProperties=function(data,schema,dataPointerPath){var error;for(var key in data){var keyPointerPath=dataPointerPath+"/"+key.replace(/~/g,"~0").replace(/\//g,"~1"),foundMatch=!1;if(void 0!==schema.properties&&void 0!==schema.properties[key]&&(foundMatch=!0,error=this.validateAll(data[key],schema.properties[key],[key],["properties",key],keyPointerPath)))return error;if(void 0!==schema.patternProperties)for(var patternKey in schema.patternProperties){var regexp=new RegExp(patternKey);if(regexp.test(key)&&(foundMatch=!0,error=this.validateAll(data[key],schema.patternProperties[patternKey],[key],["patternProperties",patternKey],keyPointerPath)))return error}if(foundMatch)this.trackUnknownProperties&&(this.knownPropertyPaths[keyPointerPath]=!0,delete this.unknownPropertyPaths[keyPointerPath]);else if(void 0!==schema.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[keyPointerPath]=!0,delete this.unknownPropertyPaths[keyPointerPath]),"boolean"==typeof schema.additionalProperties){if(!schema.additionalProperties&&(error=this.createError(ErrorCodes.OBJECT_ADDITIONAL_PROPERTIES,{}).prefixWith(key,"additionalProperties"),this.handleError(error)))return error}else if(error=this.validateAll(data[key],schema.additionalProperties,[key],["additionalProperties"],keyPointerPath))return error}else this.trackUnknownProperties&&!this.knownPropertyPaths[keyPointerPath]&&(this.unknownPropertyPaths[keyPointerPath]=!0)}return null},ValidatorContext.prototype.validateObjectDependencies=function(data,schema,dataPointerPath){var error;if(void 0!==schema.dependencies)for(var depKey in schema.dependencies)if(void 0!==data[depKey]){var dep=schema.dependencies[depKey];if("string"==typeof dep){if(void 0===data[dep]&&(error=this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY,{key:depKey,missing:dep}).prefixWith(null,depKey).prefixWith(null,"dependencies"),this.handleError(error)))return error}else if(Array.isArray(dep))for(var i=0;i<dep.length;i++){var requiredKey=dep[i];if(void 0===data[requiredKey]&&(error=this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY,{key:depKey,missing:requiredKey}).prefixWith(null,""+i).prefixWith(null,depKey).prefixWith(null,"dependencies"),this.handleError(error)))return error}else if(error=this.validateAll(data,dep,[],["dependencies",depKey],dataPointerPath))return error}return null},ValidatorContext.prototype.validateCombinations=function(data,schema,dataPointerPath){return this.validateAllOf(data,schema,dataPointerPath)||this.validateAnyOf(data,schema,dataPointerPath)||this.validateOneOf(data,schema,dataPointerPath)||this.validateNot(data,schema,dataPointerPath)||null},ValidatorContext.prototype.validateAllOf=function(data,schema,dataPointerPath){if(void 0===schema.allOf)return null;for(var error,i=0;i<schema.allOf.length;i++){var subSchema=schema.allOf[i];if(error=this.validateAll(data,subSchema,[],["allOf",i],dataPointerPath))return error}return null},ValidatorContext.prototype.validateAnyOf=function(data,schema,dataPointerPath){if(void 0===schema.anyOf)return null;var oldUnknownPropertyPaths,oldKnownPropertyPaths,errors=[],startErrorCount=this.errors.length;this.trackUnknownProperties&&(oldUnknownPropertyPaths=this.unknownPropertyPaths,oldKnownPropertyPaths=this.knownPropertyPaths);for(var errorAtEnd=!0,i=0;i<schema.anyOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var subSchema=schema.anyOf[i],errorCount=this.errors.length,error=this.validateAll(data,subSchema,[],["anyOf",i],dataPointerPath);if(null===error&&errorCount===this.errors.length){if(this.errors=this.errors.slice(0,startErrorCount),this.trackUnknownProperties){for(var knownKey in this.knownPropertyPaths)oldKnownPropertyPaths[knownKey]=!0,delete oldUnknownPropertyPaths[knownKey];for(var unknownKey in this.unknownPropertyPaths)oldKnownPropertyPaths[unknownKey]||(oldUnknownPropertyPaths[unknownKey]=!0);errorAtEnd=!1;continue}return null}error&&errors.push(error.prefixWith(null,""+i).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=oldUnknownPropertyPaths,this.knownPropertyPaths=oldKnownPropertyPaths),errorAtEnd?(errors=errors.concat(this.errors.slice(startErrorCount)),this.errors=this.errors.slice(0,startErrorCount),this.createError(ErrorCodes.ANY_OF_MISSING,{},"","/anyOf",errors)):void 0},ValidatorContext.prototype.validateOneOf=function(data,schema,dataPointerPath){if(void 0===schema.oneOf)return null;var oldUnknownPropertyPaths,oldKnownPropertyPaths,validIndex=null,errors=[],startErrorCount=this.errors.length;this.trackUnknownProperties&&(oldUnknownPropertyPaths=this.unknownPropertyPaths,oldKnownPropertyPaths=this.knownPropertyPaths);for(var i=0;i<schema.oneOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var subSchema=schema.oneOf[i],errorCount=this.errors.length,error=this.validateAll(data,subSchema,[],["oneOf",i],dataPointerPath);if(null===error&&errorCount===this.errors.length){if(null!==validIndex)return this.errors=this.errors.slice(0,startErrorCount),this.createError(ErrorCodes.ONE_OF_MULTIPLE,{index1:validIndex,index2:i},"","/oneOf");if(validIndex=i,this.trackUnknownProperties){for(var knownKey in this.knownPropertyPaths)oldKnownPropertyPaths[knownKey]=!0,delete oldUnknownPropertyPaths[knownKey];for(var unknownKey in this.unknownPropertyPaths)oldKnownPropertyPaths[unknownKey]||(oldUnknownPropertyPaths[unknownKey]=!0)}}else error&&errors.push(error.prefixWith(null,""+i).prefixWith(null,"oneOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=oldUnknownPropertyPaths,this.knownPropertyPaths=oldKnownPropertyPaths),null===validIndex?(errors=errors.concat(this.errors.slice(startErrorCount)),this.errors=this.errors.slice(0,startErrorCount),this.createError(ErrorCodes.ONE_OF_MISSING,{},"","/oneOf",errors)):(this.errors=this.errors.slice(0,startErrorCount),null)},ValidatorContext.prototype.validateNot=function(data,schema,dataPointerPath){if(void 0===schema.not)return null;var oldUnknownPropertyPaths,oldKnownPropertyPaths,oldErrorCount=this.errors.length;this.trackUnknownProperties&&(oldUnknownPropertyPaths=this.unknownPropertyPaths,oldKnownPropertyPaths=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var error=this.validateAll(data,schema.not,null,null,dataPointerPath),notErrors=this.errors.slice(oldErrorCount);return this.errors=this.errors.slice(0,oldErrorCount),this.trackUnknownProperties&&(this.unknownPropertyPaths=oldUnknownPropertyPaths,this.knownPropertyPaths=oldKnownPropertyPaths),null===error&&0===notErrors.length?this.createError(ErrorCodes.NOT_PASSED,{},"","/not"):null};var ErrorCodes={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},ErrorCodeLookup={};for(var key in ErrorCodes)ErrorCodeLookup[ErrorCodes[key]]=key;var ErrorMessagesDefault={INVALID_TYPE:"invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};ValidationError.prototype=Object.create(Error.prototype),ValidationError.prototype.constructor=ValidationError,ValidationError.prototype.name="ValidationError",ValidationError.prototype.prefixWith=function(dataPrefix,schemaPrefix){if(null!==dataPrefix&&(dataPrefix=dataPrefix.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+dataPrefix+this.dataPath),null!==schemaPrefix&&(schemaPrefix=schemaPrefix.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+schemaPrefix+this.schemaPath),null!==this.subErrors)for(var i=0;i<this.subErrors.length;i++)this.subErrors[i].prefixWith(dataPrefix,schemaPrefix);return this};var languages={},tv4=createApi();return tv4.addLanguage("en-gb",ErrorMessagesDefault),tv4.tv4=tv4,tv4}),!function(){var ObjectPath={parse:function(str){if("string"!=typeof str)throw new TypeError("ObjectPath.parse must be passed a string");for(var d,b,q,c,i=0,parts=[];i<str.length;)if(d=str.indexOf(".",i),b=str.indexOf("[",i),-1===d&&-1===b)parts.push(str.slice(i,str.length)),i=str.length;else if(-1===b||-1!==d&&b>d)parts.push(str.slice(i,d)),i=d+1;else if(b>i&&(parts.push(str.slice(i,b)),i=b),q=str.slice(b+1,b+2),'"'!==q&&"'"!==q)c=str.indexOf("]",b),-1===c&&(c=str.length),parts.push(str.slice(i+1,c)),i="."===str.slice(c+1,c+2)?c+2:c+1;else{for(c=str.indexOf(q+"]",b),-1===c&&(c=str.length);"\\"===str.slice(c-1,c)&&b<str.length;)b++,c=str.indexOf(q+"]",b);parts.push(str.slice(i+2,c).replace(new RegExp("\\"+q,"g"),q)),i="."===str.slice(c+2,c+3)?c+3:c+2}return parts},stringify:function(arr,quote){return Array.isArray(arr)||(arr=[arr.toString()]),quote='"'===quote?'"':"'",arr.map(function(n){return"["+quote+n.toString().replace(new RegExp(quote,"g"),"\\"+quote)+quote+"]"}).join("")},normalize:function(data,quote){return ObjectPath.stringify(Array.isArray(data)?data:ObjectPath.parse(data),quote)},registerModule:function(angular){angular.module("ObjectPath",[]).provider("ObjectPath",function(){this.parse=ObjectPath.parse,this.stringify=ObjectPath.stringify,this.normalize=ObjectPath.normalize,this.$get=function(){return ObjectPath}})}};"function"==typeof define&&define.amd?define(function(){return ObjectPath}):"object"==typeof exports?exports.ObjectPath=ObjectPath:window.ObjectPath=ObjectPath}(),function(window,angular,undefined){"use strict";angular.module("ngAnimate",["ng"]).directive("ngAnimateChildren",function(){var NG_ANIMATE_CHILDREN="$$ngAnimateChildren";return function(scope,element,attrs){var val=attrs.ngAnimateChildren;angular.isString(val)&&0===val.length?element.data(NG_ANIMATE_CHILDREN,!0):scope.$watch(val,function(value){element.data(NG_ANIMATE_CHILDREN,!!value)})}}).factory("$$animateReflow",["$$rAF","$document",function($$rAF,$document){var bod=$document[0].body;return function(fn){return $$rAF(function(){bod.offsetWidth+1;fn()})}}]).config(["$provide","$animateProvider",function($provide,$animateProvider){function extractElementNode(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType==ELEMENT_NODE)return elm}}function prepareElement(element){return element&&angular.element(element)}function stripCommentsFromElement(element){return angular.element(extractElementNode(element))}function isMatchingElement(elm1,elm2){return extractElementNode(elm1)==extractElementNode(elm2)}var noop=angular.noop,forEach=angular.forEach,selectors=$animateProvider.$$selectors,ELEMENT_NODE=1,NG_ANIMATE_STATE="$$ngAnimateState",NG_ANIMATE_CHILDREN="$$ngAnimateChildren",NG_ANIMATE_CLASS_NAME="ng-animate",rootAnimateState={running:!0};$provide.decorator("$animate",["$delegate","$injector","$sniffer","$rootElement","$$asyncCallback","$rootScope","$document",function($delegate,$injector,$sniffer,$rootElement,$$asyncCallback,$rootScope){function blockElementAnimations(element){var data=element.data(NG_ANIMATE_STATE)||{};data.running=!0,element.data(NG_ANIMATE_STATE,data)}function lookup(name){if(name){var matches=[],flagMap={},classes=name.substr(1).split(".");($sniffer.transitions||$sniffer.animations)&&matches.push($injector.get(selectors[""]));for(var i=0;i<classes.length;i++){var klass=classes[i],selectorFactoryName=selectors[klass];selectorFactoryName&&!flagMap[klass]&&(matches.push($injector.get(selectorFactoryName)),flagMap[klass]=!0)}return matches}}function animationRunner(element,animationEvent,className){function registerAnimation(animationFactory,event){var afterFn=animationFactory[event],beforeFn=animationFactory["before"+event.charAt(0).toUpperCase()+event.substr(1)];return afterFn||beforeFn?("leave"==event&&(beforeFn=afterFn,afterFn=null),after.push({event:event,fn:afterFn}),before.push({event:event,fn:beforeFn}),!0):void 0}function run(fns,cancellations,allCompleteFn){function afterAnimationComplete(index){if(cancellations){if((cancellations[index]||noop)(),++count<animations.length)return;cancellations=null}allCompleteFn()}var animations=[];forEach(fns,function(animation){animation.fn&&animations.push(animation)});var count=0;forEach(animations,function(animation,index){var progress=function(){afterAnimationComplete(index)};switch(animation.event){case"setClass":cancellations.push(animation.fn(element,classNameAdd,classNameRemove,progress));break;case"addClass":cancellations.push(animation.fn(element,classNameAdd||className,progress));break;case"removeClass":cancellations.push(animation.fn(element,classNameRemove||className,progress));break;default:cancellations.push(animation.fn(element,progress))}}),cancellations&&0===cancellations.length&&allCompleteFn()}var node=element[0];if(node){var classNameAdd,classNameRemove,isSetClassOperation="setClass"==animationEvent,isClassBased=isSetClassOperation||"addClass"==animationEvent||"removeClass"==animationEvent;angular.isArray(className)&&(classNameAdd=className[0],classNameRemove=className[1],className=classNameAdd+" "+classNameRemove);var currentClassName=element.attr("class"),classes=currentClassName+" "+className;if(isAnimatableClassName(classes)){var beforeComplete=noop,beforeCancel=[],before=[],afterComplete=noop,afterCancel=[],after=[],animationLookup=(" "+classes).replace(/\s+/g,".");return forEach(lookup(animationLookup),function(animationFactory){var created=registerAnimation(animationFactory,animationEvent);!created&&isSetClassOperation&&(registerAnimation(animationFactory,"addClass"),registerAnimation(animationFactory,"removeClass"))}),{node:node,event:animationEvent,className:className,isClassBased:isClassBased,isSetClassOperation:isSetClassOperation,before:function(allCompleteFn){beforeComplete=allCompleteFn,run(before,beforeCancel,function(){beforeComplete=noop,allCompleteFn()})},after:function(allCompleteFn){afterComplete=allCompleteFn,run(after,afterCancel,function(){afterComplete=noop,allCompleteFn()})},cancel:function(){beforeCancel&&(forEach(beforeCancel,function(cancelFn){(cancelFn||noop)(!0)}),beforeComplete(!0)),afterCancel&&(forEach(afterCancel,function(cancelFn){(cancelFn||noop)(!0)}),afterComplete(!0))}}}}}function performAnimation(animationEvent,className,element,parentElement,afterElement,domOperation,doneCallback){function fireDOMCallback(animationPhase){var eventName="$animate:"+animationPhase;elementEvents&&elementEvents[eventName]&&elementEvents[eventName].length>0&&$$asyncCallback(function(){element.triggerHandler(eventName,{event:animationEvent,className:className})})}function fireBeforeCallbackAsync(){fireDOMCallback("before")}function fireAfterCallbackAsync(){fireDOMCallback("after")}function fireDoneCallbackAsync(){fireDOMCallback("close"),doneCallback&&$$asyncCallback(function(){doneCallback()})}function fireDOMOperation(){fireDOMOperation.hasBeenRun||(fireDOMOperation.hasBeenRun=!0,domOperation())}function closeAnimation(){if(!closeAnimation.hasBeenRun){closeAnimation.hasBeenRun=!0;var data=element.data(NG_ANIMATE_STATE);data&&(runner&&runner.isClassBased?cleanup(element,className):($$asyncCallback(function(){var data=element.data(NG_ANIMATE_STATE)||{};localAnimationCount==data.index&&cleanup(element,className,animationEvent)}),element.data(NG_ANIMATE_STATE,data))),fireDoneCallbackAsync()}}var runner=animationRunner(element,animationEvent,className);if(!runner)return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),void closeAnimation();className=runner.className;var elementEvents=angular.element._data(runner.node);elementEvents=elementEvents&&elementEvents.events,parentElement||(parentElement=afterElement?afterElement.parent():element.parent());var skipAnimations,ngAnimateState=element.data(NG_ANIMATE_STATE)||{},runningAnimations=ngAnimateState.active||{},totalActiveAnimations=ngAnimateState.totalActive||0,lastAnimation=ngAnimateState.last;if(runner.isClassBased&&(skipAnimations=ngAnimateState.running||ngAnimateState.disabled||lastAnimation&&!lastAnimation.isClassBased),skipAnimations||animationsDisabled(element,parentElement))return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),void closeAnimation();var skipAnimation=!1;if(totalActiveAnimations>0){var animationsToCancel=[];if(runner.isClassBased){if("setClass"==lastAnimation.event)animationsToCancel.push(lastAnimation),cleanup(element,className);else if(runningAnimations[className]){var current=runningAnimations[className];current.event==animationEvent?skipAnimation=!0:(animationsToCancel.push(current),cleanup(element,className))}}else if("leave"==animationEvent&&runningAnimations["ng-leave"])skipAnimation=!0;else{for(var klass in runningAnimations)animationsToCancel.push(runningAnimations[klass]),cleanup(element,klass);runningAnimations={},totalActiveAnimations=0}animationsToCancel.length>0&&forEach(animationsToCancel,function(operation){operation.cancel()})}if(!runner.isClassBased||runner.isSetClassOperation||skipAnimation||(skipAnimation="addClass"==animationEvent==element.hasClass(className)),skipAnimation)return fireDOMOperation(),fireBeforeCallbackAsync(),fireAfterCallbackAsync(),void fireDoneCallbackAsync();"leave"==animationEvent&&element.one("$destroy",function(){var element=angular.element(this),state=element.data(NG_ANIMATE_STATE);if(state){var activeLeaveAnimation=state.active["ng-leave"];activeLeaveAnimation&&(activeLeaveAnimation.cancel(),cleanup(element,"ng-leave"))}}),element.addClass(NG_ANIMATE_CLASS_NAME);var localAnimationCount=globalAnimationCounter++;totalActiveAnimations++,runningAnimations[className]=runner,element.data(NG_ANIMATE_STATE,{last:runner,active:runningAnimations,index:localAnimationCount,totalActive:totalActiveAnimations}),fireBeforeCallbackAsync(),runner.before(function(cancelled){var data=element.data(NG_ANIMATE_STATE);cancelled=cancelled||!data||!data.active[className]||runner.isClassBased&&data.active[className].event!=animationEvent,fireDOMOperation(),cancelled===!0?closeAnimation():(fireAfterCallbackAsync(),runner.after(closeAnimation))})}function cancelChildAnimations(element){var node=extractElementNode(element);if(node){var nodes=angular.isFunction(node.getElementsByClassName)?node.getElementsByClassName(NG_ANIMATE_CLASS_NAME):node.querySelectorAll("."+NG_ANIMATE_CLASS_NAME);forEach(nodes,function(element){element=angular.element(element);var data=element.data(NG_ANIMATE_STATE);data&&data.active&&forEach(data.active,function(runner){runner.cancel()})})}}function cleanup(element,className){if(isMatchingElement(element,$rootElement))rootAnimateState.disabled||(rootAnimateState.running=!1,rootAnimateState.structural=!1);else if(className){var data=element.data(NG_ANIMATE_STATE)||{},removeAnimations=className===!0;!removeAnimations&&data.active&&data.active[className]&&(data.totalActive--,delete data.active[className]),(removeAnimations||!data.totalActive)&&(element.removeClass(NG_ANIMATE_CLASS_NAME),element.removeData(NG_ANIMATE_STATE))}}function animationsDisabled(element,parentElement){if(rootAnimateState.disabled)return!0;if(isMatchingElement(element,$rootElement))return rootAnimateState.running;var allowChildAnimations,parentRunningAnimation,hasParent;do{if(0===parentElement.length)break;var isRoot=isMatchingElement(parentElement,$rootElement),state=isRoot?rootAnimateState:parentElement.data(NG_ANIMATE_STATE)||{};if(state.disabled)return!0;if(isRoot&&(hasParent=!0),allowChildAnimations!==!1){var animateChildrenFlag=parentElement.data(NG_ANIMATE_CHILDREN);angular.isDefined(animateChildrenFlag)&&(allowChildAnimations=animateChildrenFlag)}parentRunningAnimation=parentRunningAnimation||state.running||state.last&&!state.last.isClassBased}while(parentElement=parentElement.parent());return!hasParent||!allowChildAnimations&&parentRunningAnimation}var globalAnimationCounter=0;$rootElement.data(NG_ANIMATE_STATE,rootAnimateState),$rootScope.$$postDigest(function(){$rootScope.$$postDigest(function(){rootAnimateState.running=!1})});var classNameFilter=$animateProvider.classNameFilter(),isAnimatableClassName=classNameFilter?function(className){return classNameFilter.test(className)}:function(){return!0};return{enter:function(element,parentElement,afterElement,doneCallback){element=angular.element(element),parentElement=prepareElement(parentElement),afterElement=prepareElement(afterElement),blockElementAnimations(element),$delegate.enter(element,parentElement,afterElement),$rootScope.$$postDigest(function(){element=stripCommentsFromElement(element),performAnimation("enter","ng-enter",element,parentElement,afterElement,noop,doneCallback)})},leave:function(element,doneCallback){element=angular.element(element),cancelChildAnimations(element),blockElementAnimations(element),$rootScope.$$postDigest(function(){performAnimation("leave","ng-leave",stripCommentsFromElement(element),null,null,function(){$delegate.leave(element)},doneCallback)})},move:function(element,parentElement,afterElement,doneCallback){element=angular.element(element),parentElement=prepareElement(parentElement),afterElement=prepareElement(afterElement),cancelChildAnimations(element),blockElementAnimations(element),$delegate.move(element,parentElement,afterElement),$rootScope.$$postDigest(function(){element=stripCommentsFromElement(element),performAnimation("move","ng-move",element,parentElement,afterElement,noop,doneCallback)})},addClass:function(element,className,doneCallback){element=angular.element(element),element=stripCommentsFromElement(element),performAnimation("addClass",className,element,null,null,function(){$delegate.addClass(element,className)},doneCallback)},removeClass:function(element,className,doneCallback){element=angular.element(element),element=stripCommentsFromElement(element),performAnimation("removeClass",className,element,null,null,function(){$delegate.removeClass(element,className)},doneCallback)},setClass:function(element,add,remove,doneCallback){element=angular.element(element),element=stripCommentsFromElement(element),performAnimation("setClass",[add,remove],element,null,null,function(){$delegate.setClass(element,add,remove)},doneCallback)},enabled:function(value,element){switch(arguments.length){case 2:if(value)cleanup(element);else{var data=element.data(NG_ANIMATE_STATE)||{};data.disabled=!0,element.data(NG_ANIMATE_STATE,data)}break;case 1:rootAnimateState.disabled=!value;break;default:value=!rootAnimateState.disabled}return!!value}}}]),$animateProvider.register("",["$window","$sniffer","$timeout","$$animateReflow",function($window,$sniffer,$timeout,$$animateReflow){function clearCacheAfterReflow(){cancelAnimationReflow||(cancelAnimationReflow=$$animateReflow(function(){animationReflowQueue=[],cancelAnimationReflow=null,lookupCache={}}))}function afterReflow(element,callback){cancelAnimationReflow&&cancelAnimationReflow(),animationReflowQueue.push(callback),cancelAnimationReflow=$$animateReflow(function(){forEach(animationReflowQueue,function(fn){fn()}),animationReflowQueue=[],cancelAnimationReflow=null,lookupCache={}})}function animationCloseHandler(element,totalTime){var node=extractElementNode(element);element=angular.element(node),animationElementQueue.push(element);var futureTimestamp=Date.now()+totalTime;closingTimestamp>=futureTimestamp||($timeout.cancel(closingTimer),closingTimestamp=futureTimestamp,closingTimer=$timeout(function(){closeAllAnimations(animationElementQueue),animationElementQueue=[]},totalTime,!1))}function closeAllAnimations(elements){forEach(elements,function(element){var elementData=element.data(NG_ANIMATE_CSS_DATA_KEY);elementData&&(elementData.closeAnimationFn||noop)()})}function getElementAnimationDetails(element,cacheKey){var data=cacheKey?lookupCache[cacheKey]:null;if(!data){var transitionDelayStyle,animationDelayStyle,transitionDurationStyle,transitionPropertyStyle,transitionDuration=0,transitionDelay=0,animationDuration=0,animationDelay=0;forEach(element,function(element){if(element.nodeType==ELEMENT_NODE){var elementStyles=$window.getComputedStyle(element)||{};transitionDurationStyle=elementStyles[TRANSITION_PROP+DURATION_KEY],transitionDuration=Math.max(parseMaxTime(transitionDurationStyle),transitionDuration),transitionPropertyStyle=elementStyles[TRANSITION_PROP+PROPERTY_KEY],transitionDelayStyle=elementStyles[TRANSITION_PROP+DELAY_KEY],transitionDelay=Math.max(parseMaxTime(transitionDelayStyle),transitionDelay),animationDelayStyle=elementStyles[ANIMATION_PROP+DELAY_KEY],animationDelay=Math.max(parseMaxTime(animationDelayStyle),animationDelay);var aDuration=parseMaxTime(elementStyles[ANIMATION_PROP+DURATION_KEY]);aDuration>0&&(aDuration*=parseInt(elementStyles[ANIMATION_PROP+ANIMATION_ITERATION_COUNT_KEY],10)||1),animationDuration=Math.max(aDuration,animationDuration)}}),data={total:0,transitionPropertyStyle:transitionPropertyStyle,transitionDurationStyle:transitionDurationStyle,transitionDelayStyle:transitionDelayStyle,transitionDelay:transitionDelay,transitionDuration:transitionDuration,animationDelayStyle:animationDelayStyle,animationDelay:animationDelay,animationDuration:animationDuration},cacheKey&&(lookupCache[cacheKey]=data)}return data}function parseMaxTime(str){var maxValue=0,values=angular.isString(str)?str.split(/\s*,\s*/):[];return forEach(values,function(value){maxValue=Math.max(parseFloat(value)||0,maxValue)}),maxValue}function getCacheKey(element){var parentElement=element.parent(),parentID=parentElement.data(NG_ANIMATE_PARENT_KEY);return parentID||(parentElement.data(NG_ANIMATE_PARENT_KEY,++parentCounter),parentID=parentCounter),parentID+"-"+extractElementNode(element).getAttribute("class")}function animateSetup(animationEvent,element,className,calculationDecorator){var cacheKey=getCacheKey(element),eventCacheKey=cacheKey+" "+className,itemIndex=lookupCache[eventCacheKey]?++lookupCache[eventCacheKey].total:0,stagger={};if(itemIndex>0){var staggerClassName=className+"-stagger",staggerCacheKey=cacheKey+" "+staggerClassName,applyClasses=!lookupCache[staggerCacheKey];applyClasses&&element.addClass(staggerClassName),stagger=getElementAnimationDetails(element,staggerCacheKey),applyClasses&&element.removeClass(staggerClassName)}calculationDecorator=calculationDecorator||function(fn){return fn()},element.addClass(className);var formerData=element.data(NG_ANIMATE_CSS_DATA_KEY)||{},timings=calculationDecorator(function(){return getElementAnimationDetails(element,eventCacheKey)}),transitionDuration=timings.transitionDuration,animationDuration=timings.animationDuration;if(0===transitionDuration&&0===animationDuration)return element.removeClass(className),!1;element.data(NG_ANIMATE_CSS_DATA_KEY,{running:formerData.running||0,itemIndex:itemIndex,stagger:stagger,timings:timings,closeAnimationFn:noop});var isCurrentlyAnimating=formerData.running>0||"setClass"==animationEvent;return transitionDuration>0&&blockTransitions(element,className,isCurrentlyAnimating),animationDuration>0&&stagger.animationDelay>0&&0===stagger.animationDuration&&blockKeyframeAnimations(element),!0}function isStructuralAnimation(className){return"ng-enter"==className||"ng-move"==className||"ng-leave"==className}function blockTransitions(element,className,isAnimating){isStructuralAnimation(className)||!isAnimating?extractElementNode(element).style[TRANSITION_PROP+PROPERTY_KEY]="none":element.addClass(NG_ANIMATE_BLOCK_CLASS_NAME)}function blockKeyframeAnimations(element){extractElementNode(element).style[ANIMATION_PROP]="none 0s"}function unblockTransitions(element){var prop=TRANSITION_PROP+PROPERTY_KEY,node=extractElementNode(element);node.style[prop]&&node.style[prop].length>0&&(node.style[prop]=""),element.removeClass(NG_ANIMATE_BLOCK_CLASS_NAME)}function unblockKeyframeAnimations(element){var prop=ANIMATION_PROP,node=extractElementNode(element);node.style[prop]&&node.style[prop].length>0&&(node.style[prop]="")}function animateRun(animationEvent,element,className,activeAnimationComplete){function onEnd(){element.off(css3AnimationEvents,onAnimationProgress),element.removeClass(activeClassName),animateClose(element,className);var node=extractElementNode(element);for(var i in appliedStyles)node.style.removeProperty(appliedStyles[i])}function onAnimationProgress(event){event.stopPropagation();var ev=event.originalEvent||event,timeStamp=ev.$manualTimeStamp||ev.timeStamp||Date.now(),elapsedTime=parseFloat(ev.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES));Math.max(timeStamp-startTime,0)>=maxDelayTime&&elapsedTime>=maxDuration&&activeAnimationComplete()}var node=extractElementNode(element),elementData=element.data(NG_ANIMATE_CSS_DATA_KEY);if(-1==node.getAttribute("class").indexOf(className)||!elementData)return void activeAnimationComplete();var activeClassName="";forEach(className.split(" "),function(klass,i){activeClassName+=(i>0?" ":"")+klass+"-active"});var stagger=elementData.stagger,timings=elementData.timings,itemIndex=elementData.itemIndex,maxDuration=Math.max(timings.transitionDuration,timings.animationDuration),maxDelay=Math.max(timings.transitionDelay,timings.animationDelay),maxDelayTime=maxDelay*ONE_SECOND,startTime=Date.now(),css3AnimationEvents=ANIMATIONEND_EVENT+" "+TRANSITIONEND_EVENT,style="",appliedStyles=[];
if(timings.transitionDuration>0){var propertyStyle=timings.transitionPropertyStyle;-1==propertyStyle.indexOf("all")&&(style+=CSS_PREFIX+"transition-property: "+propertyStyle+";",style+=CSS_PREFIX+"transition-duration: "+timings.transitionDurationStyle+";",appliedStyles.push(CSS_PREFIX+"transition-property"),appliedStyles.push(CSS_PREFIX+"transition-duration"))}if(itemIndex>0){if(stagger.transitionDelay>0&&0===stagger.transitionDuration){var delayStyle=timings.transitionDelayStyle;style+=CSS_PREFIX+"transition-delay: "+prepareStaggerDelay(delayStyle,stagger.transitionDelay,itemIndex)+"; ",appliedStyles.push(CSS_PREFIX+"transition-delay")}stagger.animationDelay>0&&0===stagger.animationDuration&&(style+=CSS_PREFIX+"animation-delay: "+prepareStaggerDelay(timings.animationDelayStyle,stagger.animationDelay,itemIndex)+"; ",appliedStyles.push(CSS_PREFIX+"animation-delay"))}if(appliedStyles.length>0){var oldStyle=node.getAttribute("style")||"";node.setAttribute("style",oldStyle+"; "+style)}element.on(css3AnimationEvents,onAnimationProgress),element.addClass(activeClassName),elementData.closeAnimationFn=function(){onEnd(),activeAnimationComplete()};var staggerTime=itemIndex*(Math.max(stagger.animationDelay,stagger.transitionDelay)||0),animationTime=(maxDelay+maxDuration)*CLOSING_TIME_BUFFER,totalTime=(staggerTime+animationTime)*ONE_SECOND;return elementData.running++,animationCloseHandler(element,totalTime),onEnd}function prepareStaggerDelay(delayStyle,staggerDelay,index){var style="";return forEach(delayStyle.split(","),function(val,i){style+=(i>0?",":"")+(index*staggerDelay+parseInt(val,10))+"s"}),style}function animateBefore(animationEvent,element,className,calculationDecorator){return animateSetup(animationEvent,element,className,calculationDecorator)?function(cancelled){cancelled&&animateClose(element,className)}:void 0}function animateAfter(animationEvent,element,className,afterAnimationComplete){return element.data(NG_ANIMATE_CSS_DATA_KEY)?animateRun(animationEvent,element,className,afterAnimationComplete):(animateClose(element,className),void afterAnimationComplete())}function animate(animationEvent,element,className,animationComplete){var preReflowCancellation=animateBefore(animationEvent,element,className);if(!preReflowCancellation)return clearCacheAfterReflow(),void animationComplete();var cancel=preReflowCancellation;return afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),cancel=animateAfter(animationEvent,element,className,animationComplete)}),function(cancelled){(cancel||noop)(cancelled)}}function animateClose(element,className){element.removeClass(className);var data=element.data(NG_ANIMATE_CSS_DATA_KEY);data&&(data.running&&data.running--,data.running&&0!==data.running||element.removeData(NG_ANIMATE_CSS_DATA_KEY))}function suffixClasses(classes,suffix){var className="";return classes=angular.isArray(classes)?classes:classes.split(/\s+/),forEach(classes,function(klass,i){klass&&klass.length>0&&(className+=(i>0?" ":"")+klass+suffix)}),className}var TRANSITION_PROP,TRANSITIONEND_EVENT,ANIMATION_PROP,ANIMATIONEND_EVENT,CSS_PREFIX="";window.ontransitionend===undefined&&window.onwebkittransitionend!==undefined?(CSS_PREFIX="-webkit-",TRANSITION_PROP="WebkitTransition",TRANSITIONEND_EVENT="webkitTransitionEnd transitionend"):(TRANSITION_PROP="transition",TRANSITIONEND_EVENT="transitionend"),window.onanimationend===undefined&&window.onwebkitanimationend!==undefined?(CSS_PREFIX="-webkit-",ANIMATION_PROP="WebkitAnimation",ANIMATIONEND_EVENT="webkitAnimationEnd animationend"):(ANIMATION_PROP="animation",ANIMATIONEND_EVENT="animationend");var cancelAnimationReflow,DURATION_KEY="Duration",PROPERTY_KEY="Property",DELAY_KEY="Delay",ANIMATION_ITERATION_COUNT_KEY="IterationCount",NG_ANIMATE_PARENT_KEY="$$ngAnimateKey",NG_ANIMATE_CSS_DATA_KEY="$$ngAnimateCSS3Data",NG_ANIMATE_BLOCK_CLASS_NAME="ng-animate-block-transitions",ELAPSED_TIME_MAX_DECIMAL_PLACES=3,CLOSING_TIME_BUFFER=1.5,ONE_SECOND=1e3,lookupCache={},parentCounter=0,animationReflowQueue=[],closingTimer=null,closingTimestamp=0,animationElementQueue=[];return{enter:function(element,animationCompleted){return animate("enter",element,"ng-enter",animationCompleted)},leave:function(element,animationCompleted){return animate("leave",element,"ng-leave",animationCompleted)},move:function(element,animationCompleted){return animate("move",element,"ng-move",animationCompleted)},beforeSetClass:function(element,add,remove,animationCompleted){var className=suffixClasses(remove,"-remove")+" "+suffixClasses(add,"-add"),cancellationMethod=animateBefore("setClass",element,className,function(fn){var klass=element.attr("class");element.removeClass(remove),element.addClass(add);var timings=fn();return element.attr("class",klass),timings});return cancellationMethod?(afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),animationCompleted()}),cancellationMethod):(clearCacheAfterReflow(),void animationCompleted())},beforeAddClass:function(element,className,animationCompleted){var cancellationMethod=animateBefore("addClass",element,suffixClasses(className,"-add"),function(fn){element.addClass(className);var timings=fn();return element.removeClass(className),timings});return cancellationMethod?(afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),animationCompleted()}),cancellationMethod):(clearCacheAfterReflow(),void animationCompleted())},setClass:function(element,add,remove,animationCompleted){remove=suffixClasses(remove,"-remove"),add=suffixClasses(add,"-add");var className=remove+" "+add;return animateAfter("setClass",element,className,animationCompleted)},addClass:function(element,className,animationCompleted){return animateAfter("addClass",element,suffixClasses(className,"-add"),animationCompleted)},beforeRemoveClass:function(element,className,animationCompleted){var cancellationMethod=animateBefore("removeClass",element,suffixClasses(className,"-remove"),function(fn){var klass=element.attr("class");element.removeClass(className);var timings=fn();return element.attr("class",klass),timings});return cancellationMethod?(afterReflow(element,function(){unblockTransitions(element,className),unblockKeyframeAnimations(element),animationCompleted()}),cancellationMethod):void animationCompleted()},removeClass:function(element,className,animationCompleted){return animateAfter("removeClass",element,suffixClasses(className,"-remove"),animationCompleted)}}}])}])}(window,window.angular),function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){function bubbleUp(heap,weightFunc,n){for(var element=heap[n],weight=weightFunc(element);n>0;){var parentN=Math.floor((n+1)/2)-1,parent=heap[parentN];if(weight>=weightFunc(parent))break;heap[parentN]=element,heap[n]=parent,n=parentN}}function bubbleDown(heap,weightFunc,n){for(var length=heap.length,node=heap[n],nodeWeight=weightFunc(node);;){var child2N=2*(n+1),child1N=child2N-1,swap=null;if(length>child1N){var child1=heap[child1N],child1Weight=weightFunc(child1);nodeWeight>child1Weight&&(swap=child1N)}if(length>child2N){var child2=heap[child2N],child2Weight=weightFunc(child2);child2Weight<(null===swap?nodeWeight:weightFunc(heap[child1N]))&&(swap=child2N)}if(null===swap)break;heap[n]=heap[swap],heap[swap]=node,n=swap}}function DSBinaryHeap(weightFunc){if(weightFunc&&!angular.isFunction(weightFunc))throw new Error("DSBinaryHeap(weightFunc): weightFunc: must be a function!");weightFunc=weightFunc||function(x){return x},this.weightFunc=weightFunc,this.heap=[]}function DSBinaryHeapProvider(){this.$get=function(){return DSBinaryHeap}}DSBinaryHeap.prototype.push=function(node){this.heap.push(node),bubbleUp(this.heap,this.weightFunc,this.heap.length-1)},DSBinaryHeap.prototype.peek=function(){return this.heap[0]},DSBinaryHeap.prototype.pop=function(){var front=this.heap[0],end=this.heap.pop();return this.heap.length>0&&(this.heap[0]=end,bubbleDown(this.heap,this.weightFunc,0)),front},DSBinaryHeap.prototype.remove=function(node){for(var length=this.heap.length,i=0;length>i;i++)if(angular.equals(this.heap[i],node)){var removed=this.heap[i],end=this.heap.pop();return i!==length-1&&(this.heap[i]=end,bubbleUp(this.heap,this.weightFunc,i),bubbleDown(this.heap,this.weightFunc,i)),removed}return null},DSBinaryHeap.prototype.removeAll=function(){this.heap=[]},DSBinaryHeap.prototype.size=function(){return this.heap.length},module.exports={DSBinaryHeapProvider:DSBinaryHeapProvider,DSBinaryHeap:DSBinaryHeap}},{}],2:[function(require,module){module.exports=function(){var _this=this;clearInterval(_this.$$cacheFlushIntervalId),clearInterval(_this.$$recycleFreqId),_this.removeAll(),_this.$$storage&&(_this.$$storage().removeItem(_this.$$prefix+".keys"),_this.$$storage().removeItem(_this.$$prefix)),_this.$$storage=null,_this.$$data=null,_this.$$lruHeap=null,_this.$$expiresHeap=null,_this.$$prefix=null}},{}],3:[function(require,module){var utils=require("../utils");module.exports=function(key,options){var _this=this;if(angular.isArray(key)){var keys=key,values=[];return angular.forEach(keys,function(key){var value=_this.get(key,options);null!==value&&void 0!==value&&values.push(value)}),values}if(key=utils.stringifyNumber(key),!_this.$$disabled){if(options=options||{},!angular.isString(key))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof key);if(options&&!angular.isObject(options))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof options);if(options.onExpire&&!angular.isFunction(options.onExpire))throw angular.$$minErr("ng")("areq","Expected options.onExpire to be a function! Found: {0}.",typeof options.onExpire);var item;if(_this.$$storage){if(_this.$$promises[key])return _this.$$promises[key];var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);if(!itemJson)return;item=angular.fromJson(itemJson)}else{if(!(key in _this.$$data))return;item=_this.$$data[key]}var value=item.value,now=(new Date).getTime();return _this.$$storage?(_this.$$lruHeap.remove({key:key,accessed:item.accessed}),item.accessed=now,_this.$$lruHeap.push({key:key,accessed:now})):(_this.$$lruHeap.remove(item),item.accessed=now,_this.$$lruHeap.push(item)),"passive"===_this.$$deleteOnExpire&&"expires"in item&&item.expires<now?(_this.remove(key),_this.$$onExpire?_this.$$onExpire(key,item.value,options.onExpire):options.onExpire&&options.onExpire(key,item.value),value=void 0):_this.$$storage&&_this.$$storage().setItem(_this.$$prefix+".data."+key,JSON.stringify(item)),value}}},{"../utils":21}],4:[function(require,module){function _setStorageMode(storageMode,storageImpl){var _this=this;if(!angular.isString(storageMode))throw angular.$$minErr("ng")("areq","Expected storageMode to be a string! Found: {0}.",typeof storageMode);if("memory"!==storageMode&&"localStorage"!==storageMode&&"sessionStorage"!==storageMode)throw angular.$$minErr("ng")("areq",'Expected storageMode to be "memory", "localStorage" or "sessionStorage"! Found: {0}.',storageMode);if(_this.$$storageMode=storageMode,storageImpl){if(!angular.isObject(storageImpl))throw angular.$$minErr("ng")("areq","Expected storageImpl to be an object! Found: {0}.",typeof storageImpl);if(!("setItem"in storageImpl&&"function"==typeof storageImpl.setItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "setItem(key, value)"! Found: {0}.',typeof storageImpl.setItem);if(!("getItem"in storageImpl&&"function"==typeof storageImpl.getItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "getItem(key)"! Found: {0}.',typeof storageImpl.getItem);if(!("removeItem"in storageImpl)||"function"!=typeof storageImpl.removeItem)throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "removeItem(key)"! Found: {0}.',typeof storageImpl.removeItem);_this.$$storage=function(){return storageImpl}}else if("localStorage"===_this.$$storageMode)try{localStorage.setItem("angular-cache","angular-cache"),localStorage.removeItem("angular-cache"),_this.$$storage=function(){return localStorage}}catch(e){delete _this.$$storage,_this.$$storageMode="memory"}else if("sessionStorage"===_this.$$storageMode)try{sessionStorage.setItem("angular-cache","angular-cache"),sessionStorage.removeItem("angular-cache"),_this.$$storage=function(){return sessionStorage}}catch(e){delete _this.$$storage,_this.$$storageMode="memory"}}function _setOptions(cacheOptions,strict){var _this=this;if(cacheOptions=cacheOptions||{},strict=!!strict,!angular.isObject(cacheOptions))throw angular.$$minErr("ng")("areq","Expected cacheOptions to be an object! Found: {0}.",typeof cacheOptions);"disabled"in cacheOptions?_this.$$disabled=!!cacheOptions.disabled:strict&&delete _this.$$disabled,"storeOnResolve"in cacheOptions?_this.$$storeOnResolve=!!cacheOptions.storeOnResolve:strict&&(_this.$$storeOnResolve=!1),"storeOnReject"in cacheOptions?_this.$$storeOnReject=!!cacheOptions.storeOnReject:strict&&(_this.$$storeOnReject=!1),"capacity"in cacheOptions?_this.setCapacity(cacheOptions.capacity):strict&&_this.setCapacity(null),"deleteOnExpire"in cacheOptions?_this.setDeleteOnExpire(cacheOptions.deleteOnExpire):strict&&_this.setDeleteOnExpire(null),"maxAge"in cacheOptions?_this.setMaxAge(cacheOptions.maxAge):strict&&_this.setMaxAge(null),"recycleFreq"in cacheOptions?_this.setRecycleFreq(cacheOptions.recycleFreq):strict&&_this.setRecycleFreq(null),"cacheFlushInterval"in cacheOptions?_this.setCacheFlushInterval(cacheOptions.cacheFlushInterval):strict&&_this.setCacheFlushInterval(null),"onExpire"in cacheOptions?_this.setOnExpire(cacheOptions.onExpire):strict&&_this.setOnExpire(null)}function DSCache(cacheId,options){var _this=this;_this.$$data={},_this.$$promises={},_this.$$id=cacheId,_this.$$storage=null,_this.$$expiresHeap=new DSBinaryHeap(function(x){return x.expires}),_this.$$lruHeap=new DSBinaryHeap(function(x){return x.accessed}),options=options||{},"storageMode"in options&&_setStorageMode.apply(_this,[options.storageMode,options.storageImpl]),"storagePrefix"in options&&(_this.$$storagePrefix=options.storagePrefix),_this.$$prefix=_this.$$storagePrefix+cacheId,_setOptions.apply(_this,[options,!0])}var defaults=require("../defaults"),DSBinaryHeap=require("../DSBinaryHeap").DSBinaryHeap;for(var key in defaults.defaults)DSCache.prototype["$$"+key]=defaults.defaults[key];DSCache.prototype.setOptions=_setOptions,DSCache.prototype.setCapacity=require("./setCapacity"),DSCache.prototype.setDeleteOnExpire=require("./setDeleteOnExpire"),DSCache.prototype.setMaxAge=require("./setMaxAge"),DSCache.prototype.setRecycleFreq=require("./setRecycleFreq"),DSCache.prototype.setCacheFlushInterval=require("./setCacheFlushInterval"),DSCache.prototype.setOnExpire=require("./setOnExpire"),DSCache.prototype.put=require("./put"),DSCache.prototype.get=require("./get"),DSCache.prototype.remove=require("./remove"),DSCache.prototype.removeAll=require("./removeAll"),DSCache.prototype.removeExpired=require("./removeExpired"),DSCache.prototype.destroy=require("./destroy"),DSCache.prototype.info=require("./info"),DSCache.prototype.keySet=require("./keySet"),DSCache.prototype.keys=require("./keys"),DSCache.prototype.disable=function(){this.$$disabled=!0},DSCache.prototype.enable=function(){delete this.$$disabled},DSCache.prototype.touch=function(key){var _this=this;if(key){var val=_this.get(key,{onExpire:function(k,v){_this.put(k,v)}});val&&_this.put(key,val)}else for(var keys=_this.keys(),i=0;i<keys.length;i++)_this.touch(keys[i])},module.exports=DSCache},{"../DSBinaryHeap":1,"../defaults":19,"./destroy":2,"./get":3,"./info":5,"./keySet":6,"./keys":7,"./put":8,"./remove":9,"./removeAll":10,"./removeExpired":11,"./setCacheFlushInterval":12,"./setCapacity":13,"./setDeleteOnExpire":14,"./setMaxAge":15,"./setOnExpire":16,"./setRecycleFreq":17}],5:[function(require,module){module.exports=function(key){var _this=this;if(key){var item;if(_this.$$storage){var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);return itemJson?(item=angular.fromJson(itemJson),{created:item.created,accessed:item.accessed,expires:item.expires,isExpired:(new Date).getTime()-item.created>_this.$$maxAge}):void 0}return key in _this.$$data?(item=_this.$$data[key],{created:item.created,accessed:item.accessed,expires:item.expires,isExpired:(new Date).getTime()-item.created>_this.$$maxAge}):void 0}return{id:_this.$$id,capacity:_this.$$capacity,maxAge:_this.$$maxAge,deleteOnExpire:_this.$$deleteOnExpire,onExpire:_this.$$onExpire,cacheFlushInterval:_this.$$cacheFlushInterval,recycleFreq:_this.$$recycleFreq,storageMode:_this.$$storageMode,storageImpl:_this.$$storage?_this.$$storage():void 0,disabled:_this.$$disabled,size:_this.$$lruHeap&&_this.$$lruHeap.size()||0}}},{}],6:[function(require,module){var utils=require("../utils");module.exports=function(){var _this=this;if(_this.$$storage){var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys"),kSet={};if(keysJson)for(var keys=angular.fromJson(keysJson),i=0;i<keys.length;i++)kSet[keys[i]]=keys[i];return kSet}return utils.keySet(_this.$$data)}},{"../utils":21}],7:[function(require,module){var utils=require("../utils");module.exports=function(){var _this=this;if(_this.$$storage){var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys");return keysJson?angular.fromJson(keysJson):[]}return utils.keys(_this.$$data)}},{"../utils":21}],8:[function(require,module){function isPromiseLike(v){return v&&"function"==typeof v.then}var utils=require("../utils");module.exports=function(key,value,options){function getHandler(store,isError){return function(v){return store&&(delete _this.$$promises[key],angular.isObject(v)&&"status"in v&&"data"in v?(v=[v.status,v.data,v.headers(),v.statusText],_this.put(key,v)):_this.put(key,v)),isError?_this.$q.reject(v):v}}options=options||{};var _this=this,storeOnResolve="storeOnResolve"in options?!!options.storeOnResolve:_this.$$storeOnResolve,storeOnReject="storeOnReject"in options?!!options.storeOnReject:_this.$$storeOnReject;if(!_this.$$disabled&&null!==value&&void 0!==value){if(key=utils.stringifyNumber(key),!angular.isString(key))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof key);var now=(new Date).getTime(),item={key:key,value:isPromiseLike(value)?value.then(getHandler(storeOnResolve,!1),getHandler(storeOnReject,!0)):value,created:now,accessed:now};if(item.expires=item.created+_this.$$maxAge,_this.$$storage){if(isPromiseLike(item.value))return _this.$$promises[key]=item.value,_this.$$promises[key];var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys"),keys=keysJson?angular.fromJson(keysJson):[],itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);itemJson&&_this.remove(key),_this.$$expiresHeap.push({key:key,expires:item.expires}),_this.$$lruHeap.push({key:key,accessed:item.accessed}),_this.$$storage().setItem(_this.$$prefix+".data."+key,JSON.stringify(item));for(var exists=!1,i=0;i<keys.length;i++)if(keys[i]===key){exists=!0;break}exists||keys.push(key),_this.$$storage().setItem(_this.$$prefix+".keys",JSON.stringify(keys))}else _this.$$data[key]&&_this.remove(key),_this.$$expiresHeap.push(item),_this.$$lruHeap.push(item),_this.$$data[key]=item,delete _this.$$promises[key];return _this.$$lruHeap.size()>_this.$$capacity&&_this.remove(_this.$$lruHeap.peek().key),value}}},{"../utils":21}],9:[function(require,module){module.exports=function(key){var _this=this;if(key+="",delete _this.$$promises[key],!_this.$$storage){var value=_this.$$data[key]?_this.$$data[key].value:void 0;return _this.$$lruHeap.remove(_this.$$data[key]),_this.$$expiresHeap.remove(_this.$$data[key]),_this.$$data[key]=null,delete _this.$$data[key],value}var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);if(itemJson){var item=angular.fromJson(itemJson);_this.$$lruHeap.remove({key:key,accessed:item.accessed}),_this.$$expiresHeap.remove({key:key,expires:item.expires}),_this.$$storage().removeItem(_this.$$prefix+".data."+key);var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys"),keys=keysJson?angular.fromJson(keysJson):[],index=keys.indexOf(key);return index>=0&&keys.splice(index,1),_this.$$storage().setItem(_this.$$prefix+".keys",JSON.stringify(keys)),item.value}}},{}],10:[function(require,module){module.exports=function(){var _this=this;if(_this.$$storage){_this.$$lruHeap.removeAll(),_this.$$expiresHeap.removeAll();var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys");if(keysJson)for(var keys=angular.fromJson(keysJson),i=0;i<keys.length;i++)_this.remove(keys[i]);_this.$$storage().setItem(_this.$$prefix+".keys",JSON.stringify([]))}else{_this.$$lruHeap.removeAll(),_this.$$expiresHeap.removeAll();for(var key in _this.$$data)_this.$$data[key]=null;_this.$$data={}}}},{}],11:[function(require,module){module.exports=function(){for(var key,expiredItem,_this=this,now=(new Date).getTime(),expired={};(expiredItem=_this.$$expiresHeap.peek())&&expiredItem.expires<=now;)expired[expiredItem.key]=expiredItem.value?expiredItem.value:null,_this.$$expiresHeap.pop();if(_this.$$storage)for(key in expired){var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);itemJson&&(expired[key]=angular.fromJson(itemJson).value,_this.remove(key))}else for(key in expired)_this.remove(key);if(_this.$$onExpire)for(key in expired)_this.$$onExpire(key,expired[key]);return expired}},{}],12:[function(require,module){module.exports=function(cacheFlushInterval){var _this=this;if(null===cacheFlushInterval)delete _this.$$cacheFlushInterval;else{if(!angular.isNumber(cacheFlushInterval))throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be a number! Found: {0}.",typeof cacheFlushInterval);if(0>cacheFlushInterval)throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be greater than zero! Found: {0}.",cacheFlushInterval);cacheFlushInterval!==_this.$$cacheFlushInterval&&(_this.$$cacheFlushInterval=cacheFlushInterval,clearInterval(_this.$$cacheFlushIntervalId),function(self){self.$$cacheFlushIntervalId=setInterval(function(){self.removeAll()},self.$$cacheFlushInterval)}(_this))}}},{}],13:[function(require,module){module.exports=function(capacity){var _this=this;if(null===capacity)delete _this.$$capacity;else{if(!angular.isNumber(capacity))throw angular.$$minErr("ng")("areq","Expected capacity to be a number! Found: {0}.",typeof capacity);if(0>capacity)throw angular.$$minErr("ng")("areq","Expected capacity to be greater than zero! Found: {0}.",capacity);_this.$$capacity=capacity}for(var removed={};_this.$$lruHeap.size()>_this.$$capacity;)removed[_this.$$lruHeap.peek().key]=_this.remove(_this.$$lruHeap.peek().key);return removed}},{}],14:[function(require,module){module.exports=function(deleteOnExpire){var _this=this;if(null===deleteOnExpire)delete _this.$$deleteOnExpire;else{if(!angular.isString(deleteOnExpire))throw angular.$$minErr("ng")("areq","Expected deleteOnExpire to be a string! Found: {0}.",typeof deleteOnExpire);if("none"!==deleteOnExpire&&"passive"!==deleteOnExpire&&"aggressive"!==deleteOnExpire)throw angular.$$minErr("ng")("areq",'Expected deleteOnExpire to be "none", "passive" or "aggressive"! Found: {0}.',deleteOnExpire);_this.$$deleteOnExpire=deleteOnExpire}_this.setRecycleFreq(_this.$$recycleFreq)}},{}],15:[function(require,module){var utils=require("../utils");module.exports=function(maxAge){var _this=this;if(null===maxAge)delete _this.$$maxAge;else{if(!angular.isNumber(maxAge))throw angular.$$minErr("ng")("areq","Expected maxAge to be a number! Found: {0}.",typeof maxAge);if(0>maxAge)throw angular.$$minErr("ng")("areq","Expected maxAge to be greater than zero! Found: {0}.",maxAge);_this.$$maxAge=maxAge}var i,keys,key;if(_this.$$expiresHeap.removeAll(),_this.$$storage){var keysJson=_this.$$storage().getItem(_this.$$prefix+".keys");for(keys=keysJson?angular.fromJson(keysJson):[],i=0;i<keys.length;i++){key=keys[i];var itemJson=_this.$$storage().getItem(_this.$$prefix+".data."+key);if(itemJson){var item=angular.fromJson(itemJson);item.expires=_this.$$maxAge===Number.MAX_VALUE?Number.MAX_VALUE:item.created+_this.$$maxAge,_this.$$expiresHeap.push({key:key,expires:item.expires})}}}else for(keys=utils.keys(_this.$$data),i=0;i<keys.length;i++)key=keys[i],_this.$$data[key].expires=_this.$$maxAge===Number.MAX_VALUE?Number.MAX_VALUE:_this.$$data[key].created+_this.$$maxAge,_this.$$expiresHeap.push(_this.$$data[key]);return"aggressive"===_this.$$deleteOnExpire?_this.removeExpired():{}}},{"../utils":21}],16:[function(require,module){module.exports=function(onExpire){if(null===onExpire)delete this.$$onExpire;else{if(!angular.isFunction(onExpire))throw angular.$$minErr("ng")("areq","Expected onExpire to be a function! Found: {0}.",typeof onExpire);this.$$onExpire=onExpire}}},{}],17:[function(require,module){module.exports=function(recycleFreq){var _this=this;if(null===recycleFreq)delete _this.$$recycleFreq;else{if(!angular.isNumber(recycleFreq))throw angular.$$minErr("ng")("areq","Expected recycleFreq to be a number! Found: {0}.",typeof recycleFreq);if(0>recycleFreq)throw angular.$$minErr("ng")("areq","Expected recycleFreq to be greater than zero! Found: {0}.",recycleFreq);_this.$$recycleFreq=recycleFreq}clearInterval(_this.$$recycleFreqId),"aggressive"===_this.$$deleteOnExpire?!function(self){self.$$recycleFreqId=setInterval(function(){self.removeExpired()},self.$$recycleFreq)}(_this):delete _this.$$recycleFreqId}},{}],18:[function(require,module){function DSCacheFactoryProvider(){var _this=this,config=new defaults.Config;_this.version=version,_this.setCacheDefaults=function(options){if(options=options||{},!angular.isObject(options))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof options);for(var key in defaults.defaults)key in options&&(config[key]=options[key]);"disabled"in options&&(config.$$disabled=!!options.disabled)},_this.$get=["$q",function($q){function _keys(collection){var key,keys=[];for(key in collection)collection.hasOwnProperty(key)&&keys.push(key);return keys}function createCache(cacheId,options){if(cacheId in caches)throw angular.$$minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);if(!angular.isString(cacheId))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof cacheId);return caches[cacheId]=new DSCache(cacheId,angular.extend({},config,options)),caches[cacheId].destroy=function(){this.constructor.prototype.destroy.call(this),delete caches[this.$$id]},caches[cacheId].$q=$q,caches[cacheId]}function DSCacheFactory(cacheId,options){return createCache(cacheId,options)}var caches={};return DSCacheFactory.createCache=createCache,DSCacheFactory.version=version,DSCacheFactory.info=function(){for(var keys=_keys(caches),info={size:keys.length,caches:{}},i=0;i<keys.length;i++){var key=keys[i];info.caches[key]=caches[key].info()}var c=info.cacheDefaults=angular.extend({},config);for(var option in defaults.defaults)option in c||(c[option]=config["$$"+option]);return info},DSCacheFactory.get=function(cacheId){if(!angular.isString(cacheId))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof cacheId);return caches[cacheId]},DSCacheFactory.keySet=function(){var cacheId,cacheIds={};for(cacheId in caches)caches.hasOwnProperty(cacheId)&&(cacheIds[cacheId]=cacheId);return cacheIds},DSCacheFactory.keys=function(){return _keys(caches)},DSCacheFactory.destroyAll=function(){for(var cacheId in caches)caches[cacheId].destroy();caches={}},DSCacheFactory.clearAll=function(){for(var cacheId in caches)caches[cacheId].removeAll()},DSCacheFactory.enableAll=function(){for(var cacheId in caches)caches[cacheId].$$disabled=!1},DSCacheFactory.disableAll=function(){for(var cacheId in caches)caches[cacheId].$$disabled=!0},DSCacheFactory}]}var defaults=require("../defaults"),DSCache=require("../DSCache"),version="3.2.5";module.exports=DSCacheFactoryProvider},{"../DSCache":4,"../defaults":19}],19:[function(require,module){function Config(){}var defaults={capacity:Number.MAX_VALUE,maxAge:Number.MAX_VALUE,deleteOnExpire:"none",onExpire:null,cacheFlushInterval:null,recycleFreq:1e3,storageMode:"memory",storageImpl:null,disabled:!1,storagePrefix:"angular-cache.caches.",storeOnResolve:!1,storeOnReject:!1};for(var option in defaults)Config.prototype["$$"+option]=defaults[option];module.exports={Config:Config,defaults:defaults}},{}],20:[function(require){!function(window,angular){"use strict";angular.$$minErr=angular.$$minErr||function(module){return function(){var message,i,code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments,stringify=function(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof obj?"undefined":"string"!=typeof obj?JSON.stringify(obj):obj};for(message=prefix+template.replace(/\{\d+\}/g,function(match){var arg,index=+match.slice(1,-1);return index+2<templateArgs.length?(arg=templateArgs[index+2],"function"==typeof arg?arg.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof arg?"undefined":"string"!=typeof arg?angular.toJson(arg):arg):match}),message=message+"\nhttp://errors.angularjs.org/"+angular.version.full+"/"+(module?module+"/":"")+code,i=2;i<arguments.length;i++)message=message+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(stringify(arguments[i]));return new Error(message)}},angular.module("angular-data.DSBinaryHeap",[]).provider("DSBinaryHeap",require("./DSBinaryHeap").DSBinaryHeapProvider),angular.module("angular-data.DSCacheFactory",["ng","angular-data.DSBinaryHeap"]).provider("DSCacheFactory",require("./DSCacheFactory"))}(window,window.angular)},{"./DSBinaryHeap":1,"./DSCacheFactory":18}],21:[function(require,module){module.exports={stringifyNumber:function(number){return angular.isNumber(number)?number.toString():number},keySet:function(collection){var key,keySet={};for(key in collection)collection.hasOwnProperty(key)&&(keySet[key]=key);return keySet},keys:function(collection){var key,keys=[];for(key in collection)collection.hasOwnProperty(key)&&keys.push(key);return keys}}},{}]},{},[20]),function(window,angular,undefined){"use strict";angular.module("ui.sortable",[]).value("uiSortableConfig",{}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(uiSortableConfig,$timeout,$log){return{require:"?ngModel",scope:{ngModel:"=",uiSortable:"="},link:function(scope,element,attrs,ngModel){function combineCallbacks(first,second){return second&&"function"==typeof second?function(e,ui){first(e,ui),second(e,ui)}:first}function getSortableWidgetInstance(element){var data=element.data("ui-sortable");return data&&"object"==typeof data&&"ui-sortable"===data.widgetFullName?data:null}function hasSortingHelper(element,ui){var helperOption=element.sortable("option","helper");return"clone"===helperOption||"function"==typeof helperOption&&ui.item.sortable.isCustomHelperUsed()}function isFloating(item){return/left|right/.test(item.css("float"))||/inline|table-cell/.test(item.css("display"))}function getElementScope(elementScopes,element){for(var result=null,i=0;i<elementScopes.length;i++){var x=elementScopes[i];if(x.element[0]===element[0]){result=x.scope;break}}return result}function afterStop(e,ui){ui.item.sortable._destroy()}var savedNodes,opts={},directiveOpts={"ui-floating":undefined},callbacks={receive:null,remove:null,start:null,stop:null,update:null},wrappers={helper:null};return angular.extend(opts,directiveOpts,uiSortableConfig,scope.uiSortable),angular.element.fn&&angular.element.fn.jquery?(ngModel?(scope.$watch("ngModel.length",function(){$timeout(function(){getSortableWidgetInstance(element)&&element.sortable("refresh")
},0,!1)}),callbacks.start=function(e,ui){if("auto"===opts["ui-floating"]){var siblings=ui.item.siblings(),sortableWidgetInstance=getSortableWidgetInstance(angular.element(e.target));sortableWidgetInstance.floating=isFloating(siblings)}ui.item.sortable={model:ngModel.$modelValue[ui.item.index()],index:ui.item.index(),source:ui.item.parent(),sourceModel:ngModel.$modelValue,cancel:function(){ui.item.sortable._isCanceled=!0},isCanceled:function(){return ui.item.sortable._isCanceled},isCustomHelperUsed:function(){return!!ui.item.sortable._isCustomHelperUsed},_isCanceled:!1,_isCustomHelperUsed:ui.item.sortable._isCustomHelperUsed,_destroy:function(){angular.forEach(ui.item.sortable,function(value,key){ui.item.sortable[key]=undefined})}}},callbacks.activate=function(e,ui){savedNodes=element.contents();var placeholder=element.sortable("option","placeholder");if(placeholder&&placeholder.element&&"function"==typeof placeholder.element){var phElement=placeholder.element();phElement=angular.element(phElement);var excludes=element.find('[class="'+phElement.attr("class")+'"]:not([ng-repeat], [data-ng-repeat])');savedNodes=savedNodes.not(excludes)}var connectedSortables=ui.item.sortable._connectedSortables||[];connectedSortables.push({element:element,scope:scope}),ui.item.sortable._connectedSortables=connectedSortables},callbacks.update=function(e,ui){if(!ui.item.sortable.received){ui.item.sortable.dropindex=ui.item.index();var droptarget=ui.item.parent();ui.item.sortable.droptarget=droptarget;var droptargetScope=getElementScope(ui.item.sortable._connectedSortables,droptarget);ui.item.sortable.droptargetModel=droptargetScope.ngModel,element.sortable("cancel")}hasSortingHelper(element,ui)&&!ui.item.sortable.received&&"parent"===element.sortable("option","appendTo")&&(savedNodes=savedNodes.not(savedNodes.last())),savedNodes.appendTo(element),ui.item.sortable.received&&(savedNodes=null),ui.item.sortable.received&&!ui.item.sortable.isCanceled()&&scope.$apply(function(){ngModel.$modelValue.splice(ui.item.sortable.dropindex,0,ui.item.sortable.moved)})},callbacks.stop=function(e,ui){!ui.item.sortable.received&&"dropindex"in ui.item.sortable&&!ui.item.sortable.isCanceled()?scope.$apply(function(){ngModel.$modelValue.splice(ui.item.sortable.dropindex,0,ngModel.$modelValue.splice(ui.item.sortable.index,1)[0])}):"dropindex"in ui.item.sortable&&!ui.item.sortable.isCanceled()||hasSortingHelper(element,ui)||savedNodes.appendTo(element),savedNodes=null},callbacks.receive=function(e,ui){ui.item.sortable.received=!0},callbacks.remove=function(e,ui){"dropindex"in ui.item.sortable||(element.sortable("cancel"),ui.item.sortable.cancel()),ui.item.sortable.isCanceled()||scope.$apply(function(){ui.item.sortable.moved=ngModel.$modelValue.splice(ui.item.sortable.index,1)[0]})},wrappers.helper=function(inner){return inner&&"function"==typeof inner?function(e,item){var innerResult=inner(e,item);return item.sortable._isCustomHelperUsed=item!==innerResult,innerResult}:inner},scope.$watch("uiSortable",function(newVal){var sortableWidgetInstance=getSortableWidgetInstance(element);sortableWidgetInstance&&angular.forEach(newVal,function(value,key){return key in directiveOpts?("ui-floating"!==key||value!==!1&&value!==!0||(sortableWidgetInstance.floating=value),void(opts[key]=value)):(callbacks[key]?("stop"===key&&(value=combineCallbacks(value,function(){scope.$apply()}),value=combineCallbacks(value,afterStop)),value=combineCallbacks(callbacks[key],value)):wrappers[key]&&(value=wrappers[key](value)),opts[key]=value,void element.sortable("option",key,value))})},!0),angular.forEach(callbacks,function(value,key){opts[key]=combineCallbacks(value,opts[key]),"stop"===key&&(opts[key]=combineCallbacks(opts[key],afterStop))})):$log.info("ui.sortable: ngModel not provided!",element),void element.sortable(opts)):void $log.error("ui.sortable: jQuery should be included before AngularJS!")}}}])}(window,window.angular),function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof exports&&"object"==typeof module?module.exports=factory:factory(jQuery)}(function($,undefined){"use strict";function paletteTemplate(p,color,className,opts){for(var html=[],i=0;i<p.length;i++){var current=p[i];if(current){var tiny=tinycolor(current),c=tiny.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(color,current)?" sp-thumb-active":"";var formattedString=tiny.toString(opts.preferredFormat||"rgb"),swatchStyle=rgbaSupport?"background-color:"+tiny.toRgbString():"filter:"+tiny.toFilter();html.push('<span title="'+formattedString+'" data-color="'+tiny.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+swatchStyle+';" /></span>')}else{var cls="sp-clear-display";html.push($("<div />").append($('<span data-color="" style="background-color:transparent;" class="'+cls+'"></span>').attr("title",opts.noColorSelectedText)).html())}}return"<div class='sp-cf "+className+"'>"+html.join("")+"</div>"}function hideAll(){for(var i=0;i<spectrums.length;i++)spectrums[i]&&spectrums[i].hide()}function instanceOptions(o,callbackContext){var opts=$.extend({},defaultOpts,o);return opts.callbacks={move:bind(opts.move,callbackContext),change:bind(opts.change,callbackContext),show:bind(opts.show,callbackContext),hide:bind(opts.hide,callbackContext),beforeShow:bind(opts.beforeShow,callbackContext)},opts}function spectrum(element,o){function applyOptions(){if(opts.showPaletteOnly&&(opts.showPalette=!0),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),opts.palette){palette=opts.palette.slice(0),paletteArray=$.isArray(palette[0])?palette:[palette],paletteLookup={};for(var i=0;i<paletteArray.length;i++)for(var j=0;j<paletteArray[i].length;j++){var rgb=tinycolor(paletteArray[i][j]).toRgbString();paletteLookup[rgb]=!0}}container.toggleClass("sp-flat",flat),container.toggleClass("sp-input-disabled",!opts.showInput),container.toggleClass("sp-alpha-enabled",opts.showAlpha),container.toggleClass("sp-clear-enabled",allowEmpty),container.toggleClass("sp-buttons-disabled",!opts.showButtons),container.toggleClass("sp-palette-buttons-disabled",!opts.togglePaletteOnly),container.toggleClass("sp-palette-disabled",!opts.showPalette),container.toggleClass("sp-palette-only",opts.showPaletteOnly),container.toggleClass("sp-initial-disabled",!opts.showInitial),container.addClass(opts.className).addClass(opts.containerClassName),reflow()}function initialize(){function paletteElementClick(e){return e.data&&e.data.ignore?(set($(e.target).closest(".sp-thumb-el").data("color")),move()):(set($(e.target).closest(".sp-thumb-el").data("color")),move(),updateOriginalInput(!0),opts.hideAfterPaletteSelect&&hide()),!1}if(IE&&container.find("*:not(input)").attr("unselectable","on"),applyOptions(),shouldReplace&&boundElement.after(replacer).hide(),allowEmpty||clearButton.hide(),flat)boundElement.after(container).hide();else{var appendTo="parent"===opts.appendTo?boundElement.parent():$(opts.appendTo);1!==appendTo.length&&(appendTo=$("body")),appendTo.append(container)}updateSelectionPaletteFromStorage(),offsetElement.bind("click.spectrum touchstart.spectrum",function(e){disabled||toggle(),e.stopPropagation(),$(e.target).is("input")||e.preventDefault()}),(boundElement.is(":disabled")||opts.disabled===!0)&&disable(),container.click(stopPropagation),textInput.change(setFromTextInput),textInput.bind("paste",function(){setTimeout(setFromTextInput,1)}),textInput.keydown(function(e){13==e.keyCode&&setFromTextInput()}),cancelButton.text(opts.cancelText),cancelButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),revert(),hide()}),clearButton.attr("title",opts.clearText),clearButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),isEmpty=!0,move(),flat&&updateOriginalInput(!0)}),chooseButton.text(opts.chooseText),chooseButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),isValid()&&(updateOriginalInput(!0),hide())}),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),toggleButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),opts.showPaletteOnly=!opts.showPaletteOnly,opts.showPaletteOnly||flat||container.css("left","-="+(pickerContainer.outerWidth(!0)+5)),applyOptions()}),draggable(alphaSlider,function(dragX,dragY,e){currentAlpha=dragX/alphaWidth,isEmpty=!1,e.shiftKey&&(currentAlpha=Math.round(10*currentAlpha)/10),move()},dragStart,dragStop),draggable(slider,function(dragX,dragY){currentHue=parseFloat(dragY/slideHeight),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),draggable(dragger,function(dragX,dragY,e){if(e.shiftKey){if(!shiftMovementDirection){var oldDragX=currentSaturation*dragWidth,oldDragY=dragHeight-currentValue*dragHeight,furtherFromX=Math.abs(dragX-oldDragX)>Math.abs(dragY-oldDragY);shiftMovementDirection=furtherFromX?"x":"y"}}else shiftMovementDirection=null;var setSaturation=!shiftMovementDirection||"x"===shiftMovementDirection,setValue=!shiftMovementDirection||"y"===shiftMovementDirection;setSaturation&&(currentSaturation=parseFloat(dragX/dragWidth)),setValue&&(currentValue=parseFloat((dragHeight-dragY)/dragHeight)),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),initialColor?(set(initialColor),updateUI(),currentPreferredFormat=preferredFormat||tinycolor(initialColor).format,addColorToSelectionPalette(initialColor)):updateUI(),flat&&show();var paletteEvent=IE?"mousedown.spectrum":"click.spectrum touchstart.spectrum";paletteContainer.delegate(".sp-thumb-el",paletteEvent,paletteElementClick),initialColorContainer.delegate(".sp-thumb-el:nth-child(1)",paletteEvent,{ignore:!0},paletteElementClick)}function updateSelectionPaletteFromStorage(){if(localStorageKey&&window.localStorage){try{var oldPalette=window.localStorage[localStorageKey].split(",#");oldPalette.length>1&&(delete window.localStorage[localStorageKey],$.each(oldPalette,function(i,c){addColorToSelectionPalette(c)}))}catch(e){}try{selectionPalette=window.localStorage[localStorageKey].split(";")}catch(e){}}}function addColorToSelectionPalette(color){if(showSelectionPalette){var rgb=tinycolor(color).toRgbString();if(!paletteLookup[rgb]&&-1===$.inArray(rgb,selectionPalette))for(selectionPalette.push(rgb);selectionPalette.length>maxSelectionSize;)selectionPalette.shift();if(localStorageKey&&window.localStorage)try{window.localStorage[localStorageKey]=selectionPalette.join(";")}catch(e){}}}function getUniqueSelectionPalette(){var unique=[];if(opts.showPalette)for(var i=0;i<selectionPalette.length;i++){var rgb=tinycolor(selectionPalette[i]).toRgbString();paletteLookup[rgb]||unique.push(selectionPalette[i])}return unique.reverse().slice(0,opts.maxSelectionSize)}function drawPalette(){var currentColor=get(),html=$.map(paletteArray,function(palette,i){return paletteTemplate(palette,currentColor,"sp-palette-row sp-palette-row-"+i,opts)});updateSelectionPaletteFromStorage(),selectionPalette&&html.push(paletteTemplate(getUniqueSelectionPalette(),currentColor,"sp-palette-row sp-palette-row-selection",opts)),paletteContainer.html(html.join(""))}function drawInitial(){if(opts.showInitial){var initial=colorOnShow,current=get();initialColorContainer.html(paletteTemplate([initial,current],current,"sp-palette-row-initial",opts))}}function dragStart(){(0>=dragHeight||0>=dragWidth||0>=slideHeight)&&reflow(),container.addClass(draggingClass),shiftMovementDirection=null,boundElement.trigger("dragstart.spectrum",[get()])}function dragStop(){container.removeClass(draggingClass),boundElement.trigger("dragstop.spectrum",[get()])}function setFromTextInput(){var value=textInput.val();if(null!==value&&""!==value||!allowEmpty){var tiny=tinycolor(value);tiny.isValid()?(set(tiny),updateOriginalInput(!0)):textInput.addClass("sp-validation-error")}else set(null),updateOriginalInput(!0)}function toggle(){visible?hide():show()}function show(){var event=$.Event("beforeShow.spectrum");return visible?void reflow():(boundElement.trigger(event,[get()]),void(callbacks.beforeShow(get())===!1||event.isDefaultPrevented()||(hideAll(),visible=!0,$(doc).bind("click.spectrum",clickout),$(window).bind("resize.spectrum",resize),replacer.addClass("sp-active"),container.removeClass("sp-hidden"),reflow(),updateUI(),colorOnShow=get(),drawInitial(),callbacks.show(colorOnShow),boundElement.trigger("show.spectrum",[colorOnShow]))))}function clickout(e){2!=e.button&&(clickoutFiresChange?updateOriginalInput(!0):revert(),hide())}function hide(){visible&&!flat&&(visible=!1,$(doc).unbind("click.spectrum",clickout),$(window).unbind("resize.spectrum",resize),replacer.removeClass("sp-active"),container.addClass("sp-hidden"),callbacks.hide(get()),boundElement.trigger("hide.spectrum",[get()]))}function revert(){set(colorOnShow,!0)}function set(color,ignoreFormatChange){if(tinycolor.equals(color,get()))return void updateUI();var newColor,newHsv;!color&&allowEmpty?isEmpty=!0:(isEmpty=!1,newColor=tinycolor(color),newHsv=newColor.toHsv(),currentHue=newHsv.h%360/360,currentSaturation=newHsv.s,currentValue=newHsv.v,currentAlpha=newHsv.a),updateUI(),newColor&&newColor.isValid()&&!ignoreFormatChange&&(currentPreferredFormat=preferredFormat||newColor.getFormat())}function get(opts){return opts=opts||{},allowEmpty&&isEmpty?null:tinycolor.fromRatio({h:currentHue,s:currentSaturation,v:currentValue,a:Math.round(100*currentAlpha)/100},{format:opts.format||currentPreferredFormat})}function isValid(){return!textInput.hasClass("sp-validation-error")}function move(){updateUI(),callbacks.move(get()),boundElement.trigger("move.spectrum",[get()])}function updateUI(){textInput.removeClass("sp-validation-error"),updateHelperLocations();var flatColor=tinycolor.fromRatio({h:currentHue,s:1,v:1});dragger.css("background-color",flatColor.toHexString());var format=currentPreferredFormat;1>currentAlpha&&(0!==currentAlpha||"name"!==format)&&("hex"===format||"hex3"===format||"hex6"===format||"name"===format)&&(format="rgb");var realColor=get({format:format}),displayColor="";if(previewElement.removeClass("sp-clear-display"),previewElement.css("background-color","transparent"),!realColor&&allowEmpty)previewElement.addClass("sp-clear-display");else{var realHex=realColor.toHexString(),realRgb=realColor.toRgbString();if(rgbaSupport||1===realColor.alpha?previewElement.css("background-color",realRgb):(previewElement.css("background-color","transparent"),previewElement.css("filter",realColor.toFilter())),opts.showAlpha){var rgb=realColor.toRgb();rgb.a=0;var realAlpha=tinycolor(rgb).toRgbString(),gradient="linear-gradient(left, "+realAlpha+", "+realHex+")";IE?alphaSliderInner.css("filter",tinycolor(realAlpha).toFilter({gradientType:1},realHex)):(alphaSliderInner.css("background","-webkit-"+gradient),alphaSliderInner.css("background","-moz-"+gradient),alphaSliderInner.css("background","-ms-"+gradient),alphaSliderInner.css("background","linear-gradient(to right, "+realAlpha+", "+realHex+")"))}displayColor=realColor.toString(format)}opts.showInput&&textInput.val(displayColor),opts.showPalette&&drawPalette(),drawInitial()}function updateHelperLocations(){var s=currentSaturation,v=currentValue;if(allowEmpty&&isEmpty)alphaSlideHelper.hide(),slideHelper.hide(),dragHelper.hide();else{alphaSlideHelper.show(),slideHelper.show(),dragHelper.show();var dragX=s*dragWidth,dragY=dragHeight-v*dragHeight;dragX=Math.max(-dragHelperHeight,Math.min(dragWidth-dragHelperHeight,dragX-dragHelperHeight)),dragY=Math.max(-dragHelperHeight,Math.min(dragHeight-dragHelperHeight,dragY-dragHelperHeight)),dragHelper.css({top:dragY+"px",left:dragX+"px"});var alphaX=currentAlpha*alphaWidth;alphaSlideHelper.css({left:alphaX-alphaSlideHelperWidth/2+"px"});var slideY=currentHue*slideHeight;slideHelper.css({top:slideY-slideHelperHeight+"px"})}}function updateOriginalInput(fireCallback){var color=get(),displayColor="",hasChanged=!tinycolor.equals(color,colorOnShow);color&&(displayColor=color.toString(currentPreferredFormat),addColorToSelectionPalette(color)),isInput&&boundElement.val(displayColor),fireCallback&&hasChanged&&(callbacks.change(color),boundElement.trigger("change",[color]))}function reflow(){dragWidth=dragger.width(),dragHeight=dragger.height(),dragHelperHeight=dragHelper.height(),slideWidth=slider.width(),slideHeight=slider.height(),slideHelperHeight=slideHelper.height(),alphaWidth=alphaSlider.width(),alphaSlideHelperWidth=alphaSlideHelper.width(),flat||(container.css("position","absolute"),container.offset(opts.offset?opts.offset:getOffset(container,offsetElement))),updateHelperLocations(),opts.showPalette&&drawPalette(),boundElement.trigger("reflow.spectrum")}function destroy(){boundElement.show(),offsetElement.unbind("click.spectrum touchstart.spectrum"),container.remove(),replacer.remove(),spectrums[spect.id]=null}function option(optionName,optionValue){return optionName===undefined?$.extend({},opts):optionValue===undefined?opts[optionName]:(opts[optionName]=optionValue,void applyOptions())}function enable(){disabled=!1,boundElement.attr("disabled",!1),offsetElement.removeClass("sp-disabled")}function disable(){hide(),disabled=!0,boundElement.attr("disabled",!0),offsetElement.addClass("sp-disabled")}function setOffset(coord){opts.offset=coord,reflow()}var opts=instanceOptions(o,element),flat=opts.flat,showSelectionPalette=opts.showSelectionPalette,localStorageKey=opts.localStorageKey,theme=opts.theme,callbacks=opts.callbacks,resize=throttle(reflow,10),visible=!1,dragWidth=0,dragHeight=0,dragHelperHeight=0,slideHeight=0,slideWidth=0,alphaWidth=0,alphaSlideHelperWidth=0,slideHelperHeight=0,currentHue=0,currentSaturation=0,currentValue=0,currentAlpha=1,palette=[],paletteArray=[],paletteLookup={},selectionPalette=opts.selectionPalette.slice(0),maxSelectionSize=opts.maxSelectionSize,draggingClass="sp-dragging",shiftMovementDirection=null,doc=element.ownerDocument,boundElement=(doc.body,$(element)),disabled=!1,container=$(markup,doc).addClass(theme),pickerContainer=container.find(".sp-picker-container"),dragger=container.find(".sp-color"),dragHelper=container.find(".sp-dragger"),slider=container.find(".sp-hue"),slideHelper=container.find(".sp-slider"),alphaSliderInner=container.find(".sp-alpha-inner"),alphaSlider=container.find(".sp-alpha"),alphaSlideHelper=container.find(".sp-alpha-handle"),textInput=container.find(".sp-input"),paletteContainer=container.find(".sp-palette"),initialColorContainer=container.find(".sp-initial"),cancelButton=container.find(".sp-cancel"),clearButton=container.find(".sp-clear"),chooseButton=container.find(".sp-choose"),toggleButton=container.find(".sp-palette-toggle"),isInput=boundElement.is("input"),isInputTypeColor=isInput&&inputTypeColorSupport&&"color"===boundElement.attr("type"),shouldReplace=isInput&&!flat,replacer=shouldReplace?$(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName):$([]),offsetElement=shouldReplace?replacer:boundElement,previewElement=replacer.find(".sp-preview-inner"),initialColor=opts.color||isInput&&boundElement.val(),colorOnShow=!1,preferredFormat=opts.preferredFormat,currentPreferredFormat=preferredFormat,clickoutFiresChange=!opts.showButtons||opts.clickoutFiresChange,isEmpty=!initialColor,allowEmpty=opts.allowEmpty&&!isInputTypeColor;initialize();var spect={show:show,hide:hide,toggle:toggle,reflow:reflow,option:option,enable:enable,disable:disable,offset:setOffset,set:function(c){set(c),updateOriginalInput()},get:get,destroy:destroy,container:container};return spect.id=spectrums.push(spect)-1,spect}function getOffset(picker,input){var extraY=0,dpWidth=picker.outerWidth(),dpHeight=picker.outerHeight(),inputHeight=input.outerHeight(),doc=picker[0].ownerDocument,docElem=doc.documentElement,viewWidth=docElem.clientWidth+$(doc).scrollLeft(),viewHeight=docElem.clientHeight+$(doc).scrollTop(),offset=input.offset();return offset.top+=inputHeight,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight-extraY):extraY),offset}function noop(){}function stopPropagation(e){e.stopPropagation()}function bind(func,obj){var slice=Array.prototype.slice,args=slice.call(arguments,2);return function(){return func.apply(obj,args.concat(slice.call(arguments)))}}function draggable(element,onmove,onstart,onstop){function prevent(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function move(e){if(dragging){if(IE&&doc.documentMode<9&&!e.button)return stop();var touches=e.originalEvent&&e.originalEvent.touches,pageX=touches?touches[0].pageX:e.pageX,pageY=touches?touches[0].pageY:e.pageY,dragX=Math.max(0,Math.min(pageX-offset.left,maxWidth)),dragY=Math.max(0,Math.min(pageY-offset.top,maxHeight));hasTouch&&prevent(e),onmove.apply(element,[dragX,dragY,e])}}function start(e){var rightclick=e.which?3==e.which:2==e.button;rightclick||dragging||onstart.apply(element,arguments)!==!1&&(dragging=!0,maxHeight=$(element).height(),maxWidth=$(element).width(),offset=$(element).offset(),$(doc).bind(duringDragEvents),$(doc.body).addClass("sp-dragging"),hasTouch||move(e),prevent(e))}function stop(){dragging&&($(doc).unbind(duringDragEvents),$(doc.body).removeClass("sp-dragging"),onstop.apply(element,arguments)),dragging=!1}onmove=onmove||function(){},onstart=onstart||function(){},onstop=onstop||function(){};var doc=document,dragging=!1,offset={},maxHeight=0,maxWidth=0,hasTouch="ontouchstart"in window,duringDragEvents={};duringDragEvents.selectstart=prevent,duringDragEvents.dragstart=prevent,duringDragEvents["touchmove mousemove"]=move,duringDragEvents["touchend mouseup"]=stop,$(element).bind("touchstart mousedown",start)}function throttle(func,wait,debounce){var timeout;return function(){var context=this,args=arguments,throttler=function(){timeout=null,func.apply(context,args)};debounce&&clearTimeout(timeout),(debounce||!timeout)&&(timeout=setTimeout(throttler,wait))}}var defaultOpts={beforeShow:noop,move:noop,change:noop,show:noop,hide:noop,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},spectrums=[],IE=!!/msie/i.exec(window.navigator.userAgent),rgbaSupport=function(){function contains(str,substr){return!!~(""+str).indexOf(substr)}var elem=document.createElement("div"),style=elem.style;return style.cssText="background-color:rgba(0,0,0,.5)",contains(style.backgroundColor,"rgba")||contains(style.backgroundColor,"hsla")}(),inputTypeColorSupport=function(){var colorInput=$("<input type='color' value='!' />")[0];return"color"===colorInput.type&&"!"!==colorInput.value}(),replaceInput=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),markup=function(){var gradientFix="";if(IE)for(var i=1;6>=i;i++)gradientFix+="<div class='sp-"+i+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",gradientFix,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),dataID="spectrum.id";$.fn.spectrum=function(opts){if("string"==typeof opts){var returnValue=this,args=Array.prototype.slice.call(arguments,1);return this.each(function(){var spect=spectrums[$(this).data(dataID)];if(spect){var method=spect[opts];if(!method)throw new Error("Spectrum: no such method: '"+opts+"'");"get"==opts?returnValue=spect.get():"container"==opts?returnValue=spect.container:"option"==opts?returnValue=spect.option.apply(spect,args):"destroy"==opts?(spect.destroy(),$(this).removeData(dataID)):method.apply(spect,args)}}),returnValue}return this.spectrum("destroy").each(function(){var options=$.extend({},opts,$(this).data()),spect=spectrum(this,options);$(this).data(dataID,spect.id)})},$.fn.spectrum.load=!0,$.fn.spectrum.loadOpts={},$.fn.spectrum.draggable=draggable,$.fn.spectrum.defaults=defaultOpts,$.spectrum={},$.spectrum.localization={},$.spectrum.palettes={},$.fn.spectrum.processNativeColorInputs=function(){inputTypeColorSupport||$("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function inputToRGB(color){var rgb={r:0,g:0,b:0},a=1,ok=!1,format=!1;return"string"==typeof color&&(color=stringInputToObject(color)),"object"==typeof color&&(color.hasOwnProperty("r")&&color.hasOwnProperty("g")&&color.hasOwnProperty("b")?(rgb=rgbToRgb(color.r,color.g,color.b),ok=!0,format="%"===String(color.r).substr(-1)?"prgb":"rgb"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("v")?(color.s=convertToPercentage(color.s),color.v=convertToPercentage(color.v),rgb=hsvToRgb(color.h,color.s,color.v),ok=!0,format="hsv"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("l")&&(color.s=convertToPercentage(color.s),color.l=convertToPercentage(color.l),rgb=hslToRgb(color.h,color.s,color.l),ok=!0,format="hsl"),color.hasOwnProperty("a")&&(a=color.a)),a=boundAlpha(a),{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a}}function rgbToRgb(r,g,b){return{r:255*bound01(r,255),g:255*bound01(g,255),b:255*bound01(b,255)}}function rgbToHsl(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(b>g?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,l:l}}function hslToRgb(h,s,l){function hue2rgb(p,q,t){return 0>t&&(t+=1),t>1&&(t-=1),1/6>t?p+6*(q-p)*t:.5>t?q:2/3>t?p+(q-p)*(2/3-t)*6:p}var r,g,b;if(h=bound01(h,360),s=bound01(s,100),l=bound01(l,100),0===s)r=g=b=l;else{var q=.5>l?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:255*r,g:255*g,b:255*b}}function rgbToHsv(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max==min)h=0;else{switch(max){case r:h=(g-b)/d+(b>g?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,v:v}}function hsvToRgb(h,s,v){h=6*bound01(h,360),s=bound01(s,100),v=bound01(v,100);var i=math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6,r=[v,q,p,p,t,v][mod],g=[t,v,v,q,p,p][mod],b=[p,p,t,v,v,q][mod];return{r:255*r,g:255*g,b:255*b}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0):hex.join("")}function rgbaToHex(r,g,b,a){var hex=[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return hex.join("")}function desaturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s-=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function saturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s+=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function greyscale(color){return tinycolor(color).desaturate(100)}function lighten(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l+=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function brighten(color,amount){amount=0===amount?0:amount||10;var rgb=tinycolor(color).toRgb();return rgb.r=mathMax(0,mathMin(255,rgb.r-mathRound(255*-(amount/100)))),rgb.g=mathMax(0,mathMin(255,rgb.g-mathRound(255*-(amount/100)))),rgb.b=mathMax(0,mathMin(255,rgb.b-mathRound(255*-(amount/100)))),tinycolor(rgb)}function darken(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l-=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function spin(color,amount){var hsl=tinycolor(color).toHsl(),hue=(mathRound(hsl.h)+amount)%360;return hsl.h=0>hue?360+hue:hue,tinycolor(hsl)}function complement(color){var hsl=tinycolor(color).toHsl();return hsl.h=(hsl.h+180)%360,tinycolor(hsl)}function triad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})]}function tetrad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})]}function splitcomplement(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function analogous(color,results,slices){results=results||6,slices=slices||30;var hsl=tinycolor(color).toHsl(),part=360/slices,ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;)hsl.h=(hsl.h+part)%360,ret.push(tinycolor(hsl));return ret}function monochromatic(color,results){results=results||6;for(var hsv=tinycolor(color).toHsv(),h=hsv.h,s=hsv.s,v=hsv.v,ret=[],modification=1/results;results--;)ret.push(tinycolor({h:h,s:s,v:v})),v=(v+modification)%1;return ret}function flip(o){var flipped={};for(var i in o)o.hasOwnProperty(i)&&(flipped[o[i]]=i);return flipped}function boundAlpha(a){return a=parseFloat(a),(isNaN(a)||0>a||a>1)&&(a=1),a}function bound01(n,max){isOnePointZero(n)&&(n="100%");var processPercent=isPercentage(n);return n=mathMin(max,mathMax(0,parseFloat(n))),processPercent&&(n=parseInt(n*max,10)/100),math.abs(n-max)<1e-6?1:n%max/parseFloat(max)}function clamp01(val){return mathMin(1,mathMax(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function isOnePointZero(n){return"string"==typeof n&&-1!=n.indexOf(".")&&1===parseFloat(n)}function isPercentage(n){return"string"==typeof n&&-1!=n.indexOf("%")}function pad2(c){return 1==c.length?"0"+c:""+c}function convertToPercentage(n){return 1>=n&&(n=100*n+"%"),n}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var named=!1;if(names[color])color=names[color],named=!0;else if("transparent"==color)return{r:0,g:0,b:0,a:0,format:"name"};var match;return(match=matchers.rgb.exec(color))?{r:match[1],g:match[2],b:match[3]}:(match=matchers.rgba.exec(color))?{r:match[1],g:match[2],b:match[3],a:match[4]}:(match=matchers.hsl.exec(color))?{h:match[1],s:match[2],l:match[3]}:(match=matchers.hsla.exec(color))?{h:match[1],s:match[2],l:match[3],a:match[4]}:(match=matchers.hsv.exec(color))?{h:match[1],s:match[2],v:match[3]}:(match=matchers.hsva.exec(color))?{h:match[1],s:match[2],v:match[3],a:match[4]}:(match=matchers.hex8.exec(color))?{a:convertHexToDecimal(match[1]),r:parseIntFromHex(match[2]),g:parseIntFromHex(match[3]),b:parseIntFromHex(match[4]),format:named?"name":"hex8"}:(match=matchers.hex6.exec(color))?{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"}:(match=matchers.hex3.exec(color))?{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"}:!1
}var trimLeft=/^[\s,#]+/,trimRight=/\s+$/,tinyCounter=0,math=Math,mathRound=math.round,mathMin=math.min,mathMax=math.max,mathRandom=math.random,tinycolor=function tinycolor(color,opts){if(color=color?color:"",opts=opts||{},color instanceof tinycolor)return color;if(!(this instanceof tinycolor))return new tinycolor(color,opts);var rgb=inputToRGB(color);this._originalInput=color,this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=mathRound(100*this._a)/100,this._format=opts.format||rgb.format,this._gradientType=opts.gradientType,this._r<1&&(this._r=mathRound(this._r)),this._g<1&&(this._g=mathRound(this._g)),this._b<1&&(this._b=mathRound(this._b)),this._ok=rgb.ok,this._tc_id=tinyCounter++};tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var rgb=this.toRgb();return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3},setAlpha:function(value){return this._a=boundAlpha(value),this._roundA=mathRound(100*this._a)/100,this},toHsv:function(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:360*hsv.h,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function(){var hsv=rgbToHsv(this._r,this._g,this._b),h=mathRound(360*hsv.h),s=mathRound(100*hsv.s),v=mathRound(100*hsv.v);return 1==this._a?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:360*hsl.h,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function(){var hsl=rgbToHsl(this._r,this._g,this._b),h=mathRound(360*hsl.h),s=mathRound(100*hsl.s),l=mathRound(100*hsl.l);return 1==this._a?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function(){return rgbaToHex(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:mathRound(this._r),g:mathRound(this._g),b:mathRound(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+")":"rgba("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound(100*bound01(this._r,255))+"%",g:mathRound(100*bound01(this._g,255))+"%",b:mathRound(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%)":"rgba("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1},toFilter:function(secondColor){var hex8String="#"+rgbaToHex(this._r,this._g,this._b,this._a),secondHex8String=hex8String,gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){var s=tinycolor(secondColor);secondHex8String=s.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function(format){var formatSet=!!format;format=format||this._format;var formattedString=!1,hasAlpha=this._a<1&&this._a>=0,needsAlphaFormat=!formatSet&&hasAlpha&&("hex"===format||"hex6"===format||"hex3"===format||"name"===format);return needsAlphaFormat?"name"===format&&0===this._a?this.toName():this.toRgbString():("rgb"===format&&(formattedString=this.toRgbString()),"prgb"===format&&(formattedString=this.toPercentageRgbString()),("hex"===format||"hex6"===format)&&(formattedString=this.toHexString()),"hex3"===format&&(formattedString=this.toHexString(!0)),"hex8"===format&&(formattedString=this.toHex8String()),"name"===format&&(formattedString=this.toName()),"hsl"===format&&(formattedString=this.toHslString()),"hsv"===format&&(formattedString=this.toHsvString()),formattedString||this.toHexString())},_applyModification:function(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));return this._r=color._r,this._g=color._g,this._b=color._b,this.setAlpha(color._a),this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}},tinycolor.fromRatio=function(color,opts){if("object"==typeof color){var newColor={};for(var i in color)color.hasOwnProperty(i)&&(newColor[i]="a"===i?color[i]:convertToPercentage(color[i]));color=newColor}return tinycolor(color,opts)},tinycolor.equals=function(color1,color2){return color1&&color2?tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString():!1},tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()})},tinycolor.mix=function(color1,color2,amount){amount=0===amount?0:amount||50;var w1,rgb1=tinycolor(color1).toRgb(),rgb2=tinycolor(color2).toRgb(),p=amount/100,w=2*p-1,a=rgb2.a-rgb1.a;w1=w*a==-1?w:(w+a)/(1+w*a),w1=(w1+1)/2;var w2=1-w1,rgba={r:rgb2.r*w1+rgb1.r*w2,g:rgb2.g*w1+rgb1.g*w2,b:rgb2.b*w1+rgb1.b*w2,a:rgb2.a*p+rgb1.a*(1-p)};return tinycolor(rgba)},tinycolor.readability=function(color1,color2){var c1=tinycolor(color1),c2=tinycolor(color2),rgb1=c1.toRgb(),rgb2=c2.toRgb(),brightnessA=c1.getBrightness(),brightnessB=c2.getBrightness(),colorDiff=Math.max(rgb1.r,rgb2.r)-Math.min(rgb1.r,rgb2.r)+Math.max(rgb1.g,rgb2.g)-Math.min(rgb1.g,rgb2.g)+Math.max(rgb1.b,rgb2.b)-Math.min(rgb1.b,rgb2.b);return{brightness:Math.abs(brightnessA-brightnessB),color:colorDiff}},tinycolor.isReadable=function(color1,color2){var readability=tinycolor.readability(color1,color2);return readability.brightness>125&&readability.color>500},tinycolor.mostReadable=function(baseColor,colorList){for(var bestColor=null,bestScore=0,bestIsReadable=!1,i=0;i<colorList.length;i++){var readability=tinycolor.readability(baseColor,colorList[i]),readable=readability.brightness>125&&readability.color>500,score=3*(readability.brightness/125)+readability.color/500;(readable&&!bestIsReadable||readable&&bestIsReadable&&score>bestScore||!readable&&!bestIsReadable&&score>bestScore)&&(bestIsReadable=readable,bestScore=score,bestColor=tinycolor(colorList[i]))}return bestColor};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names),matchers=function(){var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:"+CSS_NUMBER+")|(?:"+CSS_INTEGER+")",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";return{rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=tinycolor}(),$(function(){$.fn.spectrum.load&&$.fn.spectrum.processNativeColorInputs()})}),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function($){"use strict";var version=$.fn.jquery.split(" ")[0].split(".");if(version[0]<2&&version[1]<9||1==version[0]&&9==version[1]&&version[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one("bsTransitionEnd",function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){return $(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.alert");data||$this.data("bs.alert",data=new Alert(this)),"string"==typeof option&&data[option].call($this)})}var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.VERSION="3.3.2",Alert.TRANSITION_DURATION=150,Alert.prototype.close=function(e){function removeElement(){$parent.detach().trigger("closed.bs.alert").remove()}var $this=$(this),selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=$(selector);e&&e.preventDefault(),$parent.length||($parent=$this.closest(".alert")),$parent.trigger(e=$.Event("close.bs.alert")),e.isDefaultPrevented()||($parent.removeClass("in"),$.support.transition&&$parent.hasClass("fade")?$parent.one("bsTransitionEnd",removeElement).emulateTransitionEnd(Alert.TRANSITION_DURATION):removeElement())};var old=$.fn.alert;$.fn.alert=Plugin,$.fn.alert.Constructor=Alert,$.fn.alert.noConflict=function(){return $.fn.alert=old,this},$(document).on("click.bs.alert.data-api",dismiss,Alert.prototype.close)}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.button"),options="object"==typeof option&&option;data||$this.data("bs.button",data=new Button(this,options)),"toggle"==option?data.toggle():option&&data.setState(option)})}var Button=function(element,options){this.$element=$(element),this.options=$.extend({},Button.DEFAULTS,options),this.isLoading=!1};Button.VERSION="3.3.2",Button.DEFAULTS={loadingText:"loading..."},Button.prototype.setState=function(state){var d="disabled",$el=this.$element,val=$el.is("input")?"val":"html",data=$el.data();state+="Text",null==data.resetText&&$el.data("resetText",$el[val]()),setTimeout($.proxy(function(){$el[val](null==data[state]?this.options[state]:data[state]),"loadingText"==state?(this.isLoading=!0,$el.addClass(d).attr(d,d)):this.isLoading&&(this.isLoading=!1,$el.removeClass(d).removeAttr(d))},this),0)},Button.prototype.toggle=function(){var changed=!0,$parent=this.$element.closest('[data-toggle="buttons"]');if($parent.length){var $input=this.$element.find("input");"radio"==$input.prop("type")&&($input.prop("checked")&&this.$element.hasClass("active")?changed=!1:$parent.find(".active").removeClass("active")),changed&&$input.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));changed&&this.$element.toggleClass("active")};var old=$.fn.button;$.fn.button=Plugin,$.fn.button.Constructor=Button,$.fn.button.noConflict=function(){return $.fn.button=old,this},$(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(e){var $btn=$(e.target);$btn.hasClass("btn")||($btn=$btn.closest(".btn")),Plugin.call($btn,"toggle"),e.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){$(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.carousel"),options=$.extend({},Carousel.DEFAULTS,$this.data(),"object"==typeof option&&option),action="string"==typeof option?option:options.slide;data||$this.data("bs.carousel",data=new Carousel(this,options)),"number"==typeof option?data.to(option):action?data[action]():options.interval&&data.pause().cycle()})}var Carousel=function(element,options){this.$element=$(element),this.$indicators=this.$element.find(".carousel-indicators"),this.options=options,this.paused=this.sliding=this.interval=this.$active=this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",$.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",$.proxy(this.pause,this)).on("mouseleave.bs.carousel",$.proxy(this.cycle,this))};Carousel.VERSION="3.3.2",Carousel.TRANSITION_DURATION=600,Carousel.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},Carousel.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},Carousel.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval)),this},Carousel.prototype.getItemIndex=function(item){return this.$items=item.parent().children(".item"),this.$items.index(item||this.$active)},Carousel.prototype.getItemForDirection=function(direction,active){var activeIndex=this.getItemIndex(active),willWrap="prev"==direction&&0===activeIndex||"next"==direction&&activeIndex==this.$items.length-1;if(willWrap&&!this.options.wrap)return active;var delta="prev"==direction?-1:1,itemIndex=(activeIndex+delta)%this.$items.length;return this.$items.eq(itemIndex)},Carousel.prototype.to=function(pos){var that=this,activeIndex=this.getItemIndex(this.$active=this.$element.find(".item.active"));return pos>this.$items.length-1||0>pos?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){that.to(pos)}):activeIndex==pos?this.pause().cycle():this.slide(pos>activeIndex?"next":"prev",this.$items.eq(pos))},Carousel.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&$.support.transition&&(this.$element.trigger($.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},Carousel.prototype.next=function(){return this.sliding?void 0:this.slide("next")},Carousel.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},Carousel.prototype.slide=function(type,next){var $active=this.$element.find(".item.active"),$next=next||this.getItemForDirection(type,$active),isCycling=this.interval,direction="next"==type?"left":"right",that=this;if($next.hasClass("active"))return this.sliding=!1;var relatedTarget=$next[0],slideEvent=$.Event("slide.bs.carousel",{relatedTarget:relatedTarget,direction:direction});if(this.$element.trigger(slideEvent),!slideEvent.isDefaultPrevented()){if(this.sliding=!0,isCycling&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var $nextIndicator=$(this.$indicators.children()[this.getItemIndex($next)]);$nextIndicator&&$nextIndicator.addClass("active")}var slidEvent=$.Event("slid.bs.carousel",{relatedTarget:relatedTarget,direction:direction});return $.support.transition&&this.$element.hasClass("slide")?($next.addClass(type),$next[0].offsetWidth,$active.addClass(direction),$next.addClass(direction),$active.one("bsTransitionEnd",function(){$next.removeClass([type,direction].join(" ")).addClass("active"),$active.removeClass(["active",direction].join(" ")),that.sliding=!1,setTimeout(function(){that.$element.trigger(slidEvent)},0)}).emulateTransitionEnd(Carousel.TRANSITION_DURATION)):($active.removeClass("active"),$next.addClass("active"),this.sliding=!1,this.$element.trigger(slidEvent)),isCycling&&this.cycle(),this}};var old=$.fn.carousel;$.fn.carousel=Plugin,$.fn.carousel.Constructor=Carousel,$.fn.carousel.noConflict=function(){return $.fn.carousel=old,this};var clickHandler=function(e){var href,$this=$(this),$target=$($this.attr("data-target")||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""));if($target.hasClass("carousel")){var options=$.extend({},$target.data(),$this.data()),slideIndex=$this.attr("data-slide-to");slideIndex&&(options.interval=!1),Plugin.call($target,options),slideIndex&&$target.data("bs.carousel").to(slideIndex),e.preventDefault()}};$(document).on("click.bs.carousel.data-api","[data-slide]",clickHandler).on("click.bs.carousel.data-api","[data-slide-to]",clickHandler),$(window).on("load",function(){$('[data-ride="carousel"]').each(function(){var $carousel=$(this);Plugin.call($carousel,$carousel.data())})})}(jQuery),+function($){"use strict";function getTargetFromTrigger($trigger){var href,target=$trigger.attr("data-target")||(href=$trigger.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,"");return $(target)}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),"object"==typeof option&&option);!data&&options.toggle&&"show"==option&&(options.toggle=!1),data||$this.data("bs.collapse",data=new Collapse(this,options)),"string"==typeof option&&data[option]()})}var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},Collapse.DEFAULTS,options),this.$trigger=$(this.options.trigger).filter('[href="#'+element.id+'"], [data-target="#'+element.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};Collapse.VERSION="3.3.2",Collapse.TRANSITION_DURATION=350,Collapse.DEFAULTS={toggle:!0,trigger:'[data-toggle="collapse"]'},Collapse.prototype.dimension=function(){var hasWidth=this.$element.hasClass("width");return hasWidth?"width":"height"},Collapse.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var activesData,actives=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(actives&&actives.length&&(activesData=actives.data("bs.collapse"),activesData&&activesData.transitioning))){var startEvent=$.Event("show.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){actives&&actives.length&&(Plugin.call(actives,"hide"),activesData||actives.data("bs.collapse",null));var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("collapse in")[dimension](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])}}}},Collapse.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var startEvent=$.Event("hide.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var complete=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return $.support.transition?void this.$element[dimension](0).one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION):complete.call(this)}}},Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},Collapse.prototype.getParent=function(){return $(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each($.proxy(function(i,element){var $element=$(element);this.addAriaAndCollapsedClass(getTargetFromTrigger($element),$element)},this)).end()},Collapse.prototype.addAriaAndCollapsedClass=function($element,$trigger){var isOpen=$element.hasClass("in");$element.attr("aria-expanded",isOpen),$trigger.toggleClass("collapsed",!isOpen).attr("aria-expanded",isOpen)};var old=$.fn.collapse;$.fn.collapse=Plugin,$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var $this=$(this);$this.attr("data-target")||e.preventDefault();var $target=getTargetFromTrigger($this),data=$target.data("bs.collapse"),option=data?"toggle":$.extend({},$this.data(),{trigger:this});Plugin.call($target,option)})}(jQuery),+function($){"use strict";function clearMenus(e){e&&3===e.which||($(backdrop).remove(),$(toggle).each(function(){var $this=$(this),$parent=getParent($this),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||($this.attr("aria-expanded","false"),$parent.removeClass("open").trigger("hidden.bs.dropdown",relatedTarget)))}))}function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})}var backdrop=".dropdown-backdrop",toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.VERSION="3.3.2",Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$('<div class="dropdown-backdrop"/>').insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$this.trigger("focus").attr("aria-expanded","true"),$parent.toggleClass("open").trigger("shown.bs.dropdown",relatedTarget)}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive&&27!=e.which||isActive&&27==e.which)return 27==e.which&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var desc=" li:not(.divider):visible a",$items=$parent.find('[role="menu"]'+desc+', [role="listbox"]'+desc);if($items.length){var index=$items.index(e.target);38==e.which&&index>0&&index--,40==e.which&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")}}}};var old=$.fn.dropdown;$.fn.dropdown=Plugin,$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle,Dropdown.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',Dropdown.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',Dropdown.prototype.keydown)}(jQuery),+function($){"use strict";function Plugin(option,_relatedTarget){return this.each(function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.modal",data=new Modal(this,options)),"string"==typeof option?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)})}var Modal=function(element,options){this.options=options,this.$body=$(document.body),this.$element=$(element),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};Modal.VERSION="3.3.2",Modal.TRANSITION_DURATION=300,Modal.BACKDROP_TRANSITION_DURATION=150,Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.prototype.toggle=function(_relatedTarget){return this.isShown?this.hide():this.show(_relatedTarget)},Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',$.proxy(this.hide,this)),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(that.$body),that.$element.show().scrollTop(0),that.options.backdrop&&that.adjustBackdrop(),that.adjustDialog(),transition&&that.$element[0].offsetWidth,that.$element.addClass("in").attr("aria-hidden",!1),that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$element.find(".modal-dialog").one("bsTransitionEnd",function(){that.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(Modal.TRANSITION_DURATION):that.$element.trigger("focus").trigger(e)}))},Modal.prototype.hide=function(e){e&&e.preventDefault(),e=$.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(Modal.TRANSITION_DURATION):this.hideModal())},Modal.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",$.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},Modal.prototype.resize=function(){this.isShown?$(window).on("resize.bs.modal",$.proxy(this.handleUpdate,this)):$(window).off("resize.bs.modal")},Modal.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop(function(){that.$body.removeClass("modal-open"),that.resetAdjustments(),that.resetScrollbar(),that.$element.trigger("hidden.bs.modal")})},Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},Modal.prototype.backdrop=function(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').prependTo(this.$element).on("click.dismiss.bs.modal",$.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one("bsTransitionEnd",callback).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var callbackRemove=function(){that.removeBackdrop(),callback&&callback()};$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",callbackRemove).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callbackRemove()
}else callback&&callback()},Modal.prototype.handleUpdate=function(){this.options.backdrop&&this.adjustBackdrop(),this.adjustDialog()},Modal.prototype.adjustBackdrop=function(){this.$backdrop.css("height",0).css("height",this.$element[0].scrollHeight)},Modal.prototype.adjustDialog=function(){var modalIsOverflowing=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&modalIsOverflowing?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!modalIsOverflowing?this.scrollbarWidth:""})},Modal.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},Modal.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight,this.scrollbarWidth=this.measureScrollbar()},Modal.prototype.setScrollbar=function(){var bodyPad=parseInt(this.$body.css("padding-right")||0,10);this.bodyIsOverflowing&&this.$body.css("padding-right",bodyPad+this.scrollbarWidth)},Modal.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},Modal.prototype.measureScrollbar=function(){var scrollDiv=document.createElement("div");scrollDiv.className="modal-scrollbar-measure",this.$body.append(scrollDiv);var scrollbarWidth=scrollDiv.offsetWidth-scrollDiv.clientWidth;return this.$body[0].removeChild(scrollDiv),scrollbarWidth};var old=$.fn.modal;$.fn.modal=Plugin,$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault(),$target.one("show.bs.modal",function(showEvent){showEvent.isDefaultPrevented()||$target.one("hidden.bs.modal",function(){$this.is(":visible")&&$this.trigger("focus")})}),Plugin.call($target,option,this)})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip"),options="object"==typeof option&&option;(data||"destroy"!=option)&&(data||$this.data("bs.tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]())})}var Tooltip=function(element,options){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",element,options)};Tooltip.VERSION="3.3.2",Tooltip.TRANSITION_DURATION=150,Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},Tooltip.prototype.init=function(type,element,options){this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.$viewport=this.options.viewport&&$(this.options.viewport.selector||this.options.viewport);for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self&&self.$tip&&self.$tip.is(":visible")?void(self.hoverState="in"):(self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),clearTimeout(self.timeout),self.hoverState="in",self.options.delay&&self.options.delay.show?void(self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show)):self.show())},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),clearTimeout(self.timeout),self.hoverState="out",self.options.delay&&self.options.delay.hide?void(self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide)):self.hide()},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var inDom=$.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!inDom)return;var that=this,$tip=this.tip(),tipId=this.getUID(this.type);this.setContent(),$tip.attr("id",tipId),this.$element.attr("aria-describedby",tipId),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement).data("bs."+this.type,this),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var orgPlacement=placement,$container=this.options.container?$(this.options.container):this.$element.parent(),containerDim=this.getPosition($container);placement="bottom"==placement&&pos.bottom+actualHeight>containerDim.bottom?"top":"top"==placement&&pos.top-actualHeight<containerDim.top?"bottom":"right"==placement&&pos.right+actualWidth>containerDim.width?"left":"left"==placement&&pos.left-actualWidth<containerDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement);var complete=function(){var prevHoverState=that.hoverState;that.$element.trigger("shown.bs."+that.type),that.hoverState=null,"out"==prevHoverState&&that.leave(that)};$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top=offset.top+marginTop,offset.left=offset.left+marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight);var delta=this.getViewportAdjustedDelta(placement,offset,actualWidth,actualHeight);delta.left?offset.left+=delta.left:offset.top+=delta.top;var isVertical=/top|bottom/.test(placement),arrowDelta=isVertical?2*delta.left-width+actualWidth:2*delta.top-height+actualHeight,arrowOffsetPosition=isVertical?"offsetWidth":"offsetHeight";$tip.offset(offset),this.replaceArrow(arrowDelta,$tip[0][arrowOffsetPosition],isVertical)},Tooltip.prototype.replaceArrow=function(delta,dimension,isHorizontal){this.arrow().css(isHorizontal?"left":"top",50*(1-delta/dimension)+"%").css(isHorizontal?"top":"left","")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(callback){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element.removeAttr("aria-describedby").trigger("hidden.bs."+that.type),callback&&callback()}var that=this,$tip=this.tip(),e=$.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:($tip.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete(),this.hoverState=null,this)},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function($element){$element=$element||this.$element;var el=$element[0],isBody="BODY"==el.tagName,elRect=el.getBoundingClientRect();null==elRect.width&&(elRect=$.extend({},elRect,{width:elRect.right-elRect.left,height:elRect.bottom-elRect.top}));var elOffset=isBody?{top:0,left:0}:$element.offset(),scroll={scroll:isBody?document.documentElement.scrollTop||document.body.scrollTop:$element.scrollTop()},outerDims=isBody?{width:$(window).width(),height:$(window).height()}:null;return $.extend({},elRect,scroll,outerDims,elOffset)},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getViewportAdjustedDelta=function(placement,pos,actualWidth,actualHeight){var delta={top:0,left:0};if(!this.$viewport)return delta;var viewportPadding=this.options.viewport&&this.options.viewport.padding||0,viewportDimensions=this.getPosition(this.$viewport);if(/right|left/.test(placement)){var topEdgeOffset=pos.top-viewportPadding-viewportDimensions.scroll,bottomEdgeOffset=pos.top+viewportPadding-viewportDimensions.scroll+actualHeight;topEdgeOffset<viewportDimensions.top?delta.top=viewportDimensions.top-topEdgeOffset:bottomEdgeOffset>viewportDimensions.top+viewportDimensions.height&&(delta.top=viewportDimensions.top+viewportDimensions.height-bottomEdgeOffset)}else{var leftEdgeOffset=pos.left-viewportPadding,rightEdgeOffset=pos.left+viewportPadding+actualWidth;leftEdgeOffset<viewportDimensions.left?delta.left=viewportDimensions.left-leftEdgeOffset:rightEdgeOffset>viewportDimensions.width&&(delta.left=viewportDimensions.left+viewportDimensions.width-rightEdgeOffset)}return delta},Tooltip.prototype.getTitle=function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},Tooltip.prototype.getUID=function(prefix){do prefix+=~~(1e6*Math.random());while(document.getElementById(prefix));return prefix},Tooltip.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=this;e&&(self=$(e.currentTarget).data("bs."+this.type),self||(self=new this.constructor(e.currentTarget,this.getDelegateOptions()),$(e.currentTarget).data("bs."+this.type,self))),self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){var that=this;clearTimeout(this.timeout),this.hide(function(){that.$element.off("."+that.type).removeData("bs."+that.type)})};var old=$.fn.tooltip;$.fn.tooltip=Plugin,$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.popover"),options="object"==typeof option&&option;(data||"destroy"!=option)&&(data||$this.data("bs.popover",data=new Popover(this,options)),"string"==typeof option&&data[option]())})}var Popover=function(element,options){this.init("popover",element,options)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");Popover.VERSION="3.3.2",Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype),Popover.prototype.constructor=Popover,Popover.prototype.getDefaults=function(){return Popover.DEFAULTS},Popover.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof content?"html":"append":"text"](content),$tip.removeClass("fade top bottom left right in"),$tip.find(".popover-title").html()||$tip.find(".popover-title").hide()},Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()},Popover.prototype.getContent=function(){var $e=this.$element,o=this.options;return $e.attr("data-content")||("function"==typeof o.content?o.content.call($e[0]):o.content)},Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},Popover.prototype.tip=function(){return this.$tip||(this.$tip=$(this.options.template)),this.$tip};var old=$.fn.popover;$.fn.popover=Plugin,$.fn.popover.Constructor=Popover,$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(jQuery),+function($){"use strict";function ScrollSpy(element,options){var process=$.proxy(this.process,this);this.$body=$("body"),this.$scrollElement=$($(element).is("body")?window:element),this.options=$.extend({},ScrollSpy.DEFAULTS,options),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",process),this.refresh(),this.process()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.scrollspy"),options="object"==typeof option&&option;data||$this.data("bs.scrollspy",data=new ScrollSpy(this,options)),"string"==typeof option&&data[option]()})}ScrollSpy.VERSION="3.3.2",ScrollSpy.DEFAULTS={offset:10},ScrollSpy.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},ScrollSpy.prototype.refresh=function(){var offsetMethod="offset",offsetBase=0;$.isWindow(this.$scrollElement[0])||(offsetMethod="position",offsetBase=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var self=this;this.$body.find(this.selector).map(function(){var $el=$(this),href=$el.data("target")||$el.attr("href"),$href=/^#./.test(href)&&$(href);return $href&&$href.length&&$href.is(":visible")&&[[$href[offsetMethod]().top+offsetBase,href]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){self.offsets.push(this[0]),self.targets.push(this[1])})},ScrollSpy.prototype.process=function(){var i,scrollTop=this.$scrollElement.scrollTop()+this.options.offset,scrollHeight=this.getScrollHeight(),maxScroll=this.options.offset+scrollHeight-this.$scrollElement.height(),offsets=this.offsets,targets=this.targets,activeTarget=this.activeTarget;if(this.scrollHeight!=scrollHeight&&this.refresh(),scrollTop>=maxScroll)return activeTarget!=(i=targets[targets.length-1])&&this.activate(i);if(activeTarget&&scrollTop<offsets[0])return this.activeTarget=null,this.clear();for(i=offsets.length;i--;)activeTarget!=targets[i]&&scrollTop>=offsets[i]&&(!offsets[i+1]||scrollTop<=offsets[i+1])&&this.activate(targets[i])},ScrollSpy.prototype.activate=function(target){this.activeTarget=target,this.clear();var selector=this.selector+'[data-target="'+target+'"],'+this.selector+'[href="'+target+'"]',active=$(selector).parents("li").addClass("active");active.parent(".dropdown-menu").length&&(active=active.closest("li.dropdown").addClass("active")),active.trigger("activate.bs.scrollspy")},ScrollSpy.prototype.clear=function(){$(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var old=$.fn.scrollspy;$.fn.scrollspy=Plugin,$.fn.scrollspy.Constructor=ScrollSpy,$.fn.scrollspy.noConflict=function(){return $.fn.scrollspy=old,this},$(window).on("load.bs.scrollspy.data-api",function(){$('[data-spy="scroll"]').each(function(){var $spy=$(this);Plugin.call($spy,$spy.data())})})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tab");data||$this.data("bs.tab",data=new Tab(this)),"string"==typeof option&&data[option]()})}var Tab=function(element){this.element=$(element)};Tab.VERSION="3.3.2",Tab.TRANSITION_DURATION=150,Tab.prototype.show=function(){var $this=this.element,$ul=$this.closest("ul:not(.dropdown-menu)"),selector=$this.data("target");if(selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,"")),!$this.parent("li").hasClass("active")){var $previous=$ul.find(".active:last a"),hideEvent=$.Event("hide.bs.tab",{relatedTarget:$this[0]}),showEvent=$.Event("show.bs.tab",{relatedTarget:$previous[0]});if($previous.trigger(hideEvent),$this.trigger(showEvent),!showEvent.isDefaultPrevented()&&!hideEvent.isDefaultPrevented()){var $target=$(selector);this.activate($this.closest("li"),$ul),this.activate($target,$target.parent(),function(){$previous.trigger({type:"hidden.bs.tab",relatedTarget:$this[0]}),$this.trigger({type:"shown.bs.tab",relatedTarget:$previous[0]})})}}},Tab.prototype.activate=function(element,container,callback){function next(){$active.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),element.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),transition?(element[0].offsetWidth,element.addClass("in")):element.removeClass("fade"),element.parent(".dropdown-menu")&&element.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),callback&&callback()}var $active=container.find("> .active"),transition=callback&&$.support.transition&&($active.length&&$active.hasClass("fade")||!!container.find("> .fade").length);$active.length&&transition?$active.one("bsTransitionEnd",next).emulateTransitionEnd(Tab.TRANSITION_DURATION):next(),$active.removeClass("in")};var old=$.fn.tab;$.fn.tab=Plugin,$.fn.tab.Constructor=Tab,$.fn.tab.noConflict=function(){return $.fn.tab=old,this};var clickHandler=function(e){e.preventDefault(),Plugin.call($(this),"show")};$(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',clickHandler).on("click.bs.tab.data-api",'[data-toggle="pill"]',clickHandler)}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.affix"),options="object"==typeof option&&option;data||$this.data("bs.affix",data=new Affix(this,options)),"string"==typeof option&&data[option]()})}var Affix=function(element,options){this.options=$.extend({},Affix.DEFAULTS,options),this.$target=$(this.options.target).on("scroll.bs.affix.data-api",$.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",$.proxy(this.checkPositionWithEventLoop,this)),this.$element=$(element),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};Affix.VERSION="3.3.2",Affix.RESET="affix affix-top affix-bottom",Affix.DEFAULTS={offset:0,target:window},Affix.prototype.getState=function(scrollHeight,height,offsetTop,offsetBottom){var scrollTop=this.$target.scrollTop(),position=this.$element.offset(),targetHeight=this.$target.height();if(null!=offsetTop&&"top"==this.affixed)return offsetTop>scrollTop?"top":!1;if("bottom"==this.affixed)return null!=offsetTop?scrollTop+this.unpin<=position.top?!1:"bottom":scrollHeight-offsetBottom>=scrollTop+targetHeight?!1:"bottom";var initializing=null==this.affixed,colliderTop=initializing?scrollTop:position.top,colliderHeight=initializing?targetHeight:height;return null!=offsetTop&&offsetTop>=scrollTop?"top":null!=offsetBottom&&colliderTop+colliderHeight>=scrollHeight-offsetBottom?"bottom":!1},Affix.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(Affix.RESET).addClass("affix");var scrollTop=this.$target.scrollTop(),position=this.$element.offset();return this.pinnedOffset=position.top-scrollTop},Affix.prototype.checkPositionWithEventLoop=function(){setTimeout($.proxy(this.checkPosition,this),1)},Affix.prototype.checkPosition=function(){if(this.$element.is(":visible")){var height=this.$element.height(),offset=this.options.offset,offsetTop=offset.top,offsetBottom=offset.bottom,scrollHeight=$("body").height();"object"!=typeof offset&&(offsetBottom=offsetTop=offset),"function"==typeof offsetTop&&(offsetTop=offset.top(this.$element)),"function"==typeof offsetBottom&&(offsetBottom=offset.bottom(this.$element));var affix=this.getState(scrollHeight,height,offsetTop,offsetBottom);if(this.affixed!=affix){null!=this.unpin&&this.$element.css("top","");var affixType="affix"+(affix?"-"+affix:""),e=$.Event(affixType+".bs.affix");if(this.$element.trigger(e),e.isDefaultPrevented())return;this.affixed=affix,this.unpin="bottom"==affix?this.getPinnedOffset():null,this.$element.removeClass(Affix.RESET).addClass(affixType).trigger(affixType.replace("affix","affixed")+".bs.affix")}"bottom"==affix&&this.$element.offset({top:scrollHeight-height-offsetBottom})}};var old=$.fn.affix;$.fn.affix=Plugin,$.fn.affix.Constructor=Affix,$.fn.affix.noConflict=function(){return $.fn.affix=old,this},$(window).on("load",function(){$('[data-spy="affix"]').each(function(){var $spy=$(this),data=$spy.data();data.offset=data.offset||{},null!=data.offsetBottom&&(data.offset.bottom=data.offsetBottom),null!=data.offsetTop&&(data.offset.top=data.offsetTop),Plugin.call($spy,data)})})}(jQuery),function(window,angular){"use strict";function $KeepaliveProvider(){var options={http:null,interval:600};this.http=function(value){if(!value)throw new Error("Argument must be a string containing a URL, or an object containing the HTTP request configuration.");angular.isString(value)&&(value={url:value,method:"GET"}),value.cache=!1,options.http=value},this.interval=function(seconds){if(seconds=parseInt(seconds),isNaN(seconds)||0>=seconds)throw new Error("Interval must be expressed in seconds and be greater than 0.");options.interval=seconds},this.$get=function($rootScope,$log,$interval,$http){function handleResponse(data,status){$rootScope.$broadcast("$keepaliveResponse",data,status)}function ping(){$rootScope.$broadcast("$keepalive"),angular.isObject(options.http)&&$http(options.http).success(handleResponse).error(handleResponse)}var state={ping:null};return{_options:function(){return options},start:function(){$interval.cancel(state.ping),state.ping=$interval(ping,1e3*options.interval)},stop:function(){$interval.cancel(state.ping)},ping:function(){ping()}}},this.$get.$inject=["$rootScope","$log","$interval","$http"]}function $IdleProvider(){var options={idleDuration:1200,warningDuration:30,autoResume:!0,events:"mousemove keydown DOMMouseScroll mousewheel mousedown touchstart",keepalive:!0};this.activeOn=function(events){options.events=events},this.idleDuration=function(seconds){if(0>=seconds)throw new Error("idleDuration must be a value in seconds, greater than 0.");options.idleDuration=seconds},this.warningDuration=function(seconds){if(0>seconds)throw new Error("warning must be a value in seconds, greater than 0.");options.warningDuration=seconds},this.autoResume=function(value){options.autoResume=value===!0},this.keepalive=function(enabled){options.keepalive=enabled===!0},this.$get=function($interval,$log,$rootScope,$document,$keepalive){function startKeepalive(){options.keepalive&&(state.running&&$keepalive.ping(),$keepalive.start())}function stopKeepalive(){options.keepalive&&$keepalive.stop()}function toggleState(){state.idling=!state.idling;var name=state.idling?"Start":"End";$rootScope.$broadcast("$idle"+name),state.idling?(stopKeepalive(),state.countdown=options.warningDuration,countdown(),state.warning=$interval(countdown,1e3,options.warningDuration)):startKeepalive(),$interval.cancel(state.idle)}function countdown(){state.countdown<=0?$rootScope.$broadcast("$idleTimeout"):$rootScope.$broadcast("$idleWarn",state.countdown),state.countdown--}var state={idle:null,warning:null,idling:!1,running:!1,countdown:null},svc={_options:function(){return options},running:function(){return state.running},idling:function(){return state.idling},watch:function(){$interval.cancel(state.idle),$interval.cancel(state.warning),state.idling?toggleState():state.running||startKeepalive(),state.running=!0,state.idle=$interval(toggleState,1e3*options.idleDuration)},unwatch:function(){$interval.cancel(state.idle),$interval.cancel(state.warning),state.idling=!1,state.running=!1}},interrupt=function(){state.running&&options.autoResume&&svc.watch()};return $document.find("body").on(options.events,interrupt),svc},this.$get.$inject=["$interval","$log","$rootScope","$document","$keepalive"]}angular.module("ngIdle.keepalive",[]).provider("$keepalive",$KeepaliveProvider),angular.module("ngIdle.idle",[]).provider("$idle",$IdleProvider),angular.module("ngIdle.ngIdleCountdown",[]).directive("ngIdleCountdown",function(){return{restrict:"A",scope:{value:"=ngIdleCountdown"},link:function($scope){$scope.$on("$idleWarn",function(e,countdown){$scope.value=countdown}),$scope.$on("$idleTimeout",function(){$scope.value=0})}}}),angular.module("ngIdle",["ngIdle.keepalive","ngIdle.idle","ngIdle.ngIdleCountdown"])}(window,window.angular),function(){var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.7.0";var createCallback=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};_.iteratee=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?createCallback(value,context,argCount):_.isObject(value)?_.matches(value):_.property(value)},_.each=_.forEach=function(obj,iteratee,context){if(null==obj)return obj;iteratee=createCallback(iteratee,context);var i,length=obj.length;if(length===+length)for(i=0;length>i;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;length>i;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){if(null==obj)return[];iteratee=_.iteratee(iteratee,context);for(var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;length>index;index++)currentKey=keys?keys[index]:index,results[index]=iteratee(obj[currentKey],currentKey,obj);return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index=0;if(arguments.length<3){if(!length)throw new TypeError(reduceError);memo=obj[keys?keys[index++]:index++]}for(;length>index;index++)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.reduceRight=_.foldr=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),index=(keys||obj).length;if(arguments.length<3){if(!index)throw new TypeError(reduceError);memo=obj[keys?keys[--index]:--index]}for(;index--;)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.find=_.detect=function(obj,predicate,context){var result;return predicate=_.iteratee(predicate,context),_.some(obj,function(value,index,list){return predicate(value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:(predicate=_.iteratee(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(_.iteratee(predicate)),context)},_.every=_.all=function(obj,predicate,context){if(null==obj)return!0;predicate=_.iteratee(predicate,context);var index,currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length;for(index=0;length>index;index++)if(currentKey=keys?keys[index]:index,!predicate(obj[currentKey],currentKey,obj))return!1;return!0},_.some=_.any=function(obj,predicate,context){if(null==obj)return!1;predicate=_.iteratee(predicate,context);var index,currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length;for(index=0;length>index;index++)if(currentKey=keys?keys[index]:index,predicate(obj[currentKey],currentKey,obj))return!0;return!1},_.contains=_.include=function(obj,target){return null==obj?!1:(obj.length!==+obj.length&&(obj=_.values(obj)),_.indexOf(obj,target)>=0)},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-1/0,lastComputed=-1/0;if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],value>result&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed>lastComputed||computed===-1/0&&result===-1/0)&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;
if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],result>value&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(lastComputed>computed||1/0===computed&&1/0===result)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var rand,set=obj&&obj.length===+obj.length?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0;length>index;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj.length!==+obj.length&&(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=_.iteratee(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iteratee,context){iteratee=_.iteratee(iteratee,context,1);for(var value=iteratee(obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=_.iteratee(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:0>n?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,output){if(shallow&&_.every(input,_.isArray))return concat.apply(output,input);for(var i=0,length=input.length;length>i;i++){var value=input[i];_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,strict,output):strict||output.push(value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){if(null==array)return[];_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=_.iteratee(iteratee,context));for(var result=[],seen=[],i=0,length=array.length;length>i;i++){var value=array[i];if(isSorted)i&&seen===value||result.push(value),seen=value;else if(iteratee){var computed=iteratee(value,i,array);_.indexOf(seen,computed)<0&&(seen.push(computed),result.push(value))}else _.indexOf(result,value)<0&&result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0,[]))},_.intersection=function(array){if(null==array)return[];for(var result=[],argsLength=arguments.length,i=0,length=array.length;length>i;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;argsLength>j&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(slice.call(arguments,1),!0,!0,[]);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(array){if(null==array)return[];for(var length=_.max(arguments,"length").length,results=Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}for(;length>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var idx=array.length;for("number"==typeof from&&(idx=0>from?idx+from+1:Math.min(idx,from+1));--idx>=0;)if(array[idx]===item)return idx;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;length>idx;idx++,start+=step)range[idx]=start;return range};var Ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));Ctor.prototype=func.prototype;var self=new Ctor;Ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return _.isObject(result)?result:self}},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;length>i;i++)args[i]===_&&(args[i]=arguments[position++]);for(;position<arguments.length;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var i,key,length=arguments.length;if(1>=length)throw new Error("bindAll must be passed function names");for(i=1;length>i;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=hasher?hasher.apply(this,arguments):key;return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining||remaining>wait?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last&&last>0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.before=function(times,func){var memo;return function(){return--times>0?memo=func.apply(this,arguments):func=null,memo}},_.once=_.partial(_.before,2),_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){if(!_.isObject(obj))return obj;for(var source,prop,i=1,length=arguments.length;length>i;i++){source=arguments[i];for(prop in source)hasOwnProperty.call(source,prop)&&(obj[prop]=source[prop])}return obj},_.pick=function(obj,iteratee,context){var key,result={};if(null==obj)return result;if(_.isFunction(iteratee)){iteratee=createCallback(iteratee,context);for(key in obj){var value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}}else{var keys=concat.apply([],slice.call(arguments,1));obj=new Object(obj);for(var i=0,length=keys.length;length>i;i++)key=keys[i],key in obj&&(result[key]=obj[key])}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(concat.apply([],slice.call(arguments,1)),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=function(obj){if(!_.isObject(obj))return obj;for(var i=1,length=arguments.length;length>i;i++){var source=arguments[i];for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}return obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&"constructor"in a&&"constructor"in b&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor))return!1;aStack.push(a),bStack.push(b);var size,result;if("[object Array]"===className){if(size=a.length,result=size===b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{var key,keys=_.keys(a);if(size=keys.length,result=_.keys(b).length===size)for(;size--&&(key=keys[size],result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)););}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){var pairs=_.pairs(attrs),length=pairs.length;return function(obj){if(null==obj)return!length;obj=new Object(obj);for(var i=0;length>i;i++){var pair=pairs[i],key=pair[0];if(pair[1]!==obj[key]||!(key in obj))return!1}return!0}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=createCallback(iteratee,context,1);for(var i=0;n>i;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?object[property]():value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result.call(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),function(factory){"function"==typeof define&&define.amd?define(["jquery","moment"],factory):factory(jQuery,moment)}(function($,moment){function setDefaults(d){mergeOptions(defaults,d)}function mergeOptions(target){function mergeIntoTarget(name,value){$.isPlainObject(value)&&$.isPlainObject(target[name])&&!isForcedAtomicOption(name)?target[name]=mergeOptions({},target[name],value):void 0!==value&&(target[name]=value)}for(var i=1;i<arguments.length;i++)$.each(arguments[i],mergeIntoTarget);return target}function isForcedAtomicOption(name){return/(Time|Duration)$/.test(name)}function getMomentLocaleData(langCode){var func=moment.localeData||moment.langData;return func.call(moment,langCode)||func.call(moment,"en")}function compensateScroll(rowEls,scrollbarWidths){scrollbarWidths.left&&rowEls.css({"border-left-width":1,"margin-left":scrollbarWidths.left-1}),scrollbarWidths.right&&rowEls.css({"border-right-width":1,"margin-right":scrollbarWidths.right-1})}function uncompensateScroll(rowEls){rowEls.css({"margin-left":"","margin-right":"","border-left-width":"","border-right-width":""})}function disableCursor(){$("body").addClass("fc-not-allowed")}function enableCursor(){$("body").removeClass("fc-not-allowed")}function distributeHeight(els,availableHeight,shouldRedistribute){var minOffset1=Math.floor(availableHeight/els.length),minOffset2=Math.floor(availableHeight-minOffset1*(els.length-1)),flexEls=[],flexOffsets=[],flexHeights=[],usedHeight=0;undistributeHeight(els),els.each(function(i,el){var minOffset=i===els.length-1?minOffset2:minOffset1,naturalOffset=$(el).outerHeight(!0);minOffset>naturalOffset?(flexEls.push(el),flexOffsets.push(naturalOffset),flexHeights.push($(el).height())):usedHeight+=naturalOffset}),shouldRedistribute&&(availableHeight-=usedHeight,minOffset1=Math.floor(availableHeight/flexEls.length),minOffset2=Math.floor(availableHeight-minOffset1*(flexEls.length-1))),$(flexEls).each(function(i,el){var minOffset=i===flexEls.length-1?minOffset2:minOffset1,naturalOffset=flexOffsets[i],naturalHeight=flexHeights[i],newHeight=minOffset-(naturalOffset-naturalHeight);minOffset>naturalOffset&&$(el).height(newHeight)})}function undistributeHeight(els){els.height("")}function matchCellWidths(els){var maxInnerWidth=0;return els.find("> *").each(function(i,innerEl){var innerWidth=$(innerEl).outerWidth();innerWidth>maxInnerWidth&&(maxInnerWidth=innerWidth)}),maxInnerWidth++,els.width(maxInnerWidth),maxInnerWidth}function setPotentialScroller(containerEl,height){return containerEl.height(height).addClass("fc-scroller"),containerEl[0].scrollHeight-1>containerEl[0].clientHeight?!0:(unsetScroller(containerEl),!1)}function unsetScroller(containerEl){containerEl.height("").removeClass("fc-scroller")}function getScrollParent(el){var position=el.css("position"),scrollParent=el.parents().filter(function(){var parent=$(this);return/(auto|scroll)/.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return"fixed"!==position&&scrollParent.length?scrollParent:$(el[0].ownerDocument||document)}function getScrollbarWidths(container){var containerLeft=container.offset().left,containerRight=containerLeft+container.width(),inner=container.children(),innerLeft=inner.offset().left,innerRight=innerLeft+inner.outerWidth();return{left:innerLeft-containerLeft,right:containerRight-innerRight}}function isPrimaryMouseButton(ev){return 1==ev.which&&!ev.ctrlKey}function intersectionToSeg(subjectRange,constraintRange){var segStart,segEnd,isStart,isEnd,subjectStart=subjectRange.start,subjectEnd=subjectRange.end,constraintStart=constraintRange.start,constraintEnd=constraintRange.end;return subjectEnd>constraintStart&&constraintEnd>subjectStart?(subjectStart>=constraintStart?(segStart=subjectStart.clone(),isStart=!0):(segStart=constraintStart.clone(),isStart=!1),constraintEnd>=subjectEnd?(segEnd=subjectEnd.clone(),isEnd=!0):(segEnd=constraintEnd.clone(),isEnd=!1),{start:segStart,end:segEnd,isStart:isStart,isEnd:isEnd}):void 0}function smartProperty(obj,name){if(obj=obj||{},void 0!==obj[name])return obj[name];for(var res,parts=name.split(/(?=[A-Z])/),i=parts.length-1;i>=0;i--)if(res=obj[parts[i].toLowerCase()],void 0!==res)return res;return obj["default"]}function diffDayTime(a,b){return moment.duration({days:a.clone().stripTime().diff(b.clone().stripTime(),"days"),ms:a.time()-b.time()})}function diffDay(a,b){return moment.duration({days:a.clone().stripTime().diff(b.clone().stripTime(),"days")})}function computeIntervalUnit(start,end){var i,unit;for(i=0;i<intervalUnits.length&&(unit=intervalUnits[i],!computeIntervalAs(unit,start,end));i++);return unit}function computeIntervalAs(unit,start,end){var val;return val=null!=end?end.diff(start,unit,!0):moment.isDuration(start)?start.as(unit):start.end.diff(start.start,unit,!0),val>=1&&isInt(val)?val:!1}function isNativeDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function isTimeString(str){return/^\d+\:\d+(?:\:\d+\.?(?:\d{3})?)?$/.test(str)}function createObject(proto){var f=function(){};return f.prototype=proto,new f}function copyOwnProps(src,dest){for(var name in src)hasOwnProp(src,name)&&(dest[name]=src[name])}function hasOwnProp(obj,name){return hasOwnPropMethod.call(obj,name)}function isAtomic(val){return/undefined|null|boolean|number|string/.test($.type(val))}function applyAll(functions,thisObj,args){if($.isFunction(functions)&&(functions=[functions]),functions){var i,ret;for(i=0;i<functions.length;i++)ret=functions[i].apply(thisObj,args)||ret;return ret}}function firstDefined(){for(var i=0;i<arguments.length;i++)if(void 0!==arguments[i])return arguments[i]}function htmlEscape(s){return(s+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function stripHtmlEntities(text){return text.replace(/&.*?;/g,"")}function capitaliseFirstLetter(str){return str.charAt(0).toUpperCase()+str.slice(1)}function compareNumbers(a,b){return a-b}function isInt(n){return n%1===0}function debounce(func,wait){var timeoutId,args,context,timestamp,later=function(){var last=+new Date-timestamp;wait>last&&last>0?timeoutId=setTimeout(later,wait-last):(timeoutId=null,func.apply(context,args),timeoutId||(context=args=null))};return function(){context=this,args=arguments,timestamp=+new Date,timeoutId||(timeoutId=setTimeout(later,wait))}}function makeMoment(args,parseAsUTC,parseZone){var isAmbigTime,isAmbigZone,ambigMatch,mom,input=args[0],isSingleString=1==args.length&&"string"==typeof input;return moment.isMoment(input)?(mom=moment.apply(null,args),transferAmbigs(input,mom)):isNativeDate(input)||void 0===input?mom=moment.apply(null,args):(isAmbigTime=!1,isAmbigZone=!1,isSingleString?ambigDateOfMonthRegex.test(input)?(input+="-01",args=[input],isAmbigTime=!0,isAmbigZone=!0):(ambigMatch=ambigTimeOrZoneRegex.exec(input))&&(isAmbigTime=!ambigMatch[5],isAmbigZone=!0):$.isArray(input)&&(isAmbigZone=!0),mom=parseAsUTC||isAmbigTime?moment.utc.apply(moment,args):moment.apply(null,args),isAmbigTime?(mom._ambigTime=!0,mom._ambigZone=!0):parseZone&&(isAmbigZone?mom._ambigZone=!0:isSingleString&&mom.zone(input))),mom._fullCalendar=!0,mom}function commonlyAmbiguate(inputs,preserveTime){var i,mom,anyAmbigTime=!1,anyAmbigZone=!1,len=inputs.length,moms=[];for(i=0;len>i;i++)mom=inputs[i],moment.isMoment(mom)||(mom=fc.moment.parseZone(mom)),anyAmbigTime=anyAmbigTime||mom._ambigTime,anyAmbigZone=anyAmbigZone||mom._ambigZone,moms.push(mom);for(i=0;len>i;i++)mom=moms[i],preserveTime||!anyAmbigTime||mom._ambigTime?anyAmbigZone&&!mom._ambigZone&&(moms[i]=mom.clone().stripZone()):moms[i]=mom.clone().stripTime();return moms}function transferAmbigs(src,dest){src._ambigTime?dest._ambigTime=!0:dest._ambigTime&&(dest._ambigTime=!1),src._ambigZone?dest._ambigZone=!0:dest._ambigZone&&(dest._ambigZone=!1)}function setMomentValues(mom,a){mom.year(a[0]||0).month(a[1]||0).date(a[2]||0).hours(a[3]||0).minutes(a[4]||0).seconds(a[5]||0).milliseconds(a[6]||0)}function oldMomentFormat(mom,formatStr){return oldMomentProto.format.call(mom,formatStr)}function formatDate(date,formatStr){return formatDateWithChunks(date,getFormatStringChunks(formatStr))}function formatDateWithChunks(date,chunks){var i,s="";for(i=0;i<chunks.length;i++)s+=formatDateWithChunk(date,chunks[i]);return s}function formatDateWithChunk(date,chunk){var token,maybeStr;return"string"==typeof chunk?chunk:(token=chunk.token)?tokenOverrides[token]?tokenOverrides[token](date):oldMomentFormat(date,token):chunk.maybe&&(maybeStr=formatDateWithChunks(date,chunk.maybe),maybeStr.match(/[1-9]/))?maybeStr:""}function formatRange(date1,date2,formatStr,separator,isRTL){var localeData;return date1=fc.moment.parseZone(date1),date2=fc.moment.parseZone(date2),localeData=(date1.localeData||date1.lang).call(date1),formatStr=localeData.longDateFormat(formatStr)||formatStr,separator=separator||" - ",formatRangeWithChunks(date1,date2,getFormatStringChunks(formatStr),separator,isRTL)}function formatRangeWithChunks(date1,date2,chunks,separator,isRTL){var chunkStr,leftI,rightI,middleI,leftStr="",rightStr="",middleStr1="",middleStr2="",middleStr="";for(leftI=0;leftI<chunks.length&&(chunkStr=formatSimilarChunk(date1,date2,chunks[leftI]),chunkStr!==!1);leftI++)leftStr+=chunkStr;for(rightI=chunks.length-1;rightI>leftI&&(chunkStr=formatSimilarChunk(date1,date2,chunks[rightI]),chunkStr!==!1);rightI--)rightStr=chunkStr+rightStr;for(middleI=leftI;rightI>=middleI;middleI++)middleStr1+=formatDateWithChunk(date1,chunks[middleI]),middleStr2+=formatDateWithChunk(date2,chunks[middleI]);return(middleStr1||middleStr2)&&(middleStr=isRTL?middleStr2+separator+middleStr1:middleStr1+separator+middleStr2),leftStr+middleStr+rightStr}function formatSimilarChunk(date1,date2,chunk){var token,unit;return"string"==typeof chunk?chunk:(token=chunk.token)&&(unit=similarUnitMap[token.charAt(0)],unit&&date1.isSame(date2,unit))?oldMomentFormat(date1,token):!1}function getFormatStringChunks(formatStr){return formatStr in formatStringChunkCache?formatStringChunkCache[formatStr]:formatStringChunkCache[formatStr]=chunkFormatString(formatStr)}function chunkFormatString(formatStr){for(var match,chunks=[],chunker=/\[([^\]]*)\]|\(([^\)]*)\)|(LT|(\w)\4*o?)|([^\w\[\(]+)/g;match=chunker.exec(formatStr);)match[1]?chunks.push(match[1]):match[2]?chunks.push({maybe:chunkFormatString(match[2])}):match[3]?chunks.push({token:match[3]}):match[5]&&chunks.push(match[5]);return chunks}function Class(){}function isCellsEqual(cell1,cell2){return cell1||cell2?cell1&&cell2?cell1.grid===cell2.grid&&cell1.row===cell2.row&&cell1.col===cell2.col:!1:!0}function isBgEvent(event){var rendering=getEventRendering(event);return"background"===rendering||"inverse-background"===rendering}function isInverseBgEvent(event){return"inverse-background"===getEventRendering(event)}function getEventRendering(event){return firstDefined((event.source||{}).rendering,event.rendering)}function groupEventsById(events){var i,event,eventsById={};for(i=0;i<events.length;i++)event=events[i],(eventsById[event._id]||(eventsById[event._id]=[])).push(event);return eventsById}function compareNormalRanges(range1,range2){return range1.eventStartMS-range2.eventStartMS}function compareSegs(seg1,seg2){return seg1.eventStartMS-seg2.eventStartMS||seg2.eventDurationMS-seg1.eventDurationMS||seg2.event.allDay-seg1.event.allDay||(seg1.event.title||"").localeCompare(seg2.event.title)}function getDraggedElMeta(el){var eventProps,startTime,duration,stick,prefix=fc.dataAttrPrefix;return prefix&&(prefix+="-"),eventProps=el.data(prefix+"event")||null,eventProps&&(eventProps="object"==typeof eventProps?$.extend({},eventProps):{},startTime=eventProps.start,null==startTime&&(startTime=eventProps.time),duration=eventProps.duration,stick=eventProps.stick,delete eventProps.start,delete eventProps.time,delete eventProps.duration,delete eventProps.stick),null==startTime&&(startTime=el.data(prefix+"start")),null==startTime&&(startTime=el.data(prefix+"time")),null==duration&&(duration=el.data(prefix+"duration")),null==stick&&(stick=el.data(prefix+"stick")),startTime=null!=startTime?moment.duration(startTime):null,duration=null!=duration?moment.duration(duration):null,stick=Boolean(stick),{eventProps:eventProps,startTime:startTime,duration:duration,stick:stick}}function isDaySegCollision(seg,otherSegs){var i,otherSeg;for(i=0;i<otherSegs.length;i++)if(otherSeg=otherSegs[i],otherSeg.leftCol<=seg.rightCol&&otherSeg.rightCol>=seg.leftCol)return!0;return!1}function compareDaySegCols(a,b){return a.leftCol-b.leftCol}function placeSlotSegs(segs){var levels,level0,i;if(segs.sort(compareSegs),levels=buildSlotSegLevels(segs),computeForwardSlotSegs(levels),level0=levels[0]){for(i=0;i<level0.length;i++)computeSlotSegPressures(level0[i]);for(i=0;i<level0.length;i++)computeSlotSegCoords(level0[i],0,0)}}function buildSlotSegLevels(segs){var i,seg,j,levels=[];for(i=0;i<segs.length;i++){for(seg=segs[i],j=0;j<levels.length&&computeSlotSegCollisions(seg,levels[j]).length;j++);seg.level=j,(levels[j]||(levels[j]=[])).push(seg)}return levels}function computeForwardSlotSegs(levels){var i,level,j,seg,k;for(i=0;i<levels.length;i++)for(level=levels[i],j=0;j<level.length;j++)for(seg=level[j],seg.forwardSegs=[],k=i+1;k<levels.length;k++)computeSlotSegCollisions(seg,levels[k],seg.forwardSegs)}function computeSlotSegPressures(seg){var i,forwardSeg,forwardSegs=seg.forwardSegs,forwardPressure=0;if(void 0===seg.forwardPressure){for(i=0;i<forwardSegs.length;i++)forwardSeg=forwardSegs[i],computeSlotSegPressures(forwardSeg),forwardPressure=Math.max(forwardPressure,1+forwardSeg.forwardPressure);seg.forwardPressure=forwardPressure}}function computeSlotSegCoords(seg,seriesBackwardPressure,seriesBackwardCoord){var i,forwardSegs=seg.forwardSegs;if(void 0===seg.forwardCoord)for(forwardSegs.length?(forwardSegs.sort(compareForwardSlotSegs),computeSlotSegCoords(forwardSegs[0],seriesBackwardPressure+1,seriesBackwardCoord),seg.forwardCoord=forwardSegs[0].backwardCoord):seg.forwardCoord=1,seg.backwardCoord=seg.forwardCoord-(seg.forwardCoord-seriesBackwardCoord)/(seriesBackwardPressure+1),i=0;i<forwardSegs.length;i++)computeSlotSegCoords(forwardSegs[i],0,seg.forwardCoord)}function computeSlotSegCollisions(seg,otherSegs,results){results=results||[];for(var i=0;i<otherSegs.length;i++)isSlotSegCollision(seg,otherSegs[i])&&results.push(otherSegs[i]);return results}function isSlotSegCollision(seg1,seg2){return seg1.bottom>seg2.top&&seg1.top<seg2.bottom}function compareForwardSlotSegs(seg1,seg2){return seg2.forwardPressure-seg1.forwardPressure||(seg1.backwardCoord||0)-(seg2.backwardCoord||0)||compareSegs(seg1,seg2)}function Calendar(element,instanceOptions){function humanizeDuration(duration){return(duration.locale||duration.lang).call(duration,options.lang).humanize()}function render(inc){content?elementVisible()&&(calcSize(),renderView(inc)):initialRender()}function initialRender(){tm=options.theme?"ui":"fc",element.addClass("fc"),element.addClass(options.isRTL?"fc-rtl":"fc-ltr"),element.addClass(options.theme?"ui-widget":"fc-unthemed"),content=$("<div class='fc-view-container'/>").prependTo(element),header=new Header(t,options),headerElement=header.render(),headerElement&&element.prepend(headerElement),renderView(options.defaultView),options.handleWindowResize&&(windowResizeProxy=debounce(windowResize,options.windowResizeDelay),$(window).resize(windowResizeProxy))
}function destroy(){currentView&&currentView.destroyView(),header.destroy(),content.remove(),element.removeClass("fc fc-ltr fc-rtl fc-unthemed ui-widget"),$(window).unbind("resize",windowResizeProxy)}function elementVisible(){return element.is(":visible")}function renderView(viewType){ignoreWindowResize++,currentView&&viewType&&currentView.type!==viewType&&(header.deactivateButton(currentView.type),freezeContentHeight(),currentView.start&&currentView.destroyView(),currentView.el.remove(),currentView=null),!currentView&&viewType&&(currentView=instantiateView(viewType),currentView.el=$("<div class='fc-view fc-"+viewType+"-view' />").appendTo(content),header.activateButton(viewType)),currentView&&(date=currentView.massageCurrentDate(date),currentView.start&&date.isWithin(currentView.intervalStart,currentView.intervalEnd)||elementVisible()&&(freezeContentHeight(),currentView.start&&currentView.destroyView(),currentView.setDate(date),currentView.renderView(),unfreezeContentHeight(),updateTitle(),updateTodayButton(),getAndRenderEvents())),unfreezeContentHeight(),ignoreWindowResize--}function instantiateView(viewType){var spec=getViewSpec(viewType);return new spec["class"](t,spec.options,viewType)}function getViewSpec(requestedViewType){function processSpecInput(input){"function"==typeof input?viewClass=input:"object"==typeof input&&$.extend(viewOptions,input)}var viewOptions,viewClass,duration,unit,buttonText,allDefaultButtonText=options.defaultButtonText||{},allButtonText=options.buttonText||{},hash=options.views||{},viewType=requestedViewType,viewOptionsChain=[],unitIsSingle=!1;if(viewSpecCache[requestedViewType])return viewSpecCache[requestedViewType];for(;viewType&&!viewClass;)viewOptions={},processSpecInput(fcViews[viewType]),processSpecInput(hash[viewType]),viewOptionsChain.unshift(viewOptions),viewType=viewOptions.type;return viewOptionsChain.unshift({}),viewOptions=$.extend.apply($,viewOptionsChain),viewClass?(duration=viewOptions.duration||viewClass.duration,duration&&(duration=moment.duration(duration),unit=computeIntervalUnit(duration),unitIsSingle=1===computeIntervalAs(unit,duration)),unitIsSingle&&hash[unit]&&(viewOptions=$.extend({},hash[unit],viewOptions)),buttonText=allButtonText[requestedViewType]||(unitIsSingle?allButtonText[unit]:null)||allDefaultButtonText[requestedViewType]||(unitIsSingle?allDefaultButtonText[unit]:null)||viewOptions.buttonText||viewClass.buttonText||(duration?humanizeDuration(duration):null)||requestedViewType,viewSpecCache[requestedViewType]={"class":viewClass,options:viewOptions,buttonText:buttonText}):void 0}function isValidViewType(viewType){return Boolean(getViewSpec(viewType))}function getViewButtonText(viewType){var spec=getViewSpec(viewType);return spec?spec.buttonText:void 0}function updateSize(shouldRecalc){return elementVisible()?(shouldRecalc&&_calcSize(),ignoreWindowResize++,currentView.updateSize(!0),ignoreWindowResize--,!0):void 0}function calcSize(){elementVisible()&&_calcSize()}function _calcSize(){suggestedViewHeight="number"==typeof options.contentHeight?options.contentHeight:"number"==typeof options.height?options.height-(headerElement?headerElement.outerHeight(!0):0):Math.round(content.width()/Math.max(options.aspectRatio,.5))}function windowResize(ev){!ignoreWindowResize&&ev.target===window&&currentView.start&&updateSize(!0)&&currentView.trigger("windowResize",_element)}function refetchEvents(){destroyEvents(),fetchAndRenderEvents()}function renderEvents(){elementVisible()&&(freezeContentHeight(),currentView.destroyViewEvents(),currentView.renderViewEvents(events),unfreezeContentHeight())}function destroyEvents(){freezeContentHeight(),currentView.destroyViewEvents(),unfreezeContentHeight()}function getAndRenderEvents(){!options.lazyFetching||isFetchNeeded(currentView.start,currentView.end)?fetchAndRenderEvents():renderEvents()}function fetchAndRenderEvents(){fetchEvents(currentView.start,currentView.end)}function reportEvents(_events){events=_events,renderEvents()}function reportEventChange(){renderEvents()}function updateTitle(){currentView.updateTitle(),header.updateTitle(currentView.title)}function updateTodayButton(){var now=t.getNow();now.isWithin(currentView.intervalStart,currentView.intervalEnd)?header.disableButton("today"):header.enableButton("today")}function select(start,end){start=t.moment(start),end=end?t.moment(end):start.clone().add(start.hasTime()?t.defaultTimedEventDuration:t.defaultAllDayEventDuration),currentView.select({start:start,end:end})}function unselect(){currentView&&currentView.unselect()}function prev(){date=currentView.computePrevDate(date),renderView()}function next(){date=currentView.computeNextDate(date),renderView()}function prevYear(){date.add(-1,"years"),renderView()}function nextYear(){date.add(1,"years"),renderView()}function today(){date=t.getNow(),renderView()}function gotoDate(dateInput){date=t.moment(dateInput),renderView()}function incrementDate(delta){date.add(moment.duration(delta)),renderView()}function zoomTo(newDate,viewType){var viewStr,match;viewType&&isValidViewType(viewType)||(viewType=viewType||"day",viewStr=header.getViewsWithButtons().join(" "),match=viewStr.match(new RegExp("\\w+"+capitaliseFirstLetter(viewType))),match||(match=viewStr.match(/\w+Day/)),viewType=match?match[0]:"agendaDay"),date=newDate,renderView(viewType)}function getDate(){return date.clone()}function freezeContentHeight(){content.css({width:"100%",height:content.height(),overflow:"hidden"})}function unfreezeContentHeight(){content.css({width:"",height:"",overflow:""})}function getCalendar(){return t}function getView(){return currentView}function option(name,value){return void 0===value?options[name]:void(("height"==name||"contentHeight"==name||"aspectRatio"==name)&&(options[name]=value,updateSize(!0)))}function trigger(name,thisObj){return options[name]?options[name].apply(thisObj||_element,Array.prototype.slice.call(arguments,2)):void 0}var t=this;instanceOptions=instanceOptions||{};var langOptions,options=mergeOptions({},defaults,instanceOptions);langOptions=options.lang in langOptionHash?langOptionHash[options.lang]:langOptionHash[defaults.lang],langOptions&&(options=mergeOptions({},defaults,langOptions,instanceOptions)),options.isRTL&&(options=mergeOptions({},defaults,rtlDefaults,langOptions||{},instanceOptions)),t.options=options,t.render=render,t.destroy=destroy,t.refetchEvents=refetchEvents,t.reportEvents=reportEvents,t.reportEventChange=reportEventChange,t.rerenderEvents=renderEvents,t.changeView=renderView,t.select=select,t.unselect=unselect,t.prev=prev,t.next=next,t.prevYear=prevYear,t.nextYear=nextYear,t.today=today,t.gotoDate=gotoDate,t.incrementDate=incrementDate,t.zoomTo=zoomTo,t.getDate=getDate,t.getCalendar=getCalendar,t.getView=getView,t.option=option,t.trigger=trigger,t.isValidViewType=isValidViewType,t.getViewButtonText=getViewButtonText;var localeData=createObject(getMomentLocaleData(options.lang));if(options.monthNames&&(localeData._months=options.monthNames),options.monthNamesShort&&(localeData._monthsShort=options.monthNamesShort),options.dayNames&&(localeData._weekdays=options.dayNames),options.dayNamesShort&&(localeData._weekdaysShort=options.dayNamesShort),null!=options.firstDay){var _week=createObject(localeData._week);_week.dow=options.firstDay,localeData._week=_week}t.defaultAllDayEventDuration=moment.duration(options.defaultAllDayEventDuration),t.defaultTimedEventDuration=moment.duration(options.defaultTimedEventDuration),t.moment=function(){var mom;return"local"===options.timezone?(mom=fc.moment.apply(null,arguments),mom.hasTime()&&mom.local()):mom="UTC"===options.timezone?fc.moment.utc.apply(null,arguments):fc.moment.parseZone.apply(null,arguments),"_locale"in mom?mom._locale=localeData:mom._lang=localeData,mom},t.getIsAmbigTimezone=function(){return"local"!==options.timezone&&"UTC"!==options.timezone},t.rezoneDate=function(date){return t.moment(date.toArray())},t.getNow=function(){var now=options.now;return"function"==typeof now&&(now=now()),t.moment(now)},t.calculateWeekNumber=function(mom){var calc=options.weekNumberCalculation;return"function"==typeof calc?calc(mom):"local"===calc?mom.week():"ISO"===calc.toUpperCase()?mom.isoWeek():void 0},t.getEventEnd=function(event){return event.end?event.end.clone():t.getDefaultEventEnd(event.allDay,event.start)},t.getDefaultEventEnd=function(allDay,start){var end=start.clone();return allDay?end.stripTime().add(t.defaultAllDayEventDuration):end.add(t.defaultTimedEventDuration),t.getIsAmbigTimezone()&&end.stripZone(),end},EventManager.call(t,options);var header,headerElement,content,tm,currentView,suggestedViewHeight,windowResizeProxy,date,isFetchNeeded=t.isFetchNeeded,fetchEvents=t.fetchEvents,_element=element[0],viewSpecCache={},ignoreWindowResize=0,events=[];date=null!=options.defaultDate?t.moment(options.defaultDate):t.getNow(),t.getSuggestedViewHeight=function(){return void 0===suggestedViewHeight&&calcSize(),suggestedViewHeight},t.isHeightAuto=function(){return"auto"===options.contentHeight||"auto"===options.height}}function Header(calendar,options){function render(){var sections=options.header;return tm=options.theme?"ui":"fc",sections?el=$("<div class='fc-toolbar'/>").append(renderSection("left")).append(renderSection("right")).append(renderSection("center")).append('<div class="fc-clear"/>'):void 0}function destroy(){el.remove()}function renderSection(position){var sectionEl=$('<div class="fc-'+position+'"/>'),buttonStr=options.header[position];return buttonStr&&$.each(buttonStr.split(" "),function(){var groupEl,groupChildren=$(),isOnlyButtons=!0;$.each(this.split(","),function(j,buttonName){var buttonClick,themeIcon,normalIcon,defaultText,viewText,customText,innerHtml,classes,button;"title"==buttonName?(groupChildren=groupChildren.add($("<h2>&nbsp;</h2>")),isOnlyButtons=!1):(calendar[buttonName]?buttonClick=function(){calendar[buttonName]()}:calendar.isValidViewType(buttonName)&&(buttonClick=function(){calendar.changeView(buttonName)},viewsWithButtons.push(buttonName),viewText=calendar.getViewButtonText(buttonName)),buttonClick&&(themeIcon=smartProperty(options.themeButtonIcons,buttonName),normalIcon=smartProperty(options.buttonIcons,buttonName),defaultText=smartProperty(options.defaultButtonText,buttonName),customText=smartProperty(options.buttonText,buttonName),innerHtml=viewText||customText?htmlEscape(viewText||customText):themeIcon&&options.theme?"<span class='ui-icon ui-icon-"+themeIcon+"'></span>":normalIcon&&!options.theme?"<span class='fc-icon fc-icon-"+normalIcon+"'></span>":htmlEscape(defaultText||buttonName),classes=["fc-"+buttonName+"-button",tm+"-button",tm+"-state-default"],button=$('<button type="button" class="'+classes.join(" ")+'">'+innerHtml+"</button>").click(function(){button.hasClass(tm+"-state-disabled")||(buttonClick(),(button.hasClass(tm+"-state-active")||button.hasClass(tm+"-state-disabled"))&&button.removeClass(tm+"-state-hover"))}).mousedown(function(){button.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-down")}).mouseup(function(){button.removeClass(tm+"-state-down")}).hover(function(){button.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-hover")},function(){button.removeClass(tm+"-state-hover").removeClass(tm+"-state-down")}),groupChildren=groupChildren.add(button)))}),isOnlyButtons&&groupChildren.first().addClass(tm+"-corner-left").end().last().addClass(tm+"-corner-right").end(),groupChildren.length>1?(groupEl=$("<div/>"),isOnlyButtons&&groupEl.addClass("fc-button-group"),groupEl.append(groupChildren),sectionEl.append(groupEl)):sectionEl.append(groupChildren)}),sectionEl}function updateTitle(text){el.find("h2").text(text)}function activateButton(buttonName){el.find(".fc-"+buttonName+"-button").addClass(tm+"-state-active")}function deactivateButton(buttonName){el.find(".fc-"+buttonName+"-button").removeClass(tm+"-state-active")}function disableButton(buttonName){el.find(".fc-"+buttonName+"-button").attr("disabled","disabled").addClass(tm+"-state-disabled")}function enableButton(buttonName){el.find(".fc-"+buttonName+"-button").removeAttr("disabled").removeClass(tm+"-state-disabled")}function getViewsWithButtons(){return viewsWithButtons}var t=this;t.render=render,t.destroy=destroy,t.updateTitle=updateTitle,t.activateButton=activateButton,t.deactivateButton=deactivateButton,t.disableButton=disableButton,t.enableButton=enableButton,t.getViewsWithButtons=getViewsWithButtons;var tm,el=$(),viewsWithButtons=[]}function EventManager(options){function isFetchNeeded(start,end){return!rangeStart||start.clone().stripZone()<rangeStart.clone().stripZone()||end.clone().stripZone()>rangeEnd.clone().stripZone()}function fetchEvents(start,end){rangeStart=start,rangeEnd=end,cache=[];var fetchID=++currentFetchID,len=sources.length;pendingSourceCnt=len;for(var i=0;len>i;i++)fetchEventSource(sources[i],fetchID)}function fetchEventSource(source,fetchID){_fetchEventSource(source,function(eventInputs){var i,eventInput,abstractEvent,isArraySource=$.isArray(source.events);if(fetchID==currentFetchID){if(eventInputs)for(i=0;i<eventInputs.length;i++)eventInput=eventInputs[i],abstractEvent=isArraySource?eventInput:buildEventFromInput(eventInput,source),abstractEvent&&cache.push.apply(cache,expandEvent(abstractEvent));pendingSourceCnt--,pendingSourceCnt||reportEvents(cache)}})}function _fetchEventSource(source,callback){var i,res,fetchers=fc.sourceFetchers;for(i=0;i<fetchers.length;i++){if(res=fetchers[i].call(t,source,rangeStart.clone(),rangeEnd.clone(),options.timezone,callback),res===!0)return;if("object"==typeof res)return void _fetchEventSource(res,callback)}var events=source.events;if(events)$.isFunction(events)?(pushLoading(),events.call(t,rangeStart.clone(),rangeEnd.clone(),options.timezone,function(events){callback(events),popLoading()})):$.isArray(events)?callback(events):callback();else{var url=source.url;if(url){var customData,success=source.success,error=source.error,complete=source.complete;customData=$.isFunction(source.data)?source.data():source.data;var data=$.extend({},customData||{}),startParam=firstDefined(source.startParam,options.startParam),endParam=firstDefined(source.endParam,options.endParam),timezoneParam=firstDefined(source.timezoneParam,options.timezoneParam);startParam&&(data[startParam]=rangeStart.format()),endParam&&(data[endParam]=rangeEnd.format()),options.timezone&&"local"!=options.timezone&&(data[timezoneParam]=options.timezone),pushLoading(),$.ajax($.extend({},ajaxDefaults,source,{data:data,success:function(events){events=events||[];var res=applyAll(success,this,arguments);$.isArray(res)&&(events=res),callback(events)},error:function(){applyAll(error,this,arguments),callback()},complete:function(){applyAll(complete,this,arguments),popLoading()}}))}else callback()}}function addEventSource(sourceInput){var source=buildEventSource(sourceInput);source&&(sources.push(source),pendingSourceCnt++,fetchEventSource(source,currentFetchID))}function buildEventSource(sourceInput){var source,i,normalizers=fc.sourceNormalizers;if($.isFunction(sourceInput)||$.isArray(sourceInput)?source={events:sourceInput}:"string"==typeof sourceInput?source={url:sourceInput}:"object"==typeof sourceInput&&(source=$.extend({},sourceInput)),source){for(source.className?"string"==typeof source.className&&(source.className=source.className.split(/\s+/)):source.className=[],$.isArray(source.events)&&(source.origArray=source.events,source.events=$.map(source.events,function(eventInput){return buildEventFromInput(eventInput,source)})),i=0;i<normalizers.length;i++)normalizers[i].call(t,source);return source}}function removeEventSource(source){sources=$.grep(sources,function(src){return!isSourcesEqual(src,source)}),cache=$.grep(cache,function(e){return!isSourcesEqual(e.source,source)}),reportEvents(cache)}function isSourcesEqual(source1,source2){return source1&&source2&&getSourcePrimitive(source1)==getSourcePrimitive(source2)}function getSourcePrimitive(source){return("object"==typeof source?source.origArray||source.googleCalendarId||source.url||source.events:null)||source}function updateEvent(event){event.start=t.moment(event.start),event.end=event.end?t.moment(event.end):null,mutateEvent(event,getMiscEventProps(event)),reportEvents(cache)}function getMiscEventProps(event){var props={};return $.each(event,function(name,val){isMiscEventPropName(name)&&void 0!==val&&isAtomic(val)&&(props[name]=val)}),props}function isMiscEventPropName(name){return!/^_|^(id|allDay|start|end)$/.test(name)}function renderEvent(eventInput,stick){var events,i,event,abstractEvent=buildEventFromInput(eventInput);if(abstractEvent){for(events=expandEvent(abstractEvent),i=0;i<events.length;i++)event=events[i],event.source||(stick&&(stickySource.events.push(event),event.source=stickySource),cache.push(event));return reportEvents(cache),events}return[]}function removeEvents(filter){var eventID,i;for(null==filter?filter=function(){return!0}:$.isFunction(filter)||(eventID=filter+"",filter=function(event){return event._id==eventID}),cache=$.grep(cache,filter,!0),i=0;i<sources.length;i++)$.isArray(sources[i].events)&&(sources[i].events=$.grep(sources[i].events,filter,!0));reportEvents(cache)}function clientEvents(filter){return $.isFunction(filter)?$.grep(cache,filter):null!=filter?(filter+="",$.grep(cache,function(e){return e._id==filter})):cache}function pushLoading(){loadingLevel++||trigger("loading",null,!0,getView())}function popLoading(){--loadingLevel||trigger("loading",null,!1,getView())}function buildEventFromInput(input,source){var start,end,allDay,out={};if(options.eventDataTransform&&(input=options.eventDataTransform(input)),source&&source.eventDataTransform&&(input=source.eventDataTransform(input)),$.extend(out,input),source&&(out.source=source),out._id=input._id||(void 0===input.id?"_fc"+eventGUID++:input.id+""),out.className=input.className?"string"==typeof input.className?input.className.split(/\s+/):input.className:[],start=input.start||input.date,end=input.end,isTimeString(start)&&(start=moment.duration(start)),isTimeString(end)&&(end=moment.duration(end)),input.dow||moment.isDuration(start)||moment.isDuration(end))out.start=start?moment.duration(start):null,out.end=end?moment.duration(end):null,out._recurring=!0;else{if(start&&(start=t.moment(start),!start.isValid()))return!1;end&&(end=t.moment(end),end.isValid()||(end=null)),allDay=input.allDay,void 0===allDay&&(allDay=firstDefined(source?source.allDayDefault:void 0,options.allDayDefault)),assignDatesToEvent(start,end,allDay,out)}return out}function assignDatesToEvent(start,end,allDay,event){event.start=start,event.end=end,event.allDay=allDay,normalizeEventDateProps(event),backupEventDates(event)}function normalizeEventDateProps(props){null==props.allDay&&(props.allDay=!(props.start.hasTime()||props.end&&props.end.hasTime())),props.allDay?(props.start.stripTime(),props.end&&props.end.stripTime()):(props.start.hasTime()||(props.start=t.rezoneDate(props.start)),props.end&&!props.end.hasTime()&&(props.end=t.rezoneDate(props.end))),props.end&&!props.end.isAfter(props.start)&&(props.end=null),props.end||(props.end=options.forceEventDuration?t.getDefaultEventEnd(props.allDay,props.start):null)}function ensureVisibleEventRange(range){var allDay;return range.end||(allDay=range.allDay,null==allDay&&(allDay=!range.start.hasTime()),range={start:range.start,end:t.getDefaultEventEnd(allDay,range.start)}),range}function expandEvent(abstractEvent,_rangeStart,_rangeEnd){var dowHash,dow,i,date,startTime,endTime,start,end,event,events=[];if(_rangeStart=_rangeStart||rangeStart,_rangeEnd=_rangeEnd||rangeEnd,abstractEvent)if(abstractEvent._recurring){if(dow=abstractEvent.dow)for(dowHash={},i=0;i<dow.length;i++)dowHash[dow[i]]=!0;for(date=_rangeStart.clone().stripTime();date.isBefore(_rangeEnd);)(!dowHash||dowHash[date.day()])&&(startTime=abstractEvent.start,endTime=abstractEvent.end,start=date.clone(),end=null,startTime&&(start=start.time(startTime)),endTime&&(end=date.clone().time(endTime)),event=$.extend({},abstractEvent),assignDatesToEvent(start,end,!startTime&&!endTime,event),events.push(event)),date.add(1,"days")}else events.push(abstractEvent);return events}function mutateEvent(event,props){var clearEnd,dateDelta,durationDelta,undoFunc,miscProps={};return props=props||{},props.start||(props.start=event.start.clone()),void 0===props.end&&(props.end=event.end?event.end.clone():null),null==props.allDay&&(props.allDay=event.allDay),normalizeEventDateProps(props),clearEnd=null!==event._end&&null===props.end,dateDelta=props.allDay?diffDay(props.start,event._start):diffDayTime(props.start,event._start),!clearEnd&&props.end&&(durationDelta=diffDayTime(props.end,props.start).subtract(diffDayTime(event._end||t.getDefaultEventEnd(event._allDay,event._start),event._start))),$.each(props,function(name,val){isMiscEventPropName(name)&&void 0!==val&&(miscProps[name]=val)}),undoFunc=mutateEvents(clientEvents(event._id),clearEnd,props.allDay,dateDelta,durationDelta,miscProps),{dateDelta:dateDelta,durationDelta:durationDelta,undo:undoFunc}}function mutateEvents(events,clearEnd,allDay,dateDelta,durationDelta,miscProps){var isAmbigTimezone=t.getIsAmbigTimezone(),undoFunctions=[];return dateDelta&&!dateDelta.valueOf()&&(dateDelta=null),durationDelta&&!durationDelta.valueOf()&&(durationDelta=null),$.each(events,function(i,event){var oldProps,newProps;oldProps={start:event.start.clone(),end:event.end?event.end.clone():null,allDay:event.allDay},$.each(miscProps,function(name){oldProps[name]=event[name]}),newProps={start:event._start,end:event._end,allDay:event._allDay},clearEnd&&(newProps.end=null),newProps.allDay=allDay,normalizeEventDateProps(newProps),dateDelta&&(newProps.start.add(dateDelta),newProps.end&&newProps.end.add(dateDelta)),durationDelta&&(newProps.end||(newProps.end=t.getDefaultEventEnd(newProps.allDay,newProps.start)),newProps.end.add(durationDelta)),isAmbigTimezone&&!newProps.allDay&&(dateDelta||durationDelta)&&(newProps.start.stripZone(),newProps.end&&newProps.end.stripZone()),$.extend(event,miscProps,newProps),backupEventDates(event),undoFunctions.push(function(){$.extend(event,oldProps),backupEventDates(event)})}),function(){for(var i=0;i<undoFunctions.length;i++)undoFunctions[i]()}}function getBusinessHoursEvents(){var eventInput,optionVal=options.businessHours,defaultVal={className:"fc-nonbusiness",start:"09:00",end:"17:00",dow:[1,2,3,4,5],rendering:"inverse-background"},view=t.getView();return optionVal&&(eventInput="object"==typeof optionVal?$.extend({},defaultVal,optionVal):defaultVal),eventInput?expandEvent(buildEventFromInput(eventInput),view.start,view.end):[]}function isEventRangeAllowed(range,event){var source=event.source||{},constraint=firstDefined(event.constraint,source.constraint,options.eventConstraint),overlap=firstDefined(event.overlap,source.overlap,options.eventOverlap);return range=ensureVisibleEventRange(range),isRangeAllowed(range,constraint,overlap,event)}function isSelectionRangeAllowed(range){return isRangeAllowed(range,options.selectConstraint,options.selectOverlap)}function isExternalDropRangeAllowed(range,eventProps){var eventInput,event;return eventProps&&(eventInput=$.extend({},eventProps,range),event=expandEvent(buildEventFromInput(eventInput))[0]),event?isEventRangeAllowed(range,event):(range=ensureVisibleEventRange(range),isSelectionRangeAllowed(range))}function isRangeAllowed(range,constraint,overlap,event){var constraintEvents,anyContainment,i,otherEvent,otherOverlap;if(range={start:range.start.clone().stripZone(),end:range.end.clone().stripZone()},null!=constraint){for(constraintEvents=constraintToEvents(constraint),anyContainment=!1,i=0;i<constraintEvents.length;i++)if(eventContainsRange(constraintEvents[i],range)){anyContainment=!0;break}if(!anyContainment)return!1}for(i=0;i<cache.length;i++)if(otherEvent=cache[i],(!event||event._id!==otherEvent._id)&&eventIntersectsRange(otherEvent,range)){if(overlap===!1)return!1;if("function"==typeof overlap&&!overlap(otherEvent,event))return!1;if(event){if(otherOverlap=firstDefined(otherEvent.overlap,(otherEvent.source||{}).overlap),otherOverlap===!1)return!1;if("function"==typeof otherOverlap&&!otherOverlap(event,otherEvent))return!1}}return!0}function constraintToEvents(constraintInput){return"businessHours"===constraintInput?getBusinessHoursEvents():"object"==typeof constraintInput?expandEvent(buildEventFromInput(constraintInput)):clientEvents(constraintInput)}function eventContainsRange(event,range){var eventStart=event.start.clone().stripZone(),eventEnd=t.getEventEnd(event).stripZone();return range.start>=eventStart&&range.end<=eventEnd}function eventIntersectsRange(event,range){var eventStart=event.start.clone().stripZone(),eventEnd=t.getEventEnd(event).stripZone();return range.start<eventEnd&&range.end>eventStart}var t=this;t.isFetchNeeded=isFetchNeeded,t.fetchEvents=fetchEvents,t.addEventSource=addEventSource,t.removeEventSource=removeEventSource,t.updateEvent=updateEvent,t.renderEvent=renderEvent,t.removeEvents=removeEvents,t.clientEvents=clientEvents,t.mutateEvent=mutateEvent,t.normalizeEventDateProps=normalizeEventDateProps,t.ensureVisibleEventRange=ensureVisibleEventRange;var rangeStart,rangeEnd,trigger=t.trigger,getView=t.getView,reportEvents=t.reportEvents,stickySource={events:[]},sources=[stickySource],currentFetchID=0,pendingSourceCnt=0,loadingLevel=0,cache=[];$.each((options.events?[options.events]:[]).concat(options.eventSources||[]),function(i,sourceInput){var source=buildEventSource(sourceInput);source&&sources.push(source)}),t.getBusinessHoursEvents=getBusinessHoursEvents,t.isEventRangeAllowed=isEventRangeAllowed,t.isSelectionRangeAllowed=isSelectionRangeAllowed,t.isExternalDropRangeAllowed=isExternalDropRangeAllowed}function backupEventDates(event){event._allDay=event.allDay,event._start=event.start.clone(),event._end=event.end?event.end.clone():null}var defaults={titleRangeSeparator:"  ",monthYearFormat:"MMMM YYYY",defaultTimedEventDuration:"02:00:00",defaultAllDayEventDuration:{days:1},forceEventDuration:!1,nextDayThreshold:"09:00:00",defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberTitle:"W",weekNumberCalculation:"local",lazyFetching:!0,startParam:"start",endParam:"end",timezoneParam:"timezone",timezone:!1,isRTL:!1,defaultButtonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",today:"today",month:"month",week:"week",day:"day"},buttonIcons:{prev:"left-single-arrow",next:"right-single-arrow",prevYear:"left-double-arrow",nextYear:"right-double-arrow"},theme:!1,themeButtonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e",prevYear:"seek-prev",nextYear:"seek-next"},dragOpacity:.75,dragRevertDuration:500,dragScroll:!0,unselectAuto:!0,dropAccept:"*",eventLimit:!1,eventLimitText:"more",eventLimitClick:"popover",dayPopoverFormat:"LL",handleWindowResize:!0,windowResizeDelay:200},englishDefaults={dayPopoverFormat:"dddd, MMMM D"},rtlDefaults={header:{left:"next,prev today",center:"",right:"title"},buttonIcons:{prev:"right-single-arrow",next:"left-single-arrow",prevYear:"right-double-arrow",nextYear:"left-double-arrow"},themeButtonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w",nextYear:"seek-prev",prevYear:"seek-next"}},fc=$.fullCalendar={version:"2.2.6"},fcViews=fc.views={};$.fn.fullCalendar=function(options){var args=Array.prototype.slice.call(arguments,1),res=this;return this.each(function(i,_element){var singleRes,element=$(_element),calendar=element.data("fullCalendar");"string"==typeof options?calendar&&$.isFunction(calendar[options])&&(singleRes=calendar[options].apply(calendar,args),i||(res=singleRes),"destroy"===options&&element.removeData("fullCalendar")):calendar||(calendar=new Calendar(element,options),element.data("fullCalendar",calendar),calendar.render())}),res};var langOptionHash=fc.langs={};fc.datepickerLang=function(langCode,dpLangCode,dpOptions){var fcOptions=langOptionHash[langCode]||(langOptionHash[langCode]={});fcOptions.isRTL=dpOptions.isRTL,fcOptions.weekNumberTitle=dpOptions.weekHeader,$.each(dpComputableOptions,function(name,func){fcOptions[name]=func(dpOptions)}),$.datepicker&&($.datepicker.regional[dpLangCode]=$.datepicker.regional[langCode]=dpOptions,$.datepicker.regional.en=$.datepicker.regional[""],$.datepicker.setDefaults(dpOptions))},fc.lang=function(langCode,newFcOptions){var fcOptions,momOptions;fcOptions=langOptionHash[langCode]||(langOptionHash[langCode]={}),newFcOptions&&mergeOptions(fcOptions,newFcOptions),momOptions=getMomentLocaleData(langCode),$.each(momComputableOptions,function(name,func){void 0===fcOptions[name]&&(fcOptions[name]=func(momOptions,fcOptions))}),defaults.lang=langCode};var dpComputableOptions={defaultButtonText:function(dpOptions){return{prev:stripHtmlEntities(dpOptions.prevText),next:stripHtmlEntities(dpOptions.nextText),today:stripHtmlEntities(dpOptions.currentText)}},monthYearFormat:function(dpOptions){return dpOptions.showMonthAfterYear?"YYYY["+dpOptions.yearSuffix+"] MMMM":"MMMM YYYY["+dpOptions.yearSuffix+"]"}},momComputableOptions={dayOfMonthFormat:function(momOptions,fcOptions){var format=momOptions.longDateFormat("l");return format=format.replace(/^Y+[^\w\s]*|[^\w\s]*Y+$/g,""),fcOptions.isRTL?format+=" ddd":format="ddd "+format,format},smallTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"a")},extraSmallTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"t")},noMeridiemTimeFormat:function(momOptions){return momOptions.longDateFormat("LT").replace(/\s*a$/i,"")}};fc.lang("en",englishDefaults),fc.intersectionToSeg=intersectionToSeg,fc.applyAll=applyAll,fc.debounce=debounce;var allowValueOptimization,setUTCValues,setLocalValues,dayIDs=["sun","mon","tue","wed","thu","fri","sat"],intervalUnits=["year","month","week","day","hour","minute","second","millisecond"],hasOwnPropMethod={}.hasOwnProperty,ambigDateOfMonthRegex=/^\s*\d{4}-\d\d$/,ambigTimeOrZoneRegex=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?)?$/,newMomentProto=moment.fn,oldMomentProto=$.extend({},newMomentProto);fc.moment=function(){return makeMoment(arguments)},fc.moment.utc=function(){var mom=makeMoment(arguments,!0);return mom.hasTime()&&mom.utc(),mom},fc.moment.parseZone=function(){return makeMoment(arguments,!0,!0)},newMomentProto.clone=function(){var mom=oldMomentProto.clone.apply(this,arguments);return transferAmbigs(this,mom),this._fullCalendar&&(mom._fullCalendar=!0),mom},newMomentProto.time=function(time){if(!this._fullCalendar)return oldMomentProto.time.apply(this,arguments);if(null==time)return moment.duration({hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()});this._ambigTime=!1,moment.isDuration(time)||moment.isMoment(time)||(time=moment.duration(time));var dayHours=0;return moment.isDuration(time)&&(dayHours=24*Math.floor(time.asDays())),this.hours(dayHours+time.hours()).minutes(time.minutes()).seconds(time.seconds()).milliseconds(time.milliseconds())},newMomentProto.stripTime=function(){var a;return this._ambigTime||(a=this.toArray(),this.utc(),setUTCValues(this,a.slice(0,3)),this._ambigTime=!0,this._ambigZone=!0),this},newMomentProto.hasTime=function(){return!this._ambigTime},newMomentProto.stripZone=function(){var a,wasAmbigTime;return this._ambigZone||(a=this.toArray(),wasAmbigTime=this._ambigTime,this.utc(),setUTCValues(this,a),wasAmbigTime&&(this._ambigTime=!0),this._ambigZone=!0),this},newMomentProto.hasZone=function(){return!this._ambigZone},$.each(["utcOffset","zone"],function(i,name){oldMomentProto[name]&&(newMomentProto[name]=function(tzo){return null!=tzo&&(this._ambigTime=!1,this._ambigZone=!1),oldMomentProto[name].apply(this,arguments)})}),newMomentProto.local=function(){var a=this.toArray(),wasAmbigZone=this._ambigZone;return oldMomentProto.local.apply(this,arguments),wasAmbigZone&&setLocalValues(this,a),this
},newMomentProto.format=function(){return this._fullCalendar&&arguments[0]?formatDate(this,arguments[0]):this._ambigTime?oldMomentFormat(this,"YYYY-MM-DD"):this._ambigZone?oldMomentFormat(this,"YYYY-MM-DD[T]HH:mm:ss"):oldMomentProto.format.apply(this,arguments)},newMomentProto.toISOString=function(){return this._ambigTime?oldMomentFormat(this,"YYYY-MM-DD"):this._ambigZone?oldMomentFormat(this,"YYYY-MM-DD[T]HH:mm:ss"):oldMomentProto.toISOString.apply(this,arguments)},newMomentProto.isWithin=function(start,end){var a=commonlyAmbiguate([this,start,end]);return a[0]>=a[1]&&a[0]<a[2]},newMomentProto.isSame=function(input,units){var a;return this._fullCalendar?units?(a=commonlyAmbiguate([this,input],!0),oldMomentProto.isSame.call(a[0],a[1],units)):(input=fc.moment.parseZone(input),oldMomentProto.isSame.call(this,input)&&Boolean(this._ambigTime)===Boolean(input._ambigTime)&&Boolean(this._ambigZone)===Boolean(input._ambigZone)):oldMomentProto.isSame.apply(this,arguments)},$.each(["isBefore","isAfter"],function(i,methodName){newMomentProto[methodName]=function(input,units){var a;return this._fullCalendar?(a=commonlyAmbiguate([this,input]),oldMomentProto[methodName].call(a[0],a[1],units)):oldMomentProto[methodName].apply(this,arguments)}}),allowValueOptimization="_d"in moment()&&"updateOffset"in moment,setUTCValues=allowValueOptimization?function(mom,a){mom._d.setTime(Date.UTC.apply(Date,a)),moment.updateOffset(mom,!1)}:setMomentValues,setLocalValues=allowValueOptimization?function(mom,a){mom._d.setTime(+new Date(a[0]||0,a[1]||0,a[2]||0,a[3]||0,a[4]||0,a[5]||0,a[6]||0)),moment.updateOffset(mom,!1)}:setMomentValues;var tokenOverrides={t:function(date){return oldMomentFormat(date,"a").charAt(0)},T:function(date){return oldMomentFormat(date,"A").charAt(0)}};fc.formatRange=formatRange;var similarUnitMap={Y:"year",M:"month",D:"day",d:"day",A:"second",a:"second",T:"second",t:"second",H:"second",h:"second",m:"second",s:"second"},formatStringChunkCache={};fc.Class=Class,Class.extend=function(members){var subClass,superClass=this;return members=members||{},hasOwnProp(members,"constructor")&&(subClass=members.constructor),"function"!=typeof subClass&&(subClass=members.constructor=function(){superClass.apply(this,arguments)}),subClass.prototype=createObject(superClass.prototype),copyOwnProps(members,subClass.prototype),copyOwnProps(superClass,subClass),subClass},Class.mixin=function(members){copyOwnProps(members.prototype||members,this.prototype)};var Popover=Class.extend({isHidden:!0,options:null,el:null,documentMousedownProxy:null,margin:10,constructor:function(options){this.options=options||{}},show:function(){this.isHidden&&(this.el||this.render(),this.el.show(),this.position(),this.isHidden=!1,this.trigger("show"))},hide:function(){this.isHidden||(this.el.hide(),this.isHidden=!0,this.trigger("hide"))},render:function(){var _this=this,options=this.options;this.el=$('<div class="fc-popover"/>').addClass(options.className||"").css({top:0,left:0}).append(options.content).appendTo(options.parentEl),this.el.on("click",".fc-close",function(){_this.hide()}),options.autoHide&&$(document).on("mousedown",this.documentMousedownProxy=$.proxy(this,"documentMousedown"))},documentMousedown:function(ev){this.el&&!$(ev.target).closest(this.el).length&&this.hide()},destroy:function(){this.hide(),this.el&&(this.el.remove(),this.el=null),$(document).off("mousedown",this.documentMousedownProxy)},position:function(){var viewportTop,viewportLeft,viewportOffset,top,left,options=this.options,origin=this.el.offsetParent().offset(),width=this.el.outerWidth(),height=this.el.outerHeight(),windowEl=$(window),viewportEl=getScrollParent(this.el);top=options.top||0,left=void 0!==options.left?options.left:void 0!==options.right?options.right-width:0,viewportEl.is(window)||viewportEl.is(document)?(viewportEl=windowEl,viewportTop=0,viewportLeft=0):(viewportOffset=viewportEl.offset(),viewportTop=viewportOffset.top,viewportLeft=viewportOffset.left),viewportTop+=windowEl.scrollTop(),viewportLeft+=windowEl.scrollLeft(),options.viewportConstrain!==!1&&(top=Math.min(top,viewportTop+viewportEl.outerHeight()-height-this.margin),top=Math.max(top,viewportTop+this.margin),left=Math.min(left,viewportLeft+viewportEl.outerWidth()-width-this.margin),left=Math.max(left,viewportLeft+this.margin)),this.el.css({top:top-origin.top,left:left-origin.left})},trigger:function(name){this.options[name]&&this.options[name].apply(this,Array.prototype.slice.call(arguments,1))}}),GridCoordMap=Class.extend({grid:null,rowCoords:null,colCoords:null,containerEl:null,minX:null,maxX:null,minY:null,maxY:null,constructor:function(grid){this.grid=grid},build:function(){this.rowCoords=this.grid.computeRowCoords(),this.colCoords=this.grid.computeColCoords(),this.computeBounds()},clear:function(){this.rowCoords=null,this.colCoords=null},getCell:function(x,y){var i,coords,cell,rowCoords=this.rowCoords,colCoords=this.colCoords,hitRow=null,hitCol=null;if(this.inBounds(x,y)){for(i=0;i<rowCoords.length;i++)if(coords=rowCoords[i],y>=coords.top&&y<coords.bottom){hitRow=i;break}for(i=0;i<colCoords.length;i++)if(coords=colCoords[i],x>=coords.left&&x<coords.right){hitCol=i;break}if(null!==hitRow&&null!==hitCol)return cell=this.grid.getCell(hitRow,hitCol),cell.grid=this.grid,cell}return null},computeBounds:function(){var containerOffset;this.containerEl&&(containerOffset=this.containerEl.offset(),this.minX=containerOffset.left,this.maxX=containerOffset.left+this.containerEl.outerWidth(),this.minY=containerOffset.top,this.maxY=containerOffset.top+this.containerEl.outerHeight())},inBounds:function(x,y){return this.containerEl?x>=this.minX&&x<this.maxX&&y>=this.minY&&y<this.maxY:!0}}),ComboCoordMap=Class.extend({coordMaps:null,constructor:function(coordMaps){this.coordMaps=coordMaps},build:function(){var i,coordMaps=this.coordMaps;for(i=0;i<coordMaps.length;i++)coordMaps[i].build()},getCell:function(x,y){var i,coordMaps=this.coordMaps,cell=null;for(i=0;i<coordMaps.length&&!cell;i++)cell=coordMaps[i].getCell(x,y);return cell},clear:function(){var i,coordMaps=this.coordMaps;for(i=0;i<coordMaps.length;i++)coordMaps[i].clear()}}),DragListener=Class.extend({coordMap:null,options:null,isListening:!1,isDragging:!1,origCell:null,cell:null,mouseX0:null,mouseY0:null,mousemoveProxy:null,mouseupProxy:null,scrollEl:null,scrollBounds:null,scrollTopVel:null,scrollLeftVel:null,scrollIntervalId:null,scrollHandlerProxy:null,scrollSensitivity:30,scrollSpeed:200,scrollIntervalMs:50,constructor:function(coordMap,options){this.coordMap=coordMap,this.options=options||{}},mousedown:function(ev){isPrimaryMouseButton(ev)&&(ev.preventDefault(),this.startListening(ev),this.options.distance||this.startDrag(ev))},startListening:function(ev){var scrollParent,cell;this.isListening||(ev&&this.options.scroll&&(scrollParent=getScrollParent($(ev.target)),scrollParent.is(window)||scrollParent.is(document)||(this.scrollEl=scrollParent,this.scrollHandlerProxy=debounce($.proxy(this,"scrollHandler"),100),this.scrollEl.on("scroll",this.scrollHandlerProxy))),this.computeCoords(),ev&&(cell=this.getCell(ev),this.origCell=cell,this.mouseX0=ev.pageX,this.mouseY0=ev.pageY),$(document).on("mousemove",this.mousemoveProxy=$.proxy(this,"mousemove")).on("mouseup",this.mouseupProxy=$.proxy(this,"mouseup")).on("selectstart",this.preventDefault),this.isListening=!0,this.trigger("listenStart",ev))},computeCoords:function(){this.coordMap.build(),this.computeScrollBounds()},mousemove:function(ev){var minDistance,distanceSq;this.isDragging||(minDistance=this.options.distance||1,distanceSq=Math.pow(ev.pageX-this.mouseX0,2)+Math.pow(ev.pageY-this.mouseY0,2),distanceSq>=minDistance*minDistance&&this.startDrag(ev)),this.isDragging&&this.drag(ev)},startDrag:function(ev){var cell;this.isListening||this.startListening(),this.isDragging||(this.isDragging=!0,this.trigger("dragStart",ev),cell=this.getCell(ev),cell&&this.cellOver(cell))},drag:function(ev){var cell;this.isDragging&&(cell=this.getCell(ev),isCellsEqual(cell,this.cell)||(this.cell&&this.cellOut(),cell&&this.cellOver(cell)),this.dragScroll(ev))},cellOver:function(cell){this.cell=cell,this.trigger("cellOver",cell,isCellsEqual(cell,this.origCell))},cellOut:function(){this.cell&&(this.trigger("cellOut",this.cell),this.cell=null)},mouseup:function(ev){this.stopDrag(ev),this.stopListening(ev)},stopDrag:function(ev){this.isDragging&&(this.stopScrolling(),this.trigger("dragStop",ev),this.isDragging=!1)},stopListening:function(ev){this.isListening&&(this.scrollEl&&(this.scrollEl.off("scroll",this.scrollHandlerProxy),this.scrollHandlerProxy=null),$(document).off("mousemove",this.mousemoveProxy).off("mouseup",this.mouseupProxy).off("selectstart",this.preventDefault),this.mousemoveProxy=null,this.mouseupProxy=null,this.isListening=!1,this.trigger("listenStop",ev),this.origCell=this.cell=null,this.coordMap.clear())},getCell:function(ev){return this.coordMap.getCell(ev.pageX,ev.pageY)},trigger:function(name){this.options[name]&&this.options[name].apply(this,Array.prototype.slice.call(arguments,1))},preventDefault:function(ev){ev.preventDefault()},computeScrollBounds:function(){var offset,el=this.scrollEl;el&&(offset=el.offset(),this.scrollBounds={top:offset.top,left:offset.left,bottom:offset.top+el.outerHeight(),right:offset.left+el.outerWidth()})},dragScroll:function(ev){var topCloseness,bottomCloseness,leftCloseness,rightCloseness,sensitivity=this.scrollSensitivity,bounds=this.scrollBounds,topVel=0,leftVel=0;bounds&&(topCloseness=(sensitivity-(ev.pageY-bounds.top))/sensitivity,bottomCloseness=(sensitivity-(bounds.bottom-ev.pageY))/sensitivity,leftCloseness=(sensitivity-(ev.pageX-bounds.left))/sensitivity,rightCloseness=(sensitivity-(bounds.right-ev.pageX))/sensitivity,topCloseness>=0&&1>=topCloseness?topVel=topCloseness*this.scrollSpeed*-1:bottomCloseness>=0&&1>=bottomCloseness&&(topVel=bottomCloseness*this.scrollSpeed),leftCloseness>=0&&1>=leftCloseness?leftVel=leftCloseness*this.scrollSpeed*-1:rightCloseness>=0&&1>=rightCloseness&&(leftVel=rightCloseness*this.scrollSpeed)),this.setScrollVel(topVel,leftVel)},setScrollVel:function(topVel,leftVel){this.scrollTopVel=topVel,this.scrollLeftVel=leftVel,this.constrainScrollVel(),!this.scrollTopVel&&!this.scrollLeftVel||this.scrollIntervalId||(this.scrollIntervalId=setInterval($.proxy(this,"scrollIntervalFunc"),this.scrollIntervalMs))},constrainScrollVel:function(){var el=this.scrollEl;this.scrollTopVel<0?el.scrollTop()<=0&&(this.scrollTopVel=0):this.scrollTopVel>0&&el.scrollTop()+el[0].clientHeight>=el[0].scrollHeight&&(this.scrollTopVel=0),this.scrollLeftVel<0?el.scrollLeft()<=0&&(this.scrollLeftVel=0):this.scrollLeftVel>0&&el.scrollLeft()+el[0].clientWidth>=el[0].scrollWidth&&(this.scrollLeftVel=0)},scrollIntervalFunc:function(){var el=this.scrollEl,frac=this.scrollIntervalMs/1e3;this.scrollTopVel&&el.scrollTop(el.scrollTop()+this.scrollTopVel*frac),this.scrollLeftVel&&el.scrollLeft(el.scrollLeft()+this.scrollLeftVel*frac),this.constrainScrollVel(),this.scrollTopVel||this.scrollLeftVel||this.stopScrolling()},stopScrolling:function(){this.scrollIntervalId&&(clearInterval(this.scrollIntervalId),this.scrollIntervalId=null,this.computeCoords())},scrollHandler:function(){this.scrollIntervalId||this.computeCoords()}}),MouseFollower=Class.extend({options:null,sourceEl:null,el:null,parentEl:null,top0:null,left0:null,mouseY0:null,mouseX0:null,topDelta:null,leftDelta:null,mousemoveProxy:null,isFollowing:!1,isHidden:!1,isAnimating:!1,constructor:function(sourceEl,options){this.options=options=options||{},this.sourceEl=sourceEl,this.parentEl=options.parentEl?$(options.parentEl):sourceEl.parent()},start:function(ev){this.isFollowing||(this.isFollowing=!0,this.mouseY0=ev.pageY,this.mouseX0=ev.pageX,this.topDelta=0,this.leftDelta=0,this.isHidden||this.updatePosition(),$(document).on("mousemove",this.mousemoveProxy=$.proxy(this,"mousemove")))},stop:function(shouldRevert,callback){function complete(){this.isAnimating=!1,_this.destroyEl(),this.top0=this.left0=null,callback&&callback()}var _this=this,revertDuration=this.options.revertDuration;this.isFollowing&&!this.isAnimating&&(this.isFollowing=!1,$(document).off("mousemove",this.mousemoveProxy),shouldRevert&&revertDuration&&!this.isHidden?(this.isAnimating=!0,this.el.animate({top:this.top0,left:this.left0},{duration:revertDuration,complete:complete})):complete())},getEl:function(){var el=this.el;return el||(this.sourceEl.width(),el=this.el=this.sourceEl.clone().css({position:"absolute",visibility:"",display:this.isHidden?"none":"",margin:0,right:"auto",bottom:"auto",width:this.sourceEl.width(),height:this.sourceEl.height(),opacity:this.options.opacity||"",zIndex:this.options.zIndex}).appendTo(this.parentEl)),el},destroyEl:function(){this.el&&(this.el.remove(),this.el=null)},updatePosition:function(){var sourceOffset,origin;this.getEl(),null===this.top0&&(this.sourceEl.width(),sourceOffset=this.sourceEl.offset(),origin=this.el.offsetParent().offset(),this.top0=sourceOffset.top-origin.top,this.left0=sourceOffset.left-origin.left),this.el.css({top:this.top0+this.topDelta,left:this.left0+this.leftDelta})},mousemove:function(ev){this.topDelta=ev.pageY-this.mouseY0,this.leftDelta=ev.pageX-this.mouseX0,this.isHidden||this.updatePosition()},hide:function(){this.isHidden||(this.isHidden=!0,this.el&&this.el.hide())},show:function(){this.isHidden&&(this.isHidden=!1,this.updatePosition(),this.getEl().show())}}),RowRenderer=Class.extend({view:null,isRTL:null,cellHtml:"<td/>",constructor:function(view){this.view=view,this.isRTL=view.opt("isRTL")},rowHtml:function(rowType,row){var col,cell,renderCell=this.getHtmlRenderer("cell",rowType),rowCellHtml="";for(row=row||0,col=0;col<this.colCnt;col++)cell=this.getCell(row,col),rowCellHtml+=renderCell(cell);return rowCellHtml=this.bookendCells(rowCellHtml,rowType,row),"<tr>"+rowCellHtml+"</tr>"},bookendCells:function(cells,rowType,row){var intro=this.getHtmlRenderer("intro",rowType)(row||0),outro=this.getHtmlRenderer("outro",rowType)(row||0),prependHtml=this.isRTL?outro:intro,appendHtml=this.isRTL?intro:outro;return"string"==typeof cells?prependHtml+cells+appendHtml:cells.prepend(prependHtml).append(appendHtml)},getHtmlRenderer:function(rendererName,rowType){var generalName,specificName,provider,renderer,view=this.view;return generalName=rendererName+"Html",rowType&&(specificName=rowType+capitaliseFirstLetter(rendererName)+"Html"),specificName&&(renderer=view[specificName])?provider=view:specificName&&(renderer=this[specificName])?provider=this:(renderer=view[generalName])?provider=view:(renderer=this[generalName])&&(provider=this),"function"==typeof renderer?function(){return renderer.apply(provider,arguments)||""}:function(){return renderer||""}}}),Grid=fc.Grid=RowRenderer.extend({start:null,end:null,rowCnt:0,colCnt:0,rowData:null,colData:null,el:null,coordMap:null,elsByFill:null,documentDragStartProxy:null,colHeadFormat:null,eventTimeFormat:null,displayEventEnd:null,constructor:function(){RowRenderer.apply(this,arguments),this.coordMap=new GridCoordMap(this),this.elsByFill={},this.documentDragStartProxy=$.proxy(this,"documentDragStart")},render:function(){this.bindHandlers()},destroy:function(){this.unbindHandlers()},computeColHeadFormat:function(){},computeEventTimeFormat:function(){return this.view.opt("smallTimeFormat")},computeDisplayEventEnd:function(){return!1},setRange:function(range){var view=this.view;this.start=range.start.clone(),this.end=range.end.clone(),this.rowData=[],this.colData=[],this.updateCells(),this.colHeadFormat=view.opt("columnFormat")||this.computeColHeadFormat(),this.eventTimeFormat=view.opt("timeFormat")||this.computeEventTimeFormat(),this.displayEventEnd=view.opt("displayEventEnd"),null==this.displayEventEnd&&(this.displayEventEnd=this.computeDisplayEventEnd())},updateCells:function(){},rangeToSegs:function(){},getCell:function(row,col){var cell;return null==col&&("number"==typeof row?(col=row%this.colCnt,row=Math.floor(row/this.colCnt)):(col=row.col,row=row.row)),cell={row:row,col:col},$.extend(cell,this.getRowData(row),this.getColData(col)),$.extend(cell,this.computeCellRange(cell)),cell},computeCellRange:function(){},getRowData:function(row){return this.rowData[row]||{}},getColData:function(col){return this.colData[col]||{}},getRowEl:function(){},getColEl:function(){},getCellDayEl:function(cell){return this.getColEl(cell.col)||this.getRowEl(cell.row)},computeRowCoords:function(){var i,el,item,items=[];for(i=0;i<this.rowCnt;i++)el=this.getRowEl(i),item={top:el.offset().top},i>0&&(items[i-1].bottom=item.top),items.push(item);return item.bottom=item.top+el.outerHeight(),items},computeColCoords:function(){var i,el,item,items=[];for(i=0;i<this.colCnt;i++)el=this.getColEl(i),item={left:el.offset().left},i>0&&(items[i-1].right=item.left),items.push(item);return item.right=item.left+el.outerWidth(),items},bindHandlers:function(){var _this=this;this.el.on("mousedown",function(ev){$(ev.target).is(".fc-event-container *, .fc-more")||$(ev.target).closest(".fc-popover").length||_this.dayMousedown(ev)}),this.bindSegHandlers(),$(document).on("dragstart",this.documentDragStartProxy)},unbindHandlers:function(){$(document).off("dragstart",this.documentDragStartProxy)},dayMousedown:function(ev){var dayClickCell,selectionRange,_this=this,view=this.view,isSelectable=view.opt("selectable"),dragListener=new DragListener(this.coordMap,{scroll:view.opt("dragScroll"),dragStart:function(){view.unselect()},cellOver:function(cell,isOrig){var origCell=dragListener.origCell;origCell&&(dayClickCell=isOrig?cell:null,isSelectable&&(selectionRange=_this.computeSelection(origCell,cell),selectionRange?_this.renderSelection(selectionRange):disableCursor()))},cellOut:function(){dayClickCell=null,selectionRange=null,_this.destroySelection(),enableCursor()},listenStop:function(ev){dayClickCell&&view.trigger("dayClick",_this.getCellDayEl(dayClickCell),dayClickCell.start,ev),selectionRange&&view.reportSelection(selectionRange,ev),enableCursor()}});dragListener.mousedown(ev)},renderRangeHelper:function(range,sourceSeg){var fakeEvent;fakeEvent=sourceSeg?createObject(sourceSeg.event):{},fakeEvent.start=range.start.clone(),fakeEvent.end=range.end?range.end.clone():null,fakeEvent.allDay=null,this.view.calendar.normalizeEventDateProps(fakeEvent),fakeEvent.className=(fakeEvent.className||[]).concat("fc-helper"),sourceSeg||(fakeEvent.editable=!1),this.renderHelper(fakeEvent,sourceSeg)},renderHelper:function(){},destroyHelper:function(){},renderSelection:function(range){this.renderHighlight(range)},destroySelection:function(){this.destroyHighlight()},computeSelection:function(firstCell,lastCell){var range,dates=[firstCell.start,firstCell.end,lastCell.start,lastCell.end];return dates.sort(compareNumbers),range={start:dates[0].clone(),end:dates[3].clone()},this.view.calendar.isSelectionRangeAllowed(range)?range:null},renderHighlight:function(range){this.renderFill("highlight",this.rangeToSegs(range))},destroyHighlight:function(){this.destroyFill("highlight")},highlightSegClasses:function(){return["fc-highlight"]},renderFill:function(){},destroyFill:function(type){var el=this.elsByFill[type];el&&(el.remove(),delete this.elsByFill[type])},renderFillSegEls:function(type,segs){var i,_this=this,segElMethod=this[type+"SegEl"],html="",renderedSegs=[];if(segs.length){for(i=0;i<segs.length;i++)html+=this.fillSegHtml(type,segs[i]);$(html).each(function(i,node){var seg=segs[i],el=$(node);segElMethod&&(el=segElMethod.call(_this,seg,el)),el&&(el=$(el),el.is(_this.fillSegTag)&&(seg.el=el,renderedSegs.push(seg)))})}return renderedSegs},fillSegTag:"div",fillSegHtml:function(type,seg){var classesMethod=this[type+"SegClasses"],stylesMethod=this[type+"SegStyles"],classes=classesMethod?classesMethod.call(this,seg):[],styles=stylesMethod?stylesMethod.call(this,seg):"";return"<"+this.fillSegTag+(classes.length?' class="'+classes.join(" ")+'"':"")+(styles?' style="'+styles+'"':"")+" />"},headHtml:function(){return'<div class="fc-row '+this.view.widgetHeaderClass+'"><table><thead>'+this.rowHtml("head")+"</thead></table></div>"},headCellHtml:function(cell){var view=this.view,date=cell.start;return'<th class="fc-day-header '+view.widgetHeaderClass+" fc-"+dayIDs[date.day()]+'">'+htmlEscape(date.format(this.colHeadFormat))+"</th>"},bgCellHtml:function(cell){var view=this.view,date=cell.start,classes=this.getDayClasses(date);return classes.unshift("fc-day",view.widgetContentClass),'<td class="'+classes.join(" ")+'" data-date="'+date.format("YYYY-MM-DD")+'"></td>'},getDayClasses:function(date){var view=this.view,today=view.calendar.getNow().stripTime(),classes=["fc-"+dayIDs[date.day()]];return"month"===view.name&&date.month()!=view.intervalStart.month()&&classes.push("fc-other-month"),date.isSame(today,"day")?classes.push("fc-today",view.highlightStateClass):classes.push(today>date?"fc-past":"fc-future"),classes}});Grid.mixin({mousedOverSeg:null,isDraggingSeg:!1,isResizingSeg:!1,segs:null,renderEvents:function(events){var i,seg,segs=this.eventsToSegs(events),bgSegs=[],fgSegs=[];for(i=0;i<segs.length;i++)seg=segs[i],isBgEvent(seg.event)?bgSegs.push(seg):fgSegs.push(seg);bgSegs=this.renderBgSegs(bgSegs)||bgSegs,fgSegs=this.renderFgSegs(fgSegs)||fgSegs,this.segs=bgSegs.concat(fgSegs)},destroyEvents:function(){this.triggerSegMouseout(),this.destroyFgSegs(),this.destroyBgSegs(),this.segs=null},getEventSegs:function(){return this.segs||[]},renderFgSegs:function(){},destroyFgSegs:function(){},renderFgSegEls:function(segs,disableResizing){var i,view=this.view,html="",renderedSegs=[];if(segs.length){for(i=0;i<segs.length;i++)html+=this.fgSegHtml(segs[i],disableResizing);$(html).each(function(i,node){var seg=segs[i],el=view.resolveEventEl(seg.event,$(node));el&&(el.data("fc-seg",seg),seg.el=el,renderedSegs.push(seg))})}return renderedSegs},fgSegHtml:function(){},renderBgSegs:function(segs){return this.renderFill("bgEvent",segs)},destroyBgSegs:function(){this.destroyFill("bgEvent")},bgEventSegEl:function(seg,el){return this.view.resolveEventEl(seg.event,el)},bgEventSegClasses:function(seg){var event=seg.event,source=event.source||{};return["fc-bgevent"].concat(event.className,source.className||[])},bgEventSegStyles:function(seg){var view=this.view,event=seg.event,source=event.source||{},eventColor=event.color,sourceColor=source.color,optionColor=view.opt("eventColor"),backgroundColor=event.backgroundColor||eventColor||source.backgroundColor||sourceColor||view.opt("eventBackgroundColor")||optionColor;return backgroundColor?"background-color:"+backgroundColor:""},businessHoursSegClasses:function(){return["fc-nonbusiness","fc-bgevent"]},bindSegHandlers:function(){var _this=this,view=this.view;$.each({mouseenter:function(seg,ev){_this.triggerSegMouseover(seg,ev)},mouseleave:function(seg,ev){_this.triggerSegMouseout(seg,ev)},click:function(seg,ev){return view.trigger("eventClick",this,seg.event,ev)},mousedown:function(seg,ev){$(ev.target).is(".fc-resizer")&&view.isEventResizable(seg.event)?_this.segResizeMousedown(seg,ev):view.isEventDraggable(seg.event)&&_this.segDragMousedown(seg,ev)}},function(name,func){_this.el.on(name,".fc-event-container > *",function(ev){var seg=$(this).data("fc-seg");return!seg||_this.isDraggingSeg||_this.isResizingSeg?void 0:func.call(this,seg,ev)})})},triggerSegMouseover:function(seg,ev){this.mousedOverSeg||(this.mousedOverSeg=seg,this.view.trigger("eventMouseover",seg.el[0],seg.event,ev))},triggerSegMouseout:function(seg,ev){ev=ev||{},this.mousedOverSeg&&(seg=seg||this.mousedOverSeg,this.mousedOverSeg=null,this.view.trigger("eventMouseout",seg.el[0],seg.event,ev))},segDragMousedown:function(seg,ev){var dropLocation,_this=this,view=this.view,el=seg.el,event=seg.event,mouseFollower=new MouseFollower(seg.el,{parentEl:view.el,opacity:view.opt("dragOpacity"),revertDuration:view.opt("dragRevertDuration"),zIndex:2}),dragListener=new DragListener(view.coordMap,{distance:5,scroll:view.opt("dragScroll"),listenStart:function(ev){mouseFollower.hide(),mouseFollower.start(ev)},dragStart:function(ev){_this.triggerSegMouseout(seg,ev),_this.isDraggingSeg=!0,view.hideEvent(event),view.trigger("eventDragStart",el[0],event,ev,{})},cellOver:function(cell,isOrig){var origCell=seg.cell||dragListener.origCell;dropLocation=_this.computeEventDrop(origCell,cell,event),dropLocation?(view.renderDrag(dropLocation,seg)?mouseFollower.hide():mouseFollower.show(),isOrig&&(dropLocation=null)):(mouseFollower.show(),disableCursor())},cellOut:function(){dropLocation=null,view.destroyDrag(),mouseFollower.show(),enableCursor()},dragStop:function(ev){mouseFollower.stop(!dropLocation,function(){_this.isDraggingSeg=!1,view.destroyDrag(),view.showEvent(event),view.trigger("eventDragStop",el[0],event,ev,{}),dropLocation&&view.reportEventDrop(event,dropLocation,el,ev)}),enableCursor()},listenStop:function(){mouseFollower.stop()}});dragListener.mousedown(ev)},computeEventDrop:function(startCell,endCell,event){var delta,newStart,newEnd,newAllDay,dropLocation,dragStart=startCell.start,dragEnd=endCell.start;return dragStart.hasTime()===dragEnd.hasTime()?(delta=diffDayTime(dragEnd,dragStart),newStart=event.start.clone().add(delta),newEnd=null===event.end?null:event.end.clone().add(delta),newAllDay=event.allDay):(newStart=dragEnd.clone(),newEnd=null,newAllDay=!dragEnd.hasTime()),dropLocation={start:newStart,end:newEnd,allDay:newAllDay},this.view.calendar.isEventRangeAllowed(dropLocation,event)?dropLocation:null},documentDragStart:function(ev,ui){var el,accept,view=this.view;view.opt("droppable")&&(el=$(ev.target),accept=view.opt("dropAccept"),($.isFunction(accept)?accept.call(el[0],el):el.is(accept))&&this.startExternalDrag(el,ev,ui))},startExternalDrag:function(el,ev){var dragListener,dropLocation,_this=this,meta=getDraggedElMeta(el);dragListener=new DragListener(this.coordMap,{cellOver:function(cell){dropLocation=_this.computeExternalDrop(cell,meta),dropLocation?_this.renderDrag(dropLocation):disableCursor()},cellOut:function(){dropLocation=null,_this.destroyDrag(),enableCursor()}}),$(document).one("dragstop",function(ev,ui){_this.destroyDrag(),enableCursor(),dropLocation&&_this.view.reportExternalDrop(meta,dropLocation,el,ev,ui)}),dragListener.startDrag(ev)},computeExternalDrop:function(cell,meta){var dropLocation={start:cell.start.clone(),end:null};return meta.startTime&&!dropLocation.start.hasTime()&&dropLocation.start.time(meta.startTime),meta.duration&&(dropLocation.end=dropLocation.start.clone().add(meta.duration)),this.view.calendar.isExternalDropRangeAllowed(dropLocation,meta.eventProps)?dropLocation:null},renderDrag:function(){},destroyDrag:function(){},segResizeMousedown:function(seg,ev){function destroy(){_this.destroyEventResize(),view.showEvent(event),enableCursor()}var newEnd,dragListener,_this=this,view=this.view,calendar=view.calendar,el=seg.el,event=seg.event,start=event.start,oldEnd=calendar.getEventEnd(event);dragListener=new DragListener(this.coordMap,{distance:5,scroll:view.opt("dragScroll"),dragStart:function(ev){_this.triggerSegMouseout(seg,ev),_this.isResizingSeg=!0,view.trigger("eventResizeStart",el[0],event,ev,{})},cellOver:function(cell){newEnd=cell.end,newEnd.isAfter(start)||(newEnd=start.clone().add(diffDayTime(cell.end,cell.start))),newEnd.isSame(oldEnd)?newEnd=null:calendar.isEventRangeAllowed({start:start,end:newEnd},event)?(_this.renderEventResize({start:start,end:newEnd},seg),view.hideEvent(event)):(newEnd=null,disableCursor())},cellOut:function(){newEnd=null,destroy()},dragStop:function(ev){_this.isResizingSeg=!1,destroy(),view.trigger("eventResizeStop",el[0],event,ev,{}),newEnd&&view.reportEventResize(event,newEnd,el,ev)}}),dragListener.mousedown(ev)},renderEventResize:function(){},destroyEventResize:function(){},getEventTimeText:function(range,formatStr){return formatStr=formatStr||this.eventTimeFormat,range.end&&this.displayEventEnd?this.view.formatRange(range,formatStr):range.start.format(formatStr)},getSegClasses:function(seg,isDraggable,isResizable){var event=seg.event,classes=["fc-event",seg.isStart?"fc-start":"fc-not-start",seg.isEnd?"fc-end":"fc-not-end"].concat(event.className,event.source?event.source.className:[]);return isDraggable&&classes.push("fc-draggable"),isResizable&&classes.push("fc-resizable"),classes},getEventSkinCss:function(event){var view=this.view,source=event.source||{},eventColor=event.color,sourceColor=source.color,optionColor=view.opt("eventColor"),backgroundColor=event.backgroundColor||eventColor||source.backgroundColor||sourceColor||view.opt("eventBackgroundColor")||optionColor,borderColor=event.borderColor||eventColor||source.borderColor||sourceColor||view.opt("eventBorderColor")||optionColor,textColor=event.textColor||source.textColor||view.opt("eventTextColor"),statements=[];return backgroundColor&&statements.push("background-color:"+backgroundColor),borderColor&&statements.push("border-color:"+borderColor),textColor&&statements.push("color:"+textColor),statements.join(";")},eventsToSegs:function(events,rangeToSegsFunc){var i,eventRanges=this.eventsToRanges(events),segs=[];for(i=0;i<eventRanges.length;i++)segs.push.apply(segs,this.eventRangeToSegs(eventRanges[i],rangeToSegsFunc));return segs},eventsToRanges:function(events){var _this=this,eventsById=groupEventsById(events),ranges=[];return $.each(eventsById,function(id,eventGroup){eventGroup.length&&ranges.push.apply(ranges,isInverseBgEvent(eventGroup[0])?_this.eventsToInverseRanges(eventGroup):_this.eventsToNormalRanges(eventGroup))}),ranges},eventsToNormalRanges:function(events){var i,event,eventStart,eventEnd,calendar=this.view.calendar,ranges=[];for(i=0;i<events.length;i++)event=events[i],eventStart=event.start.clone().stripZone(),eventEnd=calendar.getEventEnd(event).stripZone(),ranges.push({event:event,start:eventStart,end:eventEnd,eventStartMS:+eventStart,eventDurationMS:eventEnd-eventStart});return ranges},eventsToInverseRanges:function(events){var i,normalRange,view=this.view,viewStart=view.start.clone().stripZone(),viewEnd=view.end.clone().stripZone(),normalRanges=this.eventsToNormalRanges(events),inverseRanges=[],event0=events[0],start=viewStart;for(normalRanges.sort(compareNormalRanges),i=0;i<normalRanges.length;i++)normalRange=normalRanges[i],normalRange.start>start&&inverseRanges.push({event:event0,start:start,end:normalRange.start}),start=normalRange.end;return viewEnd>start&&inverseRanges.push({event:event0,start:start,end:viewEnd}),inverseRanges},eventRangeToSegs:function(eventRange,rangeToSegsFunc){var segs,i,seg;for(segs=rangeToSegsFunc?rangeToSegsFunc(eventRange):this.rangeToSegs(eventRange),i=0;i<segs.length;i++)seg=segs[i],seg.event=eventRange.event,seg.eventStartMS=eventRange.eventStartMS,seg.eventDurationMS=eventRange.eventDurationMS;return segs}}),fc.compareSegs=compareSegs,fc.dataAttrPrefix="";var DayGrid=Grid.extend({numbersVisible:!1,bottomCoordPadding:0,breakOnWeeks:null,cellDates:null,dayToCellOffsets:null,rowEls:null,dayEls:null,helperEls:null,render:function(isRigid){var row,i,cell,view=this.view,rowCnt=this.rowCnt,colCnt=this.colCnt,cellCnt=rowCnt*colCnt,html="";for(row=0;rowCnt>row;row++)html+=this.dayRowHtml(row,isRigid);for(this.el.html(html),this.rowEls=this.el.find(".fc-row"),this.dayEls=this.el.find(".fc-day"),i=0;cellCnt>i;i++)cell=this.getCell(i),view.trigger("dayRender",null,cell.start,this.dayEls.eq(i));Grid.prototype.render.call(this)},destroy:function(){this.destroySegPopover(),Grid.prototype.destroy.call(this)},dayRowHtml:function(row,isRigid){var view=this.view,classes=["fc-row","fc-week",view.widgetContentClass];return isRigid&&classes.push("fc-rigid"),'<div class="'+classes.join(" ")+'"><div class="fc-bg"><table>'+this.rowHtml("day",row)+'</table></div><div class="fc-content-skeleton"><table>'+(this.numbersVisible?"<thead>"+this.rowHtml("number",row)+"</thead>":"")+"</table></div></div>"},dayCellHtml:function(cell){return this.bgCellHtml(cell)},computeColHeadFormat:function(){return this.rowCnt>1?"ddd":this.colCnt>1?this.view.opt("dayOfMonthFormat"):"dddd"},computeEventTimeFormat:function(){return this.view.opt("extraSmallTimeFormat")
},computeDisplayEventEnd:function(){return 1==this.colCnt},updateCells:function(){var cellDates,firstDay,rowCnt,colCnt;if(this.updateCellDates(),cellDates=this.cellDates,this.breakOnWeeks){for(firstDay=cellDates[0].day(),colCnt=1;colCnt<cellDates.length&&cellDates[colCnt].day()!=firstDay;colCnt++);rowCnt=Math.ceil(cellDates.length/colCnt)}else rowCnt=1,colCnt=cellDates.length;this.rowCnt=rowCnt,this.colCnt=colCnt},updateCellDates:function(){for(var view=this.view,date=this.start.clone(),dates=[],offset=-1,offsets=[];date.isBefore(this.end);)view.isHiddenDay(date)?offsets.push(offset+.5):(offset++,offsets.push(offset),dates.push(date.clone())),date.add(1,"days");this.cellDates=dates,this.dayToCellOffsets=offsets},computeCellRange:function(cell){var colCnt=this.colCnt,index=cell.row*colCnt+(this.isRTL?colCnt-cell.col-1:cell.col),start=this.cellDates[index].clone(),end=start.clone().add(1,"day");return{start:start,end:end}},getRowEl:function(row){return this.rowEls.eq(row)},getColEl:function(col){return this.dayEls.eq(col)},getCellDayEl:function(cell){return this.dayEls.eq(cell.row*this.colCnt+cell.col)},computeRowCoords:function(){var rowCoords=Grid.prototype.computeRowCoords.call(this);return rowCoords[rowCoords.length-1].bottom+=this.bottomCoordPadding,rowCoords},rangeToSegs:function(range){var first,last,row,rowFirst,rowLast,isStart,isEnd,segFirst,segLast,seg,isRTL=this.isRTL,rowCnt=this.rowCnt,colCnt=this.colCnt,segs=[];for(range=this.view.computeDayRange(range),first=this.dateToCellOffset(range.start),last=this.dateToCellOffset(range.end.subtract(1,"days")),row=0;rowCnt>row;row++)rowFirst=row*colCnt,rowLast=rowFirst+colCnt-1,segFirst=Math.max(rowFirst,first),segLast=Math.min(rowLast,last),segFirst=Math.ceil(segFirst),segLast=Math.floor(segLast),segLast>=segFirst&&(isStart=segFirst===first,isEnd=segLast===last,segFirst-=rowFirst,segLast-=rowFirst,seg={row:row,isStart:isStart,isEnd:isEnd},isRTL?(seg.leftCol=colCnt-segLast-1,seg.rightCol=colCnt-segFirst-1):(seg.leftCol=segFirst,seg.rightCol=segLast),segs.push(seg));return segs},dateToCellOffset:function(date){var offsets=this.dayToCellOffsets,day=date.diff(this.start,"days");return 0>day?offsets[0]-1:day>=offsets.length?offsets[offsets.length-1]+1:offsets[day]},renderDrag:function(dropLocation,seg){var opacity;return this.renderHighlight(this.view.calendar.ensureVisibleEventRange(dropLocation)),seg&&!seg.el.closest(this.el).length?(this.renderRangeHelper(dropLocation,seg),opacity=this.view.opt("dragOpacity"),void 0!==opacity&&this.helperEls.css("opacity",opacity),!0):void 0},destroyDrag:function(){this.destroyHighlight(),this.destroyHelper()},renderEventResize:function(range,seg){this.renderHighlight(range),this.renderRangeHelper(range,seg)},destroyEventResize:function(){this.destroyHighlight(),this.destroyHelper()},renderHelper:function(event,sourceSeg){var rowStructs,helperNodes=[],segs=this.eventsToSegs([event]);segs=this.renderFgSegEls(segs),rowStructs=this.renderSegRows(segs),this.rowEls.each(function(row,rowNode){var skeletonTop,rowEl=$(rowNode),skeletonEl=$('<div class="fc-helper-skeleton"><table/></div>');skeletonTop=sourceSeg&&sourceSeg.row===row?sourceSeg.el.position().top:rowEl.find(".fc-content-skeleton tbody").position().top,skeletonEl.css("top",skeletonTop).find("table").append(rowStructs[row].tbodyEl),rowEl.append(skeletonEl),helperNodes.push(skeletonEl[0])}),this.helperEls=$(helperNodes)},destroyHelper:function(){this.helperEls&&(this.helperEls.remove(),this.helperEls=null)},fillSegTag:"td",renderFill:function(type,segs){var i,seg,skeletonEl,nodes=[];for(segs=this.renderFillSegEls(type,segs),i=0;i<segs.length;i++)seg=segs[i],skeletonEl=this.renderFillRow(type,seg),this.rowEls.eq(seg.row).append(skeletonEl),nodes.push(skeletonEl[0]);return this.elsByFill[type]=$(nodes),segs},renderFillRow:function(type,seg){var skeletonEl,trEl,colCnt=this.colCnt,startCol=seg.leftCol,endCol=seg.rightCol+1;return skeletonEl=$('<div class="fc-'+type.toLowerCase()+'-skeleton"><table><tr/></table></div>'),trEl=skeletonEl.find("tr"),startCol>0&&trEl.append('<td colspan="'+startCol+'"/>'),trEl.append(seg.el.attr("colspan",endCol-startCol)),colCnt>endCol&&trEl.append('<td colspan="'+(colCnt-endCol)+'"/>'),this.bookendCells(trEl,type),skeletonEl}});DayGrid.mixin({rowStructs:null,destroyEvents:function(){this.destroySegPopover(),Grid.prototype.destroyEvents.apply(this,arguments)},getEventSegs:function(){return Grid.prototype.getEventSegs.call(this).concat(this.popoverSegs||[])},renderBgSegs:function(segs){var allDaySegs=$.grep(segs,function(seg){return seg.event.allDay});return Grid.prototype.renderBgSegs.call(this,allDaySegs)},renderFgSegs:function(segs){var rowStructs;return segs=this.renderFgSegEls(segs),rowStructs=this.rowStructs=this.renderSegRows(segs),this.rowEls.each(function(i,rowNode){$(rowNode).find(".fc-content-skeleton > table").append(rowStructs[i].tbodyEl)}),segs},destroyFgSegs:function(){for(var rowStruct,rowStructs=this.rowStructs||[];rowStruct=rowStructs.pop();)rowStruct.tbodyEl.remove();this.rowStructs=null},renderSegRows:function(segs){var segRows,row,rowStructs=[];for(segRows=this.groupSegRows(segs),row=0;row<segRows.length;row++)rowStructs.push(this.renderSegRow(row,segRows[row]));return rowStructs},fgSegHtml:function(seg,disableResizing){var titleHtml,view=this.view,event=seg.event,isDraggable=view.isEventDraggable(event),isResizable=!disableResizing&&event.allDay&&seg.isEnd&&view.isEventResizable(event),classes=this.getSegClasses(seg,isDraggable,isResizable),skinCss=this.getEventSkinCss(event),timeHtml="";return classes.unshift("fc-day-grid-event"),!event.allDay&&seg.isStart&&(timeHtml='<span class="fc-time">'+htmlEscape(this.getEventTimeText(event))+"</span>"),titleHtml='<span class="fc-title">'+(htmlEscape(event.title||"")||"&nbsp;")+"</span>",'<a class="'+classes.join(" ")+'"'+(event.url?' href="'+htmlEscape(event.url)+'"':"")+(skinCss?' style="'+skinCss+'"':"")+'><div class="fc-content">'+(this.isRTL?titleHtml+" "+timeHtml:timeHtml+" "+titleHtml)+"</div>"+(isResizable?'<div class="fc-resizer"/>':"")+"</a>"},renderSegRow:function(row,rowSegs){function emptyCellsUntil(endCol){for(;endCol>col;)td=(loneCellMatrix[i-1]||[])[col],td?td.attr("rowspan",parseInt(td.attr("rowspan")||1,10)+1):(td=$("<td/>"),tr.append(td)),cellMatrix[i][col]=td,loneCellMatrix[i][col]=td,col++}var i,levelSegs,col,tr,j,seg,td,colCnt=this.colCnt,segLevels=this.buildSegLevels(rowSegs),levelCnt=Math.max(1,segLevels.length),tbody=$("<tbody/>"),segMatrix=[],cellMatrix=[],loneCellMatrix=[];for(i=0;levelCnt>i;i++){if(levelSegs=segLevels[i],col=0,tr=$("<tr/>"),segMatrix.push([]),cellMatrix.push([]),loneCellMatrix.push([]),levelSegs)for(j=0;j<levelSegs.length;j++){for(seg=levelSegs[j],emptyCellsUntil(seg.leftCol),td=$('<td class="fc-event-container"/>').append(seg.el),seg.leftCol!=seg.rightCol?td.attr("colspan",seg.rightCol-seg.leftCol+1):loneCellMatrix[i][col]=td;col<=seg.rightCol;)cellMatrix[i][col]=td,segMatrix[i][col]=seg,col++;tr.append(td)}emptyCellsUntil(colCnt),this.bookendCells(tr,"eventSkeleton"),tbody.append(tr)}return{row:row,tbodyEl:tbody,cellMatrix:cellMatrix,segMatrix:segMatrix,segLevels:segLevels,segs:rowSegs}},buildSegLevels:function(segs){var i,seg,j,levels=[];for(segs.sort(compareSegs),i=0;i<segs.length;i++){for(seg=segs[i],j=0;j<levels.length&&isDaySegCollision(seg,levels[j]);j++);seg.level=j,(levels[j]||(levels[j]=[])).push(seg)}for(j=0;j<levels.length;j++)levels[j].sort(compareDaySegCols);return levels},groupSegRows:function(segs){var i,segRows=[];for(i=0;i<this.rowCnt;i++)segRows.push([]);for(i=0;i<segs.length;i++)segRows[segs[i].row].push(segs[i]);return segRows}}),DayGrid.mixin({segPopover:null,popoverSegs:null,destroySegPopover:function(){this.segPopover&&this.segPopover.hide()},limitRows:function(levelLimit){var row,rowLevelLimit,rowStructs=this.rowStructs||[];for(row=0;row<rowStructs.length;row++)this.unlimitRow(row),rowLevelLimit=levelLimit?"number"==typeof levelLimit?levelLimit:this.computeRowLevelLimit(row):!1,rowLevelLimit!==!1&&this.limitRow(row,rowLevelLimit)},computeRowLevelLimit:function(row){var i,trEl,rowEl=this.rowEls.eq(row),rowHeight=rowEl.height(),trEls=this.rowStructs[row].tbodyEl.children();for(i=0;i<trEls.length;i++)if(trEl=trEls.eq(i).removeClass("fc-limited"),trEl.position().top+trEl.outerHeight()>rowHeight)return i;return!1},limitRow:function(row,levelLimit){function emptyCellsUntil(endCol){for(;endCol>col;)cell=_this.getCell(row,col),segsBelow=_this.getCellSegs(cell,levelLimit),segsBelow.length&&(td=cellMatrix[levelLimit-1][col],moreLink=_this.renderMoreLink(cell,segsBelow),moreWrap=$("<div/>").append(moreLink),td.append(moreWrap),moreNodes.push(moreWrap[0])),col++}var cell,levelSegs,cellMatrix,limitedNodes,i,seg,segsBelow,totalSegsBelow,colSegsBelow,td,rowspan,segMoreNodes,j,moreTd,moreWrap,moreLink,_this=this,rowStruct=this.rowStructs[row],moreNodes=[],col=0;if(levelLimit&&levelLimit<rowStruct.segLevels.length){for(levelSegs=rowStruct.segLevels[levelLimit-1],cellMatrix=rowStruct.cellMatrix,limitedNodes=rowStruct.tbodyEl.children().slice(levelLimit).addClass("fc-limited").get(),i=0;i<levelSegs.length;i++){for(seg=levelSegs[i],emptyCellsUntil(seg.leftCol),colSegsBelow=[],totalSegsBelow=0;col<=seg.rightCol;)cell=this.getCell(row,col),segsBelow=this.getCellSegs(cell,levelLimit),colSegsBelow.push(segsBelow),totalSegsBelow+=segsBelow.length,col++;if(totalSegsBelow){for(td=cellMatrix[levelLimit-1][seg.leftCol],rowspan=td.attr("rowspan")||1,segMoreNodes=[],j=0;j<colSegsBelow.length;j++)moreTd=$('<td class="fc-more-cell"/>').attr("rowspan",rowspan),segsBelow=colSegsBelow[j],cell=this.getCell(row,seg.leftCol+j),moreLink=this.renderMoreLink(cell,[seg].concat(segsBelow)),moreWrap=$("<div/>").append(moreLink),moreTd.append(moreWrap),segMoreNodes.push(moreTd[0]),moreNodes.push(moreTd[0]);td.addClass("fc-limited").after($(segMoreNodes)),limitedNodes.push(td[0])}}emptyCellsUntil(this.colCnt),rowStruct.moreEls=$(moreNodes),rowStruct.limitedEls=$(limitedNodes)}},unlimitRow:function(row){var rowStruct=this.rowStructs[row];rowStruct.moreEls&&(rowStruct.moreEls.remove(),rowStruct.moreEls=null),rowStruct.limitedEls&&(rowStruct.limitedEls.removeClass("fc-limited"),rowStruct.limitedEls=null)},renderMoreLink:function(cell,hiddenSegs){var _this=this,view=this.view;return $('<a class="fc-more"/>').text(this.getMoreLinkText(hiddenSegs.length)).on("click",function(ev){var clickOption=view.opt("eventLimitClick"),date=cell.start,moreEl=$(this),dayEl=_this.getCellDayEl(cell),allSegs=_this.getCellSegs(cell),reslicedAllSegs=_this.resliceDaySegs(allSegs,date),reslicedHiddenSegs=_this.resliceDaySegs(hiddenSegs,date);"function"==typeof clickOption&&(clickOption=view.trigger("eventLimitClick",null,{date:date,dayEl:dayEl,moreEl:moreEl,segs:reslicedAllSegs,hiddenSegs:reslicedHiddenSegs},ev)),"popover"===clickOption?_this.showSegPopover(cell,moreEl,reslicedAllSegs):"string"==typeof clickOption&&view.calendar.zoomTo(date,clickOption)})},showSegPopover:function(cell,moreLink,segs){var topEl,options,_this=this,view=this.view,moreWrap=moreLink.parent();topEl=1==this.rowCnt?view.el:this.rowEls.eq(cell.row),options={className:"fc-more-popover",content:this.renderSegPopoverContent(cell,segs),parentEl:this.el,top:topEl.offset().top,autoHide:!0,viewportConstrain:view.opt("popoverViewportConstrain"),hide:function(){_this.segPopover.destroy(),_this.segPopover=null,_this.popoverSegs=null}},this.isRTL?options.right=moreWrap.offset().left+moreWrap.outerWidth()+1:options.left=moreWrap.offset().left-1,this.segPopover=new Popover(options),this.segPopover.show()},renderSegPopoverContent:function(cell,segs){var i,view=this.view,isTheme=view.opt("theme"),title=cell.start.format(view.opt("dayPopoverFormat")),content=$('<div class="fc-header '+view.widgetHeaderClass+'"><span class="fc-close '+(isTheme?"ui-icon ui-icon-closethick":"fc-icon fc-icon-x")+'"></span><span class="fc-title">'+htmlEscape(title)+'</span><div class="fc-clear"/></div><div class="fc-body '+view.widgetContentClass+'"><div class="fc-event-container"></div></div>'),segContainer=content.find(".fc-event-container");for(segs=this.renderFgSegEls(segs,!0),this.popoverSegs=segs,i=0;i<segs.length;i++)segs[i].cell=cell,segContainer.append(segs[i].el);return content},resliceDaySegs:function(segs,dayDate){var events=$.map(segs,function(seg){return seg.event}),dayStart=dayDate.clone().stripTime(),dayEnd=dayStart.clone().add(1,"days"),dayRange={start:dayStart,end:dayEnd};return this.eventsToSegs(events,function(range){var seg=intersectionToSeg(range,dayRange);return seg?[seg]:[]})},getMoreLinkText:function(num){var opt=this.view.opt("eventLimitText");return"function"==typeof opt?opt(num):"+"+num+" "+opt},getCellSegs:function(cell,startLevel){for(var seg,segMatrix=this.rowStructs[cell.row].segMatrix,level=startLevel||0,segs=[];level<segMatrix.length;)seg=segMatrix[level][cell.col],seg&&segs.push(seg),level++;return segs}});var TimeGrid=Grid.extend({slotDuration:null,snapDuration:null,minTime:null,maxTime:null,axisFormat:null,dayEls:null,slatEls:null,slatTops:null,helperEl:null,businessHourSegs:null,constructor:function(){Grid.apply(this,arguments),this.processOptions()},render:function(){this.el.html(this.renderHtml()),this.dayEls=this.el.find(".fc-day"),this.slatEls=this.el.find(".fc-slats tr"),this.computeSlatTops(),this.renderBusinessHours(),Grid.prototype.render.call(this)},renderBusinessHours:function(){var events=this.view.calendar.getBusinessHoursEvents();this.businessHourSegs=this.renderFill("businessHours",this.eventsToSegs(events),"bgevent")},renderHtml:function(){return'<div class="fc-bg"><table>'+this.rowHtml("slotBg")+'</table></div><div class="fc-slats"><table>'+this.slatRowHtml()+"</table></div>"},slotBgCellHtml:function(cell){return this.bgCellHtml(cell)},slatRowHtml:function(){for(var slotDate,minutes,axisHtml,view=this.view,isRTL=this.isRTL,html="",slotNormal=this.slotDuration.asMinutes()%15===0,slotTime=moment.duration(+this.minTime);slotTime<this.maxTime;)slotDate=this.start.clone().time(slotTime),minutes=slotDate.minutes(),axisHtml='<td class="fc-axis fc-time '+view.widgetContentClass+'" '+view.axisStyleAttr()+">"+(slotNormal&&minutes?"":"<span>"+htmlEscape(slotDate.format(this.axisFormat))+"</span>")+"</td>",html+="<tr "+(minutes?'class="fc-minor"':"")+">"+(isRTL?"":axisHtml)+'<td class="'+view.widgetContentClass+'"/>'+(isRTL?axisHtml:"")+"</tr>",slotTime.add(this.slotDuration);return html},processOptions:function(){var view=this.view,slotDuration=view.opt("slotDuration"),snapDuration=view.opt("snapDuration");slotDuration=moment.duration(slotDuration),snapDuration=snapDuration?moment.duration(snapDuration):slotDuration,this.slotDuration=slotDuration,this.snapDuration=snapDuration,this.minTime=moment.duration(view.opt("minTime")),this.maxTime=moment.duration(view.opt("maxTime")),this.axisFormat=view.opt("axisFormat")||view.opt("smallTimeFormat")},computeColHeadFormat:function(){return this.colCnt>1?this.view.opt("dayOfMonthFormat"):"dddd"},computeEventTimeFormat:function(){return this.view.opt("noMeridiemTimeFormat")},computeDisplayEventEnd:function(){return!0},updateCells:function(){var date,view=this.view,colData=[];for(date=this.start.clone();date.isBefore(this.end);)colData.push({day:date.clone()}),date.add(1,"day"),date=view.skipHiddenDays(date);this.isRTL&&colData.reverse(),this.colData=colData,this.colCnt=colData.length,this.rowCnt=Math.ceil((this.maxTime-this.minTime)/this.snapDuration)},computeCellRange:function(cell){var time=this.computeSnapTime(cell.row),start=this.view.calendar.rezoneDate(cell.day).time(time),end=start.clone().add(this.snapDuration);return{start:start,end:end}},getColEl:function(col){return this.dayEls.eq(col)},computeSnapTime:function(row){return moment.duration(this.minTime+this.snapDuration*row)},rangeToSegs:function(range){var seg,col,colDate,colRange,colCnt=this.colCnt,segs=[];for(range={start:range.start.clone().stripZone(),end:range.end.clone().stripZone()},col=0;colCnt>col;col++)colDate=this.colData[col].day,colRange={start:colDate.clone().time(this.minTime),end:colDate.clone().time(this.maxTime)},seg=intersectionToSeg(range,colRange),seg&&(seg.col=col,segs.push(seg));return segs},resize:function(){this.computeSlatTops(),this.updateSegVerticals()},computeRowCoords:function(){var i,item,originTop=this.el.offset().top,items=[];for(i=0;i<this.rowCnt;i++)item={top:originTop+this.computeTimeTop(this.computeSnapTime(i))},i>0&&(items[i-1].bottom=item.top),items.push(item);return item.bottom=item.top+this.computeTimeTop(this.computeSnapTime(i)),items},computeDateTop:function(date,startOfDayDate){return this.computeTimeTop(moment.duration(date.clone().stripZone()-startOfDayDate.clone().stripTime()))},computeTimeTop:function(time){var slatIndex,slatRemainder,slatTop,slatBottom,slatCoverage=(time-this.minTime)/this.slotDuration;return slatCoverage=Math.max(0,slatCoverage),slatCoverage=Math.min(this.slatEls.length,slatCoverage),slatIndex=Math.floor(slatCoverage),slatRemainder=slatCoverage-slatIndex,slatTop=this.slatTops[slatIndex],slatRemainder?(slatBottom=this.slatTops[slatIndex+1],slatTop+(slatBottom-slatTop)*slatRemainder):slatTop},computeSlatTops:function(){var top,tops=[];this.slatEls.each(function(i,node){top=$(node).position().top,tops.push(top)}),tops.push(top+this.slatEls.last().outerHeight()),this.slatTops=tops},renderDrag:function(dropLocation,seg){var opacity;return seg?(this.renderRangeHelper(dropLocation,seg),opacity=this.view.opt("dragOpacity"),void 0!==opacity&&this.helperEl.css("opacity",opacity),!0):void this.renderHighlight(this.view.calendar.ensureVisibleEventRange(dropLocation))},destroyDrag:function(){this.destroyHelper(),this.destroyHighlight()},renderEventResize:function(range,seg){this.renderRangeHelper(range,seg)},destroyEventResize:function(){this.destroyHelper()},renderHelper:function(event,sourceSeg){var tableEl,i,seg,sourceEl,segs=this.eventsToSegs([event]);for(segs=this.renderFgSegEls(segs),tableEl=this.renderSegTable(segs),i=0;i<segs.length;i++)seg=segs[i],sourceSeg&&sourceSeg.col===seg.col&&(sourceEl=sourceSeg.el,seg.el.css({left:sourceEl.css("left"),right:sourceEl.css("right"),"margin-left":sourceEl.css("margin-left"),"margin-right":sourceEl.css("margin-right")}));this.helperEl=$('<div class="fc-helper-skeleton"/>').append(tableEl).appendTo(this.el)},destroyHelper:function(){this.helperEl&&(this.helperEl.remove(),this.helperEl=null)},renderSelection:function(range){this.view.opt("selectHelper")?this.renderRangeHelper(range):this.renderHighlight(range)},destroySelection:function(){this.destroyHelper(),this.destroyHighlight()},renderFill:function(type,segs,className){var segCols,skeletonEl,trEl,col,colSegs,tdEl,containerEl,dayDate,i,seg;if(segs.length){for(segs=this.renderFillSegEls(type,segs),segCols=this.groupSegCols(segs),className=className||type.toLowerCase(),skeletonEl=$('<div class="fc-'+className+'-skeleton"><table><tr/></table></div>'),trEl=skeletonEl.find("tr"),col=0;col<segCols.length;col++)if(colSegs=segCols[col],tdEl=$("<td/>").appendTo(trEl),colSegs.length)for(containerEl=$('<div class="fc-'+className+'-container"/>').appendTo(tdEl),dayDate=this.colData[col].day,i=0;i<colSegs.length;i++)seg=colSegs[i],containerEl.append(seg.el.css({top:this.computeDateTop(seg.start,dayDate),bottom:-this.computeDateTop(seg.end,dayDate)}));this.bookendCells(trEl,type),this.el.append(skeletonEl),this.elsByFill[type]=skeletonEl}return segs}});TimeGrid.mixin({eventSkeletonEl:null,renderFgSegs:function(segs){return segs=this.renderFgSegEls(segs),this.el.append(this.eventSkeletonEl=$('<div class="fc-content-skeleton"/>').append(this.renderSegTable(segs))),segs},destroyFgSegs:function(){this.eventSkeletonEl&&(this.eventSkeletonEl.remove(),this.eventSkeletonEl=null)},renderSegTable:function(segs){var segCols,i,seg,col,colSegs,containerEl,tableEl=$("<table><tr/></table>"),trEl=tableEl.find("tr");for(segCols=this.groupSegCols(segs),this.computeSegVerticals(segs),col=0;col<segCols.length;col++){for(colSegs=segCols[col],placeSlotSegs(colSegs),containerEl=$('<div class="fc-event-container"/>'),i=0;i<colSegs.length;i++)seg=colSegs[i],seg.el.css(this.generateSegPositionCss(seg)),seg.bottom-seg.top<30&&seg.el.addClass("fc-short"),containerEl.append(seg.el);trEl.append($("<td/>").append(containerEl))}return this.bookendCells(trEl,"eventSkeleton"),tableEl},updateSegVerticals:function(){var i,allSegs=(this.segs||[]).concat(this.businessHourSegs||[]);for(this.computeSegVerticals(allSegs),i=0;i<allSegs.length;i++)allSegs[i].el.css(this.generateSegVerticalCss(allSegs[i]))},computeSegVerticals:function(segs){var i,seg;for(i=0;i<segs.length;i++)seg=segs[i],seg.top=this.computeDateTop(seg.start,seg.start),seg.bottom=this.computeDateTop(seg.end,seg.start)},fgSegHtml:function(seg,disableResizing){var timeText,fullTimeText,startTimeText,view=this.view,event=seg.event,isDraggable=view.isEventDraggable(event),isResizable=!disableResizing&&seg.isEnd&&view.isEventResizable(event),classes=this.getSegClasses(seg,isDraggable,isResizable),skinCss=this.getEventSkinCss(event);return classes.unshift("fc-time-grid-event"),view.isMultiDayEvent(event)?(seg.isStart||seg.isEnd)&&(timeText=this.getEventTimeText(seg),fullTimeText=this.getEventTimeText(seg,"LT"),startTimeText=this.getEventTimeText({start:seg.start})):(timeText=this.getEventTimeText(event),fullTimeText=this.getEventTimeText(event,"LT"),startTimeText=this.getEventTimeText({start:event.start})),'<a class="'+classes.join(" ")+'"'+(event.url?' href="'+htmlEscape(event.url)+'"':"")+(skinCss?' style="'+skinCss+'"':"")+'><div class="fc-content">'+(timeText?'<div class="fc-time" data-start="'+htmlEscape(startTimeText)+'" data-full="'+htmlEscape(fullTimeText)+'"><span>'+htmlEscape(timeText)+"</span></div>":"")+(event.title?'<div class="fc-title">'+htmlEscape(event.title)+"</div>":"")+'</div><div class="fc-bg"/>'+(isResizable?'<div class="fc-resizer"/>':"")+"</a>"},generateSegPositionCss:function(seg){var left,right,shouldOverlap=this.view.opt("slotEventOverlap"),backwardCoord=seg.backwardCoord,forwardCoord=seg.forwardCoord,props=this.generateSegVerticalCss(seg);return shouldOverlap&&(forwardCoord=Math.min(1,backwardCoord+2*(forwardCoord-backwardCoord))),this.isRTL?(left=1-forwardCoord,right=backwardCoord):(left=backwardCoord,right=1-forwardCoord),props.zIndex=seg.level+1,props.left=100*left+"%",props.right=100*right+"%",shouldOverlap&&seg.forwardPressure&&(props[this.isRTL?"marginLeft":"marginRight"]=20),props},generateSegVerticalCss:function(seg){return{top:seg.top,bottom:-seg.bottom}},groupSegCols:function(segs){var i,segCols=[];for(i=0;i<this.colCnt;i++)segCols.push([]);for(i=0;i<segs.length;i++)segCols[segs[i].col].push(segs[i]);return segCols}});var View=fc.View=Class.extend({type:null,name:null,title:null,calendar:null,options:null,coordMap:null,el:null,start:null,end:null,intervalStart:null,intervalEnd:null,intervalDuration:null,intervalUnit:null,isSelected:!1,scrollerEl:null,scrollTop:null,widgetHeaderClass:null,widgetContentClass:null,highlightStateClass:null,nextDayThreshold:null,isHiddenDayHash:null,documentMousedownProxy:null,constructor:function(calendar,viewOptions,viewType){this.calendar=calendar,this.options=viewOptions,this.type=this.name=viewType,this.nextDayThreshold=moment.duration(this.opt("nextDayThreshold")),this.initTheming(),this.initHiddenDays(),this.documentMousedownProxy=$.proxy(this,"documentMousedown"),this.initialize()},initialize:function(){},opt:function(name){var val;return val=this.options[name],void 0!==val?val:(val=this.calendar.options[name],$.isPlainObject(val)&&!isForcedAtomicOption(name)?smartProperty(val,this.type):val)},trigger:function(name,thisObj){var calendar=this.calendar;return calendar.trigger.apply(calendar,[name,thisObj||this].concat(Array.prototype.slice.call(arguments,2),[this]))},setDate:function(date){this.setRange(this.computeRange(date))},setRange:function(range){$.extend(this,range)},computeRange:function(date){var start,end,intervalDuration=moment.duration(this.opt("duration")||this.constructor.duration||{days:1}),intervalUnit=computeIntervalUnit(intervalDuration),intervalStart=date.clone().startOf(intervalUnit),intervalEnd=intervalStart.clone().add(intervalDuration);return computeIntervalAs("days",intervalDuration)?(intervalStart.stripTime(),intervalEnd.stripTime()):(intervalStart.hasTime()||(intervalStart=this.calendar.rezoneDate(intervalStart)),intervalEnd.hasTime()||(intervalEnd=this.calendar.rezoneDate(intervalEnd))),start=intervalStart.clone(),start=this.skipHiddenDays(start),end=intervalEnd.clone(),end=this.skipHiddenDays(end,-1,!0),{intervalDuration:intervalDuration,intervalUnit:intervalUnit,intervalStart:intervalStart,intervalEnd:intervalEnd,start:start,end:end}},computePrevDate:function(date){return this.massageCurrentDate(date.clone().startOf(this.intervalUnit).subtract(this.intervalDuration),-1)},computeNextDate:function(date){return this.massageCurrentDate(date.clone().startOf(this.intervalUnit).add(this.intervalDuration))},massageCurrentDate:function(date,direction){return this.intervalDuration<=moment.duration({days:1})&&this.isHiddenDay(date)&&(date=this.skipHiddenDays(date,direction),date.startOf("day")),date},updateTitle:function(){this.title=this.computeTitle()},computeTitle:function(){return this.formatRange({start:this.intervalStart,end:this.intervalEnd},this.opt("titleFormat")||this.computeTitleFormat(),this.opt("titleRangeSeparator"))},computeTitleFormat:function(){return"year"==this.intervalUnit?"YYYY":"month"==this.intervalUnit?this.opt("monthYearFormat"):this.intervalDuration.as("days")>1?"ll":"LL"},formatRange:function(range,formatStr,separator){var end=range.end;return end.hasTime()||(end=end.clone().subtract(1)),formatRange(range.start,end,formatStr,separator,this.opt("isRTL"))},renderView:function(){this.render(),this.updateSize(),this.initializeScroll(),this.trigger("viewRender",this,this,this.el),$(document).on("mousedown",this.documentMousedownProxy)},render:function(){},destroyView:function(){this.unselect(),this.destroyViewEvents(),this.destroy(),this.trigger("viewDestroy",this,this,this.el),$(document).off("mousedown",this.documentMousedownProxy)},destroy:function(){this.el.empty()},initTheming:function(){var tm=this.opt("theme")?"ui":"fc";this.widgetHeaderClass=tm+"-widget-header",this.widgetContentClass=tm+"-widget-content",this.highlightStateClass=tm+"-state-highlight"},updateSize:function(isResize){isResize&&this.recordScroll(),this.updateHeight(),this.updateWidth()},updateWidth:function(){},updateHeight:function(){var calendar=this.calendar;this.setHeight(calendar.getSuggestedViewHeight(),calendar.isHeightAuto())},setHeight:function(){},computeScrollerHeight:function(totalHeight,scrollerEl){var both,otherHeight;return scrollerEl=scrollerEl||this.scrollerEl,both=this.el.add(scrollerEl),both.css({position:"relative",left:-1}),otherHeight=this.el.outerHeight()-scrollerEl.height(),both.css({position:"",left:""}),totalHeight-otherHeight},initializeScroll:function(){},recordScroll:function(){this.scrollerEl&&(this.scrollTop=this.scrollerEl.scrollTop())},restoreScroll:function(){null!==this.scrollTop&&this.scrollerEl.scrollTop(this.scrollTop)},renderViewEvents:function(events){this.renderEvents(events),this.eventSegEach(function(seg){this.trigger("eventAfterRender",seg.event,seg.event,seg.el)}),this.trigger("eventAfterAllRender")},renderEvents:function(){},destroyViewEvents:function(){this.eventSegEach(function(seg){this.trigger("eventDestroy",seg.event,seg.event,seg.el)}),this.destroyEvents()},destroyEvents:function(){},resolveEventEl:function(event,el){var custom=this.trigger("eventRender",event,event,el);return custom===!1?el=null:custom&&custom!==!0&&(el=$(custom)),el},showEvent:function(event){this.eventSegEach(function(seg){seg.el.css("visibility","")},event)},hideEvent:function(event){this.eventSegEach(function(seg){seg.el.css("visibility","hidden")},event)},eventSegEach:function(func,event){var i,segs=this.getEventSegs();for(i=0;i<segs.length;i++)event&&segs[i].event._id!==event._id||func.call(this,segs[i])},getEventSegs:function(){return[]},isEventDraggable:function(event){var source=event.source||{};return firstDefined(event.startEditable,source.startEditable,this.opt("eventStartEditable"),event.editable,source.editable,this.opt("editable"))},reportEventDrop:function(event,dropLocation,el,ev){var calendar=this.calendar,mutateResult=calendar.mutateEvent(event,dropLocation),undoFunc=function(){mutateResult.undo(),calendar.reportEventChange()};this.triggerEventDrop(event,mutateResult.dateDelta,undoFunc,el,ev),calendar.reportEventChange()},triggerEventDrop:function(event,dateDelta,undoFunc,el,ev){this.trigger("eventDrop",el[0],event,dateDelta,undoFunc,ev,{})},reportExternalDrop:function(meta,dropLocation,el,ev,ui){var eventInput,event,eventProps=meta.eventProps;eventProps&&(eventInput=$.extend({},eventProps,dropLocation),event=this.calendar.renderEvent(eventInput,meta.stick)[0]),this.triggerExternalDrop(event,dropLocation,el,ev,ui)},triggerExternalDrop:function(event,dropLocation,el,ev,ui){this.trigger("drop",el[0],dropLocation.start,ev,ui),event&&this.trigger("eventReceive",null,event)},renderDrag:function(){},destroyDrag:function(){},isEventResizable:function(event){var source=event.source||{};return firstDefined(event.durationEditable,source.durationEditable,this.opt("eventDurationEditable"),event.editable,source.editable,this.opt("editable"))},reportEventResize:function(event,newEnd,el,ev){var calendar=this.calendar,mutateResult=calendar.mutateEvent(event,{end:newEnd}),undoFunc=function(){mutateResult.undo(),calendar.reportEventChange()};this.triggerEventResize(event,mutateResult.durationDelta,undoFunc,el,ev),calendar.reportEventChange()},triggerEventResize:function(event,durationDelta,undoFunc,el,ev){this.trigger("eventResize",el[0],event,durationDelta,undoFunc,ev,{})},select:function(range,ev){this.unselect(ev),this.renderSelection(range),this.reportSelection(range,ev)},renderSelection:function(){},reportSelection:function(range,ev){this.isSelected=!0,this.trigger("select",null,range.start,range.end,ev)},unselect:function(ev){this.isSelected&&(this.isSelected=!1,this.destroySelection(),this.trigger("unselect",null,ev))},destroySelection:function(){},documentMousedown:function(ev){var ignore;this.isSelected&&this.opt("unselectAuto")&&isPrimaryMouseButton(ev)&&(ignore=this.opt("unselectCancel"),ignore&&$(ev.target).closest(ignore).length||this.unselect(ev))},initHiddenDays:function(){var i,hiddenDays=this.opt("hiddenDays")||[],isHiddenDayHash=[],dayCnt=0;for(this.opt("weekends")===!1&&hiddenDays.push(0,6),i=0;7>i;i++)(isHiddenDayHash[i]=-1!==$.inArray(i,hiddenDays))||dayCnt++;if(!dayCnt)throw"invalid hiddenDays";this.isHiddenDayHash=isHiddenDayHash},isHiddenDay:function(day){return moment.isMoment(day)&&(day=day.day()),this.isHiddenDayHash[day]},skipHiddenDays:function(date,inc,isExclusive){var out=date.clone();for(inc=inc||1;this.isHiddenDayHash[(out.day()+(isExclusive?inc:0)+7)%7];)out.add(inc,"days");return out},computeDayRange:function(range){var endTimeMS,startDay=range.start.clone().stripTime(),end=range.end,endDay=null;return end&&(endDay=end.clone().stripTime(),endTimeMS=+end.time(),endTimeMS&&endTimeMS>=this.nextDayThreshold&&endDay.add(1,"days")),(!end||startDay>=endDay)&&(endDay=startDay.clone().add(1,"days")),{start:startDay,end:endDay}},isMultiDayEvent:function(event){var range=this.computeDayRange(event);return range.end.diff(range.start,"days")>1}});fc.sourceNormalizers=[],fc.sourceFetchers=[];var ajaxDefaults={dataType:"json",cache:!1},eventGUID=1,BasicView=fcViews.basic=View.extend({dayGrid:null,dayNumbersVisible:!1,weekNumbersVisible:!1,weekNumberWidth:null,headRowEl:null,initialize:function(){this.dayGrid=new DayGrid(this),this.coordMap=this.dayGrid.coordMap},setRange:function(range){View.prototype.setRange.call(this,range),this.dayGrid.breakOnWeeks=/year|month|week/.test(this.intervalUnit),this.dayGrid.setRange(range)
},computeRange:function(date){var range=View.prototype.computeRange.call(this,date);return/year|month/.test(range.intervalUnit)&&(range.start.startOf("week"),range.start=this.skipHiddenDays(range.start),range.end.weekday()&&(range.end.add(1,"week").startOf("week"),range.end=this.skipHiddenDays(range.end,-1,!0))),range},render:function(){this.dayNumbersVisible=this.dayGrid.rowCnt>1,this.weekNumbersVisible=this.opt("weekNumbers"),this.dayGrid.numbersVisible=this.dayNumbersVisible||this.weekNumbersVisible,this.el.addClass("fc-basic-view").html(this.renderHtml()),this.headRowEl=this.el.find("thead .fc-row"),this.scrollerEl=this.el.find(".fc-day-grid-container"),this.dayGrid.coordMap.containerEl=this.scrollerEl,this.dayGrid.el=this.el.find(".fc-day-grid"),this.dayGrid.render(this.hasRigidRows())},destroy:function(){this.dayGrid.destroy(),View.prototype.destroy.call(this)},renderHtml:function(){return'<table><thead><tr><td class="'+this.widgetHeaderClass+'">'+this.dayGrid.headHtml()+'</td></tr></thead><tbody><tr><td class="'+this.widgetContentClass+'"><div class="fc-day-grid-container"><div class="fc-day-grid"/></div></td></tr></tbody></table>'},headIntroHtml:function(){return this.weekNumbersVisible?'<th class="fc-week-number '+this.widgetHeaderClass+'" '+this.weekNumberStyleAttr()+"><span>"+htmlEscape(this.opt("weekNumberTitle"))+"</span></th>":void 0},numberIntroHtml:function(row){return this.weekNumbersVisible?'<td class="fc-week-number" '+this.weekNumberStyleAttr()+"><span>"+this.calendar.calculateWeekNumber(this.dayGrid.getCell(row,0).start)+"</span></td>":void 0},dayIntroHtml:function(){return this.weekNumbersVisible?'<td class="fc-week-number '+this.widgetContentClass+'" '+this.weekNumberStyleAttr()+"></td>":void 0},introHtml:function(){return this.weekNumbersVisible?'<td class="fc-week-number" '+this.weekNumberStyleAttr()+"></td>":void 0},numberCellHtml:function(cell){var classes,date=cell.start;return this.dayNumbersVisible?(classes=this.dayGrid.getDayClasses(date),classes.unshift("fc-day-number"),'<td class="'+classes.join(" ")+'" data-date="'+date.format()+'">'+date.date()+"</td>"):"<td/>"},weekNumberStyleAttr:function(){return null!==this.weekNumberWidth?'style="width:'+this.weekNumberWidth+'px"':""},hasRigidRows:function(){var eventLimit=this.opt("eventLimit");return eventLimit&&"number"!=typeof eventLimit},updateWidth:function(){this.weekNumbersVisible&&(this.weekNumberWidth=matchCellWidths(this.el.find(".fc-week-number")))},setHeight:function(totalHeight,isAuto){var scrollerHeight,eventLimit=this.opt("eventLimit");unsetScroller(this.scrollerEl),uncompensateScroll(this.headRowEl),this.dayGrid.destroySegPopover(),eventLimit&&"number"==typeof eventLimit&&this.dayGrid.limitRows(eventLimit),scrollerHeight=this.computeScrollerHeight(totalHeight),this.setGridHeight(scrollerHeight,isAuto),eventLimit&&"number"!=typeof eventLimit&&this.dayGrid.limitRows(eventLimit),!isAuto&&setPotentialScroller(this.scrollerEl,scrollerHeight)&&(compensateScroll(this.headRowEl,getScrollbarWidths(this.scrollerEl)),scrollerHeight=this.computeScrollerHeight(totalHeight),this.scrollerEl.height(scrollerHeight),this.restoreScroll())},setGridHeight:function(height,isAuto){isAuto?undistributeHeight(this.dayGrid.rowEls):distributeHeight(this.dayGrid.rowEls,height,!0)},renderEvents:function(events){this.dayGrid.renderEvents(events),this.updateHeight()},getEventSegs:function(){return this.dayGrid.getEventSegs()},destroyEvents:function(){this.recordScroll(),this.dayGrid.destroyEvents()},renderDrag:function(dropLocation,seg){return this.dayGrid.renderDrag(dropLocation,seg)},destroyDrag:function(){this.dayGrid.destroyDrag()},renderSelection:function(range){this.dayGrid.renderSelection(range)},destroySelection:function(){this.dayGrid.destroySelection()}});setDefaults({fixedWeekCount:!0});var MonthView=fcViews.month=BasicView.extend({computeRange:function(date){var rowCnt,range=BasicView.prototype.computeRange.call(this,date);return this.isFixedWeeks()&&(rowCnt=Math.ceil(range.end.diff(range.start,"weeks",!0)),range.end.add(6-rowCnt,"weeks")),range},setGridHeight:function(height,isAuto){isAuto=isAuto||"variable"===this.opt("weekMode"),isAuto&&(height*=this.rowCnt/6),distributeHeight(this.dayGrid.rowEls,height,!isAuto)},isFixedWeeks:function(){var weekMode=this.opt("weekMode");return weekMode?"fixed"===weekMode:this.opt("fixedWeekCount")}});MonthView.duration={months:1},fcViews.basicWeek={type:"basic",duration:{weeks:1}},fcViews.basicDay={type:"basic",duration:{days:1}},setDefaults({allDaySlot:!0,allDayText:"all-day",scrollTime:"06:00:00",slotDuration:"00:30:00",minTime:"00:00:00",maxTime:"24:00:00",slotEventOverlap:!0});var AGENDA_ALL_DAY_EVENT_LIMIT=5;fcViews.agenda=View.extend({timeGrid:null,dayGrid:null,axisWidth:null,noScrollRowEls:null,bottomRuleEl:null,bottomRuleHeight:null,initialize:function(){this.timeGrid=new TimeGrid(this),this.opt("allDaySlot")?(this.dayGrid=new DayGrid(this),this.coordMap=new ComboCoordMap([this.dayGrid.coordMap,this.timeGrid.coordMap])):this.coordMap=this.timeGrid.coordMap},setRange:function(range){View.prototype.setRange.call(this,range),this.timeGrid.setRange(range),this.dayGrid&&this.dayGrid.setRange(range)},render:function(){this.el.addClass("fc-agenda-view").html(this.renderHtml()),this.scrollerEl=this.el.find(".fc-time-grid-container"),this.timeGrid.coordMap.containerEl=this.scrollerEl,this.timeGrid.el=this.el.find(".fc-time-grid"),this.timeGrid.render(),this.bottomRuleEl=$('<hr class="'+this.widgetHeaderClass+'"/>').appendTo(this.timeGrid.el),this.dayGrid&&(this.dayGrid.el=this.el.find(".fc-day-grid"),this.dayGrid.render(),this.dayGrid.bottomCoordPadding=this.dayGrid.el.next("hr").outerHeight()),this.noScrollRowEls=this.el.find(".fc-row:not(.fc-scroller *)")},destroy:function(){this.timeGrid.destroy(),this.dayGrid&&this.dayGrid.destroy(),View.prototype.destroy.call(this)},renderHtml:function(){return'<table><thead><tr><td class="'+this.widgetHeaderClass+'">'+this.timeGrid.headHtml()+'</td></tr></thead><tbody><tr><td class="'+this.widgetContentClass+'">'+(this.dayGrid?'<div class="fc-day-grid"/><hr class="'+this.widgetHeaderClass+'"/>':"")+'<div class="fc-time-grid-container"><div class="fc-time-grid"/></div></td></tr></tbody></table>'},headIntroHtml:function(){var date,weekNumber,weekTitle,weekText;return this.opt("weekNumbers")?(date=this.timeGrid.getCell(0).start,weekNumber=this.calendar.calculateWeekNumber(date),weekTitle=this.opt("weekNumberTitle"),weekText=this.opt("isRTL")?weekNumber+weekTitle:weekTitle+weekNumber,'<th class="fc-axis fc-week-number '+this.widgetHeaderClass+'" '+this.axisStyleAttr()+"><span>"+htmlEscape(weekText)+"</span></th>"):'<th class="fc-axis '+this.widgetHeaderClass+'" '+this.axisStyleAttr()+"></th>"},dayIntroHtml:function(){return'<td class="fc-axis '+this.widgetContentClass+'" '+this.axisStyleAttr()+"><span>"+(this.opt("allDayHtml")||htmlEscape(this.opt("allDayText")))+"</span></td>"},slotBgIntroHtml:function(){return'<td class="fc-axis '+this.widgetContentClass+'" '+this.axisStyleAttr()+"></td>"},introHtml:function(){return'<td class="fc-axis" '+this.axisStyleAttr()+"></td>"},axisStyleAttr:function(){return null!==this.axisWidth?'style="width:'+this.axisWidth+'px"':""},updateSize:function(isResize){isResize&&this.timeGrid.resize(),View.prototype.updateSize.call(this,isResize)},updateWidth:function(){this.axisWidth=matchCellWidths(this.el.find(".fc-axis"))},setHeight:function(totalHeight,isAuto){var eventLimit,scrollerHeight;null===this.bottomRuleHeight&&(this.bottomRuleHeight=this.bottomRuleEl.outerHeight()),this.bottomRuleEl.hide(),this.scrollerEl.css("overflow",""),unsetScroller(this.scrollerEl),uncompensateScroll(this.noScrollRowEls),this.dayGrid&&(this.dayGrid.destroySegPopover(),eventLimit=this.opt("eventLimit"),eventLimit&&"number"!=typeof eventLimit&&(eventLimit=AGENDA_ALL_DAY_EVENT_LIMIT),eventLimit&&this.dayGrid.limitRows(eventLimit)),isAuto||(scrollerHeight=this.computeScrollerHeight(totalHeight),setPotentialScroller(this.scrollerEl,scrollerHeight)?(compensateScroll(this.noScrollRowEls,getScrollbarWidths(this.scrollerEl)),scrollerHeight=this.computeScrollerHeight(totalHeight),this.scrollerEl.height(scrollerHeight),this.restoreScroll()):(this.scrollerEl.height(scrollerHeight).css("overflow","hidden"),this.bottomRuleEl.show()))},initializeScroll:function(){function scroll(){_this.scrollerEl.scrollTop(top)}var _this=this,scrollTime=moment.duration(this.opt("scrollTime")),top=this.timeGrid.computeTimeTop(scrollTime);top=Math.ceil(top),top&&top++,scroll(),setTimeout(scroll,0)},renderEvents:function(events){var timedSegs,i,dayEvents=[],timedEvents=[],daySegs=[];for(i=0;i<events.length;i++)events[i].allDay?dayEvents.push(events[i]):timedEvents.push(events[i]);timedSegs=this.timeGrid.renderEvents(timedEvents),this.dayGrid&&(daySegs=this.dayGrid.renderEvents(dayEvents)),this.updateHeight()},getEventSegs:function(){return this.timeGrid.getEventSegs().concat(this.dayGrid?this.dayGrid.getEventSegs():[])},destroyEvents:function(){this.recordScroll(),this.timeGrid.destroyEvents(),this.dayGrid&&this.dayGrid.destroyEvents()},renderDrag:function(dropLocation,seg){return dropLocation.start.hasTime()?this.timeGrid.renderDrag(dropLocation,seg):this.dayGrid?this.dayGrid.renderDrag(dropLocation,seg):void 0},destroyDrag:function(){this.timeGrid.destroyDrag(),this.dayGrid&&this.dayGrid.destroyDrag()},renderSelection:function(range){range.start.hasTime()||range.end.hasTime()?this.timeGrid.renderSelection(range):this.dayGrid&&this.dayGrid.renderSelection(range)},destroySelection:function(){this.timeGrid.destroySelection(),this.dayGrid&&this.dayGrid.destroySelection()}}),fcViews.agendaWeek={type:"agenda",duration:{weeks:1}},fcViews.agendaDay={type:"agenda",duration:{days:1}}}),function(window){function sprintf(){var key=arguments[0],cache=sprintf.cache;return cache[key]&&cache.hasOwnProperty(key)||(cache[key]=sprintf.parse(key)),sprintf.format.call(null,cache[key],arguments)}function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}function str_repeat(input,multiplier){return Array(multiplier+1).join(input)}var re={not_string:/[^s]/,number:/[dief]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fiosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};sprintf.format=function(parse_tree,argv){var arg,i,k,match,pad,pad_character,pad_length,cursor=1,tree_length=parse_tree.length,node_type="",output=[],is_positive=!0,sign="";for(i=0;tree_length>i;i++)if(node_type=get_type(parse_tree[i]),"string"===node_type)output[output.length]=parse_tree[i];else if("array"===node_type){if(match=parse_tree[i],match[2])for(arg=argv[cursor],k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw new Error(sprintf("[sprintf] property '%s' does not exist",match[2][k]));arg=arg[match[2][k]]}else arg=match[1]?argv[match[1]]:argv[cursor++];if("function"==get_type(arg)&&(arg=arg()),re.not_string.test(match[8])&&"number"!=get_type(arg)&&isNaN(arg))throw new TypeError(sprintf("[sprintf] expecting number but found %s",get_type(arg)));switch(re.number.test(match[8])&&(is_positive=arg>=0),match[8]){case"b":arg=arg.toString(2);break;case"c":arg=String.fromCharCode(arg);break;case"d":case"i":arg=parseInt(arg,10);break;case"e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case"o":arg=arg.toString(8);break;case"s":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case"u":arg>>>=0;break;case"x":arg=arg.toString(16);break;case"X":arg=arg.toString(16).toUpperCase()}!re.number.test(match[8])||is_positive&&!match[3]?sign="":(sign=is_positive?"+":"-",arg=arg.toString().replace(re.sign,"")),pad_character=match[4]?"0"===match[4]?"0":match[4].charAt(1):" ",pad_length=match[6]-(sign+arg).length,pad=match[6]&&pad_length>0?str_repeat(pad_character,pad_length):"",output[output.length]=match[5]?sign+arg+pad:"0"===pad_character?sign+pad+arg:pad+sign+arg}return output.join("")},sprintf.cache={},sprintf.parse=function(fmt){for(var _fmt=fmt,match=[],parse_tree=[],arg_names=0;_fmt;){if(null!==(match=re.text.exec(_fmt)))parse_tree[parse_tree.length]=match[0];else if(null!==(match=re.modulo.exec(_fmt)))parse_tree[parse_tree.length]="%";else{if(null===(match=re.placeholder.exec(_fmt)))throw new SyntaxError("[sprintf] unexpected placeholder");if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if(null===(field_match=re.key.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(field_list[field_list.length]=field_match[1];""!==(replacement_field=replacement_field.substring(field_match[0].length));)if(null!==(field_match=re.key_access.exec(replacement_field)))field_list[field_list.length]=field_match[1];else{if(null===(field_match=re.index_access.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");field_list[field_list.length]=field_match[1]}match[2]=field_list}else arg_names|=2;if(3===arg_names)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");parse_tree[parse_tree.length]=match}_fmt=_fmt.substring(match[0].length)}return parse_tree};var vsprintf=function(fmt,argv,_argv){return _argv=(argv||[]).slice(0),_argv.splice(0,0,fmt),sprintf.apply(null,_argv)};"undefined"!=typeof exports?(exports.sprintf=sprintf,exports.vsprintf=vsprintf):(window.sprintf=sprintf,window.vsprintf=vsprintf,"function"==typeof define&&define.amd&&define(function(){return{sprintf:sprintf,vsprintf:vsprintf}}))}("undefined"==typeof window?this:window),function(){function bindMapEvents(scope,eventsStr,googleObject,element){angular.forEach(eventsStr.split(" "),function(eventName){window.google.maps.event.addListener(googleObject,eventName,function(event){element.triggerHandler("map-"+eventName,event),scope.$$phase||scope.$apply()})})}function mapOverlayDirective(directiveName,events){app.directive(directiveName,[function(){return{restrict:"A",link:function(scope,elm,attrs){scope.$watch(attrs[directiveName],function(newObject){newObject&&bindMapEvents(scope,events,newObject,elm)})}}}])}var app=angular.module("ui.map",["ui.event"]);app.value("uiMapConfig",{}).directive("uiMap",["uiMapConfig","$parse",function(uiMapConfig,$parse){var mapEvents="bounds_changed center_changed click dblclick drag dragend dragstart heading_changed idle maptypeid_changed mousemove mouseout mouseover projection_changed resize rightclick tilesloaded tilt_changed zoom_changed",options=uiMapConfig||{};return{restrict:"A",link:function(scope,elm,attrs){var opts=angular.extend({},options,scope.$eval(attrs.uiOptions)),map=new window.google.maps.Map(elm[0],opts),model=$parse(attrs.uiMap);model.assign(scope,map),bindMapEvents(scope,mapEvents,map,elm)}}}]),app.value("uiMapInfoWindowConfig",{}).directive("uiMapInfoWindow",["uiMapInfoWindowConfig","$parse","$compile",function(uiMapInfoWindowConfig,$parse,$compile){var infoWindowEvents="closeclick content_change domready position_changed zindex_changed",options=uiMapInfoWindowConfig||{};return{link:function(scope,elm,attrs){var opts=angular.extend({},options,scope.$eval(attrs.uiOptions));opts.content=elm[0];var model=$parse(attrs.uiMapInfoWindow),infoWindow=model(scope);infoWindow||(infoWindow=new window.google.maps.InfoWindow(opts),model.assign(scope,infoWindow)),bindMapEvents(scope,infoWindowEvents,infoWindow,elm),elm.replaceWith("<div></div>");var _open=infoWindow.open;infoWindow.open=function(a1,a2,a3,a4,a5,a6){$compile(elm.contents())(scope),_open.call(infoWindow,a1,a2,a3,a4,a5,a6)}}}}]),mapOverlayDirective("uiMapMarker","animation_changed click clickable_changed cursor_changed dblclick drag dragend draggable_changed dragstart flat_changed icon_changed mousedown mouseout mouseover mouseup position_changed rightclick shadow_changed shape_changed title_changed visible_changed zindex_changed"),mapOverlayDirective("uiMapPolyline","click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapPolygon","click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapRectangle","bounds_changed click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapCircle","center_changed click dblclick mousedown mousemove mouseout mouseover mouseup radius_changed rightclick"),mapOverlayDirective("uiMapGroundOverlay","click dblclick")}();var deps=[];try{angular.module("ngSanitize"),deps.push("ngSanitize")}catch(e){}try{angular.module("ui.sortable"),deps.push("ui.sortable")}catch(e){}try{angular.module("angularSpectrumColorpicker"),deps.push("angularSpectrumColorpicker")}catch(e){}angular.module("schemaForm",deps),angular.module("schemaForm").provider("sfPath",[function(){var sfPath={parse:ObjectPath.parse};sfPath.stringify=1===angular.version.major&&angular.version.minor<3?function(arr){return Array.isArray(arr)?arr.join("."):arr.toString()}:ObjectPath.stringify,sfPath.normalize=function(data,quote){return sfPath.stringify(Array.isArray(data)?data:sfPath.parse(data),quote)},this.parse=sfPath.parse,this.stringify=sfPath.stringify,this.normalize=sfPath.normalize,this.$get=function(){return sfPath}}]),angular.module("schemaForm").factory("sfSelect",["sfPath",function(sfPath){var numRe=/^\d+$/;return function(projection,obj,valueToSet){obj||(obj=this);var parts="string"==typeof projection?sfPath.parse(projection):projection;if("undefined"!=typeof valueToSet&&1===parts.length)return obj[parts[0]]=valueToSet,obj;"undefined"!=typeof valueToSet&&"undefined"==typeof obj[parts[0]]&&(obj[parts[0]]=parts.length>2&&numRe.test(parts[1])?[]:{});for(var value=obj[parts[0]],i=1;i<parts.length;i++){if(""===parts[i])return void 0;if("undefined"!=typeof valueToSet){if(i===parts.length-1)return value[parts[i]]=valueToSet,valueToSet;var tmp=value[parts[i]];("undefined"==typeof tmp||null===tmp)&&(tmp=numRe.test(parts[i+1])?[]:{},value[parts[i]]=tmp),value=tmp}else value&&(value=value[parts[i]])}return value}}]),angular.module("schemaForm").provider("schemaFormDecorators",["$compileProvider","sfPathProvider",function($compileProvider,sfPathProvider){var defaultDecorator="",directives={},templateUrl=function(name,form){"sfDecorator"===name&&(name=defaultDecorator);for(var directive=directives[name],rules=directive.rules,i=0;i<rules.length;i++){var res=rules[i](form);if(res)return res}return directive.mappings[form.type]?directive.mappings[form.type]:directive.mappings["default"]},createDirective=function(name){$compileProvider.directive(name,["$parse","$compile","$http","$templateCache",function($parse,$compile,$http,$templateCache){return{restrict:"AE",replace:!1,transclude:!1,scope:!0,require:"?^sfSchema",link:function(scope,element,attrs,sfSchema){var once=scope.$watch(attrs.form,function(form){if(form){scope.form=form;var url=templateUrl(name,form);$http.get(url,{cache:$templateCache}).then(function(res){var key=form.key?sfPathProvider.stringify(form.key).replace(/"/g,"&quot;"):"",template=res.data.replace(/\$\$value\$\$/g,"model"+("["!==key[0]?".":"")+key);element.html(template),$compile(element.contents())(scope)}),once()}});scope.showTitle=function(){return scope.form&&scope.form.notitle!==!0&&scope.form.title},scope.listToCheckboxValues=function(list){var values={};return angular.forEach(list,function(v){values[v]=!0}),values},scope.checkboxValuesToList=function(values){var lst=[];return angular.forEach(values,function(v,k){v&&lst.push(k)}),lst},scope.buttonClick=function($event,form){angular.isFunction(form.onClick)?form.onClick($event,form):angular.isString(form.onClick)&&(sfSchema?sfSchema.evalInParentScope(form.onClick,{$event:$event,form:form}):scope.$eval(form.onClick,{$event:$event,form:form}))},scope.evalExpr=function(expression,locals){return sfSchema?sfSchema.evalInParentScope(expression,locals):scope.$eval(expression,locals)},scope.evalInScope=function(expression,locals){return expression?scope.$eval(expression,locals):void 0},scope.errorMessage=function(schemaError){return scope.form.validationMessage?schemaError?angular.isString(scope.form.validationMessage)?scope.form.validationMessage:scope.form.validationMessage[schemaError.code]||scope.form.validationMessage["default"]:scope.form.validationMessage.number||scope.form.validationMessage["default"]||scope.form.validationMessage:schemaError?schemaError.message:"Not a number"}}}}])},createManualDirective=function(type,templateUrl,transclude){transclude=angular.isDefined(transclude)?transclude:!1,$compileProvider.directive("sf"+angular.uppercase(type[0])+type.substr(1),function(){return{restrict:"EAC",scope:!0,replace:!0,transclude:transclude,template:'<sf-decorator form="form"></sf-decorator>',link:function(scope,element,attrs){var watchThis={items:"c",titleMap:"c",schema:"c"},form={type:type},once=!0;angular.forEach(attrs,function(value,name){if("$"!==name[0]&&0!==name.indexOf("ng")&&"sfField"!==name){var updateForm=function(val){angular.isDefined(val)&&val!==form[name]&&(form[name]=val,once&&form.type&&(form.key||angular.isUndefined(attrs.key))&&(scope.form=form,once=!1))};"model"===name?scope.$watch(value,function(val){val&&scope.model!==val&&(scope.model=val)}):"c"===watchThis[name]?scope.$watchCollection(value,updateForm):attrs.$observe(name,updateForm)}})}}})};this.createDecorator=function(name,mappings,rules){directives[name]={mappings:mappings||{},rules:rules||[]},directives[defaultDecorator]||(defaultDecorator=name),createDirective(name)},this.createDirective=createManualDirective,this.createDirectives=function(mappings){angular.forEach(mappings,function(url,type){createManualDirective(type,url)})},this.directive=function(name){return name=name||defaultDecorator,directives[name]},this.addMapping=function(name,type,url){directives[name]&&(directives[name].mappings[type]=url)},this.$get=function(){return{directive:function(name){return directives[name]},defaultDecorator:defaultDecorator}},createDirective("sfDecorator")}]),angular.module("schemaForm").provider("schemaForm",["sfPathProvider",function(sfPathProvider){var enumToTitleMap=function(enm){var titleMap=[];return enm.forEach(function(name){titleMap.push({name:name,value:name})}),titleMap},canonicalTitleMap=function(titleMap,originalEnum){if(!angular.isArray(titleMap)){var canonical=[];return originalEnum?angular.forEach(originalEnum,function(value){canonical.push({name:titleMap[value],value:value})}):angular.forEach(titleMap,function(name,value){canonical.push({name:name,value:value})}),canonical}return titleMap},defaultFormDefinition=function(name,schema,options){var rules=defaults[schema.type];if(rules)for(var def,i=0;i<rules.length;i++)if(def=rules[i](name,schema,options))return def.schema["x-schema-form"]&&angular.isObject(def.schema["x-schema-form"])&&(def=angular.extend(def,def.schema["x-schema-form"])),def},stdFormObj=function(name,schema,options){options=options||{};var f=options.global&&options.global.formDefaults?angular.copy(options.global.formDefaults):{};return f.title=options.global&&options.global.supressPropertyTitles===!0?schema.title:schema.title||name,schema.description&&(f.description=schema.description),(options.required===!0||schema.required===!0)&&(f.required=!0),schema.maxLength&&(f.maxlength=schema.maxLength),schema.minLength&&(f.minlength=schema.maxLength),(schema.readOnly||schema.readonly)&&(f.readonly=!0),schema.minimum&&(f.minimum=schema.minimum+(schema.exclusiveMinimum?1:0)),schema.maximum&&(f.maximum=schema.maximum-(schema.exclusiveMaximum?1:0)),schema.validationMessage&&(f.validationMessage=schema.validationMessage),schema.enumNames&&(f.titleMap=canonicalTitleMap(schema.enumNames,schema["enum"])),f.schema=schema,f.ngModelOptions=f.ngModelOptions||{},f},text=function(name,schema,options){if("string"===schema.type&&!schema["enum"]){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="text",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},number=function(name,schema,options){if("number"===schema.type){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="number",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},integer=function(name,schema,options){if("integer"===schema.type){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="number",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},checkbox=function(name,schema,options){if("boolean"===schema.type){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="checkbox",options.lookup[sfPathProvider.stringify(options.path)]=f,f}},select=function(name,schema,options){if("string"===schema.type&&schema["enum"]){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="select",f.titleMap||(f.titleMap=enumToTitleMap(schema["enum"])),options.lookup[sfPathProvider.stringify(options.path)]=f,f}},checkboxes=function(name,schema,options){if("array"===schema.type&&schema.items&&schema.items["enum"]){var f=stdFormObj(name,schema,options);return f.key=options.path,f.type="checkboxes",f.titleMap||(f.titleMap=enumToTitleMap(schema.items["enum"])),options.lookup[sfPathProvider.stringify(options.path)]=f,f}},fieldset=function(name,schema,options){if("object"===schema.type){var f=stdFormObj(name,schema,options);return f.type="fieldset",f.items=[],options.lookup[sfPathProvider.stringify(options.path)]=f,angular.forEach(schema.properties,function(v,k){var path=options.path.slice();if(path.push(k),options.ignore[sfPathProvider.stringify(path)]!==!0){var required=schema.required&&-1!==schema.required.indexOf(k),def=defaultFormDefinition(k,v,{path:path,required:required||!1,lookup:options.lookup,ignore:options.ignore});def&&f.items.push(def)}}),f}},array=function(name,schema,options){if("array"===schema.type){var f=stdFormObj(name,schema,options);f.type="array",f.key=options.path,options.lookup[sfPathProvider.stringify(options.path)]=f;var required=schema.required&&-1!==schema.required.indexOf(options.path[options.path.length-1]),arrPath=options.path.slice();return arrPath.push(""),f.items=[defaultFormDefinition(name,schema.items,{path:arrPath,required:required||!1,lookup:options.lookup,ignore:options.ignore,global:options.global})],f}},defaults={string:[select,text],object:[fieldset],number:[number],integer:[integer],"boolean":[checkbox],array:[checkboxes,array]},postProcessFn=function(form){return form};this.defaults=defaults,this.stdFormObj=stdFormObj,this.defaultFormDefinition=defaultFormDefinition,this.postProcess=function(fn){postProcessFn=fn},this.appendRule=function(type,rule){defaults[type]||(defaults[type]=[]),defaults[type].push(rule)},this.prependRule=function(type,rule){defaults[type]||(defaults[type]=[]),defaults[type].unshift(rule)},this.createStandardForm=stdFormObj,this.$get=function(){var service={};return service.merge=function(schema,form,ignore,options,readonly){form=form||["*"],options=options||{},readonly=readonly||schema.readonly||schema.readOnly;var stdForm=service.defaults(schema,ignore,options),idx=form.indexOf("*");-1!==idx&&(form=form.slice(0,idx).concat(stdForm.form).concat(form.slice(idx+1)));var lookup=stdForm.lookup;return postProcessFn(form.map(function(obj){if("string"==typeof obj&&(obj={key:obj}),obj.key&&"string"==typeof obj.key&&(obj.key=sfPathProvider.parse(obj.key)),obj.titleMap&&(obj.titleMap=canonicalTitleMap(obj.titleMap)),obj.itemForm){obj.items=[];var str=sfPathProvider.stringify(obj.key),stdForm=lookup[str];angular.forEach(stdForm.items,function(item){var o=angular.copy(obj.itemForm);o.key=item.key,obj.items.push(o)})}if(obj.key){var strid=sfPathProvider.stringify(obj.key);lookup[strid]&&(obj=angular.extend(lookup[strid],obj))}return readonly===!0&&(obj.readonly=!0),obj.items&&(obj.items=service.merge(schema,obj.items,ignore,options,obj.readonly)),obj.tabs&&angular.forEach(obj.tabs,function(tab){tab.items=service.merge(schema,tab.items,ignore,options,obj.readonly)}),"checkbox"===obj.type&&angular.isUndefined(obj.schema["default"])&&(obj.schema["default"]=!1),obj}))},service.defaults=function(schema,ignore,globalOptions){var form=[],lookup={};if(ignore=ignore||{},globalOptions=globalOptions||{},"object"!==schema.type)throw new Error('Not implemented. Only type "object" allowed at root level of schema.');return angular.forEach(schema.properties,function(v,k){if(ignore[k]!==!0){var required=schema.required&&-1!==schema.required.indexOf(k),def=defaultFormDefinition(k,v,{path:[k],lookup:lookup,ignore:ignore,required:required,global:globalOptions});def&&form.push(def)}}),{form:form,lookup:lookup}},service.traverseSchema=function(schema,fn,path,ignoreArrays){ignoreArrays=angular.isDefined(ignoreArrays)?ignoreArrays:!0,path=path||[];var traverse=function(schema,fn,path){if(fn(schema,path),angular.forEach(schema.properties,function(prop,name){var currentPath=path.slice();currentPath.push(name),traverse(prop,fn,currentPath)}),!ignoreArrays&&schema.items){var arrPath=path.slice();arrPath.push(""),traverse(schema.items,fn,arrPath)}};traverse(schema,fn,path||[])},service.traverseForm=function(form,fn){fn(form),angular.forEach(form.items,function(f){service.traverseForm(f,fn)}),form.tabs&&angular.forEach(form.tabs,function(tab){angular.forEach(tab.items,function(f){service.traverseForm(f,fn)})})},service}}]),angular.module("schemaForm").factory("sfValidator",[function(){var validator={};return validator.validate=function(form,value){if(!form)return{valid:!0};var schema=form.schema;if(!schema)return{valid:!0};""===value&&(value=void 0),"number"===form.type&&null===value&&(value=void 0);var wrap={type:"object",properties:{}},propName=form.key[form.key.length-1];wrap.properties[propName]=schema,form.required&&(wrap.required=[propName]);var valueWrap={};return angular.isDefined(value)&&(valueWrap[propName]=value),tv4.validateResult(valueWrap,wrap)},validator}]),angular.module("schemaForm").directive("sfArray",["sfSelect","schemaForm","sfValidator","sfPath",function(sfSelect,schemaForm,sfValidator,sfPath){var setIndex=function(index){return function(form){form.key&&(form.key[form.key.indexOf("")]=index)}};return{restrict:"A",scope:!0,require:"?ngModel",link:function(scope,element,attrs,ngModel){var formDefCache={},once=scope.$watch(attrs.sfArray,function(form){var list=sfSelect(form.key,scope.model);if(scope.$watch("model"+sfPath.normalize(form.key),function(){list=sfSelect(form.key,scope.model),scope.modelArray=list}),angular.isUndefined(list)&&(list=[],sfSelect(form.key,scope.model,list)),scope.modelArray=list,form.items){var subForm=form.items[0];form.items.length>1&&(subForm={type:"section",items:form.items.map(function(item){return item.ngModelOptions=form.ngModelOptions,angular.isUndefined(item.readonly)&&(item.readonly=form.readonly),item})})}if(scope.copyWithIndex=function(index){if(!formDefCache[index]&&subForm){var copy=angular.copy(subForm);copy.arrayIndex=index,schemaForm.traverseForm(copy,setIndex(index)),formDefCache[index]=copy}return formDefCache[index]},scope.appendToArray=function(){var len=list.length,copy=scope.copyWithIndex(len);if(schemaForm.traverseForm(copy,function(part){if(part.key){var def;angular.isDefined(part["default"])&&(def=part["default"]),angular.isDefined(part.schema)&&angular.isDefined(part.schema["default"])&&(def=part.schema["default"]),angular.isDefined(def)&&sfSelect(part.key,scope.model,def)}}),len===list.length){var dflt,type=sfSelect("schema.items.type",form);"object"===type?dflt={}:"array"===type&&(dflt=[]),list.push(dflt)}return scope.validateArray&&scope.validateArray(),list},scope.deleteFromArray=function(index){return list.splice(index,1),scope.validateArray&&scope.validateArray(),ngModel.$setDirty&&ngModel.$setDirty(),list},form.titleMap||form.startEmpty===!0||0!==list.length||scope.appendToArray(),form.titleMap&&form.titleMap.length>0){scope.titleMapValues=[];
var updateTitleMapValues=function(arr){scope.titleMapValues=[],arr=arr||[],form.titleMap.forEach(function(item){scope.titleMapValues.push(-1!==arr.indexOf(item.value))})};updateTitleMapValues(scope.modelArray),scope.$watchCollection("modelArray",updateTitleMapValues),scope.$watchCollection("titleMapValues",function(vals){if(vals){for(var arr=scope.modelArray;arr.length>0;)arr.pop();form.titleMap.forEach(function(item,index){vals[index]&&arr.push(item.value)})}})}if(ngModel){var error;scope.validateArray=function(){var result=sfValidator.validate(form,scope.modelArray.length>0?scope.modelArray:void 0);result.valid!==!1||!result.error||""!==result.error.dataPath&&result.error.dataPath!=="/"+form.key[form.key.length-1]?ngModel.$setValidity("schema",!0):(ngModel.$setViewValue(scope.modelArray),error=result.error,ngModel.$setValidity("schema",!1))},scope.$on("schemaFormValidate",scope.validateArray),scope.hasSuccess=function(){return ngModel.$valid&&!ngModel.$pristine},scope.hasError=function(){return ngModel.$invalid},scope.schemaError=function(){return error}}once()})}}}]),angular.module("schemaForm").directive("sfChanged",function(){return{require:"ngModel",restrict:"AC",scope:!1,link:function(scope,element,attrs,ctrl){var form=scope.$eval(attrs.sfChanged);form&&form.onChange&&ctrl.$viewChangeListeners.push(function(){angular.isFunction(form.onChange)?form.onChange(ctrl.$modelValue,form):scope.evalExpr(form.onChange,{modelValue:ctrl.$modelValue,form:form})})}}}),angular.module("schemaForm").directive("sfSchema",["$compile","schemaForm","schemaFormDecorators","sfSelect","sfPath",function($compile,schemaForm,schemaFormDecorators,sfSelect,sfPath){var SNAKE_CASE_REGEXP=/[A-Z]/g,snakeCase=function(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})};return{scope:{schema:"=sfSchema",initialForm:"=sfForm",model:"=sfModel",options:"=sfOptions"},controller:["$scope",function($scope){this.evalInParentScope=function(expr,locals){return $scope.$parent.$eval(expr,locals)}}],replace:!1,restrict:"A",transclude:!0,require:"?form",link:function(scope,element,attrs,formCtrl,transclude){scope.formCtrl=formCtrl;var ignore={};transclude(scope,function(clone){if(clone.addClass("schema-form-ignore"),element.prepend(clone),element[0].querySelectorAll){var models=element[0].querySelectorAll("[ng-model]");if(models)for(var i=0;i<models.length;i++){var key=models[i].getAttribute("ng-model");ignore[key.substring(key.indexOf(".")+1)]=!0}}});var childScope,lastDigest={};scope.$watch(function(){var schema=scope.schema,form=scope.initialForm||["*"];if(form&&schema&&schema.type&&(lastDigest.form!==form||lastDigest.schema!==schema)&&Object.keys(schema.properties).length>0){lastDigest.schema=schema,lastDigest.form=form;var merged=schemaForm.merge(schema,form,ignore,scope.options),frag=document.createDocumentFragment();childScope&&childScope.$destroy(),childScope=scope.$new(),childScope.schemaForm={form:merged,schema:schema},element.children(":not(.schema-form-ignore)").remove();for(var slots={},slotsFound=element[0].querySelectorAll("*[sf-insert-field]"),i=0;i<slotsFound.length;i++)slots[slotsFound[i].getAttribute("sf-insert-field")]=slotsFound[i];angular.forEach(merged,function(obj,i){var n=document.createElement(attrs.sfDecorator||snakeCase(schemaFormDecorators.defaultDecorator,"-"));if(n.setAttribute("form","schemaForm.form["+i+"]"),obj.key){var slot=slots[sfPath.stringify(obj.key)];if(slot){for(;slot.firstChild;)slot.removeChild(slot.firstChild);return void slot.appendChild(n)}}frag.appendChild(n)}),element[0].appendChild(frag),$compile(element.children())(childScope),schemaForm.traverseSchema(schema,function(prop,path){if(angular.isDefined(prop["default"])){var val=sfSelect(path,scope.model);angular.isUndefined(val)&&sfSelect(path,scope.model,prop["default"])}})}scope.$emit("sf-render-finished",element)})}}}]),angular.module("schemaForm").directive("schemaValidate",["sfValidator",function(sfValidator){return{restrict:"A",scope:!1,priority:1e3,require:"ngModel",link:function(scope,element,attrs,ngModel){scope.ngModel=ngModel;var error=null,getForm=function(){return form||(form=scope.$eval(attrs.schemaValidate)),form},form=getForm();ngModel.$validators?ngModel.$validators.schema=function(value){var result=sfValidator.validate(getForm(),value);return error=result.error,result.valid}:ngModel.$parsers.push(function(viewValue){if(form=getForm(),!form)return viewValue;var result=sfValidator.validate(form,viewValue);return result.valid?(ngModel.$setValidity("schema",!0),viewValue):(ngModel.$setValidity("schema",!1),void(error=result.error))}),scope.$on("schemaFormValidate",function(){ngModel.$validate?(ngModel.$validate(),ngModel.$invalid&&(ngModel.$dirty=!0,ngModel.$pristine=!1)):ngModel.$setViewValue(ngModel.$viewValue)}),scope.hasSuccess=function(){return ngModel.$valid&&(!ngModel.$pristine||!ngModel.$isEmpty(ngModel.$modelValue))},scope.hasError=function(){return ngModel.$invalid&&!ngModel.$pristine},scope.schemaError=function(){return error}}}}]),angular.module("schemaForm").run(["$templateCache",function($templateCache){$templateCache.put("directives/decorators/bootstrap/actions-trcl.html",'<div class="btn-group schema-form-actions {{form.htmlClass}}" ng-transclude=""></div>'),$templateCache.put("directives/decorators/bootstrap/actions.html",'<div class="btn-group schema-form-actions {{form.htmlClass}}"><input ng-repeat-start="item in form.items" type="submit" class="btn {{ item.style || \'btn-default\' }} {{form.fieldHtmlClass}}" value="{{item.title}}" ng-if="item.type === \'submit\'"> <button ng-repeat-end="" class="btn {{ item.style || \'btn-default\' }} {{form.fieldHtmlClass}}" type="button" ng-disabled="form.readonly" ng-if="item.type !== \'submit\'" ng-click="buttonClick($event,item)">{{item.title}}</button></div>'),$templateCache.put("directives/decorators/bootstrap/array.html",'<div sf-array="form" class="schema-form-array {{form.htmlClass}}" ng-model="$$value$$" ng-model-options="form.ngModelOptions"><h3 ng-show="form.title && form.notitle !== true">{{ form.title }}</h3><ol class="list-group" ng-model="modelArray" ui-sortable=""><li class="list-group-item {{form.fieldHtmlClass}}" ng-repeat="item in modelArray track by $index"><button ng-hide="form.readonly" ng-click="deleteFromArray($index)" style="position: relative; z-index: 20;" type="button" class="close pull-right"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><sf-decorator ng-init="arrayIndex = $index" form="copyWithIndex($index)"></sf-decorator></li></ol><div class="clearfix" style="padding: 15px;"><button ng-hide="form.readonly || form.add === null" ng-click="appendToArray()" type="button" class="btn {{ form.style.add || \'btn-default\' }} pull-right"><i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}}</button></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/checkbox.html",'<div class="checkbox schema-form-checkbox {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label><input type="checkbox" sf-changed="form" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" schema-validate="form" class="{{form.fieldHtmlClass}}" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="form.title"></span></label><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/checkboxes.html",'<div sf-array="form" ng-model="$$value$$" class="form-group schema-form-checkboxes {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><div class="checkbox" ng-repeat="val in titleMapValues track by $index"><label><input type="checkbox" ng-disabled="form.readonly" sf-changed="form" class="{{form.fieldHtmlClass}}" ng-model="titleMapValues[$index]" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="form.titleMap[$index].name"></span></label></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/default.html",'<div class="form-group schema-form-{{form.type}} {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false }"><label class="control-label" ng-class="{\'sr-only\': !showTitle()}" for="{{form.key.slice(-1)[0]}}">{{form.title}}</label> <input ng-show="form.key" type="{{form.type}}" step="any" sf-changed="form" placeholder="{{form.placeholder}}" class="form-control {{form.fieldHtmlClass}}" id="{{form.key.slice(-1)[0]}}" ng-model-options="form.ngModelOptions" ng-model="$$value$$" ng-disabled="form.readonly" schema-validate="form" name="{{form.key.slice(-1)[0]}}" aria-describedby="{{form.key.slice(-1)[0] + \'Status\'}}"> <span ng-if="form.feedback !== false" class="form-control-feedback" ng-class="evalInScope(form.feedback) || {\'glyphicon\': true, \'glyphicon-ok\': hasSuccess(), \'glyphicon-remove\': hasError() }" aria-hidden="true"></span> <span ng-if="hasError() || hasSuccess()" id="{{form.key.slice(-1)[0] + \'Status\'}}" class="sr-only">{{ hasSuccess() ? \'(success)\' : \'(error)\' }}</span><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/fieldset-trcl.html",'<fieldset ng-disabled="form.readonly" class="schema-form-fieldset {{form.htmlClass}}"><legend ng-show="form.title">{{ form.title }}</legend><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div><div ng-transclude=""></div></fieldset>'),$templateCache.put("directives/decorators/bootstrap/fieldset.html",'<fieldset ng-disabled="form.readonly" class="schema-form-fieldset {{form.htmlClass}}"><legend ng-show="form.title">{{ form.title }}</legend><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div><sf-decorator ng-repeat="item in form.items" form="item"></sf-decorator></fieldset>'),$templateCache.put("directives/decorators/bootstrap/help.html",'<div class="helpvalue schema-form-helpvalue {{form.htmlClass}}" ng-bind-html="form.helpvalue"></div>'),$templateCache.put("directives/decorators/bootstrap/radio-buttons.html",'<div class="form-group schema-form-radiobuttons {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><div><label class="control-label" ng-show="showTitle()">{{form.title}}</label></div><div class="btn-group"><label class="btn {{ (item.value === $$value$$) ? form.style.selected || \'btn-default\' : form.style.unselected || \'btn-default\'; }}" ng-class="{ active: item.value === $$value$$ }" ng-repeat="item in form.titleMap"><input type="radio" class="{{form.fieldHtmlClass}}" sf-changed="form" style="display: none;" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-value="item.value" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="item.name"></span></label></div><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/radios-inline.html",'<div class="form-group schema-form-radios-inline {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><div><label class="radio-inline" ng-repeat="item in form.titleMap"><input type="radio" class="{{form.fieldHtmlClass}}" sf-changed="form" ng-disabled="form.readonly" ng-model="$$value$$" ng-value="item.value" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="item.name"></span></label></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/radios.html",'<div class="form-group schema-form-radios {{form.htmlClass}}" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><div class="radio" ng-repeat="item in form.titleMap"><label><input type="radio" class="{{form.fieldHtmlClass}}" sf-changed="form" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-value="item.value" name="{{form.key.slice(-1)[0]}}"> <span ng-bind-html="item.name"></span></label></div><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/readonly.html",'<div class="form-group"><label ng-class="{\'sr-only\': !showTitle()}" for="{{form.key.slice(-1)[0]}}">{{form.title}}</label> <input ng-if="form.type !== \'textarea\'" type="text" disabled="" class="form-control" id="{{form.key.slice(-1)[0]}}" value="{{$$value$$}}"> <textarea ng-if="form.type === \'textarea\'" disabled="" class="form-control">{{$$value$$}}</textarea><div class="help-block" ng-show="form.description" ng-bind-html="form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/section.html",'<div class="schema-form-section {{form.htmlClass}}" ng-if="!form.condition || evalExpr(form.condition,{ model: model, \'arrayIndex\': arrayIndex })"><sf-decorator ng-repeat="item in form.items" form="item"></sf-decorator></div>'),$templateCache.put("directives/decorators/bootstrap/select.html",'<div class="form-group {{form.htmlClass}} schema-form-select" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess(), \'has-feedback\': form.feedback !== false}"><label class="control-label" ng-show="showTitle()">{{form.title}}</label><select ng-model="$$value$$" ng-model-options="form.ngModelOptions" ng-disabled="form.readonly" sf-changed="form" class="form-control {{form.fieldHtmlClass}}" schema-validate="form" ng-options="item.value as item.name for item in form.titleMap" name="{{form.key.slice(-1)[0]}}"></select><div class="help-block" ng-show="(hasError() && errorMessage(schemaError())) || form.description" ng-bind-html="(hasError() && errorMessage(schemaError())) || form.description"></div></div>'),$templateCache.put("directives/decorators/bootstrap/submit.html",'<div class="form-group schema-form-submit {{form.htmlClass}}"><input type="submit" class="btn {{ form.style || \'btn-primary\' }} {{form.fieldHtmlClass}}" value="{{form.title}}" ng-disabled="form.readonly" ng-if="form.type === \'submit\'"> <button class="btn {{ form.style || \'btn-default\' }}" type="button" ng-click="buttonClick($event,form)" ng-disabled="form.readonly" ng-if="form.type !== \'submit\'">{{form.title}}</button></div>'),$templateCache.put("directives/decorators/bootstrap/tabarray.html",'<div sf-array="form" ng-init="selected = { tab: 0 }" class="clearfix schema-form-tabarray schema-form-tabarray-{{form.tabType || \'left\'}} {{form.htmlClass}}"><div ng-if="!form.tabType || form.tabType !== \'right\'" ng-class="{\'col-xs-3\': !form.tabType || form.tabType === \'left\'}"><ul class="nav nav-tabs" ng-class="{ \'tabs-left\': !form.tabType || form.tabType === \'left\'}"><li ng-repeat="item in modelArray track by $index" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"><a href="#">{{evalExpr(form.title,{\'$index\':$index, value: item}) || $index}}</a></li><li ng-hide="form.readonly" ng-click="$event.preventDefault() || (selected.tab = appendToArray().length - 1)"><a href="#"><i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}}</a></li></ul></div><div ng-class="{\'col-xs-9\': !form.tabType || form.tabType === \'left\' || form.tabType === \'right\'}"><div class="tab-content {{form.fieldHtmlClass}}"><div class="tab-pane clearfix" ng-repeat="item in modelArray track by $index" ng-show="selected.tab === $index" ng-class="{active: selected.tab === $index}"><sf-decorator ng-init="arrayIndex = $index" form="copyWithIndex($index)"></sf-decorator><button ng-hide="form.readonly" ng-click="selected.tab = deleteFromArray($index).length - 1" type="button" class="btn {{ form.style.remove || \'btn-default\' }} pull-right"><i class="glyphicon glyphicon-trash"></i> {{ form.remove || \'Remove\'}}</button></div></div></div><div ng-if="form.tabType === \'right\'" class="col-xs-3"><ul class="nav nav-tabs tabs-right"><li ng-repeat="item in modelArray track by $index" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"><a href="#">{{evalExpr(form.title,{\'$index\':$index, value: item}) || $index}}</a></li><li ng-hide="form.readonly" ng-click="$event.preventDefault() || appendToArray()"><a href="#"><i class="glyphicon glyphicon-plus"></i> {{ form.add || \'Add\'}}</a></li></ul></div></div>'),$templateCache.put("directives/decorators/bootstrap/tabs.html",'<div ng-init="selected = { tab: 0 }" class="schema-form-tabs {{form.htmlClass}}"><ul class="nav nav-tabs"><li ng-repeat="tab in form.tabs" ng-disabled="form.readonly" ng-click="$event.preventDefault() || (selected.tab = $index)" ng-class="{active: selected.tab === $index}"><a href="#">{{ tab.title }}</a></li></ul><div class="tab-content {{form.fieldHtmlClass}}"><div class="tab-pane" ng-disabled="form.readonly" ng-repeat="tab in form.tabs" ng-show="selected.tab === $index" ng-class="{active: selected.tab === $index}"><bootstrap-decorator ng-repeat="item in tab.items" form="item"></bootstrap-decorator></div></div></div>'),$templateCache.put("directives/decorators/bootstrap/textarea.html",'<div class="form-group has-feedback {{form.htmlClass}} schema-form-textarea" ng-class="{\'has-error\': hasError(), \'has-success\': hasSuccess()}"><label ng-class="{\'sr-only\': !showTitle()}" for="{{form.key.slice(-1)[0]}}">{{form.title}}</label> <textarea class="form-control {{form.fieldHtmlClass}}" id="{{form.key.slice(-1)[0]}}" sf-changed="form" placeholder="{{form.placeholder}}" ng-disabled="form.readonly" ng-model="$$value$$" ng-model-options="form.ngModelOptions" schema-validate="form" name="{{form.key.slice(-1)[0]}}"></textarea> <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span></div>')}]),angular.module("schemaForm").config(["schemaFormDecoratorsProvider",function(decoratorsProvider){var base="directives/decorators/bootstrap/";decoratorsProvider.createDecorator("bootstrapDecorator",{textarea:base+"textarea.html",fieldset:base+"fieldset.html",array:base+"array.html",tabarray:base+"tabarray.html",tabs:base+"tabs.html",section:base+"section.html",conditional:base+"section.html",actions:base+"actions.html",select:base+"select.html",checkbox:base+"checkbox.html",checkboxes:base+"checkboxes.html",number:base+"default.html",password:base+"default.html",submit:base+"submit.html",button:base+"submit.html",radios:base+"radios.html","radios-inline":base+"radios-inline.html",radiobuttons:base+"radio-buttons.html",help:base+"help.html","default":base+"default.html"},[]),decoratorsProvider.createDirectives({textarea:base+"textarea.html",select:base+"select.html",checkbox:base+"checkbox.html",checkboxes:base+"checkboxes.html",number:base+"default.html",submit:base+"submit.html",button:base+"submit.html",text:base+"default.html",date:base+"default.html",password:base+"default.html",datepicker:base+"datepicker.html",input:base+"default.html",radios:base+"radios.html","radios-inline":base+"radios-inline.html",radiobuttons:base+"radio-buttons.html"})}]).directive("sfFieldset",function(){return{transclude:!0,scope:!0,templateUrl:"directives/decorators/bootstrap/fieldset-trcl.html",link:function(scope,element,attrs){scope.title=scope.$eval(attrs.title)}}}),!function(a){"use strict";var b=a.module("angularSpectrumColorpicker",[]);!function(){b.directive("spectrumColorpicker",function(){return{restrict:"E",require:"ngModel",scope:{fallbackValue:"=",disabled:"=?",format:"=?",options:"=?",triggerId:"@?",onChange:"&?",onShow:"&?",onHide:"&?",onMove:"&?",onBeforeShow:"&?"},replace:!0,templateUrl:"directive.html",link:function(b,c,d,e){function f(a){var c=a;return c&&(c=a.toString(b.format)),c}function g(c){a.isFunction(b.onChange)&&b.onChange({color:c})}function h(c){var d=b.fallbackValue;c?d=f(c):a.isUndefined(b.fallbackValue)&&(d=c),e.$setViewValue(d),g(d)}var i=c.find("input"),j=function(a){b.$apply(function(){h(a)})},k=function(){return i.spectrum("toggle"),!1},l={color:e.$viewValue},m={};a.forEach({change:"onChange",move:"onMove",hide:"onHide",show:"onShow"},function(c,d){m[d]=function(d){return j(d),"change"!==c&&a.isFunction(b[c])?b[c]({color:f(d)}):void 0}}),a.isFunction(b.onBeforeShow)&&(m.beforeShow=function(a){return b.onBeforeShow({color:f(a)})});var n=a.extend({},l,b.options,m);b.triggerId&&a.element(document.body).on("click","#"+b.triggerId,k),e.$render=function(){i.spectrum("set",e.$viewValue||""),g(e.$viewValue)},n.color&&(i.spectrum("set",n.color||""),h(n.color)),i.spectrum(n),b.$on("$destroy",function(){b.triggerId&&a.element(document.body).off("click","#"+b.triggerId,k),i.spectrum("destroy")}),a.isDefined(n.disabled)&&(b.disabled=!!n.disabled),b.$watch("disabled",function(a){i.spectrum(a?"disable":"enable")})}}})}(),a.module("angularSpectrumColorpicker").run(["$templateCache",function(a){a.put("directive.html","<span><input class=input-small></span>")}])}(window.angular),angular.module("ui.calendar",[]).constant("uiCalendarConfig",{}).controller("uiCalendarCtrl",["$scope","$timeout",function($scope,$timeout){var sourceSerialId=1,eventSerialId=1,sources=$scope.eventSources,extraEventSignature=$scope.calendarWatchEvent?$scope.calendarWatchEvent:angular.noop,wrapFunctionWithScopeApply=function(functionToWrap){var wrapper;return functionToWrap&&(wrapper=function(){var args=arguments;$timeout(function(){functionToWrap.apply(this,args)})}),wrapper};this.eventsFingerprint=function(e){return e.__uiCalId||(e.__uiCalId=eventSerialId++),""+e.__uiCalId+(e.id||"")+(e.title||"")+(e.url||"")+(+e.start||"")+(+e.end||"")+(e.allDay||"")+(e.className||"")+extraEventSignature(e)||""},this.sourcesFingerprint=function(source){return source.__id||(source.__id=sourceSerialId++)},this.allEvents=function(){for(var arraySources=[],i=0,srcLen=sources.length;srcLen>i;i++){var source=sources[i];if(angular.isArray(source))arraySources.push(source);else if(angular.isObject(source)&&angular.isArray(source.events)){var extEvent={};for(var key in source)"_uiCalId"!==key&&"events"!==key&&(extEvent[key]=source[key]);for(var eI=0;eI<source.events.length;eI++)angular.extend(source.events[eI],extEvent);arraySources.push(source.events)}}return Array.prototype.concat.apply([],arraySources)},this.changeWatcher=function(arraySource,tokenFn){var self,getTokens=function(){for(var token,el,array=angular.isFunction(arraySource)?arraySource():arraySource,result=[],i=0,n=array.length;n>i;i++)el=array[i],token=tokenFn(el),map[token]=el,result.push(token);return result},subtractAsSets=function(a,b){var i,n,result=[],inB={};for(i=0,n=b.length;n>i;i++)inB[b[i]]=!0;for(i=0,n=a.length;n>i;i++)inB[a[i]]||result.push(a[i]);return result},map={},applyChanges=function(newTokens,oldTokens){var i,n,el,token,replacedTokens={},removedTokens=subtractAsSets(oldTokens,newTokens);for(i=0,n=removedTokens.length;n>i;i++){var removedToken=removedTokens[i];el=map[removedToken],delete map[removedToken];var newToken=tokenFn(el);newToken===removedToken?self.onRemoved(el):(replacedTokens[newToken]=removedToken,self.onChanged(el))}var addedTokens=subtractAsSets(newTokens,oldTokens);for(i=0,n=addedTokens.length;n>i;i++)token=addedTokens[i],el=map[token],replacedTokens[token]||self.onAdded(el)};return self={subscribe:function(scope,onChanged){scope.$watch(getTokens,function(newTokens,oldTokens){onChanged&&onChanged(newTokens,oldTokens)===!1||applyChanges(newTokens,oldTokens)},!0)},onAdded:angular.noop,onChanged:angular.noop,onRemoved:angular.noop}},this.getFullCalendarConfig=function(calendarSettings,uiCalendarConfig){var config={};return angular.extend(config,uiCalendarConfig),angular.extend(config,calendarSettings),angular.forEach(config,function(value,key){"function"==typeof value&&(config[key]=wrapFunctionWithScopeApply(config[key]))}),config}}]).directive("uiCalendar",["uiCalendarConfig","$locale",function(uiCalendarConfig,$locale){var tValues=function(data){var r,k;r=[];for(k in data)r[k]=data[k];return r},dtf=$locale.DATETIME_FORMATS;return uiCalendarConfig=angular.extend({monthNames:tValues(dtf.MONTH),monthNamesShort:tValues(dtf.SHORTMONTH),dayNames:tValues(dtf.DAY),dayNamesShort:tValues(dtf.SHORTDAY)},uiCalendarConfig||{}),{restrict:"A",scope:{eventSources:"=ngModel",calendarWatchEvent:"&"},controller:"uiCalendarCtrl",link:function(scope,elm,attrs,controller){function getOptions(){var fullCalendarConfig,calendarSettings=attrs.uiCalendar?scope.$parent.$eval(attrs.uiCalendar):{};fullCalendarConfig=controller.getFullCalendarConfig(calendarSettings,uiCalendarConfig),options={eventSources:sources},angular.extend(options,fullCalendarConfig);var options2={};for(var o in options)"eventSources"!==o&&(options2[o]=options[o]);return JSON.stringify(options2)}var sources=scope.eventSources,sourcesChanged=!1,eventSourcesWatcher=controller.changeWatcher(sources,controller.sourcesFingerprint),eventsWatcher=controller.changeWatcher(controller.allEvents,controller.eventsFingerprint),options=null;scope.destroy=function(){scope.calendar=attrs.calendar?scope.$parent[attrs.calendar]=elm.html(""):elm.html("")},scope.init=function(){scope.calendar.fullCalendar(options)},eventSourcesWatcher.onAdded=function(source){scope.calendar.fullCalendar("addEventSource",source),sourcesChanged=!0},eventSourcesWatcher.onRemoved=function(source){scope.calendar.fullCalendar("removeEventSource",source),sourcesChanged=!0},eventsWatcher.onAdded=function(event){scope.calendar.fullCalendar("renderEvent",event)},eventsWatcher.onRemoved=function(event){scope.calendar.fullCalendar("removeEvents",function(e){return e===event})},eventsWatcher.onChanged=function(event){scope.calendar.fullCalendar("updateEvent",event)},eventSourcesWatcher.subscribe(scope),eventsWatcher.subscribe(scope,function(){return sourcesChanged===!0?(sourcesChanged=!1,!1):void 0}),scope.$watch(getOptions,function(){scope.destroy(),scope.init()})}}}]),function($){$.fn.visible=function(partial,hidden){var $t=$(this).eq(0),t=$t.get(0),$w=$(window),viewTop=$w.scrollTop(),viewBottom=viewTop+$w.height(),_top=$t.offset().top,_bottom=_top+$t.height(),compareTop=partial===!0?_bottom:_top,compareBottom=partial===!0?_top:_bottom,clientSize=hidden===!0?t.offsetWidth*t.offsetHeight:!0;return!!clientSize&&viewBottom>=compareBottom&&compareTop>=viewTop}}(jQuery),function(factory){"function"==typeof define&&define.amd?define(["moment"],factory):"object"==typeof exports?module.exports=factory(require("../moment")):factory(("undefined"!=typeof global?global:this).moment)}(function(moment){return moment.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(number){var b=number%10,output=1===~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output},week:{dow:1,doy:4}})}),function(){"use strict";var adminapp;adminapp=angular.module("BBAdmin",["BB","BBAdmin.Services","BBAdmin.Filters","BBAdmin.Controllers"]),angular.module("BBAdmin").config(function($logProvider){return $logProvider.debugEnabled(!0)}),angular.module("BBAdmin.Directives",[]),angular.module("BBAdmin.Filters",[]),angular.module("BBAdmin.Services",["ngResource","ngSanitize","ngLocalData"]),angular.module("BBAdmin.Controllers",["ngLocalData","ngSanitize"]),adminapp.run(function($rootScope,$log,DebugUtilsService,FormDataStoreService,$bbug,$document,$sessionStorage,AppConfig,AdminLoginService){return AdminLoginService.checkLogin(),$rootScope.user&&$rootScope.user.company_id?($rootScope.bb||($rootScope.bb={}),$rootScope.bb.company_id=$rootScope.user.company_id):void 0})}.call(this),function(){"use strict";var app;app=angular.module("BB",["BB.Controllers","BB.Filters","BB.Models","BB.Services","BB.Directives","angular-hal","ui.bootstrap","ngSanitize","ui.map","ui.utils","ngLocalData","ui.router","ngAnimate","angular-data.DSCacheFactory","schemaForm","ngStorage","angularFileUpload"]),app.value("AppConfig",{}),window.use_no_conflict?(window.bbjq=$.noConflict(),app.value("$bbug",jQuery.noConflict(!0))):app.value("$bbug",jQuery),app.config(function($locationProvider,$httpProvider){return $httpProvider.defaults.headers.common={"App-Id":"f6b16c23","App-Key":"f0bc4f65f4fbfe7b4b3b7264b655f5eb"},$locationProvider.html5Mode(!1).hashPrefix("!")}),app.run(function($rootScope,$log,DebugUtilsService,FormDataStoreService,$bbug,$document,$sessionStorage){return $rootScope.$log=$log,$rootScope.$setIfUndefined=FormDataStoreService.setIfUndefined,$rootScope.bb||($rootScope.bb={}),$rootScope.bb.api_url=$sessionStorage.getItem("host"),$bbug.support.opacity===!1?($document.createElement("header"),$document.createElement("nav"),$document.createElement("section"),$document.createElement("footer")):void 0}),angular.module("BB.Services",["ngResource","ngSanitize","ngLocalData"]),angular.module("BB.Controllers",["ngLocalData","ngSanitize"]),angular.module("BB.Directives",[]),angular.module("BB.Filters",[]),angular.module("BB.Models",[]),window.angular.ieCreateHttpBackend=function($browser,XHR,$browserDefer,callbacks,rawDocument,locationProtocol,msie,xhr,$bbug){var completeRequest,getHostName,isLocalCall,loc,pmHandler,res;return loc=window.location,!msie||msie>9?null:(loc.origin=loc.protocol+"//"+loc.host,getHostName=function(path){var a;return a=document.createElement("a"),a.href=path,a.hostname},isLocalCall=function(reqUrl){return/^http(s)?/.test(reqUrl)&&reqUrl.indexOf(loc.origin)<0?!1:!0},completeRequest=function(callback,status,response,headersString){var URL_MATCH,protocol,url;return url=url||$browser.url(),URL_MATCH=/^([^:]+):\/\/(\w+:{0,1}\w*@)?(\{?[\w\.-]*\}?)(:([0-9]+))?(\/[^\?#]*)?(\?([^#]*))?(#(.*))?$/,protocol=(url.match(URL_MATCH)||["",locationProtocol])[1],1223===status&&(status=204),callback(status,response,headersString),$browser.$$completeOutstandingRequest(angular.noop)},pmHandler=function(method,url,post,callback,headers){var win;return win=$bbug('[name="'+getHostName(url)+'"]')[0].id,window.pm({target:window.frames[win],type:"xhrRequest",data:{headers:headers,method:method,data:post,url:url},success:function(respObj){var resp;return resp="Content-Type: "+respObj.contentType,respObj.authToken&&(resp+="\nAuth-Token: "+respObj.authToken),completeRequest(callback,200,respObj.responseText,resp)
},error:function(){return completeRequest(callback,500,"Error","Content-Type: text/plain")}})},res=function(method,url,post,callback,headers,timeout,withCredentials){return $browser.$$incOutstandingRequestCount(),url=url||$browser.url(),isLocalCall(url)?xhr(method,url,post,callback,headers,timeout,withCredentials):pmHandler(method,url,post,callback,headers,timeout,withCredentials),timeout>0?$browserDefer(function(){return window.status=-1,xhr.abort()},timeout):void 0})},window.bookingbug={logout:function(options){var logout_opts;return options||(options={}),options.reload!==!1&&(options.reload=!0),logout_opts={app_id:"f6b16c23",app_key:"f0bc4f65f4fbfe7b4b3b7264b655f5eb"},options.root&&(logout_opts.root=options.root),angular.injector(["BB.Services","BB.Models","ng"]).get("LoginService").logout(logout_opts),options.reload?window.location.reload():void 0}}}.call(this),function(){"use strict";angular.module("BBMember",["BB","BBMember.Directives","BBMember.Services","BBMember.Filters","BBMember.Controllers","BBMember.Models","trNgGrid","pascalprecht.translate"]),angular.module("BBMember").config(function($logProvider){return $logProvider.debugEnabled(!0)}),angular.module("BBMember").run(function(){return TrNgGrid.defaultColumnOptions={enableFiltering:!1}}),angular.module("BBMember.Directives",[]),angular.module("BBMember.Filters",[]),angular.module("BBMember.Services",["ngResource","ngSanitize","ngLocalData"]),angular.module("BBMember.Controllers",["ngLocalData","ngSanitize"]),angular.module("BBMember.Models",[]),angular.module("BBMemberMockE2E",["BBMember","BBAdminMockE2E"])}.call(this),function(){"use strict";angular.module("BBPersonTable",["BB","BBAdmin.Services","BBAdmin.Filters","BBAdmin.Controllers","trNgGrid"]),angular.module("BBPersonTable").config(function($logProvider){return $logProvider.debugEnabled(!0)})}.call(this),function(){"use strict";angular.module("BBAdminServices",["BB","BBAdmin.Services","BBAdmin.Filters","BBAdmin.Controllers","trNgGrid"]),angular.module("BBAdminServices").config(function($logProvider){return $logProvider.debugEnabled(!0)}),angular.module("BBAdminServicesMockE2E",["BBAdminServices","BBAdminMockE2E"])}.call(this),function(){"use strict";angular.module("BBAdminSettings",["BB","BBAdmin.Services","BBAdmin.Filters","BBAdmin.Controllers","trNgGrid"]),angular.module("BBAdminSettings").config(function($logProvider){return $logProvider.debugEnabled(!0)}),angular.module("BBAdminSettingsMockE2E",["BBAdminSettings","BBAdminMockE2E"])}.call(this),function(){"use strict";var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("BB.Models").factory("BBWidget",function($q,BBModel,BasketService,$urlMatcherFactory,$location,BreadcrumbService){var Widget;return Widget=function(){function Widget(){this.clearAddress=__bind(this.clearAddress,this),this.emptyStackedItems=__bind(this.emptyStackedItems,this),this.deleteStackedItemByService=__bind(this.deleteStackedItemByService,this),this.deleteStackedItem=__bind(this.deleteStackedItem,this),this.sortStackedItems=__bind(this.sortStackedItems,this),this.setStackedItems=__bind(this.setStackedItems,this),this.stackItem=__bind(this.stackItem,this),this.waitForRoutes=__bind(this.waitForRoutes,this),this.setBasicRoute=__bind(this.setBasicRoute,this),this.setRoute=__bind(this.setRoute,this),this.calculatePercentageComplete=__bind(this.calculatePercentageComplete,this),this.recordStep=__bind(this.recordStep,this),this.recordCurrentPage=__bind(this.recordCurrentPage,this),this.uid=_.uniqueId("bbwidget_"),this.page_suffix="",this.steps=[],this.allSteps=[],this.item_defaults={},this.usingBasket=!1,this.confirmCheckout=!1,this.isAdmin=!1,this.payment_status=null}return Widget.prototype.pageURL=function(route){return route+".html"},Widget.prototype.updateRoute=function(page){var company,date,event_group,pattern,prms,service_name,time,url;if(this.routeFormat)return page||(page=this.current_page),pattern=$urlMatcherFactory.compile(this.routeFormat),service_name="-",event_group="-",this.current_item&&(this.current_item.service&&(service_name=this.convertToDashSnakeCase(this.current_item.service.name)),this.current_item.event_group&&(event_group=this.convertToDashSnakeCase(this.current_item.event_group.name)),this.current_item.date&&(date=this.current_item.date.date.toISODate()),this.current_item.time&&(time=this.current_item.time.time),this.current_item.company&&(company=this.convertToDashSnakeCase(this.current_item.company.name))),this.route_values&&(prms=angular.copy(this.route_values)),prms||(prms={}),angular.extend(prms,{page:page,company:company,service:service_name,event_group:event_group,date:date,time:time}),url=pattern.format(prms),url=url.replace(/\/+$/,""),$location.path(url),this.routing=!0,url},Widget.prototype.setRouteFormat=function(route){var match,match_test,parts,path,pattern;if(this.routeFormat=route,this.routeFormat&&(this.routing=!0,path=$location.path())){for(parts=this.routeFormat.split("/");parts.length>0&&!match;)match_test=parts.join("/"),pattern=$urlMatcherFactory.compile(match_test),match=pattern.exec(path),parts.pop();if(match)return match.company&&(this.item_defaults.company=decodeURIComponent(match.company)),match.service&&"-"!==match.service&&(this.item_defaults.service=decodeURIComponent(match.service)),match.event_group&&"-"!==match.event_group&&(this.item_defaults.event_group=match.event_group),match.person&&(this.item_defaults.person=decodeURIComponent(match.person)),match.resource&&(this.item_defaults.resource=decodeURIComponent(match.resource)),match.date&&(this.item_defaults.date=match.date),match.time&&(this.item_defaults.time=match.time),this.route_matches=match}},Widget.prototype.matchURLToStep=function(){var path,step,_i,_j,_len,_ref;if(!this.routeFormat)return null;for(path=$location.path(),_ref=this.steps,_i=_j=0,_len=_ref.length;_len>_j;_i=++_j)if(step=_ref[_i],step.url&&step.url===path)return step.number;return null},Widget.prototype.convertToDashSnakeCase=function(str){return str=str.toLowerCase(),str=$.trim(str),str=str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,""),str=str.replace(/\s{2,}/g," "),str=str.replace(/\s/g,"-")},Widget.prototype.recordCurrentPage=function(){var match,step,title,_i,_j,_k,_len,_len1,_len2,_ref,_ref1,_ref2;if(this.current_step||(this.current_step=0),match=!1,this.allSteps)for(_ref=this.allSteps,_i=0,_len=_ref.length;_len>_i;_i++)step=_ref[_i],step.page===this.current_page&&(this.current_step=step.number,match=!0);if(!match)for(_ref1=this.steps,_j=0,_len1=_ref1.length;_len1>_j;_j++)step=_ref1[_j],step&&step.page===this.current_page&&(this.current_step=step.number,match=!0);if(match||(this.current_step+=1),title="",this.allSteps){for(_ref2=this.allSteps,_k=0,_len2=_ref2.length;_len2>_k;_k++)step=_ref2[_k],step.active=!1,step.passed=step.number<this.current_step;this.allSteps[this.current_step-1]&&(this.allSteps[this.current_step-1].active=!0,title=this.allSteps[this.current_step-1].title)}return this.recordStep(this.current_step,title)},Widget.prototype.recordStep=function(step,title){var _i,_len,_ref;for(this.steps[step-1]={url:this.updateRoute(this.current_page),current_item:this.current_item.getStep(),page:this.current_page,number:step,title:title,stacked_length:this.stacked_items.length},BreadcrumbService.setCurrentStep(step),_ref=this.steps,_i=0,_len=_ref.length;_len>_i;_i++)step=_ref[_i],step&&(step.passed=step.number<this.current_step,step.active=step.number===this.current_step);return this.calculatePercentageComplete(step.number),this.last_step_reached=this.allSteps&&this.allSteps.length===step||"checkout"===this.current_page?!0:!1},Widget.prototype.calculatePercentageComplete=function(step_number){return this.percentage_complete=step_number&&this.allSteps?step_number/this.allSteps.length*100:0},Widget.prototype.setRoute=function(rdata){var i,route,step,_i,_j,_len,_len1,_ref;for(this.allSteps.length=0,this.nextSteps={},this.routeSteps={},void 0!==rdata&&null!==rdata&&void 0!==rdata[0]&&(this.firstStep=rdata[0].page),i=_i=0,_len=rdata.length;_len>_i;i=++_i)if(step=rdata[i],step.disable_breadcrumbs&&(this.disableGoingBackAtStep=i+1),rdata[i+1]&&(this.nextSteps[step.page]=rdata[i+1].page),this.allSteps.push({number:i+1,title:step.title,page:step.page}),step.when)for(_ref=step.when,_j=0,_len1=_ref.length;_len1>_j;_j++)route=_ref[_j],this.routeSteps[route]=step.page;return this.$wait_for_routing?this.$wait_for_routing.resolve():void 0},Widget.prototype.setBasicRoute=function(routes){var i,step,_i,_len;for(this.nextSteps={},this.firstStep=routes[0],i=_i=0,_len=routes.length;_len>_i;i=++_i)step=routes[i],this.nextSteps[step]=routes[i+1];return this.$wait_for_routing?this.$wait_for_routing.resolve():void 0},Widget.prototype.waitForRoutes=function(){return this.$wait_for_routing?void 0:this.$wait_for_routing=$q.defer()},Widget.prototype.stackItem=function(item){return this.stacked_items.push(item),this.sortStackedItems()},Widget.prototype.setStackedItems=function(items){return this.stacked_items=items,this.sortStackedItems()},Widget.prototype.sortStackedItems=function(){var arr,item,_i,_len,_ref;for(arr=[],_ref=this.stacked_items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],arr=arr.concat(item.promises);return $q.all(arr)["finally"](function(_this){return function(){return _this.stacked_items=_this.stacked_items.sort(function(a,b){var _ref1,_ref2;return a.time&&b.time?null!=(_ref1=a.time.time>b.time.time)?_ref1:{1:-1}:a.service.category&&!b.service.category?1:b.service.category&&!a.service.category?-1:b.service.category||a.service.category?null!=(_ref2=a.service.category.order>b.service.category.order)?_ref2:{1:-1}:1})}}(this))},Widget.prototype.deleteStackedItem=function(item){return item&&item.id&&BasketService.deleteItem(item,this.company,{bb:this}),this.stacked_items=this.stacked_items.filter(function(i){return i!==item})},Widget.prototype.deleteStackedItemByService=function(item){var i,_i,_len,_ref;for(_ref=this.stacked_items,_i=0,_len=_ref.length;_len>_i;_i++)i=_ref[_i],i&&i.service&&i.service.self===item.self&&i.id&&BasketService.deleteItem(i,this.company,{bb:this});return this.stacked_items=this.stacked_items.filter(function(i){return i&&i.service&&i.service.self!==item.self})},Widget.prototype.emptyStackedItems=function(){return this.stacked_items=[]},Widget.prototype.pushStackToBasket=function(){var i,_i,_len,_ref;for(this.basket||(this.basket=new new BBModel.Basket(null,this)),_ref=this.stacked_items,_i=0,_len=_ref.length;_len>_i;_i++)i=_ref[_i],this.basket.addItem(i);return this.emptyStackedItems()},Widget.prototype.clearAddress=function(){return delete this.address1,delete this.address2,delete this.address3,delete this.address4,delete this.address5},Widget}()})}.call(this),function(){window.Collection=function(){function Collection(){}return Collection}(),window.Collection.Base=function(){function Base(res,items,params){var m,n;if(this.res=res,this.items=items,this.params=params,this.callbacks=[],this.jparams=JSON.stringify(this.params),res)for(n in res)m=res[n],this[n]=m}return Base.prototype.checkItem=function(item){var call,i,_i,_j,_k,_len,_len1,_len2,_ref,_ref1,_ref2,_results;if(!this.matchesParams(item))return this.deleteItem(item),!0;for(_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++)if(i=_ref[_i],item.self===i.self){for(this.items[_i]=item,_ref1=this.callbacks,_j=0,_len1=_ref1.length;_len1>_j;_j++)call=_ref1[_j],call[1](item,"update");return!0}for(this.items.push(item),_ref2=this.callbacks,_results=[],_k=0,_len2=_ref2.length;_len2>_k;_k++)call=_ref2[_k],_results.push(call[1](item,"add"));return _results},Base.prototype.deleteItem=function(item){var call,len,_i,_len,_ref,_results;if(len=this.items.length,this.items=this.items.filter(function(x){return x.self!==item.self}),this.items.length!==len){for(_ref=this.callbacks,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)call=_ref[_i],_results.push(call[1](item,"delete"));return _results}},Base.prototype.getItems=function(){return this.items},Base.prototype.addCallback=function(obj,fn){var call,_i,_len,_ref;for(_ref=this.callbacks,_i=0,_len=_ref.length;_len>_i;_i++)if(call=_ref[_i],call[0]===obj)return;return this.callbacks.push([obj,fn])},Base.prototype.matchesParams=function(){return!0},Base}(),window.BaseCollections=function(){function BaseCollections(){this.collections=[]}return BaseCollections.prototype.count=function(){return this.collections.length},BaseCollections.prototype.add=function(col){return this.collections.push(col)},BaseCollections.prototype.checkItems=function(item){var col,_i,_len,_ref,_results;for(_ref=this.collections,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)col=_ref[_i],_results.push(col.checkItem(item));return _results},BaseCollections.prototype.deleteItems=function(item){var col,_i,_len,_ref,_results;for(_ref=this.collections,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)col=_ref[_i],_results.push(col.deleteItem(item));return _results},BaseCollections.prototype.find=function(prms){var col,jprms,_i,_len,_ref;for(jprms=JSON.stringify(prms),_ref=this.collections,_i=0,_len=_ref.length;_len>_i;_i++)if(col=_ref[_i],jprms===col.jparams)return col},BaseCollections}()}.call(this),function(){"use strict";angular.module("BBAdminMockE2E",["BBAdmin","ngMockE2E"]),angular.module("BBAdminMockE2E").run(function($httpBackend){var admin_schema,administrators,company,member_bookings,member_schema,people,person_schema,service_schema,services;return $httpBackend.whenPOST("http://www.bookingbug.com/api/v1/login/admin/123").respond(function(){var login;return console.log("login post"),login={email:"tennis@example.com",auth_token:"PO_MZmDtEhU1BK6tkMNPjg",company_id:123,path:"http://www.bookingbug.com/api/v1",role:"owner",_embedded:{members:[],administrators:[{role:"owner",name:"Tom's Tennis",company_id:123,_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/administrator/29774"},company:{href:"http://www.bookingbug.com/api/v1/admin/123/company"},login:{href:"http://www.bookingbug.com/api/v1/login/admin/123"}}}]},_links:{self:{href:"http://www.bookingbug.com/api/v1/login/123"},administrator:{href:"http://www.bookingbug.com/api/v1/admin/123/administrator/29774",templated:!0}}},[200,login,{}]}),company={id:123,name:"Tom's Tennis",currency_code:"GBP",country_code:"gb",timezone:"Europe/London",_links:{self:{href:"http://www.bookingbug.com/api/v1/company/123"},new_person:{href:"http://www.bookingbug.com/api/v1/admin/123/people/new{?signup}",templated:!0},administrators:{href:"http://www.bookingbug.com/api/v1/admin/123/administrators"},new_administrator:{href:"http://www.bookingbug.com/api/v1/admin/123/administrators/new"},services:{href:"http://www.bookingbug.com/api/v1/admin/123/services"},new_service:{href:"http://www.bookingbug.com/api/v1/admin/123/services/new"}}},$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/company").respond(company),people={total_entries:3,_embedded:{people:[{id:1,name:"John",type:"person",deleted:!1,disabled:!1,company_id:123,mobile:"",_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/people/1"},items:{href:"http://www.bookingbug.com/api/v1/123/items?person_id=1"}},_embedded:{}},{id:2,name:"Mary",type:"person",email:"mary@example.com",deleted:!1,disabled:!1,company_id:123,mobile:"",_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/people/2"},items:{href:"http://www.bookingbug.com/api/v1/123/items?person_id=2"}},_embedded:{}},{id:3,name:"Bob",type:"person",email:"bob@example.com",deleted:!1,disabled:!1,company_id:123,mobile:"",_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/people/3"},items:{href:"http://www.bookingbug.com/api/v1/123/items?person_id=3"}},_embedded:{}}]},_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/people"},"new":{href:"http://www.bookingbug.com/api/v1/admin/123/people/new{?signup}",templated:!0}}},$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/people").respond(people),person_schema={form:[{key:"name",type:"text",feedback:!1},{key:"email",type:"email",feedback:!1},{key:"phone",type:"text",feedback:!1},{type:"submit",title:"Save"}],schema:{properties:{email:{title:"Email *",type:"String"},name:{title:"Name *",type:"String"},phone:{title:"Phone",type:"String"}},required:["name","email"],title:"Person",type:"object"}},$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/people/new").respond(function(){return[200,person_schema,{}]}),$httpBackend.whenPOST("http://www.bookingbug.com/api/v1/admin/123/people").respond(function(method,url,data){return console.log("post person"),console.log(method),console.log(url),console.log(data),[200,people.concat([data]),{}]}),services={total_entries:3,_embedded:{services:[{id:1,name:"Data analysis",type:"service",deleted:!1,disabled:!1,company_id:123,_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/services/1"},edit:{href:"http://www.bookingbug.com/api/v1/admin/123/services/1/edit",templated:!0},items:{href:"http://www.bookingbug.com/api/v1/123/items?service_id=1"}},_embedded:{}},{id:2,name:"Personal consultation",type:"service",deleted:!1,disabled:!1,company_id:123,_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/services/2"},edit:{href:"http://www.bookingbug.com/api/v1/admin/123/services/2/edit",templated:!0},items:{href:"http://www.bookingbug.com/api/v1/123/items?service_id=2"}},_embedded:{}},{id:3,name:"Marketing strategy",type:"service",deleted:!1,disabled:!1,company_id:123,_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/services/3"},edit:{href:"http://www.bookingbug.com/api/v1/admin/123/services/3/edit",templated:!0},items:{href:"http://www.bookingbug.com/api/v1/123/items?service_id=3"}},_embedded:{}}]},_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/services"},"new":{href:"http://www.bookingbug.com/api/v1/admin/123/services/new{?signup}",templated:!0}}},$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/services").respond(services),service_schema={form:[{key:"name",type:"text",feedback:!1},{type:"submit",title:"Save"}],schema:{properties:{name:{title:"Name *",type:"String"}},required:["name"],title:"Service",type:"object"}},$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/services/new").respond(function(){return[200,service_schema,{}]}),$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/services/1/edit").respond(function(){return[200,service_schema,{}]}),$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/services/2/edit").respond(function(){return[200,service_schema,{}]}),$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/services/3/edit").respond(function(){return[200,service_schema,{}]}),$httpBackend.whenPOST("http://www.bookingbug.com/api/v1/admin/123/services").respond(function(method,url,data){return console.log("post service"),console.log(method),console.log(url),console.log(data),[200,services.concat([data]),{}]}),administrators={_embedded:{administrators:[{name:"Dave",email:"dave@example.com",role:"admin",company_id:123,company_name:"Tom's Tennis",_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/administrators/1"},edit:{href:"http://www.bookingbug.com/api/v1/admin/123/administrators/1/edit"},company:{href:"http://www.bookingbug.com/api/v1/admin/123/company"},login:{href:"http://www.bookingbug.com/api/v1/login/admin/123"}}},{name:"Sue",email:"sue@example.com",role:"owner",company_id:123,company_name:"Tom's Tennis",_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/administrators/2"},edit:{href:"http://www.bookingbug.com/api/v1/admin/123/administrators/2/edit"},company:{href:"http://www.bookingbug.com/api/v1/admin/123/company"},login:{href:"http://www.bookingbug.com/api/v1/login/admin/123"}}}]},_links:{self:{href:"http://www.bookingbug.com/api/v1/admin/123/administrators"},"new":{href:"http://www.bookingbug.com/api/v1/admin/123/administrators/new",templated:!0}}},$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/administrators").respond(administrators),admin_schema={form:[{key:"name",type:"text",feedback:!1},{key:"email",type:"text",feedback:!1},{key:"role",type:"select",feedback:!1,titleMap:{owner:"Owner",admin:"Admin",user:"User"}},{type:"submit",title:"Save"}],schema:{properties:{name:{title:"Name *",type:"string"},email:{title:"Email *",type:"string"},role:{title:"Role",type:"string","enum":["owner","admin","user","callcenter"]}},required:["name","email"],title:"Administrator",type:"object"}},$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/administrators/new").respond(function(){return[200,admin_schema,{}]}),admin_schema={form:[{key:"name",type:"text",feedback:!1},{key:"role",type:"select",feedback:!1,titleMap:{owner:"Owner",admin:"Admin",user:"User"}},{type:"submit",title:"Save"}],schema:{properties:{name:{title:"Name *",type:"string"},role:{title:"Role",type:"string","enum":["owner","admin","user","callcenter"]}},title:"Administrator",type:"object"}},$httpBackend.whenGET("http://www.bookingbug.com/api/v1/admin/123/administrators/1/edit").respond(function(){return[200,admin_schema,{}]}),$httpBackend.whenPOST("http://www.bookingbug.com/api/v1/login/member/123").respond(function(){var login;return login={email:"smith@example.com",auth_token:"TO_4ZrDtEhU1BK6tkMNPj0",company_id:123,path:"http://www.bookingbug.com/api/v1",role:"member",_embedded:{members:[{first_name:"John",last_name:"Smith",email:"smith@example.com",client_type:"Member",address1:"Some street",address3:"Some town",id:123456,company_id:123,_links:{self:{href:"http://www.bookingbug.com/api/v1/123/members/123456{?embed}",templated:!0},bookings:{href:"http://www.bookingbug.com/api/v1/123/members/123456/bookings{?start_date,end_date,include_cancelled,page,per_page}",templated:!0},company:{href:"http://www.bookingbug.com/api/v1/company/123",templated:!0},edit_member:{href:"http://www.bookingbug.com/api/v1/123/members/123456/edit",templated:!0},pre_paid_bookings:{href:"http://www.bookingbug.com/api/v1/123/members/123456/pre_paid_bookings{?start_date,end_date,page,per_page}",templated:!0}}}],administrators:[]},_links:{self:{href:"http://www.bookingbug.com/api/v1/login/123"},member:{href:"http://www.bookingbug.com/api/v1/123/members/123456{?embed}",templated:!0}}},[200,login,{}]}),member_schema={form:[{key:"first_name",type:"text",feedback:!1},{key:"last_name",type:"text",feedback:!1},{key:"email",type:"email",feedback:!1},{key:"address1",type:"text",feedback:!1},{key:"address2",type:"text",feedback:!1},{key:"address3",type:"text",feedback:!1},{key:"address4",type:"text",feedback:!1},{key:"postcode",type:"text",feedback:!1},{type:"submit",title:"Save"}],schema:{properties:{first_name:{title:"First Name",type:"string"},last_name:{title:"Last Name",type:"string"},email:{title:"Email",type:"string"},address1:{title:"Address",type:"string"},address2:{title:" ",type:"string"},address3:{title:"Town",type:"string"},address4:{title:"County",type:"string"},postcode:{title:"Post Code",type:"string"}},title:"Member",type:"object"}},$httpBackend.whenGET("http://www.bookingbug.com/api/v1/123/members/123456/edit").respond(function(){return[200,member_schema,{}]}),member_bookings={_embedded:{bookings:[{_embedded:{answers:[{admin_only:!1,company_id:123,id:6700607,outcome:!1,price:0,question_id:20478,question_text:"Gender",value:"M"}]},_links:{company:{href:"http://www.bookingbug.com/api/v1/company/123"},edit_booking:{href:"http://www.bookingbug.com/api/v1/123/members/123456/bookings/4553463/edit"},member:{href:"http://www.bookingbug.com/api/v1/123/members/123456{?embed}",templated:!0},person:{href:"http://www.bookingbug.com/api/v1/123/people/74",templated:!0},self:{href:"http://www.bookingbug.com/api/v1/123/members/123456/bookings?start_date=2014-11-21&page=1&per_page=30"},service:{href:"http://www.bookingbug.com/api/v1/123/services/30063",templated:!0}},attended:!0,category_name:"Private Lessons",company_id:123,datetime:"2014-11-21T12:00:00+00:00",describe:"Fri 21st Nov 12:00pm",duration:3600,end_datetime:"2014-11-21T13:00:00+00:00",event_id:325562,full_describe:"Tennis Lesson",id:4553463,min_cancellation_time:"2014-11-20T12:00:00+00:00",on_waitlist:!1,paid:0,person_name:"Bob",price:1,purchase_id:3844035,purchase_ref:"j7PuYsmbexmFXS12Mzg0NDAzNQ%3D%3D",quantity:1,service_name:"Tennis Lesson",time_zone:""}]},_links:{self:{href:"http://www.bookingbug.com/api/v1/123/members/123456/bookings?start_date=2014-11-21&page=1&per_page=30"}},total_entries:1},$httpBackend.whenGET("http://www.bookingbug.com/api/v1/123/members/123456/bookings?start_date="+moment().format("YYYY-MM-DD")).respond(function(){return[200,member_bookings,{}]})})}.call(this),angular.module("angular-hal",[]).provider("data_cache",function(){this.$get=function(){return data=[],{set:function(key,val){return data[key]=val,val},get:function(key){return data[key]},del:function(key){delete data[key]},has:function(key){return key in data},delMatching:function(str){for(var k in data)-1!=k.indexOf(str)&&delete data[k]}}}}).provider("shared_header",function(){this.$get=function(){return data={},{set:function(key,val){return sessionStorage.setItem(key,val),data[key]=val,val},get:function(key){return data[key]},del:function(key){delete data[key]},has:function(key){return key in data}}}}).factory("halClient",["$http","$q","data_cache","shared_header",function($http,$q,data_cache,shared_header){function BaseResource(href,options,data){function defineHiddenProperty(target,name,value){target[name]=value}function embedResource(resource){if(angular.isArray(resource))return resource.map(function(resource){return embedResource(resource)});var href=resource.$href("self");embedded.set(href,$q.when(resource))}function hrefLink(link,params){var href=link.templated?new UriTemplate.parse(link.href).expand(params||{}):link.href;return href}function callLink(method,link,params,data){if(angular.isArray(link))return $q.all(link.map(function(link){if("GET"!==method)throw"method is not supported for arrays";return callLink(method,link,params,data)}));var linkHref=hrefLink(link,params);return"GET"===method?embedded.has(linkHref)?embedded.get(linkHref):embedded.set(linkHref,callService(method,linkHref,options,data)):callService(method,linkHref,options,data)}function flushLink(link,params){if(angular.isArray(link))return link.map(function(link){return flushLink(link,params)});var linkHref=hrefLink(link,params);embedded.has(linkHref)&&embedded.del(linkHref)}options||(options={});var links={},embedded=data_cache;data.hasOwnProperty("auth_token")&&(options.auth_token=data.auth_token),href=getSelfLink(href,data).href,defineHiddenProperty(this,"$href",function(rel,params){return rel in links?hrefLink(links[rel],params):null}),defineHiddenProperty(this,"$has",function(rel){return rel in links}),defineHiddenProperty(this,"$flush",function(rel,params){var link=links[rel];return flushLink(link,params)}),defineHiddenProperty(this,"$get",function(rel,params){var link=links[rel];return callLink("GET",link,params)}),defineHiddenProperty(this,"$post",function(rel,params,data){var link=links[rel];return callLink("POST",link,params,data)}),defineHiddenProperty(this,"$put",function(rel,params,data){var link=links[rel];return callLink("PUT",link,params,data)}),defineHiddenProperty(this,"$patch",function(rel,params,data){var link=links[rel];return callLink("PATCH",link,params,data)}),defineHiddenProperty(this,"$del",function(rel,params){var link=links[rel];return callLink("DELETE",link,params)}),defineHiddenProperty(this,"$links",function(){return links}),defineHiddenProperty(this,"$toStore",function(){return JSON.stringify({data:this,links:links,options:options})}),defineHiddenProperty(this,"setOption",function(key,value){options[key]=value}),defineHiddenProperty(this,"getOption",function(key){return options[key]}),defineHiddenProperty(this,"$link",function(rel){return links[rel]}),Object.keys(data).filter(function(key){return!~["_","$"].indexOf(key[0])}).forEach(function(key){this[key]=data[key]},this),data._links&&Object.keys(data._links).forEach(function(rel){var link=data._links[rel];link=normalizeLink(href,link),links[rel]=link},this),data._embedded&&Object.keys(data._embedded).forEach(function(rel){var embedded=data._embedded[rel],link=getSelfLink(href,embedded);links[rel]=link;var resource=createResource(href,options,embedded);embedResource(resource)},this)}function createResource(href,options,data){if(angular.isArray(data))return data.map(function(data){return createResource(href,options,data)});var resource=new BaseResource(href,options,data);return resource}function normalizeLink(baseHref,link){return angular.isArray(link)?link.map(function(link){return normalizeLink(baseHref,link)}):(link?("string"==typeof link&&(link={href:link}),link.href=resolveUrl(baseHref,link.href)):link={href:baseHref},link)}function getSelfLink(baseHref,resource){return angular.isArray(resource)?resource.map(function(resource){return getSelfLink(baseHref,resource)}):normalizeLink(baseHref,resource&&resource._links&&resource._links.self)}function callService(method,href,options,data){options||(options={}),headers={Authorization:options.authorization,"Content-Type":"application/json",Accept:"application/hal+json,application/json"},options.app_id&&shared_header.set("app_id",options.app_id),options.app_key&&shared_header.set("app_key",options.app_key),options.auth_token&&(sessionStorage.setItem("auth_token",options.auth_token),shared_header.set("auth_token",options.auth_token)),shared_header.has("app_id")&&(headers["App-Id"]=shared_header.get("app_id")),shared_header.has("app_key")&&(headers["App-Key"]=shared_header.get("app_key")),shared_header.has("auth_token")&&(headers["Auth-Token"]=shared_header.get("auth_token")),options.bypass_auth&&(headers["Bypass-Auth"]=options.bypass_auth);var resource=$http({method:method,url:options.transformUrl?options.transformUrl(href):href,headers:headers,data:data}).then(function(res){switch(res.headers("auth-token")&&(options.auth_token=res.headers("Auth-Token"),shared_header.set("auth_token",res.headers("Auth-Token"))),res.status){case 200:return res.data?createResource(href,options,res.data):null;case 201:return res.data?createResource(href,options,res.data):res.headers("Content-Location")?res.headers("Content-Location"):null;case 204:return null;default:return $q.reject(res)}},function(res){return $q.reject(res)});return resource}function parseHal(data){var resource=createResource(data._links.self.href,null,data);return resource}function resolveUrl(baseHref,href){for(var resultHref="",reFullUrl=/^((?:\w+\:)?)((?:\/\/)?)([^\/]*)((?:\/.*)?)$/,baseHrefMatch=reFullUrl.exec(baseHref),hrefMatch=reFullUrl.exec(href),partIndex=1;5>partIndex;partIndex++)resultHref+=hrefMatch[partIndex]?hrefMatch[partIndex]:baseHrefMatch[partIndex];return resultHref}return{setCache:function(cache){data_cache=cache},clearCache:function(str){data_cache.delMatching(str)},createResource:function(store){return"string"==typeof store&&(store=JSON.parse(store)),resource=store.data,resource._links=store.links,key=store.links.self.href,options=store.options,new BaseResource(key,options,resource)},$get:function(href,options){return!data_cache.has(href)||options&&options.no_cache?data_cache.set(href,callService("GET",href,options)):data_cache.get(href)},$post:function(href,options,data){return callService("POST",href,options,data)},$put:function(href,options,data){return callService("PUT",href,options,data)},$patch:function(href,options,data){return callService("PATCH",href,options,data)},$del:function(href,options){return callService("DELETE",href,options)},$parse:function(data){return parseHal(data)}}}]),angular.module("ngStorage",[]).factory("$fakeStorage",[function(){function FakeStorage(){}return FakeStorage.prototype.setItem=function(key,value){this[key]=value},FakeStorage.prototype.getItem=function(key){return"undefined"==typeof this[key]?null:this[key]},FakeStorage.prototype.removeItem=function(key){this[key]=void 0
},FakeStorage.prototype.clear=function(){for(var key in this)this.hasOwnProperty(key)&&this.removeItem(key)},FakeStorage.prototype.key=function(index){return Object.keys(this)[index]},new FakeStorage}]).factory("$localStorage",["$window","$fakeStorage",function($window,$fakeStorage){function isStorageSupported(storageName){var testKey="test",storage=$window[storageName];try{return storage.setItem(testKey,"1"),storage.removeItem(testKey),!0}catch(error){return!1}}var storage=isStorageSupported("localStorage")?$window.localStorage:$fakeStorage;return{setItem:function(key,value){storage.setItem(key,value)},getItem:function(key,defaultValue){return storage.getItem(key)||defaultValue},setObject:function(key,value){storage.setItem(key,JSON.stringify(value))},getObject:function(key){return JSON.parse(storage.getItem(key)||"{}")},removeItem:function(key){storage.removeItem(key)},clear:function(){storage.clear()},key:function(index){storage.key(index)}}}]).factory("$sessionStorage",["$window","$fakeStorage",function($window,$fakeStorage){function isStorageSupported(storageName){var testKey="test",storage=$window[storageName];try{return storage.setItem(testKey,"1"),storage.removeItem(testKey),!0}catch(error){return!1}}var storage=isStorageSupported("sessionStorage")?$window.sessionStorage:$fakeStorage;return{setItem:function(key,value){storage.setItem(key,value)},getItem:function(key,defaultValue){return storage.getItem(key)||defaultValue},setObject:function(key,value){storage.setItem(key,JSON.stringify(value))},getObject:function(key){return JSON.parse(storage.getItem(key)||"{}")},removeItem:function(key){storage.removeItem(key)},clear:function(){storage.clear()},key:function(index){storage.key(index)}}}]),function(){var angularFileUpload=angular.module("angularFileUpload",[]);angularFileUpload.service("$upload",["$http","$timeout",function($http,$timeout){function sendHttp(config){config.method=config.method||"POST",config.headers=config.headers||{},config.transformRequest=config.transformRequest||function(data,headersGetter){return window.ArrayBuffer&&data instanceof window.ArrayBuffer?data:$http.defaults.transformRequest[0](data,headersGetter)},window.XMLHttpRequest.__isShim&&(config.headers.__setXHR_=function(){return function(xhr){xhr&&(config.__XHR=xhr,config.xhrFn&&config.xhrFn(xhr),xhr.upload.addEventListener("progress",function(e){config.progress&&$timeout(function(){config.progress&&config.progress(e)})},!1),xhr.upload.addEventListener("load",function(e){e.lengthComputable&&config.progress&&config.progress(e)},!1))}});var promise=$http(config);return promise.progress=function(fn){return config.progress=fn,promise},promise.abort=function(){return config.__XHR&&$timeout(function(){config.__XHR.abort()}),promise},promise.xhr=function(fn){return config.xhrFn=fn,promise},promise.then=function(promise,origThen){return function(s,e,p){config.progress=p||config.progress;var result=origThen.apply(promise,[s,e,p]);return result.abort=promise.abort,result.progress=promise.progress,result.xhr=promise.xhr,result.then=promise.then,result}}(promise,promise.then),promise}this.upload=function(config){config.headers=config.headers||{},config.headers["Content-Type"]=void 0,config.transformRequest=config.transformRequest||$http.defaults.transformRequest;var formData=new FormData,origTransformRequest=config.transformRequest,origData=config.data;return config.transformRequest=function(formData,headerGetter){if(origData)if(config.formDataAppender)for(var key in origData){var val=origData[key];config.formDataAppender(formData,key,val)}else for(var key in origData){var val=origData[key];if("function"==typeof origTransformRequest)val=origTransformRequest(val,headerGetter);else for(var i=0;i<origTransformRequest.length;i++){var transformFn=origTransformRequest[i];"function"==typeof transformFn&&(val=transformFn(val,headerGetter))}formData.append(key,val)}if(null!=config.file){var fileFormName=config.fileFormDataName||"file";if("[object Array]"===Object.prototype.toString.call(config.file))for(var isFileFormNameString="[object String]"===Object.prototype.toString.call(fileFormName),i=0;i<config.file.length;i++)formData.append(isFileFormNameString?fileFormName+i:fileFormName[i],config.file[i],config.file[i].name);else formData.append(fileFormName,config.file,config.file.name)}return formData},config.data=formData,sendHttp(config)},this.http=function(config){return sendHttp(config)}}]),angularFileUpload.directive("ngFileSelect",["$parse","$timeout",function($parse,$timeout){return function(scope,elem,attr){var fn=$parse(attr.ngFileSelect);elem.bind("change",function(evt){var fileList,i,files=[];if(fileList=evt.target.files,null!=fileList)for(i=0;i<fileList.length;i++)files.push(fileList.item(i));$timeout(function(){fn(scope,{$files:files,$event:evt})})}),("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&elem.bind("touchend",function(e){e.preventDefault(),e.target.click()})}}]),angularFileUpload.directive("ngFileDropAvailable",["$parse","$timeout",function($parse,$timeout){return function(scope,elem,attr){if("draggable"in document.createElement("span")){var fn=$parse(attr.ngFileDropAvailable);$timeout(function(){fn(scope)})}}}]),angularFileUpload.directive("ngFileDrop",["$parse","$timeout",function($parse,$timeout){return function(scope,elem,attr){function traverseFileTree(files,item){if(item.isDirectory){var dirReader=item.createReader();processing++,dirReader.readEntries(function(entries){for(var i=0;i<entries.length;i++)traverseFileTree(files,entries[i]);processing--})}else processing++,item.file(function(file){processing--,files.push(file)})}if("draggable"in document.createElement("span")){var cancel=null,fn=$parse(attr.ngFileDrop);elem[0].addEventListener("dragover",function(evt){$timeout.cancel(cancel),evt.stopPropagation(),evt.preventDefault(),elem.addClass(attr.ngFileDragOverClass||"dragover")},!1),elem[0].addEventListener("dragleave",function(){cancel=$timeout(function(){elem.removeClass(attr.ngFileDragOverClass||"dragover")})},!1);var processing=0;elem[0].addEventListener("drop",function(evt){evt.stopPropagation(),evt.preventDefault(),elem.removeClass(attr.ngFileDragOverClass||"dragover");var files=[],items=evt.dataTransfer.items;if(items&&items.length>0&&items[0].webkitGetAsEntry)for(var i=0;i<items.length;i++)traverseFileTree(files,items[i].webkitGetAsEntry());else{var fileList=evt.dataTransfer.files;if(null!=fileList)for(var i=0;i<fileList.length;i++)files.push(fileList.item(i))}!function callback(delay){$timeout(function(){processing?callback(10):fn(scope,{$files:files,$event:evt})},delay||0)}()},!1)}}}])}(),angular.module("ngLocalData",["angular-hal"]).factory("$localCache",["halClient","$q",function(halClient,$q){return data={},jsonData=function(data){return data&&JSON.parse(data)},storage=function(){return sessionStorage},localSave=function(key,item){storage().setItem(key,item.$toStore())},localLoad=function(key){return res=jsonData(storage().getItem(key)),res?(r=halClient.createResource(res),def=$q.defer(),def.resolve(r),def.promise):null},localDelete=function(key){storage().removeItem(key)},{set:function(key,val){return data[key]=val,val.then(function(item){localSave(key,item)}),val},get:function(key){return localLoad(key),data[key]||(data[key]=localLoad(key)),data[key]},del:function(key){localDelete(key),delete data[key]},has:function(key){return data[key]||(res=localLoad(key),res&&(data[key]=res)),key in data}}}]).factory("$localData",["$http","$rootScope",function(){function LocalDataFactory(name){function LocalData(value){this.setStore(value)}return LocalData.prototype.jsonData=function(data){return data&&JSON.parse(data)},LocalData.prototype.storage=function(){return sessionStorage},LocalData.prototype.localSave=function(item){this.storage().setItem(this.store_name+item.id,JSON.stringify(item))},LocalData.prototype.localSaveIndex=function(ids){this.storage().setItem(this.store_name,ids.join(",")),this.ids=ids},LocalData.prototype.localLoadIndex=function(){return store=this.storage().getItem(this.store_name),records=store&&store.split(",")||[]},LocalData.prototype.localLoad=function(id){return this.jsonData(this.storage().getItem(this.store_name+id))},LocalData.prototype.count=function(){return this.ids.length},LocalData.prototype.setStore=function(name){for(this.store_name=name,this.data_store=[],this.ids=this.localLoadIndex(),a=0;a<this.ids.length;a++)this.data_store.push(this.localLoad(this.ids[a]))},LocalData.prototype.update=function(data){ids=[];for(x in data)data[x].id&&(ids.push(data[x].id),this.localSave(data[x]));this.localSaveIndex(ids)},new LocalData(name)}return LocalDataFactory}]),getControllerScope=function(controller,fn){$(document).ready(function(){var $element=$('div[data-ng-controller="'+controller+'"]'),scope=angular.element($element).scope();fn(scope)})},function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Collection.Booking=function(_super){function Booking(){return Booking.__super__.constructor.apply(this,arguments)}return __extends(Booking,_super),Booking.prototype.checkItem=function(){return Booking.__super__.checkItem.apply(this,arguments)},Booking.prototype.matchesParams=function(item){return null!=this.params.start_date&&(null==this.start_date&&(this.start_date=moment(this.params.date)),this.start_date.isAfter(item.start))?!1:null!=this.params.end_date&&(null==this.end_date&&(this.end_date=moment(this.params.end_date)),this.end_date.isBefore(item.start.clone().startOf("day")))?!1:!this.params.include_cancelled&&item.is_cancelled?!1:!0},Booking}(window.Collection.Base),angular.module("BB.Services").provider("BookingCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Collection.Slot=function(_super){function Slot(){return Slot.__super__.constructor.apply(this,arguments)}return __extends(Slot,_super),Slot.prototype.checkItem=function(){return Slot.__super__.checkItem.apply(this,arguments)},Slot.prototype.matchesParams=function(item){return this.params.start_date&&(this.start_date||(this.start_date=moment(this.params.start_date)),this.start_date.isAfter(item.date))?!1:this.params.end_date&&(this.end_date||(this.end_date=moment(this.params.end_date)),this.end_date.isBefore(item.date))?!1:!0},Slot}(window.Collection.Base),angular.module("BB.Services").provider("SlotCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),angular.module("ngLocalData",["angular-hal"]).factory("$localCache",["halClient","$q",function(halClient,$q){return data={},jsonData=function(data){return data&&JSON.parse(data)},storage=function(){return sessionStorage},localSave=function(key,item){storage().setItem(key,item.$toStore())},localLoad=function(key){return res=jsonData(storage().getItem(key)),res?(r=halClient.createResource(res),def=$q.defer(),def.resolve(r),def.promise):null},localDelete=function(key){storage().removeItem(key)},{set:function(key,val){return data[key]=val,val.then(function(item){localSave(key,item)}),val},get:function(key){return localLoad(key),data[key]||(data[key]=localLoad(key)),data[key]},del:function(key){localDelete(key),delete data[key]},has:function(key){return data[key]||(res=localLoad(key),res&&(data[key]=res)),key in data}}}]).factory("$localData",["$http","$rootScope",function(){function LocalDataFactory(name){function LocalData(value){this.setStore(value)}return LocalData.prototype.jsonData=function(data){return data&&JSON.parse(data)},LocalData.prototype.storage=function(){return sessionStorage},LocalData.prototype.localSave=function(item){this.storage().setItem(this.store_name+item.id,JSON.stringify(item))},LocalData.prototype.localSaveIndex=function(ids){this.storage().setItem(this.store_name,ids.join(",")),this.ids=ids},LocalData.prototype.localLoadIndex=function(){return store=this.storage().getItem(this.store_name),records=store&&store.split(",")||[]},LocalData.prototype.localLoad=function(id){return this.jsonData(this.storage().getItem(this.store_name+id))},LocalData.prototype.count=function(){return this.ids.length},LocalData.prototype.setStore=function(name){for(this.store_name=name,this.data_store=[],this.ids=this.localLoadIndex(),a=0;a<this.ids.length;a++)this.data_store.push(this.localLoad(this.ids[a]))},LocalData.prototype.update=function(data){ids=[];for(x in data)data[x].id&&(ids.push(data[x].id),this.localSave(data[x]));this.localSaveIndex(ids)},new LocalData(name)}return LocalDataFactory}]),function(window,$){"use strict";var EXCESS_ROWS=6,SCROLL_THRESHOLD=4,ASC="asc",DESC="desc",NG_FIELD="_ng_field_",NG_DEPTH="_ng_depth_",NG_HIDDEN="_ng_hidden_",NG_COLUMN="_ng_column_",CUSTOM_FILTERS=/CUSTOM_FILTERS/g,COL_FIELD=/COL_FIELD/g,DISPLAY_CELL_TEMPLATE=/DISPLAY_CELL_TEMPLATE/g,EDITABLE_CELL_TEMPLATE=/EDITABLE_CELL_TEMPLATE/g,TEMPLATE_REGEXP=/<.+>/;window.ngGrid={},window.ngGrid.i18n={};var ngGridServices=angular.module("ngGrid.services",[]),ngGridDirectives=angular.module("ngGrid.directives",[]),ngGridFilters=angular.module("ngGrid.filters",[]);angular.module("ngGrid",["ngGrid.services","ngGrid.directives","ngGrid.filters"]);var ngMoveSelectionHandler=function($scope,elm,evt,grid){if(void 0===$scope.selectionProvider.selectedItems)return!0;var newColumnIndex,charCode=evt.which||evt.keyCode,lastInRow=!1,firstInRow=!1,rowIndex=$scope.selectionProvider.lastClickedRow.rowIndex,visibleCols=$scope.columns.filter(function(c){return c.visible}),pinnedCols=$scope.columns.filter(function(c){return c.pinned});if($scope.col&&(newColumnIndex=visibleCols.indexOf($scope.col)),37!=charCode&&38!=charCode&&39!=charCode&&40!=charCode&&9!=charCode&&13!=charCode)return!0;if($scope.enableCellSelection){9==charCode&&evt.preventDefault();var focusedOnFirstColumn=$scope.showSelectionCheckbox?1==$scope.col.index:0==$scope.col.index,focusedOnFirstVisibleColumns=1==$scope.$index||0==$scope.$index,focusedOnLastVisibleColumns=$scope.$index==$scope.renderedColumns.length-1||$scope.$index==$scope.renderedColumns.length-2,focusedOnLastColumn=visibleCols.indexOf($scope.col)==visibleCols.length-1,focusedOnLastPinnedColumn=pinnedCols.indexOf($scope.col)==pinnedCols.length-1;if(37==charCode||9==charCode&&evt.shiftKey){var scrollTo=0;focusedOnFirstColumn||(newColumnIndex-=1),focusedOnFirstVisibleColumns?focusedOnFirstColumn&&9==charCode&&evt.shiftKey?(scrollTo=grid.$canvas.width(),newColumnIndex=visibleCols.length-1,firstInRow=!0):scrollTo=grid.$viewport.scrollLeft()-$scope.col.width:pinnedCols.length>0&&(scrollTo=grid.$viewport.scrollLeft()-visibleCols[newColumnIndex].width),grid.$viewport.scrollLeft(scrollTo)}else(39==charCode||9==charCode&&!evt.shiftKey)&&(focusedOnLastVisibleColumns?focusedOnLastColumn&&9==charCode&&!evt.shiftKey?(grid.$viewport.scrollLeft(0),newColumnIndex=$scope.showSelectionCheckbox?1:0,lastInRow=!0):grid.$viewport.scrollLeft(grid.$viewport.scrollLeft()+$scope.col.width):focusedOnLastPinnedColumn&&grid.$viewport.scrollLeft(0),focusedOnLastColumn||(newColumnIndex+=1))}var items;items=$scope.configGroups.length>0?grid.rowFactory.parsedData.filter(function(row){return!row.isAggRow}):grid.filteredRows;var offset=0;if(0!=rowIndex&&(38==charCode||13==charCode&&evt.shiftKey||9==charCode&&evt.shiftKey&&firstInRow)?offset=-1:rowIndex!=items.length-1&&(40==charCode||13==charCode&&!evt.shiftKey||9==charCode&&lastInRow)&&(offset=1),offset){var r=items[rowIndex+offset];r.beforeSelectionChange(r,evt)&&(r.continueSelection(evt),$scope.$emit("ngGridEventDigestGridParent"),$scope.selectionProvider.lastClickedRow.renderedRowIndex>=$scope.renderedRows.length-EXCESS_ROWS-2?grid.$viewport.scrollTop(grid.$viewport.scrollTop()+$scope.rowHeight):$scope.selectionProvider.lastClickedRow.renderedRowIndex<=EXCESS_ROWS+2&&grid.$viewport.scrollTop(grid.$viewport.scrollTop()-$scope.rowHeight))}return $scope.enableCellSelection&&setTimeout(function(){$scope.domAccessProvider.focusCellElement($scope,$scope.renderedColumns.indexOf(visibleCols[newColumnIndex]))},3),!1};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(elt){var len=this.length>>>0,from=Number(arguments[1])||0;for(from=0>from?Math.ceil(from):Math.floor(from),0>from&&(from+=len);len>from;from++)if(from in this&&this[from]===elt)return from;return-1}),Array.prototype.filter||(Array.prototype.filter=function(fun){var t=Object(this),len=t.length>>>0;if("function"!=typeof fun)throw new TypeError;for(var res=[],thisp=arguments[1],i=0;len>i;i++)if(i in t){var val=t[i];fun.call(thisp,val,i,t)&&res.push(val)}return res}),ngGridFilters.filter("checkmark",function(){return function(input){return input?"":""}}),ngGridFilters.filter("ngColumns",function(){return function(input){return input.filter(function(col){return!col.isAggCol})}}),ngGridServices.factory("$domUtilityService",["$utilityService",function($utils){var domUtilityService={},regexCache={},getWidths=function(){var $testContainer=$("<div></div>");$testContainer.appendTo("body"),$testContainer.height(100).width(100).css("position","absolute").css("overflow","scroll"),$testContainer.append('<div style="height: 400px; width: 400px;"></div>'),domUtilityService.ScrollH=$testContainer.height()-$testContainer[0].clientHeight,domUtilityService.ScrollW=$testContainer.width()-$testContainer[0].clientWidth,$testContainer.empty(),$testContainer.attr("style",""),$testContainer.append('<span style="font-family: Verdana, Helvetica, Sans-Serif; font-size: 14px;"><strong>M</strong></span>'),domUtilityService.LetterW=$testContainer.children().first().width(),$testContainer.remove()};return domUtilityService.eventStorage={},domUtilityService.AssignGridContainers=function($scope,rootEl,grid){grid.$root=$(rootEl),grid.$topPanel=grid.$root.find(".ngTopPanel"),grid.$groupPanel=grid.$root.find(".ngGroupPanel"),grid.$headerContainer=grid.$topPanel.find(".ngHeaderContainer"),$scope.$headerContainer=grid.$headerContainer,grid.$headerScroller=grid.$topPanel.find(".ngHeaderScroller"),grid.$headers=grid.$headerScroller.children(),grid.$viewport=grid.$root.find(".ngViewport"),grid.$canvas=grid.$viewport.find(".ngCanvas"),grid.$footerPanel=grid.$root.find(".ngFooterPanel"),$scope.$watch(function(){return grid.$viewport.scrollLeft()},function(newLeft){return grid.$headerContainer.scrollLeft(newLeft)}),domUtilityService.UpdateGridLayout($scope,grid)},domUtilityService.getRealWidth=function(obj){var width=0,props={visibility:"hidden",display:"block"},hiddenParents=obj.parents().andSelf().not(":visible");return $.swap(hiddenParents[0],props,function(){width=obj.outerWidth()}),width},domUtilityService.UpdateGridLayout=function($scope,grid){var scrollTop=grid.$viewport.scrollTop();grid.elementDims.rootMaxW=grid.$root.width(),grid.$root.is(":hidden")&&(grid.elementDims.rootMaxW=domUtilityService.getRealWidth(grid.$root)),grid.elementDims.rootMaxH=grid.$root.height(),grid.refreshDomSizes(),$scope.adjustScrollTop(scrollTop,!0)},domUtilityService.numberOfGrids=0,domUtilityService.BuildStyles=function($scope,grid,digest){var css,rowHeight=grid.config.rowHeight,$style=grid.$styleSheet,gridId=grid.gridId,cols=$scope.columns,sumWidth=0;$style||($style=$("#"+gridId),$style[0]||($style=$("<style id='"+gridId+"' type='text/css' rel='stylesheet' />").appendTo(grid.$root))),$style.empty();var trw=$scope.totalRowWidth();css="."+gridId+" .ngCanvas { width: "+trw+"px; }."+gridId+" .ngRow { width: "+trw+"px; }."+gridId+" .ngCanvas { width: "+trw+"px; }."+gridId+" .ngHeaderScroller { width: "+(trw+domUtilityService.ScrollH)+"px}";for(var i=0;i<cols.length;i++){var col=cols[i];if(col.visible!==!1){var colLeft=col.pinned?grid.$viewport.scrollLeft()+sumWidth:sumWidth;css+="."+gridId+" .col"+i+" { width: "+col.width+"px; left: "+colLeft+"px; height: "+rowHeight+"px }."+gridId+" .colt"+i+" { width: "+col.width+"px; }",sumWidth+=col.width}}$utils.isIe?$style[0].styleSheet.cssText=css:$style[0].appendChild(document.createTextNode(css)),grid.$styleSheet=$style,digest&&($scope.adjustScrollLeft(grid.$viewport.scrollLeft()),domUtilityService.digest($scope))},domUtilityService.setColLeft=function(col,colLeft,grid){if(grid.$styleSheet){var regex=regexCache[col.index];regex||(regex=regexCache[col.index]=new RegExp(".col"+col.index+" { width: [0-9]+px; left: [0-9]+px"));var str=grid.$styleSheet.html(),newStr=str.replace(regex,".col"+col.index+" { width: "+col.width+"px; left: "+colLeft+"px");$utils.isIe?setTimeout(function(){grid.$styleSheet.html(newStr)}):grid.$styleSheet.html(newStr)}},domUtilityService.setColLeft.immediate=1,domUtilityService.RebuildGrid=function($scope,grid){domUtilityService.UpdateGridLayout($scope,grid),grid.config.maintainColumnRatios&&grid.configureColumnWidths(),$scope.adjustScrollLeft(grid.$viewport.scrollLeft()),domUtilityService.BuildStyles($scope,grid,!0)},domUtilityService.digest=function($scope){$scope.$root.$$phase||$scope.$digest()},domUtilityService.ScrollH=17,domUtilityService.ScrollW=17,domUtilityService.LetterW=10,getWidths(),domUtilityService}]),ngGridServices.factory("$sortService",["$parse",function($parse){var sortService={};return sortService.colSortFnCache={},sortService.guessSortFn=function(item){var itemType=typeof item;switch(itemType){case"number":return sortService.sortNumber;case"boolean":return sortService.sortBool;case"string":return item.match(/^-?[$]?[\d,.]+%?$/)?sortService.sortNumberStr:sortService.sortAlpha;default:return"[object Date]"===Object.prototype.toString.call(item)?sortService.sortDate:sortService.basicSort}},sortService.basicSort=function(a,b){return a==b?0:b>a?-1:1},sortService.sortNumber=function(a,b){return a-b},sortService.sortNumberStr=function(a,b){var numA,numB,badA=!1,badB=!1;return numA=parseFloat(a.replace(/[^0-9.-]/g,"")),isNaN(numA)&&(badA=!0),numB=parseFloat(b.replace(/[^0-9.-]/g,"")),isNaN(numB)&&(badB=!0),badA&&badB?0:badA?1:badB?-1:numA-numB},sortService.sortAlpha=function(a,b){var strA=a.toLowerCase(),strB=b.toLowerCase();return strA==strB?0:strB>strA?-1:1},sortService.sortDate=function(a,b){var timeA=a.getTime(),timeB=b.getTime();return timeA==timeB?0:timeB>timeA?-1:1},sortService.sortBool=function(a,b){return a&&b?0:a||b?a?1:-1:0},sortService.sortData=function(sortInfo,data){if(data&&sortInfo){var col,direction,l=sortInfo.fields.length,order=sortInfo.fields,d=data.slice(0);data.sort(function(itemA,itemB){for(var sortFn,tem=0,indx=0;0==tem&&l>indx;){col=sortInfo.columns[indx],direction=sortInfo.directions[indx],sortFn=sortService.getSortFn(col,d);var propA=$parse(order[indx])(itemA),propB=$parse(order[indx])(itemB);!propA&&0!=propA||!propB&&0!=propB?propB||propA?propA?propB||(tem=-1):tem=1:tem=0:tem=sortFn(propA,propB),indx++}return direction===ASC?tem:0-tem})}},sortService.Sort=function(sortInfo,data){sortService.isSorting||(sortService.isSorting=!0,sortService.sortData(sortInfo,data),sortService.isSorting=!1)},sortService.getSortFn=function(col,data){var item,sortFn=void 0;if(sortService.colSortFnCache[col.field])sortFn=sortService.colSortFnCache[col.field];else if(void 0!=col.sortingAlgorithm)sortFn=col.sortingAlgorithm,sortService.colSortFnCache[col.field]=col.sortingAlgorithm;else{if(item=data[0],!item)return sortFn;sortFn=sortService.guessSortFn($parse(col.field)(item)),sortFn?sortService.colSortFnCache[col.field]=sortFn:sortFn=sortService.sortAlpha}return sortFn},sortService}]),ngGridServices.factory("$utilityService",["$parse",function($parse){var funcNameRegex=/function (.{1,})\(/,utils={visualLength:function(node){var elem=document.getElementById("testDataLength");return elem||(elem=document.createElement("SPAN"),elem.id="testDataLength",elem.style.visibility="hidden",document.body.appendChild(elem)),$(elem).css("font",$(node).css("font")),elem.innerHTML=$(node).text(),elem.offsetWidth},forIn:function(obj,action){for(var prop in obj)obj.hasOwnProperty(prop)&&action(obj[prop],prop)},evalProperty:function(entity,path){return $parse(path)(entity)},endsWith:function(str,suffix){return str&&suffix&&"string"==typeof str?-1!==str.indexOf(suffix,str.length-suffix.length):!1},isNullOrUndefined:function(obj){return void 0===obj||null===obj?!0:!1},getElementsByClassName:function(cl){for(var retnode=[],myclass=new RegExp("\\b"+cl+"\\b"),elem=document.getElementsByTagName("*"),i=0;i<elem.length;i++){var classes=elem[i].className;myclass.test(classes)&&retnode.push(elem[i])}return retnode},newId:function(){var seedId=(new Date).getTime();return function(){return seedId+=1}}(),seti18n:function($scope,language){var $langPack=window.ngGrid.i18n[language];for(var label in $langPack)$scope.i18n[label]=$langPack[label]},getInstanceType:function(o){var results=funcNameRegex.exec(o.constructor.toString());return results&&results.length>1?results[1]:""},ieVersion:function(){for(var version=3,div=document.createElement("div"),iElems=div.getElementsByTagName("i");div.innerHTML="<!--[if gt IE "+ ++version+"]><i></i><![endif]-->",iElems[0];);return version>4?version:void 0}()};return $.extend(utils,{isIe:function(){return void 0!==utils.ieVersion}()}),utils}]);var ngAggregate=function(aggEntity,rowFactory,rowHeight,groupInitState){var self=this;self.rowIndex=0,self.offsetTop=self.rowIndex*rowHeight,self.entity=aggEntity,self.label=aggEntity.gLabel,self.field=aggEntity.gField,self.depth=aggEntity.gDepth,self.parent=aggEntity.parent,self.children=aggEntity.children,self.aggChildren=aggEntity.aggChildren,self.aggIndex=aggEntity.aggIndex,self.collapsed=groupInitState,self.isAggRow=!0,self.offsetLeft=25*aggEntity.gDepth,self.aggLabelFilter=aggEntity.aggLabelFilter,self.toggleExpand=function(){self.collapsed=self.collapsed?!1:!0,self.orig&&(self.orig.collapsed=self.collapsed),self.notifyChildren()},self.setExpand=function(state){self.collapsed=state,self.notifyChildren()},self.notifyChildren=function(){for(var longest=Math.max(rowFactory.aggCache.length,self.children.length),i=0;longest>i;i++)if(self.aggChildren[i]&&(self.aggChildren[i].entity[NG_HIDDEN]=self.collapsed,self.collapsed&&self.aggChildren[i].setExpand(self.collapsed)),self.children[i]&&(self.children[i][NG_HIDDEN]=self.collapsed),i>self.aggIndex&&rowFactory.aggCache[i]){var agg=rowFactory.aggCache[i],offset=30*self.children.length;agg.offsetTop=self.collapsed?agg.offsetTop-offset:agg.offsetTop+offset}rowFactory.renderedChange()},self.aggClass=function(){return self.collapsed?"ngAggArrowCollapsed":"ngAggArrowExpanded"},self.totalChildren=function(){if(self.aggChildren.length>0){var i=0,recurse=function(cur){cur.aggChildren.length>0?angular.forEach(cur.aggChildren,function(a){recurse(a)}):i+=cur.children.length};return recurse(self),i}return self.children.length},self.copy=function(){var ret=new ngAggregate(self.entity,rowFactory,rowHeight,groupInitState);return ret.orig=self,ret}},ngColumn=function(config,$scope,grid,domUtilityService,$templateCache,$utils){var self=this,colDef=config.colDef,delay=500,clicks=0,timer=null;self.colDef=config.colDef,self.width=colDef.width,self.groupIndex=0,self.isGroupedBy=!1,self.minWidth=colDef.minWidth?colDef.minWidth:50,self.maxWidth=colDef.maxWidth?colDef.maxWidth:9e3,self.enableCellEdit=config.enableCellEdit||colDef.enableCellEdit,self.headerRowHeight=config.headerRowHeight,self.displayName=colDef.displayName||colDef.field,self.index=config.index,self.isAggCol=config.isAggCol,self.cellClass=colDef.cellClass,self.sortPriority=void 0,self.cellFilter=colDef.cellFilter?colDef.cellFilter:"",self.field=colDef.field,self.aggLabelFilter=colDef.cellFilter||colDef.aggLabelFilter,self.visible=$utils.isNullOrUndefined(colDef.visible)||colDef.visible,self.sortable=!1,self.resizable=!1,self.pinnable=!1,self.pinned=config.enablePinning&&colDef.pinned,self.originalIndex=self.index,self.groupable=$utils.isNullOrUndefined(colDef.groupable)||colDef.groupable,config.enableSort&&(self.sortable=$utils.isNullOrUndefined(colDef.sortable)||colDef.sortable),config.enableResize&&(self.resizable=$utils.isNullOrUndefined(colDef.resizable)||colDef.resizable),config.enablePinning&&(self.pinnable=$utils.isNullOrUndefined(colDef.pinnable)||colDef.pinnable),self.sortDirection=void 0,self.sortingAlgorithm=colDef.sortFn,self.headerClass=colDef.headerClass,self.cursor=self.sortable?"pointer":"default",self.headerCellTemplate=colDef.headerCellTemplate||$templateCache.get("headerCellTemplate.html"),self.cellTemplate=colDef.cellTemplate||$templateCache.get("cellTemplate.html").replace(CUSTOM_FILTERS,self.cellFilter?"|"+self.cellFilter:""),self.enableCellEdit&&(self.cellEditTemplate=$templateCache.get("cellEditTemplate.html"),self.editableCellTemplate=colDef.editableCellTemplate||$templateCache.get("editableCellTemplate.html")),colDef.cellTemplate&&!TEMPLATE_REGEXP.test(colDef.cellTemplate)&&(self.cellTemplate=$.ajax({type:"GET",url:colDef.cellTemplate,async:!1}).responseText),self.enableCellEdit&&colDef.editableCellTemplate&&!TEMPLATE_REGEXP.test(colDef.editableCellTemplate)&&(self.editableCellTemplate=$.ajax({type:"GET",url:colDef.editableCellTemplate,async:!1}).responseText),colDef.headerCellTemplate&&!TEMPLATE_REGEXP.test(colDef.headerCellTemplate)&&(self.headerCellTemplate=$.ajax({type:"GET",url:colDef.headerCellTemplate,async:!1}).responseText),self.colIndex=function(){var classes=self.pinned?"pinned ":"";return classes+="col"+self.index+" colt"+self.index,self.cellClass&&(classes+=" "+self.cellClass),classes},self.groupedByClass=function(){return self.isGroupedBy?"ngGroupedByIcon":"ngGroupIcon"},self.toggleVisible=function(){self.visible=!self.visible},self.showSortButtonUp=function(){return self.sortable?self.sortDirection===DESC:self.sortable},self.showSortButtonDown=function(){return self.sortable?self.sortDirection===ASC:self.sortable},self.noSortVisible=function(){return!self.sortDirection},self.sort=function(evt){if(!self.sortable)return!0;var dir=self.sortDirection===ASC?DESC:ASC;return self.sortDirection=dir,config.sortCallback(self,evt),!1},self.gripClick=function(){clicks++,1===clicks?timer=setTimeout(function(){clicks=0},delay):(clearTimeout(timer),config.resizeOnDataCallback(self),clicks=0)},self.gripOnMouseDown=function(event){return event.ctrlKey&&!self.pinned?(self.toggleVisible(),domUtilityService.BuildStyles($scope,grid),!0):(event.target.parentElement.style.cursor="col-resize",self.startMousePosition=event.clientX,self.origWidth=self.width,$(document).mousemove(self.onMouseMove),$(document).mouseup(self.gripOnMouseUp),!1)},self.onMouseMove=function(event){var diff=event.clientX-self.startMousePosition,newWidth=diff+self.origWidth;return self.width=newWidth<self.minWidth?self.minWidth:newWidth>self.maxWidth?self.maxWidth:newWidth,domUtilityService.BuildStyles($scope,grid),!1},self.gripOnMouseUp=function(event){return $(document).off("mousemove",self.onMouseMove),$(document).off("mouseup",self.gripOnMouseUp),event.target.parentElement.style.cursor="default",$scope.adjustScrollLeft(0),domUtilityService.digest($scope),!1},self.copy=function(){var ret=new ngColumn(config,$scope,grid,domUtilityService,$templateCache);return ret.isClone=!0,ret.orig=self,ret},self.setVars=function(fromCol){self.orig=fromCol,self.width=fromCol.width,self.groupIndex=fromCol.groupIndex,self.isGroupedBy=fromCol.isGroupedBy,self.displayName=fromCol.displayName,self.index=fromCol.index,self.isAggCol=fromCol.isAggCol,self.cellClass=fromCol.cellClass,self.cellFilter=fromCol.cellFilter,self.field=fromCol.field,self.aggLabelFilter=fromCol.aggLabelFilter,self.visible=fromCol.visible,self.sortable=fromCol.sortable,self.resizable=fromCol.resizable,self.pinnable=fromCol.pinnable,self.pinned=fromCol.pinned,self.originalIndex=fromCol.originalIndex,self.sortDirection=fromCol.sortDirection,self.sortingAlgorithm=fromCol.sortingAlgorithm,self.headerClass=fromCol.headerClass,self.headerCellTemplate=fromCol.headerCellTemplate,self.cellTemplate=fromCol.cellTemplate,self.cellEditTemplate=fromCol.cellEditTemplate
}},ngDimension=function(options){this.outerHeight=null,this.outerWidth=null,$.extend(this,options)},ngDomAccessProvider=function(grid){var previousColumn,self=this;self.selectInputElement=function(elm){var node=elm.nodeName.toLowerCase();("input"==node||"textarea"==node)&&elm.select()},self.focusCellElement=function($scope,index){if($scope.selectionProvider.lastClickedRow){var columnIndex=void 0!=index?index:previousColumn,elm=$scope.selectionProvider.lastClickedRow.clone?$scope.selectionProvider.lastClickedRow.clone.elm:$scope.selectionProvider.lastClickedRow.elm;if(void 0!=columnIndex&&elm){var columns=angular.element(elm[0].children).filter(function(){return 8!=this.nodeType}),i=Math.max(Math.min($scope.renderedColumns.length-1,columnIndex),0);grid.config.showSelectionCheckbox&&angular.element(columns[i]).scope()&&0==angular.element(columns[i]).scope().col.index&&(i=1),columns[i]&&columns[i].children[0].focus(),previousColumn=columnIndex}}};var changeUserSelect=function(elm,value){elm.css({"-webkit-touch-callout":value,"-webkit-user-select":value,"-khtml-user-select":value,"-moz-user-select":"none"==value?"-moz-none":value,"-ms-user-select":value,"user-select":value})};self.selectionHandlers=function($scope,elm){var doingKeyDown=!1;elm.bind("keydown",function(evt){if(16==evt.keyCode)return changeUserSelect(elm,"none",evt),!0;if(!doingKeyDown){doingKeyDown=!0;var ret=ngMoveSelectionHandler($scope,elm,evt,grid);return doingKeyDown=!1,ret}return!0}),elm.bind("keyup",function(evt){return 16==evt.keyCode&&changeUserSelect(elm,"text",evt),!0})}},ngEventProvider=function(grid,$scope,domUtilityService,$timeout){var self=this;self.colToMove=void 0,self.groupToMove=void 0,self.assignEvents=function(){grid.config.jqueryUIDraggable&&!grid.config.enablePinning?grid.$groupPanel.droppable({addClasses:!1,drop:function(event){self.onGroupDrop(event)}}):(grid.$groupPanel.on("mousedown",self.onGroupMouseDown).on("dragover",self.dragOver).on("drop",self.onGroupDrop),grid.$headerScroller.on("mousedown",self.onHeaderMouseDown).on("dragover",self.dragOver),grid.config.enableColumnReordering&&!grid.config.enablePinning&&grid.$headerScroller.on("drop",self.onHeaderDrop),grid.config.enableRowReordering&&grid.$viewport.on("mousedown",self.onRowMouseDown).on("dragover",self.dragOver).on("drop",self.onRowDrop)),$scope.$watch("renderedColumns",function(){$timeout(self.setDraggables)})},self.dragStart=function(evt){evt.dataTransfer.setData("text","")},self.dragOver=function(evt){evt.preventDefault()},self.setDraggables=function(){if(grid.config.jqueryUIDraggable)grid.$root.find(".ngHeaderSortColumn").draggable({helper:"clone",appendTo:"body",stack:"div",addClasses:!1,start:function(event){self.onHeaderMouseDown(event)}}).droppable({drop:function(event){self.onHeaderDrop(event)}});else{var columns=grid.$root.find(".ngHeaderSortColumn");angular.forEach(columns,function(col){col.setAttribute("draggable","true"),col.addEventListener&&col.addEventListener("dragstart",self.dragStart)}),-1!=navigator.userAgent.indexOf("MSIE")&&grid.$root.find(".ngHeaderSortColumn").bind("selectstart",function(){return this.dragDrop(),!1})}},self.onGroupMouseDown=function(event){var groupItem=$(event.target);if("ngRemoveGroup"!=groupItem[0].className){var groupItemScope=angular.element(groupItem).scope();groupItemScope&&(grid.config.jqueryUIDraggable||(groupItem.attr("draggable","true"),this.addEventListener&&this.addEventListener("dragstart",self.dragStart),-1!=navigator.userAgent.indexOf("MSIE")&&groupItem.bind("selectstart",function(){return this.dragDrop(),!1})),self.groupToMove={header:groupItem,groupName:groupItemScope.group,index:groupItemScope.$index})}else self.groupToMove=void 0},self.onGroupDrop=function(event){event.stopPropagation();var groupContainer,groupScope;self.groupToMove?(groupContainer=$(event.target).closest(".ngGroupElement"),"ngGroupPanel"==groupContainer.context.className?($scope.configGroups.splice(self.groupToMove.index,1),$scope.configGroups.push(self.groupToMove.groupName)):(groupScope=angular.element(groupContainer).scope(),groupScope&&self.groupToMove.index!=groupScope.$index&&($scope.configGroups.splice(self.groupToMove.index,1),$scope.configGroups.splice(groupScope.$index,0,self.groupToMove.groupName))),self.groupToMove=void 0,grid.fixGroupIndexes()):self.colToMove&&(-1==$scope.configGroups.indexOf(self.colToMove.col)&&(groupContainer=$(event.target).closest(".ngGroupElement"),"ngGroupPanel"==groupContainer.context.className||"ngGroupPanelDescription ng-binding"==groupContainer.context.className?$scope.groupBy(self.colToMove.col):(groupScope=angular.element(groupContainer).scope(),groupScope&&$scope.removeGroup(groupScope.$index))),self.colToMove=void 0),$scope.$$phase||$scope.$apply()},self.onHeaderMouseDown=function(event){var headerContainer=$(event.target).closest(".ngHeaderSortColumn"),headerScope=angular.element(headerContainer).scope();headerScope&&(self.colToMove={header:headerContainer,col:headerScope.col})},self.onHeaderDrop=function(event){if(self.colToMove&&!self.colToMove.col.pinned){var headerContainer=$(event.target).closest(".ngHeaderSortColumn"),headerScope=angular.element(headerContainer).scope();if(headerScope){if(self.colToMove.col==headerScope.col)return;$scope.columns.splice(self.colToMove.col.index,1),$scope.columns.splice(headerScope.col.index,0,self.colToMove.col),grid.fixColumnIndexes(),domUtilityService.BuildStyles($scope,grid,!0),self.colToMove=void 0}}},self.onRowMouseDown=function(event){var targetRow=$(event.target).closest(".ngRow"),rowScope=angular.element(targetRow).scope();rowScope&&(targetRow.attr("draggable","true"),domUtilityService.eventStorage.rowToMove={targetRow:targetRow,scope:rowScope})},self.onRowDrop=function(event){var targetRow=$(event.target).closest(".ngRow"),rowScope=angular.element(targetRow).scope();if(rowScope){var prevRow=domUtilityService.eventStorage.rowToMove;if(prevRow.scope.row==rowScope.row)return;grid.changeRowOrder(prevRow.scope.row,rowScope.row),grid.searchProvider.evalFilter(),domUtilityService.eventStorage.rowToMove=void 0,domUtilityService.digest(rowScope.$root)}},self.assignGridEventHandlers=function(){-1===grid.config.tabIndex?(grid.$viewport.attr("tabIndex",domUtilityService.numberOfGrids),domUtilityService.numberOfGrids++):grid.$viewport.attr("tabIndex",grid.config.tabIndex),$(window).resize(function(){domUtilityService.RebuildGrid($scope,grid)}),$(grid.$root.parent()).on("resize",function(){domUtilityService.RebuildGrid($scope,grid)})},self.assignGridEventHandlers(),self.assignEvents()},ngFooter=function($scope,grid){$scope.maxRows=function(){var ret=Math.max(grid.config.totalServerItems,grid.data.length);return ret},$scope.multiSelect=grid.config.enableRowSelection&&grid.config.multiSelect,$scope.selectedItemCount=grid.selectedItemCount,$scope.maxPages=function(){return Math.ceil($scope.maxRows()/$scope.pagingOptions.pageSize)},$scope.pageForward=function(){var page=$scope.pagingOptions.currentPage;grid.config.totalServerItems>0?$scope.pagingOptions.currentPage=Math.min(page+1,$scope.maxPages()):$scope.pagingOptions.currentPage++},$scope.pageBackward=function(){var page=$scope.pagingOptions.currentPage;$scope.pagingOptions.currentPage=Math.max(page-1,1)},$scope.pageToFirst=function(){$scope.pagingOptions.currentPage=1},$scope.pageToLast=function(){var maxPages=$scope.maxPages();$scope.pagingOptions.currentPage=maxPages},$scope.cantPageForward=function(){var curPage=$scope.pagingOptions.currentPage,maxPages=$scope.maxPages();return grid.config.totalServerItems>0?!(maxPages>curPage):grid.data.length<1},$scope.cantPageToLast=function(){return grid.config.totalServerItems>0?$scope.cantPageForward():!0},$scope.cantPageBackward=function(){var curPage=$scope.pagingOptions.currentPage;return!(curPage>1)}},ngGrid=function($scope,options,sortService,domUtilityService,$filter,$templateCache,$utils,$timeout,$parse,$http,$q){var defaults={aggregateTemplate:void 0,afterSelectionChange:function(){},beforeSelectionChange:function(){return!0},checkboxCellTemplate:void 0,checkboxHeaderTemplate:void 0,columnDefs:void 0,data:[],dataUpdated:function(){},enableCellEdit:!1,enableCellSelection:!1,enableColumnResize:!1,enableColumnReordering:!1,enableColumnHeavyVirt:!1,enablePaging:!1,enablePinning:!1,enableRowReordering:!1,enableRowSelection:!0,enableSorting:!0,enableHighlighting:!1,excludeProperties:[],filterOptions:{filterText:"",useExternalFilter:!1},footerRowHeight:55,footerTemplate:void 0,groups:[],groupsCollapsedByDefault:!0,headerRowHeight:30,headerRowTemplate:void 0,jqueryUIDraggable:!1,jqueryUITheme:!1,keepLastSelected:!0,maintainColumnRatios:void 0,menuTemplate:void 0,multiSelect:!0,pagingOptions:{pageSizes:[250,500,1e3],pageSize:250,currentPage:1},pinSelectionCheckbox:!1,plugins:[],primaryKey:void 0,rowHeight:30,rowTemplate:void 0,selectedItems:[],selectWithCheckboxOnly:!1,showColumnMenu:!1,showFilter:!1,showFooter:!1,showGroupPanel:!1,showSelectionCheckbox:!1,sortInfo:{fields:[],columns:[],directions:[]},tabIndex:-1,totalServerItems:0,useExternalSorting:!1,i18n:"en",virtualizationThreshold:50},self=this;self.maxCanvasHt=0,self.config=$.extend(defaults,window.ngGrid.config,options),self.config.showSelectionCheckbox=self.config.showSelectionCheckbox&&self.config.enableColumnHeavyVirt===!1,self.config.enablePinning=self.config.enablePinning&&self.config.enableColumnHeavyVirt===!1,self.config.selectWithCheckboxOnly=self.config.selectWithCheckboxOnly&&self.config.showSelectionCheckbox!==!1,self.config.pinSelectionCheckbox=self.config.enablePinning,"string"==typeof options.columnDefs&&(self.config.columnDefs=$scope.$eval(options.columnDefs)),self.rowCache=[],self.rowMap=[],self.gridId="ng"+$utils.newId(),self.$root=null,self.$groupPanel=null,self.$topPanel=null,self.$headerContainer=null,self.$headerScroller=null,self.$headers=null,self.$viewport=null,self.$canvas=null,self.rootDim=self.config.gridDim,self.data=[],self.lateBindColumns=!1,self.filteredRows=[],self.initTemplates=function(){var templates=["rowTemplate","aggregateTemplate","headerRowTemplate","checkboxCellTemplate","checkboxHeaderTemplate","menuTemplate","footerTemplate"],promises=[];return templates.forEach(function(template){promises.push(self.getTemplate(template))}),$q.all(promises)},self.getTemplate=function(key){var t=self.config[key],uKey=self.gridId+key+".html",p=$q.defer();if(t&&!TEMPLATE_REGEXP.test(t))$http.get(t,{cache:$templateCache}).success(function(data){$templateCache.put(uKey,data),p.resolve()}).error(function(){p.reject("Could not load template: "+t)});else if(t)$templateCache.put(uKey,t),p.resolve();else{var dKey=key+".html";$templateCache.put(uKey,$templateCache.get(dKey)),p.resolve()}return p.promise},"object"==typeof self.config.data&&(self.data=self.config.data),self.calcMaxCanvasHeight=function(){return self.config.groups.length>0?self.rowFactory.parsedData.filter(function(e){return!e[NG_HIDDEN]}).length*self.config.rowHeight:self.filteredRows.length*self.config.rowHeight},self.elementDims={scrollW:0,scrollH:0,rowIndexCellW:25,rowSelectedCellW:25,rootMaxW:0,rootMaxH:0},self.setRenderedRows=function(newRows){$scope.renderedRows.length=newRows.length;for(var i=0;i<newRows.length;i++)!$scope.renderedRows[i]||newRows[i].isAggRow||$scope.renderedRows[i].isAggRow?($scope.renderedRows[i]=newRows[i].copy(),$scope.renderedRows[i].collapsed=newRows[i].collapsed,newRows[i].isAggRow||$scope.renderedRows[i].setVars(newRows[i])):$scope.renderedRows[i].setVars(newRows[i]),$scope.renderedRows[i].rowIndex=newRows[i].rowIndex,$scope.renderedRows[i].offsetTop=newRows[i].offsetTop,$scope.renderedRows[i].selected=newRows[i].selected,newRows[i].renderedRowIndex=i;self.refreshDomSizes(),$scope.$emit("ngGridEventRows",newRows)},self.minRowsToRender=function(){var viewportH=$scope.viewportDimHeight()||1;return Math.floor(viewportH/self.config.rowHeight)},self.refreshDomSizes=function(){var dim=new ngDimension;dim.outerWidth=self.elementDims.rootMaxW,dim.outerHeight=self.elementDims.rootMaxH,self.rootDim=dim,self.maxCanvasHt=self.calcMaxCanvasHeight()},self.buildColumnDefsFromData=function(){self.config.columnDefs=[];var item=self.data[0];return item?void $utils.forIn(item,function(prop,propName){-1==self.config.excludeProperties.indexOf(propName)&&self.config.columnDefs.push({field:propName})}):void(self.lateBoundColumns=!0)},self.buildColumns=function(){var columnDefs=self.config.columnDefs,cols=[];if(columnDefs||(self.buildColumnDefsFromData(),columnDefs=self.config.columnDefs),self.config.showSelectionCheckbox&&cols.push(new ngColumn({colDef:{field:"",width:self.elementDims.rowSelectedCellW,sortable:!1,resizable:!1,groupable:!1,headerCellTemplate:$templateCache.get($scope.gridId+"checkboxHeaderTemplate.html"),cellTemplate:$templateCache.get($scope.gridId+"checkboxCellTemplate.html"),pinned:self.config.pinSelectionCheckbox},index:0,headerRowHeight:self.config.headerRowHeight,sortCallback:self.sortData,resizeOnDataCallback:self.resizeOnData,enableResize:self.config.enableColumnResize,enableSort:self.config.enableSorting,enablePinning:self.config.enablePinning},$scope,self,domUtilityService,$templateCache,$utils)),columnDefs.length>0){var indexOffset=self.config.showSelectionCheckbox?self.config.groups.length+1:self.config.groups.length;$scope.configGroups.length=0,angular.forEach(columnDefs,function(colDef,i){i+=indexOffset;var column=new ngColumn({colDef:colDef,index:i,headerRowHeight:self.config.headerRowHeight,sortCallback:self.sortData,resizeOnDataCallback:self.resizeOnData,enableResize:self.config.enableColumnResize,enableSort:self.config.enableSorting,enablePinning:self.config.enablePinning,enableCellEdit:self.config.enableCellEdit},$scope,self,domUtilityService,$templateCache,$utils),indx=self.config.groups.indexOf(colDef.field);-1!=indx&&(column.isGroupedBy=!0,$scope.configGroups.splice(indx,0,column),column.groupIndex=$scope.configGroups.length),cols.push(column)}),$scope.columns=cols}},self.configureColumnWidths=function(){var cols=self.config.columnDefs,indexOffset=self.config.showSelectionCheckbox?$scope.configGroups.length+1:$scope.configGroups.length,asterisksArray=(cols.length+indexOffset,[]),percentArray=[],asteriskNum=0,totalWidth=0;if(totalWidth+=self.config.showSelectionCheckbox?25:0,angular.forEach(cols,function(col,i){i+=indexOffset;var isPercent=!1,t=void 0;if($utils.isNullOrUndefined(col.width)?col.width="*":(isPercent=isNaN(col.width)?$utils.endsWith(col.width,"%"):!1,t=isPercent?col.width:parseInt(col.width,10)),isNaN(t)){if(t=col.width,"auto"==t){$scope.columns[i].width=col.minWidth,totalWidth+=$scope.columns[i].width;var temp=$scope.columns[i];return void $timeout(function(){self.resizeOnData(temp,!0)})}if(-1!=t.indexOf("*"))return col.visible!==!1&&(asteriskNum+=t.length),col.index=i,void asterisksArray.push(col);if(isPercent)return col.index=i,void percentArray.push(col);throw'unable to parse column width, use percentage ("10%","20%", etc...) or "*" to use remaining width of grid'}col.visible!==!1&&(totalWidth+=$scope.columns[i].width=parseInt(col.width,10))}),asterisksArray.length>0){self.config.maintainColumnRatios===!1?angular.noop():self.config.maintainColumnRatios=!0;var remainigWidth=self.rootDim.outerWidth-totalWidth,asteriskVal=Math.floor(remainigWidth/asteriskNum);angular.forEach(asterisksArray,function(col){var t=col.width.length;$scope.columns[col.index].width=asteriskVal*t;var offset=1;self.maxCanvasHt>$scope.viewportDimHeight()&&(offset+=domUtilityService.ScrollW),$scope.columns[col.index].width-=offset,col.visible!==!1&&(totalWidth+=$scope.columns[col.index].width)})}percentArray.length>0&&angular.forEach(percentArray,function(col){var t=col.width;$scope.columns[col.index].width=Math.floor(self.rootDim.outerWidth*(parseInt(t.slice(0,-1),10)/100))})},self.init=function(){return self.initTemplates().then(function(){$scope.selectionProvider=new ngSelectionProvider(self,$scope,$parse),$scope.domAccessProvider=new ngDomAccessProvider(self),self.rowFactory=new ngRowFactory(self,$scope,domUtilityService,$templateCache,$utils),self.searchProvider=new ngSearchProvider($scope,self,$filter),self.styleProvider=new ngStyleProvider($scope,self),$scope.$watch("configGroups",function(a){var tempArr=[];angular.forEach(a,function(item){tempArr.push(item.field||item)}),self.config.groups=tempArr,self.rowFactory.filteredRowsChanged(),$scope.$emit("ngGridEventGroups",a)},!0),$scope.$watch("columns",function(a){domUtilityService.BuildStyles($scope,self,!0),$scope.$emit("ngGridEventColumns",a)},!0),$scope.$watch(function(){return options.i18n},function(newLang){$utils.seti18n($scope,newLang)}),self.maxCanvasHt=self.calcMaxCanvasHeight(),self.config.sortInfo.fields&&self.config.sortInfo.fields.length>0&&(self.getColsFromFields(),self.sortActual())})},self.resizeOnData=function(col){var longest=col.minWidth,arr=$utils.getElementsByClassName("col"+col.index);angular.forEach(arr,function(elem,index){var i;if(0===index){var kgHeaderText=$(elem).find(".ngHeaderText");i=$utils.visualLength(kgHeaderText)+10}else{var ngCellText=$(elem).find(".ngCellText");i=$utils.visualLength(ngCellText)+10}i>longest&&(longest=i)}),col.width=col.longest=Math.min(col.maxWidth,longest+7),domUtilityService.BuildStyles($scope,self,!0)},self.lastSortedColumns=[],self.changeRowOrder=function(prevRow,targetRow){var i=self.rowCache.indexOf(prevRow),j=self.rowCache.indexOf(targetRow);self.rowCache.splice(i,1),self.rowCache.splice(j,0,prevRow),$scope.$emit("ngGridEventChangeOrder",self.rowCache)},self.sortData=function(col,evt){if(evt&&evt.shiftKey&&self.config.sortInfo){var indx=self.config.sortInfo.columns.indexOf(col);-1===indx?(1==self.config.sortInfo.columns.length&&(self.config.sortInfo.columns[0].sortPriority=1),self.config.sortInfo.columns.push(col),col.sortPriority=self.config.sortInfo.columns.length,self.config.sortInfo.fields.push(col.field),self.config.sortInfo.directions.push(col.sortDirection),self.lastSortedColumns.push(col)):self.config.sortInfo.directions[indx]=col.sortDirection}else{var isArr=$.isArray(col);self.config.sortInfo.columns.length=0,self.config.sortInfo.fields.length=0,self.config.sortInfo.directions.length=0;var push=function(c){self.config.sortInfo.columns.push(c),self.config.sortInfo.fields.push(c.field),self.config.sortInfo.directions.push(c.sortDirection),self.lastSortedColumns.push(c)};isArr?(self.clearSortingData(),angular.forEach(col,function(c,i){c.sortPriority=i+1,push(c)})):(self.clearSortingData(col),col.sortPriority=void 0,push(col))}self.sortActual(),self.searchProvider.evalFilter(),$scope.$emit("ngGridEventSorted",self.config.sortInfo)},self.getColsFromFields=function(){self.config.sortInfo.columns?self.config.sortInfo.columns.length=0:self.config.sortInfo.columns=[],angular.forEach($scope.columns,function(c){var i=self.config.sortInfo.fields.indexOf(c.field);return-1!=i&&(c.sortDirection=self.config.sortInfo.directions[i]||"asc",self.config.sortInfo.columns.push(c)),!1})},self.sortActual=function(){if(!self.config.useExternalSorting){var tempData=self.data.slice(0);angular.forEach(tempData,function(item,i){var e=self.rowMap[i];if(void 0!=e){var v=self.rowCache[i];void 0!=v&&(item.preSortSelected=v.selected,item.preSortIndex=i)}}),sortService.Sort(self.config.sortInfo,tempData),angular.forEach(tempData,function(item,i){self.rowCache[i].entity=item,self.rowCache[i].selected=item.preSortSelected,self.rowMap[item.preSortIndex]=i,delete item.preSortSelected,delete item.preSortIndex})}},self.clearSortingData=function(col){col?(angular.forEach(self.lastSortedColumns,function(c){col.index!=c.index&&(c.sortDirection="",c.sortPriority=null)}),self.lastSortedColumns[0]=col,self.lastSortedColumns.length=1):(angular.forEach(self.lastSortedColumns,function(c){c.sortDirection="",c.sortPriority=null}),self.lastSortedColumns=[])},self.fixColumnIndexes=function(){for(var i=0;i<$scope.columns.length;i++)$scope.columns[i].visible!==!1&&($scope.columns[i].index=i)},self.fixGroupIndexes=function(){angular.forEach($scope.configGroups,function(item,i){item.groupIndex=i+1})},$scope.elementsNeedMeasuring=!0,$scope.columns=[],$scope.renderedRows=[],$scope.renderedColumns=[],$scope.headerRow=null,$scope.rowHeight=self.config.rowHeight,$scope.jqueryUITheme=self.config.jqueryUITheme,$scope.showSelectionCheckbox=self.config.showSelectionCheckbox,$scope.enableCellSelection=self.config.enableCellSelection,$scope.footer=null,$scope.selectedItems=self.config.selectedItems,$scope.multiSelect=self.config.multiSelect,$scope.showFooter=self.config.showFooter,$scope.footerRowHeight=$scope.showFooter?self.config.footerRowHeight:0,$scope.showColumnMenu=self.config.showColumnMenu,$scope.showMenu=!1,$scope.configGroups=[],$scope.gridId=self.gridId,$scope.enablePaging=self.config.enablePaging,$scope.pagingOptions=self.config.pagingOptions,$scope.i18n={},$utils.seti18n($scope,self.config.i18n),$scope.adjustScrollLeft=function(scrollLeft){for(var colwidths=0,totalLeft=0,x=$scope.columns.length,newCols=[],dcv=!self.config.enableColumnHeavyVirt,r=0,addCol=function(c){dcv?newCols.push(c):$scope.renderedColumns[r]?$scope.renderedColumns[r].setVars(c):$scope.renderedColumns[r]=c.copy(),r++},i=0;x>i;i++){var col=$scope.columns[i];if(col.visible!==!1){var w=col.width+colwidths;if(col.pinned){addCol(col);var newLeft=i>0?scrollLeft+totalLeft:scrollLeft;domUtilityService.setColLeft(col,newLeft,self),totalLeft+=col.width}else w>=scrollLeft&&colwidths<=scrollLeft+self.rootDim.outerWidth&&addCol(col);colwidths+=col.width}}dcv&&($scope.renderedColumns=newCols)},self.prevScrollTop=0,self.prevScrollIndex=0,$scope.adjustScrollTop=function(scrollTop,force){if(self.prevScrollTop!==scrollTop||force){scrollTop>0&&self.$viewport[0].scrollHeight-scrollTop<=self.$viewport.outerHeight()&&$scope.$emit("ngGridEventScroll");var newRange,rowIndex=Math.floor(scrollTop/self.config.rowHeight);if(self.filteredRows.length>self.config.virtualizationThreshold){if(self.prevScrollTop<scrollTop&&rowIndex<self.prevScrollIndex+SCROLL_THRESHOLD)return;if(self.prevScrollTop>scrollTop&&rowIndex>self.prevScrollIndex-SCROLL_THRESHOLD)return;newRange=new ngRange(Math.max(0,rowIndex-EXCESS_ROWS),rowIndex+self.minRowsToRender()+EXCESS_ROWS)}else{var maxLen=$scope.configGroups.length>0?self.rowFactory.parsedData.length:self.data.length;newRange=new ngRange(0,Math.max(maxLen,self.minRowsToRender()+EXCESS_ROWS))}self.prevScrollTop=scrollTop,self.rowFactory.UpdateViewableRange(newRange),self.prevScrollIndex=rowIndex}},$scope.toggleShowMenu=function(){$scope.showMenu=!$scope.showMenu},$scope.toggleSelectAll=function(a){$scope.selectionProvider.toggleSelectAll(a)},$scope.totalFilteredItemsLength=function(){return self.filteredRows.length},$scope.showGroupPanel=function(){return self.config.showGroupPanel},$scope.topPanelHeight=function(){return self.config.showGroupPanel===!0?self.config.headerRowHeight+32:self.config.headerRowHeight},$scope.viewportDimHeight=function(){return Math.max(0,self.rootDim.outerHeight-$scope.topPanelHeight()-$scope.footerRowHeight-2)},$scope.groupBy=function(col){if(!(self.data.length<1)&&col.groupable&&col.field){col.sortDirection||col.sort({shiftKey:$scope.configGroups.length>0?!0:!1});var indx=$scope.configGroups.indexOf(col);-1==indx?(col.isGroupedBy=!0,$scope.configGroups.push(col),col.groupIndex=$scope.configGroups.length):$scope.removeGroup(indx),self.$viewport.scrollTop(0),domUtilityService.digest($scope)}},$scope.removeGroup=function(index){var col=$scope.columns.filter(function(item){return item.groupIndex==index+1})[0];col.isGroupedBy=!1,col.groupIndex=0,$scope.columns[index].isAggCol&&($scope.columns.splice(index,1),$scope.configGroups.splice(index,1),self.fixGroupIndexes()),0===$scope.configGroups.length&&(self.fixColumnIndexes(),domUtilityService.digest($scope)),$scope.adjustScrollLeft(0)},$scope.togglePin=function(col){for(var indexFrom=col.index,indexTo=0,i=0;i<$scope.columns.length&&$scope.columns[i].pinned;i++)indexTo++;col.pinned&&(indexTo=Math.max(col.originalIndex,indexTo-1)),col.pinned=!col.pinned,$scope.columns.splice(indexFrom,1),$scope.columns.splice(indexTo,0,col),self.fixColumnIndexes(),domUtilityService.BuildStyles($scope,self,!0),self.$viewport.scrollLeft(self.$viewport.scrollLeft()-col.width)},$scope.totalRowWidth=function(){for(var totalWidth=0,cols=$scope.columns,i=0;i<cols.length;i++)cols[i].visible!==!1&&(totalWidth+=cols[i].width);return totalWidth},$scope.headerScrollerDim=function(){var viewportH=$scope.viewportDimHeight(),maxHeight=self.maxCanvasHt,vScrollBarIsOpen=maxHeight>viewportH,newDim=new ngDimension;return newDim.autoFitHeight=!0,newDim.outerWidth=$scope.totalRowWidth(),vScrollBarIsOpen?newDim.outerWidth+=self.elementDims.scrollW:maxHeight-viewportH<=self.elementDims.scrollH&&(newDim.outerWidth+=self.elementDims.scrollW),newDim}},ngRange=function(top,bottom){this.topRow=top,this.bottomRow=bottom},ngRow=function(entity,config,selectionProvider,rowIndex,$utils){var self=this,enableRowSelection=config.enableRowSelection;self.jqueryUITheme=config.jqueryUITheme,self.rowClasses=config.rowClasses,self.entity=entity,self.selectionProvider=selectionProvider,self.selected=selectionProvider.getSelection(entity),self.cursor=enableRowSelection?"pointer":"default",self.setSelection=function(isSelected){self.selectionProvider.setSelection(self,isSelected),self.selectionProvider.lastClickedRow=self},self.continueSelection=function(event){self.selectionProvider.ChangeSelection(self,event)},self.ensureEntity=function(expected){self.entity!=expected&&(self.entity=expected,self.selected=self.selectionProvider.getSelection(self.entity))},self.toggleSelected=function(event){if(!enableRowSelection&&!config.enableCellSelection)return!0;var element=event.target||event;return"checkbox"==element.type&&"ngSelectionCell ng-scope"!=element.parentElement.className?!0:config.selectWithCheckboxOnly&&"checkbox"!=element.type?(self.selectionProvider.lastClickedRow=self,!0):(self.beforeSelectionChange(self,event)&&self.continueSelection(event),!1)},self.rowIndex=rowIndex,self.offsetTop=self.rowIndex*config.rowHeight,self.rowDisplayIndex=0,self.alternatingRowClass=function(){var isEven=self.rowIndex%2===0,classes={ngRow:!0,selected:self.selected,even:isEven,odd:!isEven,"ui-state-default":self.jqueryUITheme&&isEven,"ui-state-active":self.jqueryUITheme&&!isEven};return classes},self.beforeSelectionChange=config.beforeSelectionChangeCallback,self.afterSelectionChange=config.afterSelectionChangeCallback,self.getProperty=function(path){return $utils.evalProperty(self.entity,path)},self.copy=function(){return self.clone=new ngRow(entity,config,selectionProvider,rowIndex,$utils),self.clone.isClone=!0,self.clone.elm=self.elm,self.clone.orig=self,self.clone},self.setVars=function(fromRow){fromRow.clone=self,self.entity=fromRow.entity,self.selected=fromRow.selected}},ngRowFactory=function(grid,$scope,domUtilityService,$templateCache,$utils){var self=this;self.aggCache={},self.parentCache=[],self.dataChanged=!0,self.parsedData=[],self.rowConfig={},self.selectionProvider=$scope.selectionProvider,self.rowHeight=30,self.numberOfAggregates=0,self.groupedData=void 0,self.rowHeight=grid.config.rowHeight,self.rowConfig={enableRowSelection:grid.config.enableRowSelection,rowClasses:grid.config.rowClasses,selectedItems:$scope.selectedItems,selectWithCheckboxOnly:grid.config.selectWithCheckboxOnly,beforeSelectionChangeCallback:grid.config.beforeSelectionChange,afterSelectionChangeCallback:grid.config.afterSelectionChange,jqueryUITheme:grid.config.jqueryUITheme,enableCellSelection:grid.config.enableCellSelection,rowHeight:grid.config.rowHeight},self.renderedRange=new ngRange(0,grid.minRowsToRender()+EXCESS_ROWS),self.buildEntityRow=function(entity,rowIndex){return new ngRow(entity,self.rowConfig,self.selectionProvider,rowIndex,$utils)},self.buildAggregateRow=function(aggEntity,rowIndex){var agg=self.aggCache[aggEntity.aggIndex];return agg||(agg=new ngAggregate(aggEntity,self,self.rowConfig.rowHeight,grid.config.groupsCollapsedByDefault),self.aggCache[aggEntity.aggIndex]=agg),agg.rowIndex=rowIndex,agg.offsetTop=rowIndex*self.rowConfig.rowHeight,agg},self.UpdateViewableRange=function(newRange){self.renderedRange=newRange,self.renderedChange()},self.filteredRowsChanged=function(){grid.lateBoundColumns&&grid.filteredRows.length>0&&(grid.config.columnDefs=void 0,grid.buildColumns(),grid.lateBoundColumns=!1,$scope.$evalAsync(function(){$scope.adjustScrollLeft(0)})),self.dataChanged=!0,grid.config.groups.length>0&&self.getGrouping(grid.config.groups),self.UpdateViewableRange(self.renderedRange)},self.renderedChange=function(){if(!self.groupedData||grid.config.groups.length<1)return self.renderedChangeNoGroups(),void grid.refreshDomSizes();self.wasGrouped=!0,self.parentCache=[];var x=0,temp=self.parsedData.filter(function(e){return e.isAggRow?e.parent&&e.parent.collapsed?!1:!0:(e[NG_HIDDEN]||(e.rowIndex=x++),!e[NG_HIDDEN])});self.totalRows=temp.length;for(var rowArr=[],i=self.renderedRange.topRow;i<self.renderedRange.bottomRow;i++)temp[i]&&(temp[i].offsetTop=i*grid.config.rowHeight,rowArr.push(temp[i]));grid.setRenderedRows(rowArr)},self.renderedChangeNoGroups=function(){for(var rowArr=[],i=self.renderedRange.topRow;i<self.renderedRange.bottomRow;i++)grid.filteredRows[i]&&(grid.filteredRows[i].rowIndex=i,grid.filteredRows[i].offsetTop=i*grid.config.rowHeight,rowArr.push(grid.filteredRows[i]));grid.setRenderedRows(rowArr)},self.fixRowCache=function(){var newLen=grid.data.length,diff=newLen-grid.rowCache.length;if(0>diff)grid.rowCache.length=grid.rowMap.length=newLen;else for(var i=grid.rowCache.length;newLen>i;i++)grid.rowCache[i]=grid.rowFactory.buildEntityRow(grid.data[i],i)},self.parseGroupData=function(g){if(g.values)for(var x=0;x<g.values.length;x++)self.parentCache[self.parentCache.length-1].children.push(g.values[x]),self.parsedData.push(g.values[x]);else for(var prop in g)if(prop!=NG_FIELD&&prop!=NG_DEPTH&&prop!=NG_COLUMN&&g.hasOwnProperty(prop)){var agg=self.buildAggregateRow({gField:g[NG_FIELD],gLabel:prop,gDepth:g[NG_DEPTH],isAggRow:!0,_ng_hidden_:!1,children:[],aggChildren:[],aggIndex:self.numberOfAggregates,aggLabelFilter:g[NG_COLUMN].aggLabelFilter},0);self.numberOfAggregates++,agg.parent=self.parentCache[agg.depth-1],agg.parent&&(agg.parent.collapsed=!1,agg.parent.aggChildren.push(agg)),self.parsedData.push(agg),self.parentCache[agg.depth]=agg,self.parseGroupData(g[prop])}},self.getGrouping=function(groups){self.aggCache=[],self.numberOfAggregates=0,self.groupedData={};for(var rows=grid.filteredRows,maxDepth=groups.length,cols=$scope.columns,x=0;x<rows.length;x++){var model=rows[x].entity;if(!model)return;rows[x][NG_HIDDEN]=grid.config.groupsCollapsedByDefault;for(var ptr=self.groupedData,y=0;y<groups.length;y++){var group=groups[y],col=cols.filter(function(c){return c.field==group})[0],val=$utils.evalProperty(model,group);val=val?val.toString():"null",ptr[val]||(ptr[val]={}),ptr[NG_FIELD]||(ptr[NG_FIELD]=group),ptr[NG_DEPTH]||(ptr[NG_DEPTH]=y),ptr[NG_COLUMN]||(ptr[NG_COLUMN]=col),ptr=ptr[val]}ptr.values||(ptr.values=[]),ptr.values.push(rows[x])}for(var z=0;z<groups.length;z++)!cols[z].isAggCol&&maxDepth>=z&&cols.splice(0,0,new ngColumn({colDef:{field:"",width:25,sortable:!1,resizable:!1,headerCellTemplate:'<div class="ngAggHeader"></div>',pinned:grid.config.pinSelectionCheckbox},enablePinning:grid.config.enablePinning,isAggCol:!0,headerRowHeight:grid.config.headerRowHeight},$scope,grid,domUtilityService,$templateCache,$utils));domUtilityService.BuildStyles($scope,grid,!0),grid.fixColumnIndexes(),$scope.adjustScrollLeft(0),self.parsedData.length=0,self.parseGroupData(self.groupedData),self.fixRowCache()},grid.config.groups.length>0&&grid.filteredRows.length>0&&self.getGrouping(grid.config.groups)},ngSearchProvider=function($scope,grid,$filter){var self=this,searchConditions=[];self.extFilter=grid.config.filterOptions.useExternalFilter,$scope.showFilter=grid.config.showFilter,$scope.filterText="",self.fieldMap={},self.evalFilter=function(){var filterFunc=function(item){for(var x=0,len=searchConditions.length;len>x;x++){var result,condition=searchConditions[x];
if(!condition.column){for(var prop in item)if(item.hasOwnProperty(prop)){var c=self.fieldMap[prop];if(!c)continue;var f=null,s=null;c&&c.cellFilter&&(s=c.cellFilter.split(":"),f=$filter(s[0]));var pVal=item[prop];if(null!=pVal){if("function"==typeof f){var filterRes=f("object"==typeof pVal?evalObject(pVal,c.field):pVal,s[1]).toString();result=condition.regex.test(filterRes)}else result=condition.regex.test("object"==typeof pVal?evalObject(pVal,c.field).toString():pVal.toString());if(pVal&&result)return!0}}return!1}var col=self.fieldMap[condition.columnDisplay];if(!col)return!1;var sp=col.cellFilter.split(":"),filter=col.cellFilter?$filter(sp[0]):null,value=item[condition.column]||item[col.field.split(".")[0]];if(null==value)return!1;if("function"==typeof filter){var filterResults=filter("object"==typeof value?evalObject(value,col.field):value,sp[1]).toString();result=condition.regex.test(filterResults)}else result=condition.regex.test("object"==typeof value?evalObject(value,col.field).toString():value.toString());if(!value||!result)return!1}return!0};grid.filteredRows=0===searchConditions.length?grid.rowCache:grid.rowCache.filter(function(row){return filterFunc(row.entity)});for(var i=0;i<grid.filteredRows.length;i++)grid.filteredRows[i].rowIndex=i;grid.rowFactory.filteredRowsChanged()};var evalObject=function(obj,columnName){if("object"!=typeof obj||"string"!=typeof columnName)return obj;var args=columnName.split("."),cObj=obj;if(args.length>1){for(var i=1,len=args.length;len>i;i++)if(cObj=cObj[args[i]],!cObj)return obj;return cObj}return obj},getRegExp=function(str,modifiers){try{return new RegExp(str,modifiers)}catch(err){return new RegExp(str.replace(/(\^|\$|\(|\)|\<|\>|\[|\]|\{|\}|\\|\||\.|\*|\+|\?)/g,"\\$1"))}},buildSearchConditions=function(a){searchConditions=[];var qStr;if(qStr=$.trim(a))for(var columnFilters=qStr.split(";"),i=0;i<columnFilters.length;i++){var args=columnFilters[i].split(":");if(args.length>1){var columnName=$.trim(args[0]),columnValue=$.trim(args[1]);columnName&&columnValue&&searchConditions.push({column:columnName,columnDisplay:columnName.replace(/\s+/g,"").toLowerCase(),regex:getRegExp(columnValue,"i")})}else{var val=$.trim(args[0]);val&&searchConditions.push({column:"",regex:getRegExp(val,"i")})}}};$scope.$watch(function(){return grid.config.filterOptions.filterText},function(a){$scope.filterText=a}),$scope.$watch("filterText",function(a){self.extFilter||($scope.$emit("ngGridEventFilter",a),buildSearchConditions(a),self.evalFilter())}),self.extFilter||$scope.$watch("columns",function(cs){for(var i=0;i<cs.length;i++){var col=cs[i];col.field&&(self.fieldMap[col.field.split(".")[0]]=col),col.displayName&&(self.fieldMap[col.displayName.toLowerCase().replace(/\s+/g,"")]=col)}})},ngSelectionProvider=function(grid,$scope,$parse){var self=this;self.multi=grid.config.multiSelect,self.selectedItems=grid.config.selectedItems,self.selectedIndex=grid.config.selectedIndex,self.lastClickedRow=void 0,self.ignoreSelectedItemChanges=!1,self.pKeyParser=$parse(grid.config.primaryKey),self.ChangeSelection=function(rowItem,evt){var charCode=evt.which||evt.keyCode,isUpDownKeyPress=40===charCode||38===charCode;if(!evt||evt.keyCode&&!isUpDownKeyPress||evt.ctrlKey||evt.shiftKey||self.toggleSelectAll(!1,!0),evt&&evt.shiftKey&&!evt.keyCode&&self.multi&&grid.config.enableRowSelection){if(self.lastClickedRow){var rowsArr;rowsArr=$scope.configGroups.length>0?grid.rowFactory.parsedData.filter(function(row){return!row.isAggRow}):grid.filteredRows;var thisIndx=rowItem.rowIndex,prevIndx=self.lastClickedRow.rowIndex;if(self.lastClickedRow=rowItem,thisIndx==prevIndx)return!1;prevIndx>thisIndx?(thisIndx^=prevIndx,prevIndx=thisIndx^prevIndx,thisIndx^=prevIndx,thisIndx--):prevIndx++;for(var rows=[];thisIndx>=prevIndx;prevIndx++)rows.push(rowsArr[prevIndx]);if(rows[rows.length-1].beforeSelectionChange(rows,evt)){for(var i=0;i<rows.length;i++){var ri=rows[i],selectionState=ri.selected;ri.selected=!selectionState,ri.clone&&(ri.clone.selected=ri.selected);var index=self.selectedItems.indexOf(ri.entity);-1===index?self.selectedItems.push(ri.entity):self.selectedItems.splice(index,1)}rows[rows.length-1].afterSelectionChange(rows,evt)}return!0}}else self.multi?(!evt.keyCode||isUpDownKeyPress)&&self.setSelection(rowItem,!rowItem.selected):self.lastClickedRow==rowItem?self.setSelection(self.lastClickedRow,grid.config.keepLastSelected?!0:!rowItem.selected):(self.lastClickedRow&&self.setSelection(self.lastClickedRow,!1),self.setSelection(rowItem,!rowItem.selected));return self.lastClickedRow=rowItem,!0},self.getSelection=function(entity){var isSelected=!1;if(grid.config.primaryKey){var val=self.pKeyParser(entity);angular.forEach(self.selectedItems,function(c){val==self.pKeyParser(c)&&(isSelected=!0)})}else isSelected=-1!==self.selectedItems.indexOf(entity);return isSelected},self.setSelection=function(rowItem,isSelected){if(grid.config.enableRowSelection){if(isSelected)-1===self.selectedItems.indexOf(rowItem.entity)&&(!self.multi&&self.selectedItems.length>0&&self.toggleSelectAll(!1,!0),self.selectedItems.push(rowItem.entity));else{var indx=self.selectedItems.indexOf(rowItem.entity);-1!=indx&&self.selectedItems.splice(indx,1)}rowItem.selected=isSelected,rowItem.orig&&(rowItem.orig.selected=isSelected),rowItem.clone&&(rowItem.clone.selected=isSelected),rowItem.afterSelectionChange(rowItem)}},self.toggleSelectAll=function(checkAll,bypass){if(bypass||grid.config.beforeSelectionChange(grid.filteredRows,checkAll)){var selectedlength=self.selectedItems.length;selectedlength>0&&(self.selectedItems.length=0);for(var i=0;i<grid.filteredRows.length;i++)grid.filteredRows[i].selected=checkAll,grid.filteredRows[i].clone&&(grid.filteredRows[i].clone.selected=checkAll),checkAll&&self.selectedItems.push(grid.filteredRows[i].entity);bypass||grid.config.afterSelectionChange(grid.filteredRows,checkAll)}}},ngStyleProvider=function($scope,grid){$scope.headerCellStyle=function(col){return{height:col.headerRowHeight+"px"}},$scope.rowStyle=function(row){var ret={top:row.offsetTop+"px",height:$scope.rowHeight+"px"};return row.isAggRow&&(ret.left=row.offsetLeft),ret},$scope.canvasStyle=function(){return{height:grid.maxCanvasHt.toString()+"px"}},$scope.headerScrollerStyle=function(){return{height:grid.config.headerRowHeight+"px"}},$scope.topPanelStyle=function(){return{width:grid.rootDim.outerWidth+"px",height:$scope.topPanelHeight()+"px"}},$scope.headerStyle=function(){return{width:grid.rootDim.outerWidth+"px",height:grid.config.headerRowHeight+"px"}},$scope.groupPanelStyle=function(){return{width:grid.rootDim.outerWidth+"px",height:"32px"}},$scope.viewportStyle=function(){return{width:grid.rootDim.outerWidth+"px",height:$scope.viewportDimHeight()+"px"}},$scope.footerStyle=function(){return{width:grid.rootDim.outerWidth+"px",height:$scope.footerRowHeight+"px"}}};ngGridDirectives.directive("ngCellHasFocus",["$domUtilityService",function(domUtilityService){var focusOnInputElement=function($scope,elm){$scope.isFocused=!0,domUtilityService.digest($scope);var elementWithoutComments=angular.element(elm[0].children).filter(function(){return 8!=this.nodeType}),inputElement=angular.element(elementWithoutComments[0].children[0]);inputElement.length>0&&(angular.element(inputElement).focus(),$scope.domAccessProvider.selectInputElement(inputElement[0]),angular.element(inputElement).bind("blur",function(){return $scope.isFocused=!1,domUtilityService.digest($scope),!0}))};return function($scope,elm){var isFocused=!1;$scope.editCell=function(){setTimeout(function(){focusOnInputElement($scope,elm)},0)},elm.bind("mousedown",function(){return elm.focus(),!0}),elm.bind("focus",function(){return isFocused=!0,!0}),elm.bind("blur",function(){return isFocused=!1,!0}),elm.bind("keydown",function(evt){return isFocused&&37!=evt.keyCode&&38!=evt.keyCode&&39!=evt.keyCode&&40!=evt.keyCode&&9!=evt.keyCode&&!evt.shiftKey&&13!=evt.keyCode&&focusOnInputElement($scope,elm),27==evt.keyCode&&elm.focus(),!0})}}]),ngGridDirectives.directive("ngCellText",function(){return function(scope,elm){elm.bind("mouseover",function(evt){evt.preventDefault(),elm.css({cursor:"text"})}),elm.bind("mouseleave",function(evt){evt.preventDefault(),elm.css({cursor:"default"})})}}),ngGridDirectives.directive("ngCell",["$compile","$domUtilityService",function($compile,domUtilityService){var ngCell={scope:!1,compile:function(){return{pre:function($scope,iElement){var html,cellTemplate=$scope.col.cellTemplate.replace(COL_FIELD,"$eval('row.entity.' + col.field)");$scope.col.enableCellEdit?(html=$scope.col.cellEditTemplate,html=html.replace(DISPLAY_CELL_TEMPLATE,cellTemplate),html=html.replace(EDITABLE_CELL_TEMPLATE,$scope.col.editableCellTemplate.replace(COL_FIELD,"$eval('row.entity.' + col.field)"))):html=cellTemplate;var cellElement=$compile(html)($scope);$scope.enableCellSelection&&-1==cellElement[0].className.indexOf("ngSelectionCell")&&(cellElement[0].setAttribute("tabindex",0),cellElement.addClass("ngCellElement")),iElement.append(cellElement)},post:function($scope,iElement){$scope.enableCellSelection&&$scope.domAccessProvider.selectionHandlers($scope,iElement),$scope.$on("ngGridEventDigestCell",function(){domUtilityService.digest($scope)})}}}};return ngCell}]),ngGridDirectives.directive("ngGridFooter",["$compile","$templateCache",function($compile,$templateCache){var ngGridFooter={scope:!1,compile:function(){return{pre:function($scope,iElement){0===iElement.children().length&&iElement.append($compile($templateCache.get($scope.gridId+"footerTemplate.html"))($scope))}}}};return ngGridFooter}]),ngGridDirectives.directive("ngGridMenu",["$compile","$templateCache",function($compile,$templateCache){var ngGridMenu={scope:!1,compile:function(){return{pre:function($scope,iElement){0===iElement.children().length&&iElement.append($compile($templateCache.get($scope.gridId+"menuTemplate.html"))($scope))}}}};return ngGridMenu}]),ngGridDirectives.directive("ngGrid",["$compile","$filter","$templateCache","$sortService","$domUtilityService","$utilityService","$timeout","$parse","$http","$q",function($compile,$filter,$templateCache,sortService,domUtilityService,$utils,$timeout,$parse,$http,$q){var ngGridDirective={scope:!0,compile:function(){return{pre:function($scope,iElement,iAttrs){var $element=$(iElement),options=$scope.$eval(iAttrs.ngGrid);options.gridDim=new ngDimension({outerHeight:$($element).height(),outerWidth:$($element).width()});var grid=new ngGrid($scope,options,sortService,domUtilityService,$filter,$templateCache,$utils,$timeout,$parse,$http,$q);return grid.init().then(function(){if("string"==typeof options.columnDefs?$scope.$parent.$watch(options.columnDefs,function(a){return a?(grid.lateBoundColumns=!1,$scope.columns=[],grid.config.columnDefs=a,grid.buildColumns(),grid.configureColumnWidths(),grid.eventProvider.assignEvents(),void domUtilityService.RebuildGrid($scope,grid)):(grid.refreshDomSizes(),void grid.buildColumns())},!0):grid.buildColumns(),"string"==typeof options.data){var dataWatcher=function(a){grid.data=$.extend([],a),grid.rowFactory.fixRowCache(),angular.forEach(grid.data,function(item,j){var indx=grid.rowMap[j]||j;grid.rowCache[indx]&&grid.rowCache[indx].ensureEntity(item),grid.rowMap[indx]=j}),grid.searchProvider.evalFilter(),grid.configureColumnWidths(),grid.refreshDomSizes(),grid.config.sortInfo.fields.length>0&&(grid.getColsFromFields(),grid.sortActual(),grid.searchProvider.evalFilter(),$scope.$emit("ngGridEventSorted",grid.config.sortInfo)),$scope.$emit("ngGridEventData",grid.gridId)};$scope.$parent.$watch(options.data,dataWatcher),$scope.$parent.$watch(options.data+".length",function(){dataWatcher($scope.$eval(options.data))})}return grid.footerController=new ngFooter($scope,grid),iElement.addClass("ngGrid").addClass(grid.gridId.toString()),options.enableHighlighting||iElement.addClass("unselectable"),options.jqueryUITheme&&iElement.addClass("ui-widget"),iElement.append($compile($templateCache.get("gridTemplate.html"))($scope)),domUtilityService.AssignGridContainers($scope,iElement,grid),grid.eventProvider=new ngEventProvider(grid,$scope,domUtilityService,$timeout),options.selectRow=function(rowIndex,state){grid.rowCache[rowIndex]&&(grid.rowCache[rowIndex].clone&&grid.rowCache[rowIndex].clone.setSelection(state?!0:!1),grid.rowCache[rowIndex].setSelection(state?!0:!1))},options.selectItem=function(itemIndex,state){options.selectRow(grid.rowMap[itemIndex],state)},options.selectAll=function(state){$scope.toggleSelectAll(state)},options.groupBy=function(field){if(field)$scope.groupBy($scope.columns.filter(function(c){return c.field==field})[0]);else{var arr=$.extend(!0,[],$scope.configGroups);angular.forEach(arr,$scope.groupBy)}},options.sortBy=function(field){var col=$scope.columns.filter(function(c){return c.field==field})[0];col&&col.sort()},options.gridId=grid.gridId,options.ngGrid=grid,options.$gridScope=$scope,options.$gridServices={SortService:sortService,DomUtilityService:domUtilityService},$scope.$on("ngGridEventDigestGrid",function(){domUtilityService.digest($scope.$parent)}),$scope.$on("ngGridEventDigestGridParent",function(){domUtilityService.digest($scope.$parent)}),$scope.$evalAsync(function(){$scope.adjustScrollLeft(0)}),angular.forEach(options.plugins,function(p){"function"==typeof p&&(p=p.call(this)),p.init($scope.$new(),grid,options.$gridServices),options.plugins[$utils.getInstanceType(p)]=p}),"function"==options.init&&options.init(grid,$scope),null})}}}};return ngGridDirective}]),ngGridDirectives.directive("ngHeaderCell",["$compile",function($compile){var ngHeaderCell={scope:!1,compile:function(){return{pre:function($scope,iElement){iElement.append($compile($scope.col.headerCellTemplate)($scope))}}}};return ngHeaderCell}]),ngGridDirectives.directive("ngIf",[function(){return{transclude:"element",priority:1e3,terminal:!0,restrict:"A",compile:function(e,a,transclude){return function(scope,element,attr){var childElement,childScope;scope.$watch(attr.ngIf,function(newValue){childElement&&(childElement.remove(),childElement=void 0),childScope&&(childScope.$destroy(),childScope=void 0),newValue&&(childScope=scope.$new(),transclude(childScope,function(clone){childElement=clone,element.after(clone)}))})}}}}]),ngGridDirectives.directive("ngInput",["$parse",function($parse){return function($scope,elm,attrs){var getter=$parse($scope.$eval(attrs.ngInput)),setter=getter.assign,oldCellValue=getter($scope.row.entity);elm.val(oldCellValue),elm.bind("keyup",function(){var newVal=elm.val();$scope.$root.$$phase||$scope.$apply(function(){setter($scope.row.entity,newVal)})}),elm.bind("keydown",function(evt){switch(evt.keyCode){case 37:case 38:case 39:case 40:evt.stopPropagation();break;case 27:$scope.$root.$$phase||$scope.$apply(function(){setter($scope.row.entity,oldCellValue),elm.val(oldCellValue),elm.blur()})}return!0})}}]),ngGridDirectives.directive("ngRow",["$compile","$domUtilityService","$templateCache",function($compile,domUtilityService,$templateCache){var ngRow={scope:!1,compile:function(){return{pre:function($scope,iElement){if($scope.row.elm=iElement,$scope.row.clone&&($scope.row.clone.elm=iElement),$scope.row.isAggRow){var html=$templateCache.get($scope.gridId+"aggregateTemplate.html");html=$scope.row.aggLabelFilter?html.replace(CUSTOM_FILTERS,"| "+$scope.row.aggLabelFilter):html.replace(CUSTOM_FILTERS,""),iElement.append($compile(html)($scope))}else iElement.append($compile($templateCache.get($scope.gridId+"rowTemplate.html"))($scope));$scope.$on("ngGridEventDigestRow",function(){domUtilityService.digest($scope)})}}}};return ngRow}]),ngGridDirectives.directive("ngViewport",[function(){return function($scope,elm){var isMouseWheelActive,prevScollLeft,prevScollTop=0;elm.bind("scroll",function(evt){var scrollLeft=evt.target.scrollLeft,scrollTop=evt.target.scrollTop;return $scope.$headerContainer&&$scope.$headerContainer.scrollLeft(scrollLeft),$scope.adjustScrollLeft(scrollLeft),$scope.adjustScrollTop(scrollTop),$scope.$root.$$phase||$scope.$digest(),prevScollLeft=scrollLeft,prevScollTop=prevScollTop,isMouseWheelActive=!1,!0}),elm.bind("mousewheel DOMMouseScroll",function(){return isMouseWheelActive=!0,elm.focus(),!0}),$scope.enableCellSelection||$scope.domAccessProvider.selectionHandlers($scope,elm)}}]),window.ngGrid.i18n.en={ngAggregateLabel:"items",ngGroupPanelDescription:"Drag a column header here and drop it to group by that column.",ngSearchPlaceHolder:"Search...",ngMenuText:"Choose Columns:",ngShowingItemsLabel:"Showing Items:",ngTotalItemsLabel:"Total Items:",ngSelectedItemsLabel:"Selected Items:",ngPageSizeLabel:"Page Size:",ngPagerFirstTitle:"First Page",ngPagerNextTitle:"Next Page",ngPagerPrevTitle:"Previous Page",ngPagerLastTitle:"Last Page"},window.ngGrid.i18n.fr={ngAggregateLabel:"articles",ngGroupPanelDescription:"Faites glisser un en-tte de colonne ici et dposez-le vers un groupe par cette colonne.",ngSearchPlaceHolder:"Recherche...",ngMenuText:"Choisir des colonnes:",ngShowingItemsLabel:"Articles Affichage des:",ngTotalItemsLabel:"Nombre total d'articles:",ngSelectedItemsLabel:"lments Articles:",ngPageSizeLabel:"Taille de page:",ngPagerFirstTitle:"Premire page",ngPagerNextTitle:"Page Suivante",ngPagerPrevTitle:"Page prcdente",ngPagerLastTitle:"Dernire page"},window.ngGrid.i18n.ge={ngAggregateLabel:"artikel",ngGroupPanelDescription:"Ziehen Sie eine Spaltenberschrift hier und legen Sie es der Gruppe nach dieser Spalte.",ngSearchPlaceHolder:"Suche...",ngMenuText:"Spalten auswhlen:",ngShowingItemsLabel:"Zeige Artikel:",ngTotalItemsLabel:"Meiste Artikel:",ngSelectedItemsLabel:"Ausgewhlte Artikel:",ngPageSizeLabel:"Gre Seite:",ngPagerFirstTitle:"Erste Page",ngPagerNextTitle:"Nchste Page",ngPagerPrevTitle:"Vorherige Page",ngPagerLastTitle:"Letzte Page"},window.ngGrid.i18n.sp={ngAggregateLabel:"Artculos",ngGroupPanelDescription:"Arrastre un encabezado de columna aqu y soltarlo para agrupar por esa columna.",ngSearchPlaceHolder:"Buscar...",ngMenuText:"Elegir columnas:",ngShowingItemsLabel:"Artculos Mostrando:",ngTotalItemsLabel:"Artculos Totales:",ngSelectedItemsLabel:"Artculos Seleccionados:",ngPageSizeLabel:"Tamao de Pgina:",ngPagerFirstTitle:"Primera Pgina",ngPagerNextTitle:"Pgina Siguiente",ngPagerPrevTitle:"Pgina Anterior",ngPagerLastTitle:"ltima Pgina"},window.ngGrid.i18n["zh-cn"]={ngAggregateLabel:"",ngGroupPanelDescription:"",ngSearchPlaceHolder:"...",ngMenuText:"",ngShowingItemsLabel:"",ngTotalItemsLabel:"",ngSelectedItemsLabel:"",ngPageSizeLabel:"",ngPagerFirstTitle:"",ngPagerNextTitle:"",ngPagerPrevTitle:"",ngPagerLastTitle:""},window.ngGrid.i18n["zh-tw"]={ngAggregateLabel:"",ngGroupPanelDescription:"",ngSearchPlaceHolder:"...",ngMenuText:"",ngShowingItemsLabel:"",ngTotalItemsLabel:"",ngSelectedItemsLabel:"",ngPageSizeLabel:"",ngPagerFirstTitle:"",ngPagerNextTitle:"",ngPagerPrevTitle:"",ngPagerLastTitle:""},angular.module("ngGrid").run(["$templateCache",function($templateCache){$templateCache.put("aggregateTemplate.html",'<div ng-click="row.toggleExpand()" ng-style="rowStyle(row)" class="ngAggregate">    <span class="ngAggregateText">{{row.label CUSTOM_FILTERS}} ({{row.totalChildren()}} {{AggItemsLabel}})</span>    <div class="{{row.aggClass()}}"></div></div>'),$templateCache.put("cellEditTemplate.html",'<div ng-cell-has-focus ng-dblclick="editCell()"> <div ng-if="!isFocused"> DISPLAY_CELL_TEMPLATE </div> <div ng-if="isFocused"> EDITABLE_CELL_TEMPLATE </div></div>'),$templateCache.put("cellTemplate.html",'<div class="ngCellText" ng-class="col.colIndex()"><span ng-cell-text>{{COL_FIELD CUSTOM_FILTERS}}</span></div>'),$templateCache.put("checkboxCellTemplate.html",'<div class="ngSelectionCell"><input tabindex="-1" class="ngSelectionCheckbox" type="checkbox" ng-checked="row.selected" /></div>'),$templateCache.put("checkboxHeaderTemplate.html",'<input class="ngSelectionHeader" type="checkbox" ng-show="multiSelect" ng-model="allSelected" ng-change="toggleSelectAll(allSelected)"/>'),$templateCache.put("editableCellTemplate.html",'<input ng-class="\'colt\' + col.index" ng-input="COL_FIELD" />'),$templateCache.put("footerTemplate.html",'<div ng-show="showFooter" class="ngFooterPanel" ng-class="{\'ui-widget-content\': jqueryUITheme, \'ui-corner-bottom\': jqueryUITheme}" ng-style="footerStyle()">    <div class="ngTotalSelectContainer" >        <div class="ngFooterTotalItems" ng-class="{\'ngNoMultiSelect\': !multiSelect}" >            <span class="ngLabel">{{i18n.ngTotalItemsLabel}} {{maxRows()}}</span><span ng-show="filterText.length > 0" class="ngLabel">({{i18n.ngShowingItemsLabel}} {{totalFilteredItemsLength()}})</span>        </div>        <div class="ngFooterSelectedItems" ng-show="multiSelect">            <span class="ngLabel">{{i18n.ngSelectedItemsLabel}} {{selectedItems.length}}</span>        </div>    </div>    <div class="ngPagerContainer" style="float: right; margin-top: 10px;" ng-show="enablePaging" ng-class="{\'ngNoMultiSelect\': !multiSelect}">        <div style="float:left; margin-right: 10px;" class="ngRowCountPicker">            <span style="float: left; margin-top: 3px;" class="ngLabel">{{i18n.ngPageSizeLabel}}</span>            <select style="float: left;height: 27px; width: 100px" ng-model="pagingOptions.pageSize" >                <option ng-repeat="size in pagingOptions.pageSizes">{{size}}</option>            </select>        </div>        <div style="float:left; margin-right: 10px; line-height:25px;" class="ngPagerControl" style="float: left; min-width: 135px;">            <button class="ngPagerButton" ng-click="pageToFirst()" ng-disabled="cantPageBackward()" title="{{i18n.ngPagerFirstTitle}}"><div class="ngPagerFirstTriangle"><div class="ngPagerFirstBar"></div></div></button>            <button class="ngPagerButton" ng-click="pageBackward()" ng-disabled="cantPageBackward()" title="{{i18n.ngPagerPrevTitle}}"><div class="ngPagerFirstTriangle ngPagerPrevTriangle"></div></button>            <input class="ngPagerCurrent" type="number" style="width:50px; height: 24px; margin-top: 1px; padding: 0 4px;" ng-model="pagingOptions.currentPage"/>            <button class="ngPagerButton" ng-click="pageForward()" ng-disabled="cantPageForward()" title="{{i18n.ngPagerNextTitle}}"><div class="ngPagerLastTriangle ngPagerNextTriangle"></div></button>            <button class="ngPagerButton" ng-click="pageToLast()" ng-disabled="cantPageToLast()" title="{{i18n.ngPagerLastTitle}}"><div class="ngPagerLastTriangle"><div class="ngPagerLastBar"></div></div></button>        </div>    </div></div>'),$templateCache.put("gridTemplate.html",'<div class="ngTopPanel" ng-class="{\'ui-widget-header\':jqueryUITheme, \'ui-corner-top\': jqueryUITheme}" ng-style="topPanelStyle()">    <div class="ngGroupPanel" ng-show="showGroupPanel()" ng-style="groupPanelStyle()">        <div class="ngGroupPanelDescription" ng-show="configGroups.length == 0">{{i18n.ngGroupPanelDescription}}</div>        <ul ng-show="configGroups.length > 0" class="ngGroupList">            <li class="ngGroupItem" ng-repeat="group in configGroups">                <span class="ngGroupElement">                    <span class="ngGroupName">{{group.displayName}}                        <span ng-click="removeGroup($index)" class="ngRemoveGroup">x</span>                    </span>                    <span ng-hide="$last" class="ngGroupArrow"></span>                </span>            </li>        </ul>    </div>    <div class="ngHeaderContainer" ng-style="headerStyle()">        <div class="ngHeaderScroller" ng-style="headerScrollerStyle()" ng-include="gridId + \'headerRowTemplate.html\'"></div>    </div>    <div ng-grid-menu></div></div><div class="ngViewport" unselectable="on" ng-viewport ng-class="{\'ui-widget-content\': jqueryUITheme}" ng-style="viewportStyle()">    <div class="ngCanvas" ng-style="canvasStyle()">        <div ng-style="rowStyle(row)" ng-repeat="row in renderedRows" ng-click="row.toggleSelected($event)" ng-class="row.alternatingRowClass()" ng-row></div>    </div></div><div ng-grid-footer></div>'),$templateCache.put("headerCellTemplate.html",'<div class="ngHeaderSortColumn {{col.headerClass}}" ng-style="{\'cursor\': col.cursor}" ng-class="{ \'ngSorted\': !noSortVisible }">    <div ng-click="col.sort($event)" ng-class="\'colt\' + col.index" class="ngHeaderText">{{col.displayName}}</div>    <div class="ngSortButtonDown" ng-show="col.showSortButtonDown()"></div>    <div class="ngSortButtonUp" ng-show="col.showSortButtonUp()"></div>    <div class="ngSortPriority">{{col.sortPriority}}</div>    <div ng-class="{ ngPinnedIcon: col.pinned, ngUnPinnedIcon: !col.pinned }" ng-click="togglePin(col)" ng-show="col.pinnable"></div></div><div ng-show="col.resizable" class="ngHeaderGrip" ng-click="col.gripClick($event)" ng-mousedown="col.gripOnMouseDown($event)"></div>'),$templateCache.put("headerRowTemplate.html",'<div ng-style="{ height: col.headerRowHeight }" ng-repeat="col in renderedColumns" ng-class="col.colIndex()" class="ngHeaderCell" ng-header-cell></div>'),$templateCache.put("menuTemplate.html",'<div ng-show="showColumnMenu || showFilter"  class="ngHeaderButton" ng-click="toggleShowMenu()">    <div class="ngHeaderButtonArrow"></div></div><div ng-show="showMenu" class="ngColMenu">    <div ng-show="showFilter">        <input placeholder="{{i18n.ngSearchPlaceHolder}}" type="text" ng-model="filterText"/>    </div>    <div ng-show="showColumnMenu">        <span class="ngMenuText">{{i18n.ngMenuText}}</span>        <ul class="ngColList">            <li class="ngColListItem" ng-repeat="col in columns | ngColumns">                <label><input ng-disabled="col.pinned" type="checkbox" class="ngColListCheckbox" ng-model="col.visible"/>{{col.displayName}}</label>       <a title="Group By" ng-class="col.groupedByClass()" ng-show="col.groupable && col.visible" ng-click="groupBy(col)"></a>       <span class="ngGroupingNumber" ng-show="col.groupIndex > 0">{{col.groupIndex}}</span>                      </li>        </ul>    </div></div>'),$templateCache.put("rowTemplate.html",'<div ng-style="{ \'cursor\': row.cursor }" ng-repeat="col in renderedColumns" ng-class="col.colIndex()" class="ngCell {{col.cellClass}}" ng-cell></div>')}])}(window,jQuery),angular.module("ajoslin.promise-tracker",[]),angular.module("ajoslin.promise-tracker").factory("trackerResponseInterceptor",["$q","promiseTracker","$injector",function($q,promiseTracker,$injector){var $http;return function(promise){$http||($http=$injector.get("$http"));var config=$http.pendingRequests[$http.pendingRequests.length-1];return config.tracker&&promiseTracker(config.tracker).addPromise(promise,config),promise}}]).factory("trackerHttpInterceptor",["$q","promiseTracker","$injector",function($q,promiseTracker){return{request:function(config){if(config.tracker){var deferred=promiseTracker(config.tracker).createPromise(config);config.$promiseTrackerDeferred=deferred}return $q.when(config)},response:function(response){return response.config.$promiseTrackerDeferred&&response.config.$promiseTrackerDeferred.resolve(response),$q.when(response)},responseError:function(response){return response.config.$promiseTrackerDeferred&&response.config.$promiseTrackerDeferred.reject(response),$q.reject(response)}}}]).config(["$httpProvider",function($httpProvider){$httpProvider.interceptors?$httpProvider.interceptors.push("trackerHttpInterceptor"):$httpProvider.responseInterceptors.push("trackerResponseInterceptor")}]),angular.module("ajoslin.promise-tracker").provider("promiseTracker",function(){function nextUid(){for(var digit,index=uid.length;index;){if(index--,digit=uid[index].charCodeAt(0),57===digit)return uid[index]="A",uid.join("");if(90!==digit)return uid[index]=String.fromCharCode(digit+1),uid.join("");uid[index]="0"}return uid.unshift("0"),uid.join("")}var uid=["0","0","0"],trackers={};this.$get=["$q","$timeout",function($q,$timeout){function Tracker(options){function fireEvent(options){angular.forEach(callbacks[options.event],function(cb){cb.call(self,options.value,options.id)})}function createPromise(startArg){function onDone(isError){return function(value){self.minPromise.then(function(){fireEvent({event:isError?"error":"success",id:promiseId,value:value}),fireEvent({event:"done",id:promiseId,value:value});var index=trackedPromises.indexOf(deferred);trackedPromises.splice(index,1),0===trackedPromises.length&&self.maxPromise&&$timeout.cancel(self.maxPromise)})}}var deferred=$q.defer(),promiseId=nextUid();return trackedPromises.push(deferred),fireEvent({event:"start",id:promiseId,value:startArg}),1===trackedPromises.length&&(self.minPromise=self._minDuration?$timeout(angular.noop,self._minDuration):$q.when(!0),self._maxDuration&&(self.maxPromise=$timeout(deferred.resolve,self._maxDuration))),deferred.promise.then(onDone(!1),onDone(!0)),deferred}options=options||{};var self=this,callbacks={start:[],done:[],error:[],success:[]},trackedPromises=[];self.setMinDuration=function(minimum){self._minDuration=minimum},self.setMinDuration(options.minDuration),self.setMaxDuration=function(maximum){self._maxDuration=maximum},self.setMaxDuration(options.maxDuration),self.active=function(){return trackedPromises.length>0},self.cancel=function(){angular.forEach(trackedPromises,function(deferred){deferred.resolve()})},self.addPromise=function(promise,startArg){var deferred=createPromise(startArg);return(promise.$then||promise.then)(function(value){return deferred.resolve(value),value},function(value){return deferred.reject(value),$q.reject(value)}),deferred},self.createPromise=function(startArg){return createPromise(startArg)},self.on=self.bind=function(event,cb){if(!callbacks[event])throw"Cannot create callback for event '"+event+"'. Allowed types: 'start', 'done', 'error', 'success'";return callbacks[event].push(cb),self},self.off=self.unbind=function(event,cb){if(!callbacks[event])throw"Cannot create callback for event '"+event+"'. Allowed types: 'start', 'done', 'error', 'success'";if(cb){var index=callbacks[event].indexOf(cb);callbacks[event].splice(index,1)}else callbacks[event].length=0;return self}}return function(trackerName,options){return trackers[trackerName]||(trackers[trackerName]=new Tracker(options)),trackers[trackerName]}}]}),function(ctx){function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}function str_repeat(input,multiplier){for(var output=[];multiplier>0;output[--multiplier]=input);return output.join("")}var sprintf=function(){return sprintf.cache.hasOwnProperty(arguments[0])||(sprintf.cache[arguments[0]]=sprintf.parse(arguments[0])),sprintf.format.call(null,sprintf.cache[arguments[0]],arguments)};sprintf.format=function(parse_tree,argv){var arg,i,k,match,pad,pad_character,pad_length,cursor=1,tree_length=parse_tree.length,node_type="",output=[];for(i=0;tree_length>i;i++)if(node_type=get_type(parse_tree[i]),"string"===node_type)output.push(parse_tree[i]);else if("array"===node_type){if(match=parse_tree[i],match[2])for(arg=argv[cursor],k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw sprintf('[sprintf] property "%s" does not exist',match[2][k]);arg=arg[match[2][k]]}else arg=match[1]?argv[match[1]]:argv[cursor++];if(/[^s]/.test(match[8])&&"number"!=get_type(arg))throw sprintf("[sprintf] expecting number but found %s",get_type(arg));switch(match[8]){case"b":arg=arg.toString(2);break;case"c":arg=String.fromCharCode(arg);break;case"d":arg=parseInt(arg,10);break;case"e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case"o":arg=arg.toString(8);break;case"s":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case"u":arg>>>=0;break;case"x":arg=arg.toString(16);break;case"X":arg=arg.toString(16).toUpperCase()}arg=/[def]/.test(match[8])&&match[3]&&arg>=0?"+"+arg:arg,pad_character=match[4]?"0"==match[4]?"0":match[4].charAt(1):" ",pad_length=match[6]-String(arg).length,pad=match[6]?str_repeat(pad_character,pad_length):"",output.push(match[5]?arg+pad:pad+arg)
}return output.join("")},sprintf.cache={},sprintf.parse=function(fmt){for(var _fmt=fmt,match=[],parse_tree=[],arg_names=0;_fmt;){if(null!==(match=/^[^\x25]+/.exec(_fmt)))parse_tree.push(match[0]);else if(null!==(match=/^\x25{2}/.exec(_fmt)))parse_tree.push("%");else{if(null===(match=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(_fmt)))throw"[sprintf] huh?";if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if(null===(field_match=/^([a-z_][a-z_\d]*)/i.exec(replacement_field)))throw"[sprintf] huh?";for(field_list.push(field_match[1]);""!==(replacement_field=replacement_field.substring(field_match[0].length));)if(null!==(field_match=/^\.([a-z_][a-z_\d]*)/i.exec(replacement_field)))field_list.push(field_match[1]);else{if(null===(field_match=/^\[(\d+)\]/.exec(replacement_field)))throw"[sprintf] huh?";field_list.push(field_match[1])}match[2]=field_list}else arg_names|=2;if(3===arg_names)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";parse_tree.push(match)}_fmt=_fmt.substring(match[0].length)}return parse_tree};var vsprintf=function(fmt,argv,_argv){return _argv=argv.slice(0),_argv.splice(0,0,fmt),sprintf.apply(null,_argv)};ctx.sprintf=sprintf,ctx.vsprintf=vsprintf}("undefined"!=typeof exports?exports:window),angular.module("ui.codemirror",[]).constant("uiCodemirrorConfig",{}).directive("uiCodemirror",["uiCodemirrorConfig","$timeout",function(uiCodemirrorConfig,$timeout){"use strict";var events=["cursorActivity","viewportChange","gutterClick","focus","blur","scroll","update"];return{restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ngModel){var options,opts,onChange,deferCodeMirror,codeMirror;if("textarea"!==elm[0].type)throw new Error("uiCodemirror3 can only be applied to a textarea element");options=uiCodemirrorConfig.codemirror||{},opts=angular.extend({},options,scope.$eval(attrs.uiCodemirror)),onChange=function(aEvent){return function(instance,changeObj){var newValue=instance.getValue();newValue!==ngModel.$viewValue&&(ngModel.$setViewValue(newValue),scope.$$phase||scope.$apply()),"function"==typeof aEvent&&aEvent(instance,changeObj)}},deferCodeMirror=function(){codeMirror=CodeMirror.fromTextArea(elm[0],opts),codeMirror.on("change",onChange(opts.onChange));for(var aEvent,i=0,n=events.length;n>i;++i)aEvent=opts["on"+events[i].charAt(0).toUpperCase()+events[i].slice(1)],void 0!==aEvent&&"function"==typeof aEvent&&codeMirror.on(events[i],aEvent);ngModel.$formatters.push(function(value){if(angular.isUndefined(value)||null===value)return"";if(angular.isObject(value)||angular.isArray(value))throw new Error("ui-codemirror cannot use an object or an array as a model");return value}),ngModel.$render=function(){codeMirror.setValue(ngModel.$viewValue)},attrs.uiRefresh&&scope.$watch(attrs.uiRefresh,function(newVal,oldVal){newVal!==oldVal&&$timeout(function(){codeMirror.refresh()})})},$timeout(deferCodeMirror)}}}]),angular.module("ui.event",[]).directive("uiEvent",["$parse",function($parse){return function($scope,elm,attrs){var events=$scope.$eval(attrs.uiEvent);angular.forEach(events,function(uiEvent,eventName){var fn=$parse(uiEvent);elm.bind(eventName,function(evt){var params=Array.prototype.slice.call(arguments);params=params.splice(1),fn($scope,{$event:evt,$params:params}),$scope.$$phase||$scope.$apply()})})}}]),angular.module("ui.format",[]).filter("format",function(){return function(value,replace){if(!value)return value;var token,target=value.toString();return void 0===replace?target:angular.isArray(replace)||angular.isObject(replace)?(token=angular.isArray(replace)&&"$"||":",angular.forEach(replace,function(value,key){target=target.split(token+key).join(value)}),target):target.split("$0").join(replace)}}),angular.module("ui.highlight",[]).filter("highlight",function(){return function(text,search,caseSensitive){return search||angular.isNumber(search)?(text=text.toString(),search=search.toString(),caseSensitive?text.split(search).join('<span class="ui-match">'+search+"</span>"):text.replace(new RegExp(search,"gi"),'<span class="ui-match">$&</span>')):text}}),angular.module("ui.indeterminate",[]).directive("uiIndeterminate",[function(){return{compile:function(tElm,tAttrs){return tAttrs.type&&"checkbox"===tAttrs.type.toLowerCase()?function($scope,elm,attrs){$scope.$watch(attrs.uiIndeterminate,function(newVal){elm[0].indeterminate=!!newVal})}:angular.noop}}}]),angular.module("ui.inflector",[]).filter("inflector",function(){function ucwords(text){return text.replace(/^([a-z])|\s+([a-z])/g,function($1){return $1.toUpperCase()})}function breakup(text,separator){return text.replace(/[A-Z]/g,function(match){return separator+match})}var inflectors={humanize:function(value){return ucwords(breakup(value," ").split("_").join(" "))},underscore:function(value){return value.substr(0,1).toLowerCase()+breakup(value.substr(1),"_").toLowerCase().split(" ").join("_")},variable:function(value){return value=value.substr(0,1).toLowerCase()+ucwords(value.split("_").join(" ")).substr(1).split(" ").join("")}};return function(text,inflector){return inflector!==!1&&angular.isString(text)?(inflector=inflector||"humanize",inflectors[inflector](text)):text}}),angular.module("ui.jq",[]).value("uiJqConfig",{}).directive("uiJq",["uiJqConfig","$timeout",function(uiJqConfig,$timeout){return{restrict:"A",compile:function(tElm,tAttrs){if(!angular.isFunction(tElm[tAttrs.uiJq]))throw new Error('ui-jq: The "'+tAttrs.uiJq+'" function does not exist');var options=uiJqConfig&&uiJqConfig[tAttrs.uiJq];return function(scope,elm,attrs){function callPlugin(){$timeout(function(){elm[attrs.uiJq].apply(elm,linkOptions)},0,!1)}var linkOptions=[];attrs.uiOptions?(linkOptions=scope.$eval("["+attrs.uiOptions+"]"),angular.isObject(options)&&angular.isObject(linkOptions[0])&&(linkOptions[0]=angular.extend({},options,linkOptions[0]))):options&&(linkOptions=[options]),attrs.ngModel&&elm.is("select,input,textarea")&&elm.bind("change",function(){elm.trigger("input")}),attrs.uiRefresh&&scope.$watch(attrs.uiRefresh,function(){callPlugin()}),callPlugin()}}}}]),angular.module("ui.keypress",[]).factory("keypressHelper",["$parse",function($parse){var keysByCode={8:"backspace",9:"tab",13:"enter",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete"},capitaliseFirstLetter=function(string){return string.charAt(0).toUpperCase()+string.slice(1)};return function(mode,scope,elm,attrs){var params,combinations=[];params=scope.$eval(attrs["ui"+capitaliseFirstLetter(mode)]),angular.forEach(params,function(v,k){var combination,expression;expression=$parse(v),angular.forEach(k.split(" "),function(variation){combination={expression:expression,keys:{}},angular.forEach(variation.split("-"),function(value){combination.keys[value]=!0}),combinations.push(combination)})}),elm.bind(mode,function(event){var metaPressed=!(!event.metaKey||event.ctrlKey),altPressed=!!event.altKey,ctrlPressed=!!event.ctrlKey,shiftPressed=!!event.shiftKey,keyCode=event.keyCode;"keypress"===mode&&!shiftPressed&&keyCode>=97&&122>=keyCode&&(keyCode-=32),angular.forEach(combinations,function(combination){var mainKeyPressed=combination.keys[keysByCode[event.keyCode]]||combination.keys[event.keyCode.toString()],metaRequired=!!combination.keys.meta,altRequired=!!combination.keys.alt,ctrlRequired=!!combination.keys.ctrl,shiftRequired=!!combination.keys.shift;mainKeyPressed&&metaRequired===metaPressed&&altRequired===altPressed&&ctrlRequired===ctrlPressed&&shiftRequired===shiftPressed&&scope.$apply(function(){combination.expression(scope,{$event:event})})})})}}]),angular.module("ui.keypress").directive("uiKeydown",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keydown",scope,elm,attrs)}}}]),angular.module("ui.keypress").directive("uiKeypress",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keypress",scope,elm,attrs)}}}]),angular.module("ui.keypress").directive("uiKeyup",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keyup",scope,elm,attrs)}}}]),angular.module("ui.mask",[]).directive("uiMask",[function(){var maskDefinitions={9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/};return{priority:100,require:"ngModel",restrict:"A",link:function(scope,iElement,iAttrs,controller){function initialize(maskAttr){return angular.isDefined(maskAttr)?(processRawMask(maskAttr),maskProcessed?(initializeElement(),void bindEventListeners()):uninitialize()):uninitialize()}function formatter(fromModelValue){return maskProcessed?(value=unmaskValue(fromModelValue||""),isValid=validateValue(value),controller.$setValidity("mask",isValid),isValid&&value.length?maskValue(value):void 0):fromModelValue}function parser(fromViewValue){return maskProcessed?(value=unmaskValue(fromViewValue||""),isValid=validateValue(value),viewValue=value.length?maskValue(value):"",controller.$viewValue=viewValue,controller.$setValidity("mask",isValid),""===value&&void 0!==controller.$error.required&&controller.$setValidity("required",!1),isValid?value:void 0):fromViewValue}function uninitialize(){return maskProcessed=!1,unbindEventListeners(),angular.isDefined(originalPlaceholder)?iElement.attr("placeholder",originalPlaceholder):iElement.removeAttr("placeholder"),angular.isDefined(originalMaxlength)?iElement.attr("maxlength",originalMaxlength):iElement.removeAttr("maxlength"),iElement.val(controller.$modelValue),controller.$viewValue=controller.$modelValue,!1}function initializeElement(){value=oldValueUnmasked=unmaskValue(controller.$modelValue||""),valueMasked=oldValue=maskValue(value),isValid=validateValue(value),viewValue=isValid&&value.length?valueMasked:"",iAttrs.maxlength&&iElement.attr("maxlength",2*maskCaretMap[maskCaretMap.length-1]),iElement.attr("placeholder",maskPlaceholder),iElement.val(viewValue),controller.$viewValue=viewValue}function bindEventListeners(){return eventsBound?!0:(iElement.bind("blur",blurHandler),iElement.bind("mousedown mouseup",mouseDownUpHandler),iElement.bind("input keyup click",eventHandler),void(eventsBound=!0))}function unbindEventListeners(){return eventsBound?(iElement.unbind("blur",blurHandler),iElement.unbind("mousedown",mouseDownUpHandler),iElement.unbind("mouseup",mouseDownUpHandler),iElement.unbind("input",eventHandler),iElement.unbind("keyup",eventHandler),iElement.unbind("click",eventHandler),void(eventsBound=!1)):!0}function validateValue(value){return value.length?value.length>=minRequiredLength:!0}function unmaskValue(value){var valueUnmasked="",maskPatternsCopy=maskPatterns.slice();return value=value.toString(),angular.forEach(maskComponents,function(component){value=value.replace(component,"")}),angular.forEach(value.split(""),function(chr){maskPatternsCopy.length&&maskPatternsCopy[0].test(chr)&&(valueUnmasked+=chr,maskPatternsCopy.shift())}),valueUnmasked}function maskValue(unmaskedValue){var valueMasked="",maskCaretMapCopy=maskCaretMap.slice();return angular.forEach(maskPlaceholder.split(""),function(chr,i){unmaskedValue.length&&i===maskCaretMapCopy[0]?(valueMasked+=unmaskedValue.charAt(0)||"_",unmaskedValue=unmaskedValue.substr(1),maskCaretMapCopy.shift()):valueMasked+=chr}),valueMasked}function processRawMask(mask){var characterCount=0;if(maskCaretMap=[],maskPatterns=[],maskPlaceholder="","string"==typeof mask){minRequiredLength=0;var isOptional=!1;angular.forEach(mask.split(""),function(chr){maskDefinitions[chr]?(maskCaretMap.push(characterCount),maskPlaceholder+="_",maskPatterns.push(maskDefinitions[chr]),characterCount++,isOptional||minRequiredLength++):"?"===chr?isOptional=!0:(maskPlaceholder+=chr,characterCount++)})}maskCaretMap.push(maskCaretMap.slice().pop()+1),maskComponents=maskPlaceholder.replace(/[_]+/g,"_").replace(/([^_]+)([a-zA-Z0-9])([^_])/g,"$1$2_$3").split("_"),maskProcessed=maskCaretMap.length>1?!0:!1}function blurHandler(){oldCaretPosition=0,oldSelectionLength=0,isValid&&0!==value.length||(valueMasked="",iElement.val(""),scope.$apply(function(){controller.$setViewValue("")}))}function mouseDownUpHandler(e){"mousedown"===e.type?iElement.bind("mouseout",mouseoutHandler):iElement.unbind("mouseout",mouseoutHandler)}function mouseoutHandler(){oldSelectionLength=getSelectionLength(this),iElement.unbind("mouseout",mouseoutHandler)}function eventHandler(e){e=e||{};var eventWhich=e.which,eventType=e.type;if(16===eventWhich||91===eventWhich)return!0;var valMasked,val=iElement.val(),valOld=oldValue,valUnmasked=unmaskValue(val),valUnmaskedOld=oldValueUnmasked,valAltered=!1,caretPos=getCaretPosition(this)||0,caretPosOld=oldCaretPosition||0,caretPosDelta=caretPos-caretPosOld,caretPosMin=maskCaretMap[0],caretPosMax=maskCaretMap[valUnmasked.length]||maskCaretMap.slice().shift(),selectionLen=getSelectionLength(this),selectionLenOld=oldSelectionLength||0,isSelected=selectionLen>0,wasSelected=selectionLenOld>0,isAddition=val.length>valOld.length||selectionLenOld&&val.length>valOld.length-selectionLenOld,isDeletion=val.length<valOld.length||selectionLenOld&&val.length===valOld.length-selectionLenOld,isSelection=eventWhich>=37&&40>=eventWhich&&e.shiftKey,isKeyLeftArrow=37===eventWhich,isKeyBackspace=8===eventWhich||"keyup"!==eventType&&isDeletion&&-1===caretPosDelta,isKeyDelete=46===eventWhich||"keyup"!==eventType&&isDeletion&&0===caretPosDelta&&!wasSelected,caretBumpBack=(isKeyLeftArrow||isKeyBackspace||"click"===eventType)&&caretPos>caretPosMin;if(oldSelectionLength=selectionLen,isSelection||isSelected&&("click"===eventType||"keyup"===eventType))return!0;if("input"===eventType&&isDeletion&&!wasSelected&&valUnmasked===valUnmaskedOld){for(;isKeyBackspace&&caretPos>caretPosMin&&!isValidCaretPosition(caretPos);)caretPos--;for(;isKeyDelete&&caretPosMax>caretPos&&-1===maskCaretMap.indexOf(caretPos);)caretPos++;var charIndex=maskCaretMap.indexOf(caretPos);valUnmasked=valUnmasked.substring(0,charIndex)+valUnmasked.substring(charIndex+1),valAltered=!0}for(valMasked=maskValue(valUnmasked),oldValue=valMasked,oldValueUnmasked=valUnmasked,iElement.val(valMasked),valAltered&&scope.$apply(function(){controller.$setViewValue(valUnmasked)}),isAddition&&caretPosMin>=caretPos&&(caretPos=caretPosMin+1),caretBumpBack&&caretPos--,caretPos=caretPos>caretPosMax?caretPosMax:caretPosMin>caretPos?caretPosMin:caretPos;!isValidCaretPosition(caretPos)&&caretPos>caretPosMin&&caretPosMax>caretPos;)caretPos+=caretBumpBack?-1:1;(caretBumpBack&&caretPosMax>caretPos||isAddition&&!isValidCaretPosition(caretPosOld))&&caretPos++,oldCaretPosition=caretPos,setCaretPosition(this,caretPos)}function isValidCaretPosition(pos){return maskCaretMap.indexOf(pos)>-1}function getCaretPosition(input){if(void 0!==input.selectionStart)return input.selectionStart;if(document.selection){input.focus();var selection=document.selection.createRange();return selection.moveStart("character",-input.value.length),selection.text.length}}function setCaretPosition(input,pos){if(0===input.offsetWidth||0===input.offsetHeight)return!0;if(input.setSelectionRange)input.focus(),input.setSelectionRange(pos,pos);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}function getSelectionLength(input){return void 0!==input.selectionStart?input.selectionEnd-input.selectionStart:document.selection?document.selection.createRange().text.length:void 0}var maskCaretMap,maskPatterns,maskPlaceholder,maskComponents,minRequiredLength,value,valueMasked,isValid,oldValue,oldValueUnmasked,oldCaretPosition,oldSelectionLength,maskProcessed=!1,eventsBound=!1,originalPlaceholder=iAttrs.placeholder,originalMaxlength=iAttrs.maxlength;iAttrs.$observe("uiMask",initialize),controller.$formatters.push(formatter),controller.$parsers.push(parser),iElement.bind("mousedown mouseup",mouseDownUpHandler),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){"use strict";if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&1/0!==n&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);len>k;k++)if(k in t&&t[k]===searchElement)return k;return-1})}}}]),angular.module("ui.reset",[]).value("uiResetConfig",null).directive("uiReset",["uiResetConfig",function(uiResetConfig){var resetValue=null;return void 0!==uiResetConfig&&(resetValue=uiResetConfig),{require:"ngModel",link:function(scope,elm,attrs,ctrl){var aElement;aElement=angular.element('<a class="ui-reset" />'),elm.wrap('<span class="ui-resetwrap" />').after(aElement),aElement.bind("click",function(e){e.preventDefault(),scope.$apply(function(){ctrl.$setViewValue(attrs.uiReset?scope.$eval(attrs.uiReset):resetValue),ctrl.$render()})})}}}]),angular.module("ui.route",[]).directive("uiRoute",["$location","$parse",function($location,$parse){return{restrict:"AC",scope:!0,compile:function(tElement,tAttrs){var useProperty;if(tAttrs.uiRoute)useProperty="uiRoute";else if(tAttrs.ngHref)useProperty="ngHref";else{if(!tAttrs.href)throw new Error("uiRoute missing a route or href property on "+tElement[0]);useProperty="href"}return function($scope,elm,attrs){function staticWatcher(newVal){(hash=newVal.indexOf("#"))>-1&&(newVal=newVal.substr(hash+1)),(watcher=function(){modelSetter($scope,$location.path().indexOf(newVal)>-1)})()}function regexWatcher(newVal){(hash=newVal.indexOf("#"))>-1&&(newVal=newVal.substr(hash+1)),(watcher=function(){var regexp=new RegExp("^"+newVal+"$",["i"]);modelSetter($scope,regexp.test($location.path()))})()}var modelSetter=$parse(attrs.ngModel||attrs.routeModel||"$uiRoute").assign,watcher=angular.noop;switch(useProperty){case"uiRoute":attrs.uiRoute?regexWatcher(attrs.uiRoute):attrs.$observe("uiRoute",regexWatcher);break;case"ngHref":attrs.ngHref?staticWatcher(attrs.ngHref):attrs.$observe("ngHref",staticWatcher);break;case"href":staticWatcher(attrs.href)}$scope.$on("$routeChangeSuccess",function(){watcher()})}}}}]),angular.module("ui.scrollfix",[]).directive("uiScrollfix",["$window",function($window){"use strict";return{require:"^?uiScrollfixTarget",link:function(scope,elm,attrs,uiScrollfixTarget){var top=elm[0].offsetTop,$target=uiScrollfixTarget&&uiScrollfixTarget.$element||angular.element($window);attrs.uiScrollfix?"-"===attrs.uiScrollfix.charAt(0)?attrs.uiScrollfix=top-attrs.uiScrollfix.substr(1):"+"===attrs.uiScrollfix.charAt(0)&&(attrs.uiScrollfix=top+parseFloat(attrs.uiScrollfix.substr(1))):attrs.uiScrollfix=top,$target.bind("scroll.ui-scrollfix",function(){var offset;if(angular.isDefined($window.pageYOffset))offset=$window.pageYOffset;else{var iebody=document.compatMode&&"BackCompat"!==document.compatMode?document.documentElement:document.body;offset=iebody.scrollTop}!elm.hasClass("ui-scrollfix")&&offset>attrs.uiScrollfix?elm.addClass("ui-scrollfix"):elm.hasClass("ui-scrollfix")&&offset<attrs.uiScrollfix&&elm.removeClass("ui-scrollfix")})}}}]).directive("uiScrollfixTarget",[function(){"use strict";return{controller:function($element){this.$element=$element}}}]),angular.module("ui.showhide",[]).directive("uiShow",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiShow,function(newVal){newVal?elm.addClass("ui-show"):elm.removeClass("ui-show")})}}]).directive("uiHide",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiHide,function(newVal){newVal?elm.addClass("ui-hide"):elm.removeClass("ui-hide")})}}]).directive("uiToggle",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiToggle,function(newVal){newVal?elm.removeClass("ui-hide").addClass("ui-show"):elm.removeClass("ui-show").addClass("ui-hide")})}}]),angular.module("ui.unique",[]).filter("unique",["$parse",function($parse){return function(items,filterOn){if(filterOn===!1)return items;if((filterOn||angular.isUndefined(filterOn))&&angular.isArray(items)){var newItems=[],get=angular.isString(filterOn)?$parse(filterOn):function(item){return item},extractValueToCompare=function(item){return angular.isObject(item)?get(item):item};angular.forEach(items,function(item){for(var isDuplicate=!1,i=0;i<newItems.length;i++)if(angular.equals(extractValueToCompare(newItems[i]),extractValueToCompare(item))){isDuplicate=!0;break}isDuplicate||newItems.push(item)}),items=newItems}return items}}]),angular.module("ui.validate",[]).directive("uiValidate",function(){return{restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ctrl){var validateFn,watch,validators={},validateExpr=scope.$eval(attrs.uiValidate);validateExpr&&(angular.isString(validateExpr)&&(validateExpr={validator:validateExpr}),angular.forEach(validateExpr,function(exprssn,key){validateFn=function(valueToValidate){var expression=scope.$eval(exprssn,{$value:valueToValidate});return angular.isFunction(expression.then)?(expression.then(function(){ctrl.$setValidity(key,!0)},function(){ctrl.$setValidity(key,!1)}),valueToValidate):expression?(ctrl.$setValidity(key,!0),valueToValidate):void ctrl.$setValidity(key,!1)},validators[key]=validateFn,ctrl.$formatters.push(validateFn),ctrl.$parsers.push(validateFn)}),attrs.uiValidateWatch&&(watch=scope.$eval(attrs.uiValidateWatch),angular.isString(watch)?scope.$watch(watch,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue)})}):angular.forEach(watch,function(expression,key){scope.$watch(expression,function(){validators[key](ctrl.$modelValue)})})))}}}),angular.module("ui.utils",["ui.event","ui.format","ui.highlight","ui.indeterminate","ui.inflector","ui.jq","ui.keypress","ui.mask","ui.reset","ui.route","ui.scrollfix","ui.showhide","ui.unique","ui.validate"]),!function(e){"use strict";function t(e){var n;if(null===e||void 0===e)return!1;if(r.isArray(e))return e.length>0;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return!0;for(n in e)if(e.hasOwnProperty(n)&&t(e[n]))return!0;return!1}var n=function(){function e(e){this.options=e}return e.prototype.toString=function(){return JSON&&JSON.stringify?JSON.stringify(this.options):this.options},e}(),r=function(){function e(e){return"[object Array]"===Object.prototype.toString.apply(e)}function t(e){return"[object String]"===Object.prototype.toString.apply(e)}function n(e){return"[object Number]"===Object.prototype.toString.apply(e)}function r(e){return"[object Boolean]"===Object.prototype.toString.apply(e)}function i(e,t){var n,r="",i=!0;for(n=0;n<e.length;n+=1)i?i=!1:r+=t,r+=e[n];return r}function o(e,t){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}function s(e,t){for(var n=[],r=0;r<e.length;r+=1)t(e[r])&&n.push(e[r]);return n}function a(e){if("object"!=typeof e||null===e)return e;Object.freeze(e);var t,n;for(n in e)e.hasOwnProperty(n)&&(t=e[n],"object"==typeof t&&u(t));return e}function u(e){return"function"==typeof Object.freeze?a(e):e}return{isArray:e,isString:t,isNumber:n,isBoolean:r,join:i,map:o,filter:s,deepFreeze:u}}(),i=function(){function e(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e}function t(e){return e>="0"&&"9">=e}function n(e){return t(e)||e>="a"&&"f">=e||e>="A"&&"F">=e}return{isAlpha:e,isDigit:t,isHexDigit:n}}(),o=function(){function e(e){var t,n,r="",i=s.encode(e);for(n=0;n<i.length;n+=1)t=i.charCodeAt(n),r+="%"+(16>t?"0":"")+t.toString(16).toUpperCase();return r}function t(e,t){return"%"===e.charAt(t)&&i.isHexDigit(e.charAt(t+1))&&i.isHexDigit(e.charAt(t+2))}function n(e,t){return parseInt(e.substr(t,2),16)}function r(e){if(!t(e,0))return!1;var r=n(e,1),i=s.numBytes(r);if(0===i)return!1;for(var o=1;i>o;o+=1)if(!t(e,3*o)||!s.isValidFollowingCharCode(n(e,3*o+1)))return!1;return!0}function o(e,r){var i=e.charAt(r);if(!t(e,r))return i;var o=n(e,r+1),a=s.numBytes(o);if(0===a)return i;for(var u=1;a>u;u+=1)if(!t(e,r+3*u)||!s.isValidFollowingCharCode(n(e,r+3*u+1)))return i;return e.substr(r,3*a)}var s={encode:function(e){return unescape(encodeURIComponent(e))},numBytes:function(e){return 127>=e?1:e>=194&&223>=e?2:e>=224&&239>=e?3:e>=240&&244>=e?4:0},isValidFollowingCharCode:function(e){return e>=128&&191>=e}};return{encodeCharacter:e,isPctEncoded:r,pctCharAt:o}}(),s=function(){function e(e){return i.isAlpha(e)||i.isDigit(e)||"_"===e||o.isPctEncoded(e)}function t(e){return i.isAlpha(e)||i.isDigit(e)||"-"===e||"."===e||"_"===e||"~"===e}function n(e){return":"===e||"/"===e||"?"===e||"#"===e||"["===e||"]"===e||"@"===e||"!"===e||"$"===e||"&"===e||"("===e||")"===e||"*"===e||"+"===e||","===e||";"===e||"="===e||"'"===e}return{isVarchar:e,isUnreserved:t,isReserved:n}}(),a=function(){function e(e,t){var n,r="",i="";for(("number"==typeof e||"boolean"==typeof e)&&(e=e.toString()),n=0;n<e.length;n+=i.length)i=e.charAt(n),r+=s.isUnreserved(i)||t&&s.isReserved(i)?i:o.encodeCharacter(i);return r}function t(t){return e(t,!0)}function n(e,t){var n=o.pctCharAt(e,t);return n.length>1?n:s.isReserved(n)||s.isUnreserved(n)?n:o.encodeCharacter(n)}function r(e){var t,n="",r="";for(t=0;t<e.length;t+=r.length)r=o.pctCharAt(e,t),n+=r.length>1?r:s.isReserved(r)||s.isUnreserved(r)?r:o.encodeCharacter(r);return n}return{encode:e,encodePassReserved:t,encodeLiteral:r,encodeLiteralCharacter:n}}(),u=function(){function e(e){t[e]={symbol:e,separator:"?"===e?"&":""===e||"+"===e||"#"===e?",":e,named:";"===e||"&"===e||"?"===e,ifEmpty:"&"===e||"?"===e?"=":"",first:"+"===e?"":e,encode:"+"===e||"#"===e?a.encodePassReserved:a.encode,toString:function(){return this.symbol}}}var t={};return e(""),e("+"),e("#"),e("."),e("/"),e(";"),e("?"),e("&"),{valueOf:function(e){return t[e]?t[e]:"=,!@|".indexOf(e)>=0?null:t[""]}}}(),f=function(){function e(e){this.literal=a.encodeLiteral(e)}return e.prototype.expand=function(){return this.literal},e.prototype.toString=e.prototype.expand,e}(),p=function(){function e(e){function t(){var t=e.substring(h,f);if(0===t.length)throw new n({expressionText:e,message:"a varname must be specified",position:f});c={varname:t,exploded:!1,maxLength:null},h=null}function r(){if(d===f)throw new n({expressionText:e,message:"after a ':' you have to specify the length",position:f});c.maxLength=parseInt(e.substring(d,f),10),d=null}var a,f,p=[],c=null,h=null,d=null,g="";for(a=function(t){var r=u.valueOf(t);if(null===r)throw new n({expressionText:e,message:"illegal use of reserved operator",position:f,operator:t});return r}(e.charAt(0)),f=a.symbol.length,h=f;f<e.length;f+=g.length){if(g=o.pctCharAt(e,f),null!==h){if("."===g){if(h===f)throw new n({expressionText:e,message:"a varname MUST NOT start with a dot",position:f});continue}if(s.isVarchar(g))continue;t()}if(null!==d){if(f===d&&"0"===g)throw new n({expressionText:e,message:"A :prefix must not start with digit 0",position:f});if(i.isDigit(g)){if(f-d>=4)throw new n({expressionText:e,message:"A :prefix must have max 4 digits",position:f});continue}r()}if(":"!==g)if("*"!==g){if(","!==g)throw new n({expressionText:e,message:"illegal character",character:g,position:f});p.push(c),c=null,h=f+1}else{if(null===c)throw new n({expressionText:e,message:"exploded without varspec",position:f});if(c.exploded)throw new n({expressionText:e,message:"exploded twice",position:f});if(c.maxLength)throw new n({expressionText:e,message:"an explode (*) MUST NOT follow to a prefix",position:f});c.exploded=!0}else{if(null!==c.maxLength)throw new n({expressionText:e,message:"only one :maxLength is allowed per varspec",position:f});if(c.exploded)throw new n({expressionText:e,message:"an exploeded varspec MUST NOT be varspeced",position:f});d=f+1}}return null!==h&&t(),null!==d&&r(),p.push(c),new l(e,a,p)}function t(t){var r,i,o=[],s=null,a=0;for(r=0;r<t.length;r+=1)if(i=t.charAt(r),null===a){if(null===s)throw new Error("reached unreachable code");if("{"===i)throw new n({templateText:t,message:"brace already opened",position:r});if("}"===i){if(s+1===r)throw new n({templateText:t,message:"empty braces",position:s});try{o.push(e(t.substring(s+1,r)))}catch(u){if(u.prototype===n.prototype)throw new n({templateText:t,message:u.options.message,position:s+u.options.position,details:u.options});throw u}s=null,a=r+1}}else{if("}"===i)throw new n({templateText:t,message:"unopened brace closed",position:r});"{"===i&&(r>a&&o.push(new f(t.substring(a,r))),a=null,s=r)}if(null!==s)throw new n({templateText:t,message:"unclosed brace",position:s});return a<t.length&&o.push(new f(t.substr(a))),new c(t,o)}return t}(),l=function(){function e(e){return JSON&&JSON.stringify?JSON.stringify(e):e}function n(e){if(!t(e))return!0;if(r.isString(e))return""===e;if(r.isNumber(e)||r.isBoolean(e))return!1;if(r.isArray(e))return 0===e.length;for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}function i(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push({name:t,value:e[t]});return n}function o(e,t,n){this.templateText=e,this.operator=t,this.varspecs=n}function s(e,t,n){var r="";if(n=n.toString(),t.named){if(r+=a.encodeLiteral(e.varname),""===n)return r+=t.ifEmpty;r+="="}return null!==e.maxLength&&(n=n.substr(0,e.maxLength)),r+=t.encode(n)}function u(e){return t(e.value)}function f(e,o,s){var f=[],p="";if(o.named){if(p+=a.encodeLiteral(e.varname),n(s))return p+=o.ifEmpty;p+="="}return r.isArray(s)?(f=s,f=r.filter(f,t),f=r.map(f,o.encode),p+=r.join(f,",")):(f=i(s),f=r.filter(f,u),f=r.map(f,function(e){return o.encode(e.name)+","+o.encode(e.value)}),p+=r.join(f,",")),p}function p(e,o,s){var f=r.isArray(s),p=[];return f?(p=s,p=r.filter(p,t),p=r.map(p,function(t){var r=a.encodeLiteral(e.varname);return r+=n(t)?o.ifEmpty:"="+o.encode(t)})):(p=i(s),p=r.filter(p,u),p=r.map(p,function(e){var t=a.encodeLiteral(e.name);return t+=n(e.value)?o.ifEmpty:"="+o.encode(e.value)})),r.join(p,o.separator)}function l(e,n){var o=[],s="";return r.isArray(n)?(o=n,o=r.filter(o,t),o=r.map(o,e.encode),s+=r.join(o,e.separator)):(o=i(n),o=r.filter(o,function(e){return t(e.value)}),o=r.map(o,function(t){return e.encode(t.name)+"="+e.encode(t.value)}),s+=r.join(o,e.separator)),s}return o.prototype.toString=function(){return this.templateText},o.prototype.expand=function(i){var o,a,u,c,h=[],d=!1,g=this.operator;for(o=0;o<this.varspecs.length;o+=1)if(a=this.varspecs[o],u=i[a.varname],null!==u&&void 0!==u)if(a.exploded&&(d=!0),c=r.isArray(u),"string"==typeof u||"number"==typeof u||"boolean"==typeof u)h.push(s(a,g,u));else{if(a.maxLength&&t(u))throw new Error("Prefix modifiers are not applicable to variables that have composite values. You tried to expand "+this+" with "+e(u));a.exploded?t(u)&&h.push(g.named?p(a,g,u):l(g,u)):(g.named||!n(u))&&h.push(f(a,g,u))}return 0===h.length?"":g.first+r.join(h,g.separator)},o}(),c=function(){function e(e,t){this.templateText=e,this.expressions=t,r.deepFreeze(this)}return e.prototype.toString=function(){return this.templateText},e.prototype.expand=function(e){var t,n="";for(t=0;t<this.expressions.length;t+=1)n+=this.expressions[t].expand(e);return n},e.parse=p,e.UriTemplateError=n,e}();e(c)}(function(e){"use strict";"undefined"!=typeof module?module.exports=e:"function"==typeof define?define([],function(){return e}):"undefined"!=typeof window?window.UriTemplate=e:global.UriTemplate=e}),angular.module("BBAdmin.Directives").controller("CalController",function($scope){$scope.calendarConfig={height:450,editiable:!0,dayClick:function(){scope.$apply($scope.alertEventOnClick)}}}),function(){angular.module("BBAdmin.Controllers").controller("BBAdminCtrl",function($controller,$scope,$location,$rootScope,halClient,$window,$http,$localCache,$q,BasketService,LoginService,AlertService,$sce,$element,$compile,$sniffer,$modal,$timeout,BBModel,BBWidget,SSOService,ErrorService,AppConfig,BookingCollections,SlotCollections,$state,AdminLoginService,AdminBookingService,$sessionStorage,$log){return angular.extend(this,$controller("BBCtrl",{$scope:$scope,$location:$location,$rootScope:$rootScope,$window:$window,$http:$http,$localCache:$localCache,$q:$q,halClient:halClient,BasketService:BasketService,LoginService:LoginService,AlertService:AlertService,$sce:$sce,$element:$element,$compile:$compile,$sniffer:$sniffer,$modal:$modal,$timeout:$timeout,BBModel:BBModel,BBWidget:BBWidget,SSOService:SSOService,ErrorService:ErrorService,AppConfig:AppConfig,$sessionStorage:$sessionStorage})),$scope.loggedInDef=$q.defer(),$scope.logged_in=$scope.loggedInDef.promise,$scope.nativeDate=Modernizr.inputtypes.date&&Modernizr.touch,$rootScope.bb=$scope.bb,$scope.old_init=function(){return function(prms){var comp_id;
return comp_id=prms.company_id,comp_id?($scope.bb.company_id=comp_id,$scope.channel_name="private-company-"+$scope.bb.company_id):void 0}}(this),$scope.$on("newCheckout",function(){return function(event,total){return total.$has("admin_bookings")&&BookingCollections.count()>0&&total.$get("admin_bookings").then(function(bookings){var b,booking,_i,_len,_results;for(_results=[],_i=0,_len=bookings.length;_len>_i;_i++)booking=bookings[_i],b=new BBModel.Admin.Booking(booking),_results.push(BookingCollections.checkItems(b));return _results}),total.$has("admin_slots")&&SlotCollections.count()>0?total.$get("admin_slots").then(function(slots){var s,slot,_i,_len,_results;for(_results=[],_i=0,_len=slots.length;_len>_i;_i++)slot=slots[_i],s=new BBModel.Admin.Slot(slot),_results.push(SlotCollections.checkItems(s));return _results}):void 0}}(this)),$scope.$on("$stateChangeStart",function(event,toState){var company_id;if("login"!==toState.name){if(AdminLoginService.checkLogin(),!AdminLoginService.isLoggedIn())return $timeout(function(){return $state.go("login")});if(company_id=AdminLoginService.user().company_id,!$scope.init_widget_started)return $scope.initWidget({company_id:company_id})}}),$scope.pusherSubscribe=function(){return function(){var channelName,pusherEvent;return null!=$scope.bb.company&&"undefined"!=typeof Pusher&&null!==Pusher&&(null==$scope.pusher&&($scope.pusher=new Pusher("c8d8cea659cc46060608",{authEndpoint:"/api/v1/push/"+$scope.bb.company_id+"/pusher.json",auth:{headers:{"App-Id":"f6b16c23","App-Key":"f0bc4f65f4fbfe7b4b3b7264b655f5eb","Auth-Token":$sessionStorage.getItem("auth_token")}}})),channelName="private-c"+$scope.bb.company.id+"-w"+$scope.bb.company.numeric_widget_id,null==$scope.pusher.channel(channelName))?($scope.pusher_channel=$scope.pusher.subscribe(channelName),pusherEvent=function(res){return null!=res.id?setTimeout(function(){var prms;return prms={company_id:$scope.bb.company_id,id:res.id,url:$scope.bb.api_url},AdminBookingService.getBooking(prms).then(function(){})},2e3):void 0},$scope.pusher_channel.bind("booking",pusherEvent),$scope.pusher_channel.bind("cancellation",pusherEvent),$scope.pusher_channel.bind("updating",pusherEvent)):void 0}}(this),$rootScope.$on("company:setup",$scope.pusherSubscribe),$scope.$on("$idleStart",function(){return AdminLoginService.isLoggedIn()?($log.info("User is idle"),$scope.idleModal=$modal.open({template:'<div class="modal-body">\n  <p><div easypiechart options="options" percent="idle_percent" class="text-center"></p>\n  <p class="text-center">You will be automatically logged out after {{timeout_minutes}} minutes of inactivity</p>\n</div>',controller:function($scope,$modalInstance,idleStart,idleTimeout){var timeout;return $scope.options={lineWidth:20,barColor:"#000000",lineCap:"circle"},timeout=idleStart+idleTimeout,$scope.timeout_minutes=Math.floor(timeout/60),$scope.idle_percent=100-100*idleStart/timeout,$scope.$on("$idleWarn",function(e,countdown){var idle_time;return idle_time=timeout+idleStart-countdown,$scope.idle_percent=100-100*idle_time/timeout,$log.info("User has been idle for "+idle_time+" seconds")})}})):void 0}),$scope.$on("$idleTimeout",function(){return AdminLoginService.isLoggedIn()?($log.info("User session timeout"),$scope.idleModal&&$scope.idleModal.dismiss(),$timeout(function(){return $state.go("login")})):void 0}),$scope.$on("$keepalive",function(){return $scope.idleModal?$scope.idleModal.dismiss():void 0})})}.call(this),function(){"use strict";angular.module("BBAdmin.Controllers").controller("CalendarCtrl",function($scope,AdminBookingService){return $scope.eventsF=function(start,end,tz,callback){var bookings,prms;return console.log(start,end,callback),prms={company_id:21},prms.start_date=start.format("YYYY-MM-DD"),prms.end_date=end.format("YYYY-MM-DD"),bookings=AdminBookingService.query(prms),bookings.then(function(){return function(s){return console.log(s.items),callback(s.items),s.addCallback(function(booking){return $scope.myCalendar.fullCalendar("renderEvent",booking,!0)})}}(this))},$scope.dayClick=function(date,allDay,jsEvent,view){return $scope.$apply(function(){return function(){return console.log(date,allDay,jsEvent,view),$scope.alertMessage="Day Clicked "+date}}(this))},$scope.alertOnDrop=function(event,revertFunc){return $scope.$apply(function(){return function(){return $scope.popupTimeAction({action:"move",booking:event,newdate:event.start,onCancel:revertFunc})}}(this))},$scope.alertOnResize=function(){return $scope.$apply(function(){return function(){return $scope.alertMessage="Event Resized "}}(this))},$scope.addRemoveEventSource=function(sources,source){var canAdd;return canAdd=0,angular.forEach(sources,function(){return function(value,key){return sources[key]===source?(sources.splice(key,1),canAdd=1):void 0}}(this)),0===canAdd?sources.push(source):void 0},$scope.addEvent=function(){var m,y;return y="",m="",$scope.events.push({title:"Open Sesame",start:new Date(y,m,28),end:new Date(y,m,29),className:["openSesame"]})},$scope.remove=function(index){return $scope.events.splice(index,1)},$scope.changeView=function(view){return $scope.myCalendar.fullCalendar("changeView",view)},$scope.eventClick=function(event){return $scope.$apply(function(){return function(){return $scope.selectBooking(event)}}(this))},$scope.selectTime=function(start,end,allDay){return $scope.$apply(function(){return function(){return $scope.popupTimeAction({start_time:moment(start),end_time:moment(end),allDay:allDay}),$scope.myCalendar.fullCalendar("unselect")}}(this))},$scope.uiConfig={calendar:{height:450,editable:!0,header:{left:"month agendaWeek agendaDay",center:"title",right:"today prev,next"},dayClick:$scope.dayClick,eventClick:$scope.eventClick,eventDrop:$scope.alertOnDrop,eventResize:$scope.alertOnResize,selectable:!0,selectHelper:!0,select:$scope.selectTime}},$scope.eventSources=[$scope.eventsF]})}.call(this),function(){angular.module("BBAdmin.Controllers").controller("CategoryList",function($scope,$location,CategoryService,$rootScope){return $rootScope.connection_started.then(function(){return function(){return $scope.categories=CategoryService.query($scope.bb.company),$scope.categories.then(function(){})}}(this)),$scope.$watch("selectedCategory",function(){return function(newValue){var items;return $rootScope.category=newValue,items=$(".inline_time").each(function(idx,e){return angular.element(e).scope().clear()})}}(this)),$scope.$on("Refresh_Cat",function(){return function(){return $scope.$apply()}}(this))})}.call(this),function(){angular.module("BBAdmin.Controllers").controller("CompanyList",function($scope,$rootScope){return $scope.selectedCategory=null,$rootScope.connection_started.then(function(){return function(){var d,date,end,_results;for(date=moment(),$scope.current_date=date,$scope.companies=$scope.bb.company.companies,$scope.companies&&0!==$scope.companies.length||($scope.companies=[$scope.bb.company]),$scope.dates=[],end=moment(date).add(21,"days"),$scope.end_date=end,d=moment(date),_results=[];d.isBefore(end);)$scope.dates.push(d.clone()),_results.push(d.add(1,"days"));return _results}}(this)),$scope.selectCompany=function(item){return window.location="/view/dashboard/pick_company/"+item.id},$scope.advance_date=function(num){var d,date,_results;for(date=$scope.current_date.add(num,"days"),$scope.end_date=moment(date).add(21,"days"),$scope.current_date=moment(date),$scope.dates=[],d=date.clone(),_results=[];d.isBefore($scope.end_date);)$scope.dates.push(d.clone()),_results.push(d.add(1,"days"));return _results},$scope.$on("Refresh_Comp",function(){return $scope.$apply()})})}.call(this),function(){angular.module("BBAdmin.Controllers").controller("DashboardContainer",function($scope,$rootScope,$location,$modal){var ModalInstanceCtrl;return $scope.selectedBooking=null,$scope.poppedBooking=null,$scope.selectBooking=function(booking){return $scope.selectedBooking=booking},$scope.popupBooking=function(booking){var modalInstance;return $scope.poppedBooking=booking,modalInstance=$modal.open({templateUrl:"full_booking_details",controller:ModalInstanceCtrl,scope:$scope,backdrop:!0,resolve:{items:function(){return function(){return{booking:booking}}}(this)}}),modalInstance.result.then(function(){return function(selectedItem){return $scope.selected=selectedItem}}(this),function(){return function(){return console.log("Modal dismissed at: "+new Date)}}(this))},ModalInstanceCtrl=function($scope,$modalInstance,items){return angular.extend($scope,items),$scope.ok=function(){return console.log("closeing",items,items.booking&&items.booking.self?items.booking.$update():void 0),$modalInstance.close()},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},$scope.popupTimeAction=function(prms){var modalInstance;return console.log(prms),modalInstance=$modal.open({templateUrl:$scope.partial_url+"time_popup",controller:ModalInstanceCtrl,scope:$scope,backdrop:!1,resolve:{items:function(){return function(){return prms}}(this)}})}})}.call(this),function(){"use strict";angular.module("BBAdmin.Controllers").controller("DashDayList",function($scope,$rootScope,$q,AdminDayService){return $scope.init=function(){return function(company_id){var date,dayListDef,prms,weekListDef;return $scope.inline_items="",company_id&&($scope.bb.company_id=company_id),$scope.current_date||($scope.current_date=moment().startOf("month")),date=$scope.current_date,prms={date:date.format("DD-MM-YYYY"),company_id:$scope.bb.company_id},$scope.service_id&&(prms.service_id=$scope.service_id),$scope.end_date&&(prms.edate=$scope.end_date.format("DD-MM-YYYY")),dayListDef=$q.defer(),weekListDef=$q.defer(),$scope.dayList=dayListDef.promise,$scope.weeks=weekListDef.promise,prms.url=$scope.bb.api_url,AdminDayService.query(prms).then(function(days){return $scope.sdays=days,dayListDef.resolve(),$scope.category?$scope.update_days():void 0})}}(this),$scope.format_date=function(){return function(fmt){return $scope.current_date.format(fmt)}}(this),$scope.selectDay=function(){return function(day,dayBlock,e){var elm,seldate,xelm;return 0===day.spaces?!1:(seldate=moment($scope.current_date),seldate.date(day.day),$scope.selected_date=seldate,elm=angular.element(e.toElement),elm.parent().children().removeClass("selected"),elm.addClass("selected"),xelm=$("#tl_"+$scope.bb.company_id),$scope.service_id=dayBlock.service_id,$scope.service={id:dayBlock.service_id,name:dayBlock.name},$scope.selected_day=day,0===xelm.length?$scope.inline_items="/view/dash/time_small":xelm.scope().init(day))}}(this),$scope.$watch("current_date",function(){return function(newValue){return newValue&&$scope.bb.company_id?$scope.init():void 0}}(this)),$scope.update_days=function(){return function(){var day,_i,_len,_ref,_results;for($scope.dayList=[],$scope.service_id=null,_ref=$scope.sdays,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)day=_ref[_i],day.category_id===$scope.category.id?($scope.dayList.push(day),_results.push($scope.service_id=day.id)):_results.push(void 0);return _results}}(this),$rootScope.$watch("category",function(){return function(newValue){return newValue&&$scope.sdays?$scope.update_days():void 0}}(this))})}.call(this),function(){angular.module("BBAdmin.Controllers").controller("EditBookingDetails",function(){})}.call(this),function(){angular.module("BBAdmin").directive("bbAdminLogin",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"AdminLogin",templateUrl:"login.html"}}),angular.module("BBAdmin").controller("AdminLogin",function($scope,$rootScope,AdminLoginService,$q,$sessionStorage){return $scope.host=$sessionStorage.getItem("host"),$scope.login_sso=function(){return function(token){return $rootScope.connection_started.then(function(){return AdminLoginService.ssoLogin({company_id:$scope.bb.company.id,root:$scope.bb.api_url},{token:token}).then(function(user){return $scope.loggedInDef.resolve(user)})})}}(this),$scope.login_with_password=function(){return function(email,password){return $rootScope.connection_started.then(function(){return AdminLoginService.login({email:email,password:password,company_id:$scope.bb.company.id},{}).then(function(user){return $scope.loggedInDef.resolve(user),$scope.user=user})})}}(this),$scope.login=function(){return function(){return $rootScope.bb||($rootScope.bb={}),$scope.host&&($rootScope.bb.api_url=$scope.host,$sessionStorage.setItem("host",$scope.host)),AdminLoginService.login({email:$scope.email,password:$scope.password},{}).then(function(user){return $scope.user=user,user.$has("administrators")?user.$get("administrators").then(function(admins){return $scope.administrators=admins}):void 0})}}(this),$scope.pickAdmin=function(){return function(admin){return LoginService.setLogin(admin)}}(this)})}.call(this),function(){angular.module("BBAdmin.Controllers").controller("SelectedBookingDetails",function($scope){return $scope.$watch("selectedBooking",function(){return function(newValue){return newValue?($scope.booking=newValue,$scope.showItemView="/view/dash/booking_details"):void 0}}(this))})}.call(this),SpaceMonitorCtrl.$inject=["$scope","$location","CompanyService"],function(){"use strict";angular.module("BBAdmin.Controllers").controller("DashTimeList",function($scope,$rootScope,$location,$q,$element,AdminTimeService){var $loaded;return $loaded=null,$scope.init=function(){return function(day){var elem,prms,timeListDef;return $scope.selected_day=day,elem=angular.element($element),elem.attr("id","tl_"+$scope.bb.company_id),angular.element($element).show(),prms={company_id:$scope.bb.company_id,day:day},$scope.service_id&&(prms.service_id=$scope.service_id),timeListDef=$q.defer(),$scope.slots=timeListDef.promise,prms.url=$scope.bb.api_url,$scope.aslots=AdminTimeService.query(prms),$scope.aslots.then(function(res){var k,slot,slots,x,xres,_i,_len;for($scope.loaded=!0,slots={},_i=0,_len=res.length;_len>_i;_i++)x=res[_i],slots[x.time]||(slots[x.time]=x);xres=[];for(k in slots)slot=slots[k],xres.push(slot);return timeListDef.resolve(xres)})}}(this),$scope.selected_day&&$scope.init($scope.selected_day),$scope.format_date=function(){return function(fmt){return $scope.selected_date.format(fmt)}}(this),$scope.selectSlot=function(){return function(slot,route){return $scope.pickTime(slot.time),$scope.pickDate($scope.selected_date),$location.path(route)}}(this),$scope.highlighSlot=function(){return function(slot){return $scope.pickTime(slot.time),$scope.pickDate($scope.selected_date),$scope.setCheckout(!0)}}(this),$scope.clear=function(){return function(){return $scope.loaded=!1,$scope.slots=null,angular.element($element).hide()}}(this),$scope.popupCheckout=function(){return function(slot){var dHeight,dWidth,dlg,item,k,src,url,v,wHeight,wWidth;item={time:slot.time,date:$scope.selected_day.date,company_id:$scope.bb.company_id,duration:30,service_id:$scope.service_id,event_id:slot.id},url="/booking/new_checkout?";for(k in item)v=item[k],url+=k+"="+v+"&";return wWidth=$(window).width(),dWidth=.8*wWidth,wHeight=$(window).height(),dHeight=.8*wHeight,dlg=$("#dialog-modal"),src=dlg.html("<iframe frameborder=0 id='mod_dlg' onload='nowait();setTimeout(set_iframe_focus, 100);' width=100% height=99% src='"+url+"'></iframe>"),dlg.attr("title","Checkout"),dlg.dialog({my:"top",at:"top",height:dHeight,width:dWidth,modal:!0,overlay:{opacity:.1,background:"black"}})}}(this)})}.call(this),function(){angular.module("BBAdmin.Controllers").controller("TimeOptions",function($scope,$location,$rootScope,AdminResourceService,AdminPersonService){return AdminResourceService.query({company:$scope.bb.company}).then(function(resources){return $scope.resources=resources}),AdminPersonService.query({company:$scope.bb.company}).then(function(people){return $scope.people=people}),$scope.block=function(){return $scope.person&&AdminPersonService.block($scope.bb.company,$scope.person,{start_time:$scope.start_time,end_time:$scope.end_time}),$scope.ok()}})}.call(this),function(){"use strict";var bbAdminFilters;bbAdminFilters=angular.module("BBAdmin.Filters",[]),bbAdminFilters.filter("rag",function(){return function(value,v1,v2){return v1>=value?"red":v2>=value?"amber":"green"}}),bbAdminFilters.filter("gar",function(){return function(value,v1,v2){return v1>=value?"green":v2>=value?"amber":"red"}}),bbAdminFilters.filter("time",function($window){return function(v){return $window.sprintf("%02d:%02d",Math.floor(v/60),v%60)}})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Admin.BookingModel",function($q,BBModel,BaseModel){var Admin_Booking;return Admin_Booking=function(_super){function Admin_Booking(){Admin_Booking.__super__.constructor.apply(this,arguments),this.datetime=moment(this.datetime),this.start=this.datetime,this.end=this.datetime.clone().add(this.duration,"minutes"),this.title=this.full_describe,this.time=60*this.start.hour()+this.start.minute(),this.allDay=!1,3===this.status?this.className="status_blocked":4===this.status&&(this.className="status_booked")}return __extends(Admin_Booking,_super),Admin_Booking.prototype.getPostData=function(){var data,q;return data={},data.date=this.start.format("YYYY-MM-DD"),data.time=60*this.start.hour()+this.start.minute(),data.duration=this.duration,data.id=this.id,data.questions=function(){var _i,_len,_ref,_results;for(_ref=this.questions,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)q=_ref[_i],_results.push(q.getPostData());return _results}.call(this),data},Admin_Booking.prototype.hasStatus=function(status){return null!=this.multi_status[status]},Admin_Booking.prototype.statusTime=function(status){return this.multi_status[status]?moment(this.multi_status[status]):null},Admin_Booking.prototype.sinceStatus=function(status){var s;return s=this.statusTime(status),s?Math.floor((moment().unix()-s.unix())/60):0},Admin_Booking.prototype.sinceStart=function(options){var s,start;return start=this.datetime.unix(),Math.floor(options?options.later&&(s=this.statusTime(options.later).unix(),s>start)?(moment().unix()-s)/60:options.earlier&&(s=this.statusTime(options.earlier).unix(),start>s)?(moment().unix()-s)/60:(moment().unix()-start)/60:(moment().unix()-start)/60)},Admin_Booking.prototype.$update=function(){var data;return data=this.getPostData(),this.$put("self",{},data).then(function(_this){return function(res){return _this.constructor(res)}}(this))},Admin_Booking}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Admin.SlotModel",function($q,BBModel,BaseModel,TimeSlotModel){var Admin_Slot;return Admin_Slot=function(_super){function Admin_Slot(data){Admin_Slot.__super__.constructor.call(this,data),this.title=this.full_describe,0===this.status&&(this.title="Available"),this.datetime=moment(this.datetime),this.start=this.datetime,this.end=this.datetime.clone().add(this.duration,"minutes"),this.time=60*this.start.hour()+this.start.minute(),this.allDay=!1,3===this.status?this.className="status_blocked":4===this.status?this.className="status_booked":0===this.status&&(this.className="status_available")}return __extends(Admin_Slot,_super),Admin_Slot}(TimeSlotModel)})}.call(this),function(){angular.module("BBAdmin.Services").factory("AdminBookingService",function($q,$window,halClient,BookingCollections,BBModel){return{query:function(prms){var deferred,existing,href,uri,url;return prms.slot&&(prms.slot_id=prms.slot.id),prms.date&&(prms.start_date=prms.date,prms.end_date=prms.date),null==prms.per_page&&(prms.per_page=1024),null==prms.include_cancelled&&(prms.include_cancelled=!1),deferred=$q.defer(),existing=BookingCollections.find(prms),existing?deferred.resolve(existing):(url="",prms.url&&(url=prms.url),href=url+"/api/v1/admin/{company_id}/bookings{?slot_id,start_date,end_date,service_id,resource_id,person_id,page,per_page,include_cancelled}",uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$get(uri,{}).then(function(){return function(found){return found.$get("bookings").then(function(items){var item,sitems,spaces,_i,_len;for(sitems=[],_i=0,_len=items.length;_len>_i;_i++)item=items[_i],sitems.push(new BBModel.Admin.Booking(item));return spaces=new $window.Collection.Booking(found,sitems,prms),BookingCollections.add(spaces),deferred.resolve(spaces)})}}(this),function(){return function(err){return deferred.reject(err)}}(this))),deferred.promise},getBooking:function(prms){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/admin/{company_id}/bookings/{id}{?embed}",uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$get(uri,{no_cache:!0}).then(function(item){var booking;return booking=new BBModel.Admin.Booking(item),BookingCollections.checkItems(booking),deferred.resolve(booking)},function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},cancelBooking:function(prms,booking){var deferred,href,notify,uri;return deferred=$q.defer(),href="/api/v1/admin/{company_id}/bookings/{id}?notify={notify}",null==prms.id&&(prms.id=booking.id),notify=prms.notify,null==notify&&(notify=!0),uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$del(uri,{notify:notify}).then(function(item){return booking=new BBModel.Admin.Booking(item),BookingCollections.checkItems(booking),deferred.resolve(booking)},function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},updateBooking:function(prms,booking){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/admin/{company_id}/bookings/{id}",null==prms.id&&(prms.id=booking.id),uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$put(uri,{},prms).then(function(item){return booking=new BBModel.Admin.Booking(item),BookingCollections.checkItems(booking),deferred.resolve(booking)},function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},blockTimeForPerson:function(prms,person){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/admin/{company_id}/people/{person_id}/block",null==prms.person_id&&(prms.person_id=person.id),prms.booking=!0,uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$put(uri,{},prms).then(function(item){var booking;return booking=new BBModel.Admin.Booking(item),BookingCollections.checkItems(booking),deferred.resolve(booking)},function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},addStatusToBooking:function(prms,booking,status){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/admin/{company_id}/bookings/{booking_id}/multi_status",null==prms.booking_id&&(prms.booking_id=booking.id),uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$put(uri,{},{status:status}).then(function(item){return booking=new BBModel.Admin.Booking(item),BookingCollections.checkItems(booking),deferred.resolve(booking)},function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},addPrivateNoteToBooking:function(prms,booking,note){var deferred,href,noteParam,uri;return deferred=$q.defer(),href="/api/v1/admin/{company_id}/bookings/{booking_id}/private_notes",null==prms.booking_id&&(prms.booking_id=booking.id),null!=note.note&&(noteParam=note.note),null==noteParam&&(noteParam=note),uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$put(uri,{},{note:noteParam}).then(function(item){return booking=new BBModel.Admin.Booking(item),BookingCollections.checkItems(booking),deferred.resolve(booking)},function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},updatePrivateNoteForBooking:function(prms,booking,note){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/admin/{company_id}/bookings/{booking_id}/private_notes/{id}",null==prms.booking_id&&(prms.booking_id=booking.id),null==prms.id&&(prms.id=note.id),uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$put(uri,{},{note:note.note}).then(function(item){return booking=new BBModel.Admin.Booking(item),BookingCollections.checkItems(booking),deferred.resolve(booking)},function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},deletePrivateNoteFromBooking:function(prms,booking,note){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/admin/{company_id}/bookings/{booking_id}/private_notes/{id}",null==prms.booking_id&&(prms.booking_id=booking.id),null==prms.id&&(prms.id=note.id),uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$del(uri,{}).then(function(item){return booking=new BBModel.Admin.Booking(item),BookingCollections.checkItems(booking),deferred.resolve(booking)},function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BBAdmin.Services").factory("AdminCompanyService",function($q,BBModel,AdminLoginService,$rootScope,$sessionStorage){return{query:function(params){var defer,login_form,options,_base,_base1;return defer=$q.defer(),$rootScope.bb||($rootScope.bb={}),$rootScope.bb.api_url=$sessionStorage.getItem("host"),(_base=$rootScope.bb).api_url||(_base.api_url=params.apiUrl),(_base1=$rootScope.bb).api_url||(_base1.api_url="http://www.bookingbug.com"),AdminLoginService.checkLogin(),$rootScope.user&&$rootScope.user.company_id?($rootScope.bb||($rootScope.bb={}),$rootScope.bb.company_id=$rootScope.user.company_id,$rootScope.user.$get("company").then(function(company){return defer.resolve(company)},function(err){return defer.reject(err)})):(login_form={email:params.adminEmail,password:params.adminPassword},options={company_id:params.companyId},AdminLoginService.login(login_form,options).then(function(user){return user.$get("company").then(function(company){return defer.resolve(company)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)})),defer.promise}}})}.call(this),function(){angular.module("BBAdmin.Services").factory("AdminDayService",function($q,$window,halClient,BBModel){return{query:function(prms){var deferred,href,uri,url;return url="",prms.url&&(url=prms.url),href=url+"/api/v1/{company_id}/day_data{?month,week,date,edate,event_id,service_id}",uri=new $window.UriTemplate.parse(href).expand(prms||{}),deferred=$q.defer(),halClient.$get(uri,{}).then(function(){return function(found){var item,mdays,_i,_len,_ref;if(found.items){for(mdays=[],_ref=found.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],halClient.$get(item.uri).then(function(data){var days,dcol,i,_j,_len1,_ref1;for(days=[],_ref1=data.days,_j=0,_len1=_ref1.length;_len1>_j;_j++)i=_ref1[_j],i.type===prms.item&&days.push(new BBModel.Day(i));return dcol=new $window.Collection.Day(data,days,{}),mdays.push(dcol)});return deferred.resolve(mdays)}}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BBAdmin.Services").factory("AdminLoginService",function($q,halClient,$rootScope,BBModel,$sessionStorage){return{login:function(form,options){var deferred,url;return deferred=$q.defer(),url=""+$rootScope.bb.api_url+"/api/v1/login/admin",null!=options&&null!=options.company_id&&(url=""+url+"/"+options.company_id),halClient.$post(url,options,form).then(function(_this){return function(login){var login_model;return login.$has("administrator")?login.$get("administrator").then(function(user){return user=_this.setLogin(user),deferred.resolve(user)}):login.$has("administrators")?(login_model=new BBModel.Admin.Login(login),deferred.resolve(login_model)):deferred.reject("No admin account for login")}}(this),function(){return function(err){var login,login_model;return 400===err.status?(login=halClient.$parse(err.data),login.$has("administrators")?(login_model=new BBModel.Admin.Login(login),deferred.resolve(login_model)):deferred.reject(err)):deferred.reject(err)}}(this)),deferred.promise},ssoLogin:function(options,data){var deferred,url;return deferred=$q.defer(),url=$rootScope.bb.api_url+"/api/v1/login/sso/"+options.company_id,halClient.$post(url,{},data).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("user").then(function(user){return user=_this.setLogin(user),deferred.resolve(user)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},isLoggedIn:function(){return this.checkLogin(),$rootScope.user?!0:!1},setLogin:function(user){var auth_token;return auth_token=user.getOption("auth_token"),user=new BBModel.Admin.User(user),$sessionStorage.setItem("user",user.$toStore()),$sessionStorage.setItem("auth_token",auth_token),$rootScope.user=user,user},user:function(){return this.checkLogin(),$rootScope.user},checkLogin:function(){var user;if(!$rootScope.user)return user=$sessionStorage.getItem("user"),user?$rootScope.user=halClient.createResource(user):void 0},logout:function(){return $rootScope.user=null,$sessionStorage.removeItem("user"),$sessionStorage.removeItem("auth_token")},getLogin:function(options){var defer,url;return defer=$q.defer(),url=""+$rootScope.bb.api_url+"/api/v1/login/admin/"+options.company_id,halClient.$get(url,options).then(function(_this){return function(login){return login.$has("administrator")?login.$get("administrator").then(function(user){return user=_this.setLogin(user),defer.resolve(user)},function(err){return defer.reject(err)}):defer.reject()}}(this),function(err){return defer.reject(err)}),defer.promise}}})}.call(this),function(){angular.module("BBAdmin.Services").factory("AdminSlotService",function($q,$window,halClient,SlotCollections,BBModel){return{query:function(prms){var deferred,existing,href,uri,url;return deferred=$q.defer(),existing=SlotCollections.find(prms),existing?deferred.resolve(existing):prms.user?prms.user.$get("company").then(function(company){return company.$get("slots",prms).then(function(slots_collection){return slots_collection.$get("slots").then(function(slots){var s,slot_models;return slot_models=function(){var _i,_len,_results;for(_results=[],_i=0,_len=slots.length;_len>_i;_i++)s=slots[_i],_results.push(new BBModel.Admin.Slot(s));return _results}(),deferred.resolve(slot_models)},function(err){return deferred.reject(err)})})}):(url="",prms.url&&(url=prms.url),href=url+"/api/v1/admin/{company_id}/slots{?start_date,end_date,date,service_id,resource_id,person_id,page,per_page}",uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$get(uri,{}).then(function(){return function(found){return found.$get("slots").then(function(items){var item,sitems,slots,_i,_len;for(sitems=[],_i=0,_len=items.length;_len>_i;_i++)item=items[_i],sitems.push(new BBModel.Admin.Slot(item));return slots=new $window.Collection.Slot(found,sitems,prms),SlotCollections.add(slots),deferred.resolve(slots)})}}(this),function(){return function(err){return deferred.reject(err)}}(this))),deferred.promise},create:function(prms,data){var deferred,href,uri,url;return url="",prms.url&&(url=prms.url),href=url+"/api/v1/admin/{company_id}/slots",uri=new $window.UriTemplate.parse(href).expand(prms||{}),deferred=$q.defer(),halClient.$post(uri,{},data).then(function(){return function(slot){return slot=new BBModel.Admin.Slot(slot),SlotCollections.checkItems(slot),deferred.resolve(slot)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},"delete":function(item){var deferred;return deferred=$q.defer(),item.$del("self").then(function(){return function(slot){return slot=new BBModel.Admin.Slot(slot),SlotCollections.deleteItems(slot),deferred.resolve(slot)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise
},update:function(item,data){var deferred;return deferred=$q.defer(),item.$put("self",{},data).then(function(){return function(slot){return slot=new BBModel.Admin.Slot(slot),SlotCollections.checkItems(slot),deferred.resolve(slot)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BBAdmin.Services").factory("AdminTimeService",function($q,$window,halClient,BBModel){return{query:function(prms){var deferred,href,uri,url;return prms.day&&(prms.date=prms.day.date),!prms.edate&&prms.date&&(prms.edate=prms.date),url="",prms.url&&(url=prms.url),href=url+"/api/v1/{company_id}/time_data{?date,event_id,service_id,person_id}",uri=new $window.UriTemplate.parse(href).expand(prms||{}),deferred=$q.defer(),halClient.$get(uri,{no_cache:!1}).then(function(){return function(found){return found.$get("events").then(function(events){var event,eventItem,eventItems,time,ts,_i,_j,_len,_len1,_ref;for(eventItems=[],_i=0,_len=events.length;_len>_i;_i++){for(eventItem=events[_i],event={},event.times=[],event.event_id=eventItem.event_id,event.person_id=found.person_id,_ref=eventItem.times,_j=0,_len1=_ref.length;_len1>_j;_j++)time=_ref[_j],ts=new BBModel.TimeSlot(time),event.times.push(ts);eventItems.push(event)}return deferred.resolve(eventItems)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BBAdminServices").directive("personTable",function(AdminCompanyService,AdminPersonService,$modal,$log,ModalForm){var controller,link;return controller=function($scope){return $scope.getPeople=function(){var params;return params={company:$scope.company},AdminPersonService.query(params).then(function(people){return $scope.people_models=people,$scope.people=_.map(people,function(person){return _.pick(person,"id","name","mobile")})})},$scope.newPerson=function(){return ModalForm["new"]({company:$scope.company,title:"New Person",new_rel:"new_person",post_rel:"people",success:function(person){return $scope.people.push(person)}})},$scope["delete"]=function(id){var person;return person=_.find($scope.people_models,function(p){return p.id===id}),person.$del("self").then(function(){return $scope.people=_.reject($scope.people,function(p){return p.id===id})},function(){return $log.error("Failed to delete person")})},$scope.edit=function(id){var person;return person=_.find($scope.people_models,function(p){return p.id===id}),ModalForm.edit({model:person,title:"Edit Person"})}},link=function(scope,element,attrs){return scope.company?scope.getPeople():AdminCompanyService.query(attrs).then(function(company){return scope.company=company,scope.getPeople()})},{controller:controller,link:link,templateUrl:"person_table_main.html"}})}.call(this),function(){angular.module("BBAdminServices").directive("resourceTable",function(AdminCompanyService,AdminResourceService,$modal,$log,ModalForm){var controller,link;return controller=function($scope){return $scope.getResources=function(){var params;return params={company:$scope.company},AdminResourceService.query(params).then(function(resources){return $scope.resources_models=resources,$scope.resources=_.map(resources,function(resource){return _.pick(resource,"id","name","mobile")})})},$scope.newResource=function(){return ModalForm["new"]({company:$scope.company,title:"New Resource",new_rel:"new_resource",post_rel:"resources",success:function(resource){return $scope.resources.push(resource)}})},$scope["delete"]=function(id){var resource;return resource=_.find($scope.resources_models,function(p){return p.id===id}),resource.$del("self").then(function(){return $scope.resources=_.reject($scope.resources,function(p){return p.id===id})},function(){return $log.error("Failed to delete resource")})},$scope.edit=function(id){var resource;return resource=_.find($scope.resources_models,function(p){return p.id===id}),ModalForm.edit({model:resource,title:"Edit Resource"})}},link=function(scope,element,attrs){return scope.company?scope.getResources():AdminCompanyService.query(attrs).then(function(company){return scope.company=company,scope.getResources()})},{controller:controller,link:link,templateUrl:"resource_table_main.html"}})}.call(this),function(){angular.module("BBAdminServices").directive("scheduleEdit",function($window,$document){var controller,hourRange,link;return hourRange=function(start_hour){var end,start;return start=100*start_hour,end=100*start_hour+100,""+sprintf("%04s",start)+"-"+sprintf("%04s",end)},controller=function($scope){var x;return $scope.dates=[0,1,2,3,4,5,6],$scope.hours=function(){var _i,_results;for(_results=[],x=_i=0;23>=_i;x=++_i)_results.push(hourRange(x));return _results}(),$scope.hoursDone=!1,$scope.datesDone=!1,$scope.lastHour=function(){return $scope.hoursDone=!0},$scope.lastDate=function(){return $scope.hoursDone?$scope.datesDone=!0:void 0}},link=function(scope,element,attrs,ngModel){var cellsBetween,cls,dragging,getCoords,mode,mouseDown,mouseEnter,mouseUp,selectedIds,setEndCell,setStartCell,sortSelectedCells,startCell,updateModel,updateTableElements,wrap;return selectedIds={},cls="eng-selected-item",startCell=null,dragging=!1,mode="add",ngModel.$render=function(){var ids;return ids=_.flatten(_.map(ngModel.$viewValue,function(hours,date){return _.map(_.range(parseInt(hours.split("-")[0])/100,parseInt(hours.split("-")[1])/100),function(hour){return""+date+"|"+hourRange(hour)})})),scope.datesDone?updateTableElements(ids):scope.$watch("datesDone",function(){return updateTableElements(ids)})},updateTableElements=function(ids){var td,_i,_len,_ref,_results;for(_ref=element.find("td"),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)td=_ref[_i],_.indexOf(ids,td.id)>-1&&_results.push(angular.element(td).addClass(cls));return _results},updateModel=function(ids){return ngModel.$setViewValue(_.reduce(ids,function(memo,id){var date,end,hours,hours_end,hours_start,memo_end,memo_start,start;return date=id.split("|")[0],hours=id.split("|")[1],memo[date]?(memo_start=parseInt(memo[date].slice(0,2)),memo_end=parseInt(memo[date].slice(5,7)),hours_start=parseInt(hours.slice(0,2)),hours_end=parseInt(hours.slice(5,7)),start=memo_start>hours_start?hours.split("-")[0]:memo[date].split("-")[0],end=hours_end>memo_end?hours.split("-")[1]:memo[date].split("-")[1],memo[date]=""+start+"-"+end):memo[date]=hours,memo},{}))},sortSelectedCells=function(ids){return ids=_.toArray(ids),ids.sort(function(id1,id2){var a,b;return a={},b={},a.date=parseInt(id1.split("|")[0]),a.hours=parseInt(id1.split("|")[1].slice(0,2)),b.date=parseInt(id2.split("|")[0]),b.hours=parseInt(id2.split("|")[1].slice(0,2)),a.date===b.date?a.hours-b.hours:a.date-b.date}),ids},mouseUp=function(){return dragging=!1,updateModel(selectedIds)},mouseDown=function(el){return dragging=!0,setStartCell(el),setEndCell(el)},mouseEnter=function(el){return dragging?setEndCell(el):void 0},setStartCell=function(el){return startCell=el,mode=el.hasClass(cls)?"subtract":"add"},setEndCell=function(el){return cellsBetween(startCell,el).each(function(){return el=angular.element(this),"add"===mode?(el.addClass(cls),selectedIds[el.attr("id")]=el.attr("id")):(el.removeClass(cls),delete selectedIds[el.attr("id")])})},cellsBetween=function(start,end){var bottomRight,coordsEnd,coordsStart,topLeft;return coordsStart=getCoords(start),coordsEnd=getCoords(end),topLeft={column:$window.Math.min(coordsStart.column,coordsEnd.column),row:$window.Math.min(coordsStart.row,coordsEnd.row)},bottomRight={column:$window.Math.max(coordsStart.column,coordsEnd.column),row:$window.Math.max(coordsStart.row,coordsEnd.row)},element.find("td").filter(function(){var coords,el;return el=angular.element(this),coords=getCoords(el),coords.column>=topLeft.column&&coords.column<=bottomRight.column&&coords.row>=topLeft.row&&coords.row<=bottomRight.row})},getCoords=function(cell){var row;return row=cell.parents("row"),{column:cell[0].cellIndex,row:cell.parent()[0].rowIndex}},wrap=function(fn){return function(){var el;return el=angular.element(this),scope.$apply(function(){return fn(el)})}},element.delegate("td","mousedown",wrap(mouseDown)),element.delegate("td","mouseenter",wrap(mouseEnter)),$document.delegate("body","mouseup",wrap(mouseUp))},{controller:controller,link:link,templateUrl:"schedule_edit_main.html",require:"ngModel",scope:{}}}),angular.module("schemaForm").config(function(schemaFormProvider,schemaFormDecoratorsProvider){return schemaFormDecoratorsProvider.addMapping("bootstrapDecorator","schedule","schedule_edit_form.html"),schemaFormDecoratorsProvider.createDirective("schedule","schedule_edit_form.html")})}.call(this),function(){angular.module("BBAdminServices").directive("scheduleTable",function(AdminCompanyService,AdminScheduleService,$modal,$log,ModalForm){var controller,link;return controller=function($scope){return $scope.getSchedules=function(){var params;return params={company:$scope.company},AdminScheduleService.query(params).then(function(schedules){return $scope.schedules_models=schedules,$scope.schedules=_.map(schedules,function(schedule){return _.pick(schedule,"id","name","mobile")})})},$scope.newSchedule=function(){return ModalForm["new"]({company:$scope.company,title:"New Schedule",new_rel:"new_schedule",post_rel:"schedules",success:function(schedule){return $scope.schedules.push(schedule)}})},$scope["delete"]=function(id){var schedule;return schedule=_.find($scope.schedules_models,function(p){return p.id===id}),schedule.$del("self").then(function(){return $scope.schedules=_.reject($scope.schedules,function(p){return p.id===id})},function(){return $log.error("Failed to delete schedule")})},$scope.edit=function(id){var schedule;return schedule=_.find($scope.schedules_models,function(p){return p.id===id}),console.log(id,schedule),ModalForm.edit({model:schedule,title:"Edit Schedule"})}},link=function(scope,element,attrs){return scope.company?scope.getSchedules():AdminCompanyService.query(attrs).then(function(company){return scope.company=company,scope.getSchedules()})},{controller:controller,link:link,templateUrl:"schedule_table_main.html"}})}.call(this),function(){angular.module("BBAdminServices").directive("serviceTable",function(AdminCompanyService,AdminServiceService,$modal,$log,ModalForm){var controller,link;return controller=function($scope){return $scope.getServices=function(){var params;return params={company:$scope.company},AdminServiceService.query(params).then(function(services){return console.log(services),$scope.services_models=services,$scope.services=_.map(services,function(service){return _.pick(service,"id","name")})})},$scope.newService=function(){return ModalForm["new"]({company:$scope.company,title:"New Service",new_rel:"new_service",post_rel:"services",success:function(service){return $scope.services.push(service)}})},$scope["delete"]=function(id){var service;return service=_.find($scope.services_models,function(s){return s.id===id}),service.$del("self").then(function(){return $scope.services=_.reject($scope.services,function(s){return s.id===id})},function(){return $log.error("Failed to delete service")})},$scope.edit=function(id){var service;return service=_.find($scope.services_models,function(s){return s.id===id}),ModalForm.edit({model:service,title:"Edit Service"})}},link=function(scope,element,attrs){return scope.company?scope.getServices():AdminCompanyService.query(attrs).then(function(company){return scope.company=company,scope.getServices()})},{controller:controller,link:link,templateUrl:"service_table_main.html"}})}.call(this),function(){var app;app=angular.module("BB.Filters"),app.filter("dayName",function(){return function(day_of_week){var date;return date=moment().weekday(day_of_week),date.format("ddd")}}),app.filter("hourName",function(){return function(timestamp){var date;return timestamp=timestamp.substring(0,5),date=moment(timestamp,"HH:mm"),date.format("ha")}})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Admin.PersonModel",function($q,BBModel){var Person;return Person=function(_super){function Person(){return Person.__super__.constructor.apply(this,arguments)}return __extends(Person,_super),Person}(BBModel.Person)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Admin.ResourceModel",function($q,BBModel){var Resource;return Resource=function(_super){function Resource(){return Resource.__super__.constructor.apply(this,arguments)}return __extends(Resource,_super),Resource}(BBModel.Resource)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Admin.ScheduleModel",function($q,BBModel,BaseModel){var Admin_Schedule;return Admin_Schedule=function(_super){function Admin_Schedule(data){Admin_Schedule.__super__.constructor.call(this,data)}return __extends(Admin_Schedule,_super),Admin_Schedule}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Admin.ServiceModel",function($q,BBModel){var Service;return Service=function(_super){function Service(){return Service.__super__.constructor.apply(this,arguments)}return __extends(Service,_super),Service}(BBModel.Service)})}.call(this),function(){angular.module("BBAdminServices").factory("AdminPersonService",function($q,$window,$rootScope,halClient,SlotCollections,BBModel,LoginService){return{query:function(params){var company,defer;return company=params.company,defer=$q.defer(),company.$get("people").then(function(collection){return collection.$get("people").then(function(people){var models,p;return models=function(){var _i,_len,_results;for(_results=[],_i=0,_len=people.length;_len>_i;_i++)p=people[_i],_results.push(new BBModel.Person(p));return _results}(),defer.resolve(models)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise},block:function(company,person,data){var deferred,href,prms,uri;return prms={id:person.id,company_id:company.id},deferred=$q.defer(),href="/api/v1/admin/{company_id}/people/{id}/block",uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$put(uri,{},data).then(function(){return function(slot){return slot=new BBModel.Admin.Slot(slot),SlotCollections.checkItems(slot),deferred.resolve(slot)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},signup:function(user,data){var defer;return defer=$q.defer(),user.$get("company").then(function(company){var params;return params={},company.$post("people",params,data).then(function(person){return person.$has("administrator")?person.$get("administrator").then(function(user){return LoginService.setLogin(user),defer.resolve(person)}):defer.resolve(person)},function(err){return defer.reject(err)}),defer.promise})}}})}.call(this),function(){angular.module("BBAdminServices").factory("AdminResourceService",function($q,$window,halClient,SlotCollections,BBModel){return{query:function(params){var company,defer;return company=params.company,defer=$q.defer(),company.$get("resources").then(function(collection){return collection.$get("resources").then(function(resources){var models,r;return models=function(){var _i,_len,_results;for(_results=[],_i=0,_len=resources.length;_len>_i;_i++)r=resources[_i],_results.push(new BBModel.Resource(r));return _results}(),defer.resolve(models)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise},block:function(company,resource,data){var deferred,href,prms,uri;return prms={id:resource.id,company_id:company.id},deferred=$q.defer(),href="/api/v1/admin/{company_id}/resource/{id}/block",uri=new $window.UriTemplate.parse(href).expand(prms||{}),halClient.$put(uri,{},data).then(function(){return function(slot){return slot=new BBModel.Admin.Slot(slot),SlotCollections.checkItems(slot),deferred.resolve(slot)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BBAdminServices").factory("AdminScheduleService",function($q,BBModel){return{query:function(params){var company,defer;return company=params.company,defer=$q.defer(),company.$get("schedules").then(function(collection){return collection.$get("schedules").then(function(schedules){var models,s;return models=function(){var _i,_len,_results;for(_results=[],_i=0,_len=schedules.length;_len>_i;_i++)s=schedules[_i],_results.push(new BBModel.Admin.Schedule(s));return _results}(),defer.resolve(models)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise}}})}.call(this),function(){angular.module("BBAdmin.Services").factory("AdminServiceService",function($q,BBModel){return{query:function(params){var company,defer;return company=params.company,defer=$q.defer(),company.$get("services").then(function(collection){return collection.$get("services").then(function(services){var models,s;return models=function(){var _i,_len,_results;for(_results=[],_i=0,_len=services.length;_len>_i;_i++)s=services[_i],_results.push(new BBModel.Service(s));return _results}(),defer.resolve(models)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise}}})}.call(this),function(){angular.module("BBAdminSettings").directive("adminTable",function(AdminCompanyService,AdminAdministratorService,$modal,$log,ModalForm){var controller,link;return controller=function($scope){return $scope.getAdministrators=function(){var params;return params={company:$scope.company},AdminAdministratorService.query(params).then(function(administrators){return $scope.admin_models=administrators,$scope.administrators=_.map(administrators,function(administrator){return _.pick(administrator,"id","name","email","role")})})},$scope.newAdministrator=function(){return ModalForm["new"]({company:$scope.company,title:"New Administrator",new_rel:"new_administrator",post_rel:"administrators",success:function(administrator){return $scope.administrators.push(administrator)}})},$scope.edit=function(id){var admin;return admin=_.find($scope.admin_models,function(p){return p.id===id}),ModalForm.edit({model:admin,title:"Edit Administrator"})}},link=function(scope,element,attrs){return scope.company?scope.getAdministrators():AdminCompanyService.query(attrs).then(function(company){return scope.company=company,scope.getAdministrators()})},{controller:controller,link:link,templateUrl:"admin_table_main.html"}})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Admin.AdministratorModel",function($q,BBModel,BaseModel){var Admin_Administrator;return Admin_Administrator=function(_super){function Admin_Administrator(data){Admin_Administrator.__super__.constructor.call(this,data)}return __extends(Admin_Administrator,_super),Admin_Administrator}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Admin.UserModel",function($q,BBModel,BaseModel){var Admin_User;return Admin_User=function(_super){function Admin_User(data){Admin_User.__super__.constructor.call(this,data),this.companies=[],data&&this.$has("companies")&&this.$get("companies").then(function(_this){return function(comps){return _this.companies=comps}}(this))}return __extends(Admin_User,_super),Admin_User}(BaseModel)})}.call(this),function(){angular.module("BBAdmin.Services").factory("AdminAdministratorService",function($q,BBModel){return{query:function(params){var company,defer;return company=params.company,defer=$q.defer(),company.$get("administrators").then(function(collection){return collection.$get("administrators").then(function(administrators){var a,models;return models=function(){var _i,_len,_results;for(_results=[],_i=0,_len=administrators.length;_len>_i;_i++)a=administrators[_i],_results.push(new BBModel.Admin.Administrator(a));return _results}(),defer.resolve(models)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise}}})}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Collection.Day=function(_super){function Day(){return Day.__super__.constructor.apply(this,arguments)}return __extends(Day,_super),Day.prototype.checkItem=function(){return Day.__super__.checkItem.apply(this,arguments)},Day}(window.Collection.Base),angular.module("BB.Services").provider("DayCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.Collection.Space=function(_super){function Space(){return Space.__super__.constructor.apply(this,arguments)}return __extends(Space,_super),Space.prototype.checkItem=function(){return Space.__super__.checkItem.apply(this,arguments)},Space}(window.Collection.Base),angular.module("BB.Services").provider("SpaceCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbBasket",function(PathSvc){return{restrict:"A",replace:!0,scope:!0,templateUrl:function(element,attrs){return PathSvc.directivePartial(_.has(attrs,"mini")?"basket_mini":"basket")},controllerAs:"BasketCtrl",controller:function($scope){$scope.setUsingBasket(!0),this.empty=function(){return $scope.$eval("emptyBasket()")},this.view=function(){return $scope.$eval("viewBasket()")},$scope.$watch(function(){var len;$scope.basketItemCount=len=$scope.bb.basket?$scope.bb.basket.length():0,$scope.basketStatus=len?1===len?"1 item in your basket":len+" items in your basket":"empty"})},link:function(scope,element){return element.bind("click",function(e){return e.preventDefault()})}}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbBreadcrumb",function(PathSvc){return{restrict:"A",replace:!0,scope:!0,controller:"Breadcrumbs",templateUrl:function(element,attrs){return PathSvc.directivePartial(_.has(attrs,"complex")?"breadcrumb_complex":"breadcrumb")},link:function(){}}}),angular.module("BB.Controllers").controller("Breadcrumbs",function($scope){var atDisablePoint,currentStep,lastStep,loadStep;return loadStep=$scope.loadStep,$scope.steps=$scope.bb.steps,$scope.allSteps=$scope.bb.allSteps,$scope.loadStep=function(number){return lastStep()||currentStep(number)||atDisablePoint()?void 0:loadStep(number)},lastStep=function(){return $scope.bb.current_step===$scope.bb.allSteps.length},currentStep=function(step){return step===$scope.bb.current_step},atDisablePoint=function(){return angular.isDefined($scope.bb.disableGoingBackAtStep)?$scope.bb.current_step>=$scope.bb.disableGoingBackAtStep:!1},$scope.isDisabledStep=function(step){return lastStep()||currentStep(step.number)||!step.passed||atDisablePoint()?!0:!1}})}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbContentNew",function(PathSvc){return{restrict:"A",replace:!0,scope:!0,templateUrl:PathSvc.directivePartial("content_main"),controller:function($scope){$scope.initPage=function(){return $scope.$eval("setPageLoaded()")}}}})}.call(this),function(){angular.module("BB.Directives").directive("bbDatepickerPopup",function($parse,$document,$timeout,$bbug){var e,ie8orLess;ie8orLess=!1;try{ie8orLess=window.parseInt(/MSIE\s*(\d)/.exec(window.navigator.userAgent)[1])}catch(_error){e=_error,ie8orLess=!1}return{restrict:"A",priority:-1,require:"ngModel",link:function(scope,element,attrs,ngModel){var callDateHandler,data,dateFormat,f,getTimeRangeScope,getter,origDateParser,replacementDateParser,timeRangeScope,yearNow;return origDateParser=null,data=element.controller("ngModel"),dateFormat=attrs.bbDatepickerPopup?attrs.bbDatepickerPopup:"DD/MM/YYYY",yearNow=moment(new Date).year(),getter=$parse(attrs.ngModel),timeRangeScope=scope,getTimeRangeScope=function(scope){return scope?scope.controller&&scope.controller.indexOf("TimeRangeList")>0?timeRangeScope=scope:getTimeRangeScope(scope.$parent):void 0},getTimeRangeScope(scope),ie8orLess&&$bbug(element).on("keydown keyup keypress",function(ev){return ev.preventDefault(),ev.stopPropagation()}),(ie8orLess||scope.display.xs)&&$bbug(element).attr("readonly","true"),$bbug(element).on("keydown",function(e){return 13===e.keyCode?(replacementDateParser($bbug(e.target).val(),!0),$document.trigger("click"),$bbug(element).blur()):void 0}),$bbug(element).on("click",function(e){return e.preventDefault(),e.stopPropagation(),$timeout(function(){return scope.opened=!0})}),callDateHandler=function(date){var isDate,watch;return watch=scope.$watch(getter,function(newVal){return newVal?void 0:getter.assign(timeRangeScope,date)}),$timeout(watch,0),isDate=_.isDate(date),isDate&&(getter.assign(timeRangeScope,date),ngModel.$setValidity("date",!0),scope.$eval(attrs.onDateChange)),isDate},replacementDateParser=function(viewValue,returnKey){var mDate;return callDateHandler(viewValue)?viewValue:ie8orLess?viewValue:(mDate=moment(viewValue,dateFormat),mDate.isValid()||(mDate=moment(new Date)),/\/YY$/.test(dateFormat)&&(dateFormat+="YY"),0===mDate.year()&&mDate.year(yearNow),viewValue=mDate.format("MM/DD/YYYY"),viewValue=viewValue.replace(/\/00/,"/20"),/\/02\d{2}$/.test(viewValue)?void 0:returnKey?(2===mDate.year().toString().length&&mDate.year(mDate.year()+2e3),callDateHandler(mDate._d)):origDateParser.call(this,viewValue))},(f=function(){return _.isFunction(data.$parsers[0])?(origDateParser=data.$parsers[0],void(data.$parsers[0]=replacementDateParser)):setTimeout(f,10)})()}}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbFormDataStore",function(FormDataStoreService){return{require:"?bbWidget",link:function(scope){return FormDataStoreService.register(scope)}}})}.call(this),function(){var app;app=angular.module("BB.Directives"),app.directive("ngConfirmClick",function(){return{link:function(scope,element,attr){var clickAction,msg;return msg=attr.ngConfirmClick||"Are you sure?",clickAction=attr.ngConfirmedClick,element.bind("click",function(){return function(){return window.confirm(msg)?scope.$eval(clickAction):void 0}}(this))}}}),app.directive("ngValidInclude",function($compile){return{link:function(scope,element,attr){return scope[attr.watchValue].then(function(){return function(){return element.attr("ng-include",attr.ngValidInclude),element.attr("ng-valid-include",null),$compile(element)(scope)}}(this))}}}),app.directive("ngDelayed",function($compile){return{link:function(scope,element,attr){return scope[attr.ngDelayedWatch].then(function(){return function(){return element.attr(attr.ngDelayed,attr.ngDelayedValue),element.attr("ng-delayed-value",null),element.attr("ng-delayed-watch",null),element.attr("ng-delayed",null),$compile(element)(scope),attr.ngDelayedReady?scope[attr.ngDelayedReady].resolve(!0):void 0}}(this))}}}),app.directive("ngInitial",function(){return{restrict:"A",controller:["$scope","$element","$attrs","$parse",function($scope,$element,$attrs,$parse){var getter,setter,val;return val=$attrs.ngInitial||$attrs.value,getter=$parse($attrs.ngModel),setter=getter.assign,"true"===val?val=!0:"false"===val&&(val=!1),setter($scope,val)}]}}),app.directive("bbPrintPage",function($window,$timeout){return{restrict:"A",link:function(scope,element,attr){return attr.bbPrintPage?scope.$watch(attr.bbPrintPage,function(){return function(){return console.log(attr.bbPrintPage),$timeout(function(){return $window.print()},3e3)}}(this)):void 0}}}),app.directive("bbInclude",function($compile){return{link:function(scope,element,attr){return scope.$watch("bb.path_setup",function(){return function(newval){return newval?(element.attr("ng-include","'"+scope.getPartial(attr.bbInclude)+"'"),element.attr("bb-include",null),$compile(element)(scope)):void 0}}(this))}}}),app.directive("bbRaiseAlertWhenInvalid",function(){return{require:"^form",link:function(scope,element,attr,ctrl){var options;return ctrl.raise_alerts=!0,options=scope.$eval(attr.bbRaiseAlertWhenInvalid),options&&options.alert?ctrl.alert=options.alert:void 0}}}),app.directive("bbHeader",function($compile){return{link:function(scope,element,attr){return scope.bb.waitForRoutes(),scope.$watch("bb.path_setup",function(){return function(newval){return newval?(element.attr("ng-include","'"+scope.getPartial(attr.bbHeader)+"'"),element.attr("bb-header",null),$compile(element)(scope)):void 0}}(this))}}}),app.directive("bbDate",function(){return{restrict:"AE",scope:!0,link:function(scope,element,attrs){var date,track_service;return track_service=null!=attrs.bbTrackService,date=attrs.bbDate?moment(scope.$eval(attrs.bbDate)):scope.bb&&scope.bb.current_item&&scope.bb.current_item.date?scope.bb.current_item.date.date:moment(),track_service&&scope.bb.current_item&&scope.bb.current_item.service&&(scope.min_date=scope.bb.current_item.service.min_advance_datetime,scope.max_date=scope.bb.current_item.service.max_advance_datetime),scope.$broadcast("dateChanged",moment(date)),scope.bb_date={date:date,js_date:date.toDate(),addDays:function(type,amount){return this.date=moment(this.date).add(amount,type),this.js_date=this.date.toDate(),scope.$broadcast("dateChanged",moment(this.date))},subtractDays:function(type,amount){return this.addDays(type,-amount)},setDate:function(date){return this.date=date,this.js_date=date.toDate(),scope.$broadcast("dateChanged",moment(this.date))}},scope.$on("currentItemUpdate",function(){return scope.bb.current_item.service&&track_service&&(scope.min_date=scope.bb.current_item.service.min_advance_datetime,scope.max_date=scope.bb.current_item.service.max_advance_datetime,scope.bb_date.date.isBefore(scope.min_date,"day")&&scope.bb_date.setDate(scope.min_date.clone()),scope.bb_date.date.isAfter(scope.max_date,"day"))?scope.bb_date.setDate(scope.max_date.clone()):void 0}),scope.$watch("bb_date.js_date",function(newval){var ndate;return ndate=moment(newval),scope.bb_date.date.isSame(ndate)?void 0:(scope.bb_date.date=ndate,scope.$broadcast("dateChanged",moment(ndate)))})}}}),app.directive("bbDebounce",function($timeout){return{restrict:"A",link:function(scope,element,attrs){var delay;
return delay=400,attrs.bbDebounce&&(delay=attrs.bbDebounce),element.bind("click",function(){return function(){return $timeout(function(){return element.attr("disabled",!0)},0),$timeout(function(){return element.attr("disabled",!1)},delay)}}(this))}}}),app.directive("bbLocalNumber",function(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){var prettyifyNumber;return prettyifyNumber=function(value){return value&&"0"!==value[0]&&(value="0"+value),value},ctrl.$formatters.push(prettyifyNumber)}}}),app.directive("bbPadWithZeros",function(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){var how_many,options,padNumber;return options=scope.$eval(attrs.bbPadWithZeros)||{},how_many=options.how_many||2,padNumber=function(value){var index,padding,_i,_ref;if(value=String(value),value&&value.length<how_many){for(padding="",index=_i=1,_ref=how_many-value.length;_ref>=1?_ref>=_i:_i>=_ref;index=_ref>=1?++_i:--_i)padding+="0";value=padding.concat(value)}return value},ctrl.$formatters.push(padNumber)}}}),app.directive("bbFormResettable",function($parse){return{restrict:"A",controller:function($scope,$element,$attrs){return $scope.inputs=[],$scope.resetForm=function(options){var input,_i,_len,_ref,_results;for(options&&options.clear_submitted&&($scope[$attrs.name].submitted=!1),_ref=$scope.inputs,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)input=_ref[_i],input.getter.assign($scope,null),_results.push(input.controller.$setPristine());return _results},{registerInput:function(input,ctrl){var getter;return getter=$parse(input),$scope.inputs.push({getter:getter,controller:ctrl})}}}}}),app.directive("bbResettable",function(){return{restrict:"A",require:["ngModel","^bbFormResettable"],link:function(scope,element,attrs,ctrls){var formResettableCtrl,ngModelCtrl;return ngModelCtrl=ctrls[0],formResettableCtrl=ctrls[1],formResettableCtrl.registerInput(attrs.ngModel,ngModelCtrl)}}}),app.directive("bbDateSplit",function(){return{restrict:"A",require:["ngModel"],link:function(scope,element,attrs,ctrls){var ngModel,question;return ngModel=ctrls[0],question=scope.$eval(attrs.bbDateSplit),question.date={day:null,month:null,year:null,date:null,joinDate:function(){var date_string;return this.day&&this.month&&this.year?(date_string=this.day+"/"+this.month+"/"+this.year,this.date=moment(date_string,"DD/MM/YYYY"),date_string=this.date.toISODate(),ngModel.$setViewValue(date_string),ngModel.$render()):void 0},splitDate:function(date){return date&&date.isValid()?(this.day=date.date(),this.month=date.month()+1,this.year=date.year(),this.date=date):void 0}},ngModel.$viewValue?question.date.splitDate(moment(ngModel.$viewValue)):void 0}}}),app.directive("bbCommPref",function(){return{restrict:"A",require:["ngModel"],link:function(scope,element,attrs,ctrls){var comm_pref_default,ngModelCtrl;return ngModelCtrl=ctrls[0],comm_pref_default=scope.$eval(attrs.bbCommPref||!1),ngModelCtrl.$setViewValue(comm_pref_default),scope.$watch(attrs.ngModel,function(newval,oldval){return newval!==oldval?(scope.bb.current_item.settings.send_email_followup=newval,scope.bb.current_item.settings.send_sms_followup=newval):void 0})}}}),app.directive("bbOwlCarousel",function(){return{restrict:"A",link:function(scope,element,attrs){var options;if(element.owlCarousel)return options=scope.$eval(attrs.bbOwlCarousel),scope.initCarousel=function(){return scope.destroyCarousel(),element.owlCarousel(options),$(".bb-owl-prev").click(function(){return element.trigger("owl.prev")}),$(".bb-owl-next").click(function(){return element.trigger("owl.next")})},scope.destroyCarousel=function(){return element.data("owlCarousel")?element.data("owlCarousel").destroy():void 0},scope.$watch(options.data,function(newval){return newval&&newval.length>0?scope.initCarousel():void 0})}}}),app.directive("bbCountTicketTypes",function(){return{restrict:"A",link:function(scope,element,attrs){var counts,item,items,_i,_len,_results;for(items=scope.$eval(attrs.bbCountTicketTypes),counts=[],_results=[],_i=0,_len=items.length;_len>_i;_i++)item=items[_i],item.tickets?(counts[item.tickets.name]?counts[item.tickets.name]+=1:counts[item.tickets.name]=1,_results.push(item.number=counts[item.tickets.name])):_results.push(void 0);return _results}}}),app.directive("bbCapitaliseFirstLetter",function(){return{restrict:"A",require:["ngModel"],link:function(scope,element,attrs,ctrls){var ngModel;return ngModel=ctrls[0],scope.$watch(attrs.ngModel,function(newval){var string;newval&&(string=scope.$eval(attrs.ngModel),string=string.charAt(0).toUpperCase()+string.slice(1),ngModel.$setViewValue(string),ngModel.$render())})}}})}.call(this),function(){"use strict";var app,isEmpty;app=angular.module("BB.Directives"),app.directive("bbQuestionLine",function($compile){return{transclude:!1,restrict:"A",link:function(scope,element){var e,elm,html,index;return"heading"===scope.question.detail_type&&(elm="",scope.question.name.length>0&&(elm+="<div class='bb-question-heading'>"+scope.question.name+"</div>"),scope.question.help_text&&scope.question.help_text.length>0&&(elm+="<div class='bb-question-help-text'>"+scope.question.help_text+"</div>"),element.html(elm)),scope.idmaps&&(scope.idmaps[scope.question.detail_type]&&scope.idmaps[scope.question.detail_type].block||scope.idmaps[scope.question.id]&&scope.idmaps[scope.question.id].block)?(index=scope.idmaps[scope.question.id]?scope.question.id:scope.question.detail_type,html=scope.$parent.idmaps[index].html,e=$compile(html)(scope,function(){return function(cloned){return element.replaceWith(cloned)}}(this))):void 0}}}),app.directive("bbQuestion",function($compile){return{priority:0,replace:!0,transclude:!1,restrict:"A",compile:function(){return{pre:function(scope,element,attrs){var adminRequired,_ref;return adminRequired=null!=(_ref=attrs.bbAdminRequired)?_ref:!1,scope.$watch(attrs.bbQuestion,function(question){var e,html,index,itemx,lastName,name,_i,_j,_len,_len1,_ref1,_ref2;if(question){if(html="",lastName="",scope.recalc=function(){return function(){return angular.isDefined(scope.recalc_price)&&(question.outcome||scope.recalc_price()),angular.isDefined(scope.recalc_question)?scope.recalc_question():void 0}}(this),scope.idmaps&&(scope.idmaps[question.detail_type]||scope.idmaps[question.id]))index=scope.idmaps[scope.question.id]?scope.question.id:scope.question.detail_type,html=scope.idmaps[index].html;else if("select"===question.detail_type||"select-price"===question.detail_type){for(html="<select ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-change='recalc()' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' class='form-question form-control'>",_ref1=question.options,_i=0,_len=_ref1.length;_len>_i;_i++)itemx=_ref1[_i],html+="<option data_id='"+itemx.id+"' value='"+itemx.name+"'>"+itemx.display_name+"</option>";html+="</select>"}else if("text_area"===question.detail_type)html="<textarea ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' rows=3 class='form-question form-control'>"+question.answer+"</textarea>";else if("radio"===question.detail_type){for(html='<div class="radio-group">',_ref2=question.options,_j=0,_len1=_ref2.length;_len1>_j;_j++)itemx=_ref2[_j],html+="<div class='radio'><label class='radio-label'><input ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-change='recalc()' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' type='radio' value=\""+itemx.name+'"/>'+itemx.name+"</label></div>";html+="</div>"}else"check"===question.detail_type?(name=question.name,name===lastName&&(name=""),lastName=question.name,html="<div class='checkbox' ng-class='{\"selected\": question.answer}'><label><input name='q"+question.id+"' id='"+question.id+"' ng-model='question.answer' ng-checked='question.answer == \"1\"' ng-change='recalc()' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' type='checkbox' value=1>"+name+"</label></div>"):html="check-price"===question.detail_type?"<div class='checkbox'><label><input name='q"+question.id+"' id='"+question.id+"' ng-model='question.answer' ng-checked='question.answer == \"1\"' ng-change='recalc()' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' type='checkbox' value=1> ({{question.price | currency:'GBP'}})</label></div>":"date"===question.detail_type?"<div class='input-group date-picker'> <input type='text' class='form-question form-control' name='q"+question.id+"' id='"+question.id+"' bb-datepicker-popup='DD/MM/YYYY' datepicker-popup='dd/MM/yyyy' ng-model='question.answer' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' datepicker-options='{\"starting-day\": 1}' show-weeks='false' show-button-bar='false' is-open='opened' /> <span class='input-group-btn' ng-click='$event.preventDefault();$event.stopPropagation();opened=true'> <button class='btn btn-default' type='submit'><span class='glyphicon glyphicon-calendar'></span></button> </span> </div>":"<input type='text' ng-model='question.answer' name='q"+question.id+"' id='"+question.id+"' ng-required='question.currentlyShown && ("+adminRequired+" || (question.required && !bb.isAdmin))' class='form-question form-control'/>";if(html)return e=$compile(html)(scope,function(){return function(cloned){return element.replaceWith(cloned)}}(this))}})},post:function(){}}}}}),app.directive("bbQuestionSetup",function(){return{restrict:"A",terminal:!0,priority:1e3,link:function(scope,element){var block,child,def,id,idmaps,index,_i,_len,_ref;for(idmaps={},def=null,_ref=element.children(),index=_i=0,_len=_ref.length;_len>_i;index=++_i)child=_ref[index],id=$(child).attr("bb-question-id"),block=!1,$(child).attr("bb-replace-block")&&(block=!0),child.innerHTML=child.innerHTML.replace(/question_form/g,"question_form_"+index),idmaps[id]={id:id,html:child.innerHTML,block:block};return scope.idmaps=idmaps,element.replaceWith("")}}}),app.directive("bbFocus",[function(){var FOCUS_CLASS;return FOCUS_CLASS="bb-focused",{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){return ctrl.$focused=!1,element.bind("focus",function(){return element.addClass(FOCUS_CLASS),scope.$apply(function(){return ctrl.$focused=!0})}).bind("blur",function(){return element.removeClass(FOCUS_CLASS),scope.$apply(function(){return ctrl.$focused=!1})})}}}]),isEmpty=function(value){return angular.isUndefined(value)||""===value||null===value||value!==value},app.directive("ngMin",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){var minValidator;scope.$watch(attr.ngMin,function(){ctrl.$setViewValue(ctrl.$viewValue)}),minValidator=function(value){var min;return min=scope.$eval(attr.ngMin)||0,!isEmpty(value)&&min>value?void ctrl.$setValidity("ngMin",!1):(ctrl.$setValidity("ngMin",!0),value)},ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}}}),app.directive("ngMax",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){var maxValidator;scope.$watch(attr.ngMax,function(){ctrl.$setViewValue(ctrl.$viewValue)}),maxValidator=function(value){var max;return max=scope.$eval(attr.ngMax),!isEmpty(value)&&value>max?void ctrl.$setValidity("ngMax",!1):(ctrl.$setValidity("ngMax",!0),value)},ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}}}),app.directive("creditCardNumber",function(){var getCardType,isValid,linker;return getCardType=function(ccnumber){return ccnumber?(ccnumber=ccnumber.toString().replace(/\s+/g,""),/^(34)|^(37)/.test(ccnumber)?"american_express":/^(62)|^(88)/.test(ccnumber)?"china_unionpay":/^30[0-5]/.test(ccnumber)?"diners_club_carte_blanche":/^(2014)|^(2149)/.test(ccnumber)?"diners_club_enroute":/^36/.test(ccnumber)?"diners_club_international":/^(6011)|^(622(1(2[6-9]|[3-9][0-9])|[2-8][0-9]{2}|9([01][0-9]|2[0-5])))|^(64[4-9])|^65/.test(ccnumber)?"discover":/^35(2[89]|[3-8][0-9])/.test(ccnumber)?"jcb":/^(6304)|^(6706)|^(6771)|^(6709)/.test(ccnumber)?"laser":/^(5018)|^(5020)|^(5038)|^(5893)|^(6304)|^(6759)|^(6761)|^(6762)|^(6763)|^(0604)/.test(ccnumber)?"maestro":/^5[1-5]/.test(ccnumber)?"master":/^4/.test(ccnumber)?"visa":/^(4026)|^(417500)|^(4405)|^(4508)|^(4844)|^(4913)|^(4917)/.test(ccnumber)?"visa_electron":void 0):""},isValid=function(ccnumber){var len,mul,prodArr,sum;if(!ccnumber)return!1;for(len=ccnumber.length,mul=0,prodArr=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],sum=0;len--;)sum+=prodArr[mul][parseInt(ccnumber.charAt(len),10)],mul^=1;return sum%10===0&&sum>0},linker=function(scope,element,attributes,ngModel){return scope.$watch(function(){return ngModel.$modelValue},function(newValue){return ngModel.$setValidity("card_number",isValid(newValue)),scope.cardType=getCardType(newValue),null!=newValue&&16===newValue.length?ngModel.$invalid?(element.parent().addClass("has-error"),element.parent().removeClass("has-success")):(element.parent().removeClass("has-error"),element.parent().addClass("has-success")):element.parent().removeClass("has-success")})},{restrict:"C",require:"ngModel",link:linker,scope:{cardType:"="}}}),app.directive("cardSecurityCode",function(){var linker;return linker=function(scope,element){return scope.$watch("cardType",function(newValue){return"american_express"===newValue?(element.attr("maxlength",4),element.attr("placeholder","")):(element.attr("maxlength",3),element.attr("placeholder",""))})},{restrict:"C",link:linker,scope:{cardType:"="}}}),app.directive("bbInputGroupManager",function(){return{restrict:"A",controller:function($scope,$element){return $scope.input_manger={input_groups:{},inputs:[],registerInput:function(input,name){return this.inputs.indexOf(input.$name)>=0?void 0:(this.inputs.push(input.$name),this.input_groups[name]||(this.input_groups[name]={inputs:[],valid:!1}),this.input_groups[name].inputs.push(input))},validateInputGroup:function(name){var input,is_valid,_i,_j,_len,_len1,_ref,_ref1;for(is_valid=!1,_ref=this.input_groups[name].inputs,_i=0,_len=_ref.length;_len>_i&&(input=_ref[_i],!(is_valid=input.$modelValue));_i++);if(is_valid===!this.input_groups[name].valid){for(_ref1=this.input_groups[name].inputs,_j=0,_len1=_ref1.length;_len1>_j;_j++)input=_ref1[_j],input.$setValidity(input.$name,is_valid);return this.input_groups[name].valid=is_valid}}},$element.on("submit",function(){var input_group,_results;_results=[];for(input_group in $scope.input_manger.input_groups)_results.push($scope.input_manger.validateInputGroup(input_group));return _results})}}}),app.directive("bbInputGroup",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ngModel){return scope.input_manger.inputs.indexOf(ngModel.$name)>=0?void 0:(scope.input_manger.registerInput(ngModel,attrs.bbInputGroup),scope.$watch(attrs.ngModel,function(newval,oldval){return newval===!oldval?scope.input_manger.validateInputGroup(attrs.bbInputGroup):void 0}))}}}),app.directive("bbQuestionLabel",function(){return{transclude:!1,restrict:"A",scope:!1,link:function(scope,element,attrs){return scope.$watch(attrs.bbQuestionLabel,function(question){return!question||"check"!==question.detail_type&&"check-price"!==question.detail_type?void 0:element.html("")})}}}),app.directive("bbQuestionLink",function($compile){return{transclude:!1,restrict:"A",scope:!0,link:function(scope,element,attrs){var id;return id=parseInt(attrs.bbQuestionLink),scope.$watch("question_set",function(newval){var q,_i,_len,_ref,_results;if(newval){for(_ref=scope.question_set,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)q=_ref[_i],q.id===id?(scope.question=q,element.attr("ng-model","question.answer"),element.attr("bb-question-link",null),_results.push($compile(element)(scope))):_results.push(void 0);return _results}})}}}),app.directive("bbQuestionSet",function(){return{transclude:!1,restrict:"A",scope:!0,link:function(scope,element,attrs){var set;return set=attrs.bbQuestionSet,element.addClass("ng-hide"),scope.$watch(set,function(newval){return newval?(scope.question_set=newval,element.removeClass("ng-hide")):void 0})}}})}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbLoader",function($rootScope,$compile,PathSvc,TemplateSvc){return{restrict:"A",replace:!1,scope:{},controllerAs:"LoaderCtrl",controller:function($scope){var addScopeId,hideLoader,parentScopeId,removeScopeId,scopeIdArr,showLoader;parentScopeId=$scope.$parent.$id,scopeIdArr=[],addScopeId=function(id){scopeIdArr.push(id),scopeIdArr=_.uniq(scopeIdArr)},removeScopeId=function(id){return scopeIdArr=_.without(scopeIdArr,id),scopeIdArr.length},showLoader=function(e,cscope){var sid;for(sid=cscope.$id;cscope;){if(cscope.$id===parentScopeId){addScopeId(sid),$scope.scopeLoaded=!1;break}cscope=cscope.$parent}},hideLoader=function(e,cscope){removeScopeId(cscope.$id)||($scope.scopeLoaded=!0)},$rootScope.$on("show:loader",showLoader),$rootScope.$on("hide:loader",hideLoader),$scope.scopeLoaded=!1},link:function(scope,element,attrs){TemplateSvc.get(PathSvc.directivePartial("loader")).then(function(html){var str;_.isString(attrs.bbLoader)&&(str=attrs.bbLoader.slice(1),/^#/.test(attrs.bbLoader)?html.attr("id",str):/^\./.test(attrs.bbLoader)&&html.addClass(str)),element.prepend(html),$compile(html)(scope)})}}})}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbLoading",function($compile){return{transclude:!1,restrict:"A",link:function(scope,element){scope.scopeLoaded=!0,element.attr("ng-hide","scopeLoaded"),element.attr("bb-loading",null),$compile(element)(scope)}}})}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbContent",function($compile){return{transclude:!1,restrict:"A",link:function(scope,element){return element.attr("ng-include","bb_main"),element.attr("onLoad","initPage()"),element.attr("bb-content",null),element.attr("ng-hide","hide_page"),scope.initPage=function(){return function(){return scope.setPageLoaded(),scope.setLoadingPage(!1)}}(this),$compile(element)(scope)}}}),app.directive("bbLoading",function($compile){return{transclude:!1,restrict:"A",link:function(scope,element){scope.scopeLoaded=scope.areScopesLoaded(scope),element.attr("ng-hide","scopeLoaded"),element.attr("bb-loading",null),$compile(element)(scope)}}}),app.directive("bbScrollTo",function($rootScope,AppConfig,BreadcrumbService,$bbug){return{transclude:!1,restrict:"A",link:function(scope,element,attrs){var always_scroll,evnt,evnts,scrollToCallback,_i,_len;if(evnts=attrs.bbScrollTo.split(","),always_scroll=null!=attrs.bbAlwaysScroll||!1,angular.isArray(evnts))for(_i=0,_len=evnts.length;_len>_i;_i++)evnt=evnts[_i],$rootScope.$on(evnt,function(){return scrollToCallback(evnt)});else $rootScope.$on(evnts,function(){return scrollToCallback(evnts)});return scrollToCallback=function(evnt){var current_step,scroll_to_element;return scroll_to_element=$bbug("page:loaded"===evnt&&scope.display&&scope.display.xs&&$bbug('[data-scroll-id="'+AppConfig.uid+'"]').length?'[data-scroll-id="'+AppConfig.uid+'"]':element),current_step=BreadcrumbService.getCurrentStep(),scroll_to_element&&("page:loaded"===evnt&&current_step>1||always_scroll||!scroll_to_element.is(":visible")&&0!==scroll_to_element.offset().top)?$bbug("html, body").animate({scrollTop:scroll_to_element.offset().top},500):void 0}}}}),app.directive("bbSlotGrouper",function(){return{restrict:"A",require:["^?bbTimeRanges?","^?bbTimes"],scope:!0,link:function(scope,element,attrs){var slot,slots,_i,_len,_results;if(slots=scope.$eval(attrs.slots)){for(scope.grouped_slots=[],_results=[],_i=0,_len=slots.length;_len>_i;_i++)slot=slots[_i],slot.time>=scope.$eval(attrs.startTime)&&slot.time<scope.$eval(attrs.endTime)&&scope.grouped_slots.push(slot),_results.push(scope.has_slots=scope.grouped_slots.length>0);return _results}}}}),app.directive("bbForm",function($bbug){return{restrict:"A",require:"^form",link:function(scope,elem){return elem.on("submit",function(){var invalid_form_group,invalid_input;return invalid_form_group=elem.find(".has-error:first"),invalid_form_group&&invalid_form_group.length>0?($bbug("html, body").animate({scrollTop:invalid_form_group.offset().top},1e3),invalid_input=invalid_form_group.find(".ng-invalid"),invalid_input.focus(),!1):!0})}}})}.call(this),function(){angular.module("BB.Directives").directive("ngOptions",function($sniffer,$rootScope){return{restrict:"A",link:function(scope,el,attrs){var size;return size=parseInt(attrs.size,10),!isNaN(size)&&size>1&&$sniffer.msie?$rootScope.$on("loading:finished",function(){return el.focus(),$("body").focus()}):void 0}}})}.call(this),function(){angular.module("BB.Directives").directive("paymentButton",function($compile,$sce,$http,$templateCache,$q,$log){var getButtonFormTemplate,getTemplate,linker,setClassAndValue;return getTemplate=function(type,scope){switch(type){case"button_form":return getButtonFormTemplate(scope);case"page":return'<a ng-click="decideNextPage()">{{label}}</a>';case"location":return"<a href='{{payment_link}}'>{{label}}</a>";default:return""}},getButtonFormTemplate=function(scope){var src;return src=$sce.parseAsResourceUrl("'"+scope.payment_link+"'")(),$http.get(src,{cache:$templateCache}).then(function(response){return response.data})},setClassAndValue=function(scope,element,attributes){var c,i,inputs,main_tag,_i,_len,_ref,_results;switch(scope.link_type){case"button_form":inputs=element.find("input"),main_tag=function(){var _i,_len,_results;for(_results=[],_i=0,_len=inputs.length;_len>_i;_i++)i=inputs[_i],"submit"===$(i).attr("type")&&_results.push(i);return _results}()[0],attributes.value&&$(main_tag).attr("value",attributes.value);break;case"page":case"location":main_tag=element.find("a")[0]}if(attributes["class"]){for(_ref=attributes["class"].split(" "),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)c=_ref[_i],$(main_tag).addClass(c),_results.push($(element).removeClass(c));return _results}},linker=function(scope,element,attributes){var url;return scope.bb.payment_status="pending",scope.bb.total=scope.total,scope.link_type=scope.total.$link("new_payment").type,scope.label=attributes.value||"Make Payment",scope.payment_link=scope.total.$href("new_payment"),url=scope.total.$href("new_payment"),$q.when(getTemplate(scope.link_type,scope)).then(function(template){return element.html(template).show(),$compile(element.contents())(scope),setClassAndValue(scope,element,attributes)},function(err){return $log.warn(err.data),element.remove()})},{restrict:"EA",replace:!0,scope:{total:"=",bb:"=",decideNextPage:"="},link:linker}}),angular.module("BB.Directives").directive("bbPaypalExpressButton",function($compile,$sce,$http,$templateCache,$q,$log,$window){var linker;return linker=function(scope){var paypalOptions,total;return total=scope.total,paypalOptions=scope.paypalOptions,scope.href=$window.UriTemplate.parse(total.$link("paypal_express").href).expand(paypalOptions),scope.showLoader=function(){return scope.notLoaded?scope.notLoaded(scope):void 0}},{restrict:"EA",replace:!0,template:'<a ng-href="{{href}}" ng-click="showLoader()">Pay</a>',scope:{total:"=",bb:"=",decideNextPage:"=",paypalOptions:"=bbPaypalExpressButton",notLoaded:"="},link:linker}})}.call(this),function(){angular.module("BB.Directives").directive("scoped",function($document,$timeout){var scopeIt;return this.compat=function(){var DOMRules,DOMStyle,changeSelectorTextAllowed,check,e,scopeSupported,testSheet,testStyle;check=document.createElement("style"),DOMStyle="undefined"!=typeof check.sheet?"sheet":"undefined"!=typeof check.getSheet?"getSheet":"styleSheet",scopeSupported=void 0!==check.scoped,document.body.appendChild(check),testSheet=check[DOMStyle],testSheet.addRule?testSheet.addRule("c","blink"):testSheet.insertRule("c{}",0),DOMRules=testSheet.rules?"rules":"cssRules",testStyle=testSheet[DOMRules][0];try{testStyle.selectorText="d"}catch(_error){e=_error}return changeSelectorTextAllowed="d"===testStyle.selectorText.toLowerCase(),check.parentNode.removeChild(check),{scopeSupported:scopeSupported,rules:DOMRules,sheet:DOMStyle,changeSelectorTextAllowed:changeSelectorTextAllowed}}(),scopeIt=function(_this){return function(element){var allRules,glue,id,idCounter,index,par,rule,selector,sheet,styleNode,styleRule,_results;if(styleNode=element[0],idCounter=0,sheet=styleNode[_this.compat.sheet]){for(allRules=sheet[_this.compat.rules],par=styleNode.parentNode,id=par.id||(par.id="scopedByScopedPolyfill_"+ ++idCounter),glue="",index=allRules.length||0;par;)par.id&&(glue="#"+par.id+" "+glue),par=par.parentNode;for(_results=[];index--;)rule=allRules[index],rule.selectorText?rule.selectorText.match(new RegExp(glue))?_results.push(void 0):(selector=glue+" "+rule.selectorText.split(",").join(", "+glue),selector=selector.replace(/[\ ]+:root/gi,""),_this.compat.changeSelectorTextAllowed?_results.push(rule.selectorText=selector):rule.type&&1!==rule.type?_results.push(void 0):(styleRule=rule.style.cssText,styleRule?(sheet.removeRule?sheet.removeRule(index):sheet.deleteRule(index),_results.push(sheet.addRule?sheet.addRule(selector,styleRule):sheet.insertRule(selector+"{"+styleRule+"}",index))):_results.push(void 0))):_results.push(void 0);return _results}}}(this),{restrict:"A",link:function(scope,element){return scope.scopeSupported=this.compat.scopeSupported,this.compat.scopeSupported?void 0:$timeout(function(){return scopeIt(element)})},controller:function($scope,$element,$timeout){$scope.scopeSupported||(this.updateCss=function(){return $timeout(function(){return scopeIt($element)})})}}})}.call(this),function(){var app;app=angular.module("BB.Directives"),app.directive("bbDisplayMode",function($compile,$window,$bbug){return{transclude:!1,restrict:"A",template:'<span class="visible-xs"></span><span class="visible-sm"></span><span class="visible-md"></span><span class="visible-lg"></span>',link:function(scope,elem){var getCurrentSize,isVisible,markers,t,update;return markers=elem.find("span"),$bbug(elem).addClass("bb-display-mode"),scope.display={},isVisible=function(element){return element&&"none"!==element.style.display&&element.offsetWidth&&element.offsetHeight},getCurrentSize=function(){var element,_i,_len;for(_i=0,_len=markers.length;_len>_i;_i++)return element=markers[_i],isVisible(element)?element.className.slice(8,11):(scope.display={},scope.display[element.className.slice(8,11)]=!0,!1)},update=function(_this){return function(){var nsize;return nsize=getCurrentSize(),nsize!==_this.currentSize?(_this.currentSize=nsize,scope.display.xs=!1,scope.display.sm=!1,scope.display.md=!1,scope.display.lg=!1,scope.display.not_xs=!0,scope.display.not_sm=!0,scope.display.not_md=!0,scope.display.not_lg=!0,scope.display[nsize]=!0,scope.display["not_"+nsize]=!1,!0):!1}}(this),t=null,angular.element($window).bind("resize",function(){return function(){return window.clearTimeout(t),t=setTimeout(function(){return update()?scope.$apply():void 0},50)}}(this)),angular.element($window).bind("load",function(){return function(){return update()?scope.$apply():void 0}}(this))}}})}.call(this),function(){angular.module("BB.Directives").directive("popover",function(){var openElement,openScope;return openElement=null,openScope=null,$('div[ng-controller="BBCtrl"]').off(".bbtooltip").on("click.bbtooltip",function(e){var target;return target=$(e.target).closest("[popover]")[0],!target&&openElement&&openScope&&($(openElement).next(".popover").remove(),openScope.tt_isOpen=!1),!0}),{restrict:"EA",priority:-1e3,link:function(scope,element){return element.on("click.bbtooltip",function(e){return openElement===$(e.target).closest("[popover]")[0]?void e.preventDefault():(openElement&&openScope&&($(openElement).next(".popover").remove(),openScope.tt_isOpen=!1),openElement=element[0],openScope=scope)}),scope.$on("$destroy",function(){return $(element).off(".bbtooltip")})}}})}.call(this),function(angular){"use strict";var app=angular.module("BB.Directives");app.directive("appVersion",function(version){return function(scope,elm){elm.text(version)}})}(window.angular),function(){var app;app=angular.module("BB.Filters"),app.filter("stripPostcode",function(){return function(address){var match;return match=address.toLowerCase().match(/[a-z]+\d/),match&&(address=address.substr(0,match.index)),address=$.trim(address),/,$/.test(address)&&(address=address.slice(0,-1)),address}}),app.filter("labelNumber",function(){return function(input,labels){var response;return response=input,labels[input]&&(response=labels[input]),response}}),app.filter("interpolate",["version",function(version){return function(text){return String(text).replace(/\%VERSION\%/gm,version)}}]),app.filter("rag",function(){return function(value,v1,v2){return v1>=value?"red":v2>=value?"amber":"green"}}),app.filter("time",function($window){return function(v){return $window.sprintf("%02d:%02d",Math.floor(v/60),v%60)}}),app.filter("address_single_line",function(){return function(){return function(address){var addr;if(address&&address.address1)return addr="",addr+=address.address1,address.address2&&address.address2.length>0&&(addr+=", ",addr+=address.address2),address.address3&&address.address3.length>0&&(addr+=", ",addr+=address.address3),address.address4&&address.address4.length>0&&(addr+=", ",addr+=address.address4),address.address5&&address.address5.length>0&&(addr+=", ",addr+=address.address5),address.postcode&&address.postcode.length>0&&(addr+=", ",addr+=address.postcode),addr}}(this)}),app.filter("address_multi_line",function(){return function(){return function(address){var str;if(address&&address.address1)return str="",address.address1&&(str+=address.address1),address.address2&&str.length>0&&(str+="<br/>"),address.address2&&(str+=address.address2),address.address3&&str.length>0&&(str+="<br/>"),address.address3&&(str+=address.address3),address.address4&&str.length>0&&(str+="<br/>"),address.address4&&(str+=address.address4),address.address5&&str.length>0&&(str+="<br/>"),address.address5&&(str+=address.address5),address.postcode&&str.length>0&&(str+="<br/>"),address.postcode&&(str+=address.postcode),str}}(this)}),app.filter("map_lat_long",function(){return function(){return function(address){var cord;if(address&&address.map_url)return cord=/([-+]*\d{1,3}[\.]\d*)[, ]([-+]*\d{1,3}[\.]\d*)/.exec(address.map_url),cord[0]}}(this)}),app.filter("currency",function($window,$rootScope){return function(){return function(number,currencyCode){var currency,decimal,format,thousand;return currencyCode||(currencyCode=$rootScope.bb_currency),currency={USD:"$",GBP:"",AUD:"$",EUR:"",CAD:"$",MIXED:"~"},$.inArray(currencyCode,["USD","AUD","CAD","MIXED","GBP"])>=0?(thousand=",",decimal=".",format="%s%v"):(thousand=".",decimal=",",format="%s%v"),$window.accounting.formatMoney(number,currency[currencyCode],2,thousand,decimal,format)}}(this)}),app.filter("icurrency",function($window,$rootScope){return function(){return function(number,currencyCode){var currency,decimal,format,thousand;return currencyCode||(currencyCode=$rootScope.bb_currency),currency={USD:"$",GBP:"",AUD:"$",EUR:"",CAD:"$",MIXED:"~"},$.inArray(currencyCode,["USD","AUD","CAD","MIXED","GBP"])>=0?(thousand=",",decimal=".",format="%s%v"):(thousand=".",decimal=",",format="%s%v"),number/=100,$window.accounting.formatMoney(number,currency[currencyCode],2,thousand,decimal,format)}}(this)}),app.filter("pretty_price",function($window){return function(price,symbol){return parseFloat(price)%1===0?symbol+parseFloat(price):symbol+$window.sprintf("%.2f",parseFloat(price))}}),app.filter("time_period",function(){return function(v,options){var hour_string,hours,min_string,mins,seperator,str,val;if(angular.isNumber(v))return hour_string=options&&options.abbr_units?"hr":"hour",min_string=options&&options.abbr_units?"min":"minute",seperator=options&&angular.isString(options.seperator)?options.seperator:"and",val=parseInt(v),60>val?""+val+" "+min_string+"s":(hours=parseInt(val/60),mins=val%60,0===mins?1===hours?"1 "+hour_string:""+hours+" "+hour_string+"s":(str=""+hours+" "+hour_string,hours>1&&(str+="s"),0===mins?str:(seperator.length>0&&(str+=" "+seperator),str+=" "+mins+" "+min_string+"s")))
}}),app.filter("twelve_hour_time",function($window){return function(time,options){var h,m,omit_mins_on_hour,seperator,suffix,t;if(angular.isNumber(time))return omit_mins_on_hour=options&&options.omit_mins_on_hour||!1,seperator=options&&options.seperator?options.seperator:":",t=time,h=Math.floor(t/60),m=t%60,suffix="am",h>=12&&(suffix="pm"),h>12&&(h-=12),time=0===m&&omit_mins_on_hour?""+h:""+h+seperator+$window.sprintf("%02d",m),time+=suffix}}),app.filter("time_period_from_seconds",function(){return function(v){var hours,mins,secs,str,val;if(val=parseInt(v),60>val)return""+val+" seconds";if(hours=Math.floor(val/3600),mins=Math.floor(val%3600/60),secs=Math.floor(val%60),str="",hours>0){if(str+=hours+" hour",hours>1&&(str+="s"),0===mins&&0===secs)return str;str+=" and "}if(mins>0){if(str+=mins+" minute",mins>1&&(str+="s"),0===secs)return str;str+=" and "}return str+=secs+" second",secs>0&&(str+="s"),str}}),app.filter("round_up",function(){return function(number,interval){var result;return result=number/interval,result=parseInt(result),result*=interval,number%interval>0&&(result+=interval),result}}),app.filter("exclude_days",function(){return function(days,excluded){return _.filter(days,function(day){return-1===excluded.indexOf(day.date.format("dddd"))})}}),app.filter("us_tel",function(){return function(tel){var city,country,number,value;if(!tel)return"";if(value=tel.toString().trim().replace(/^\+/,""),value.match(/[^0-9]/))return tel;switch(country=void 0,city=void 0,number=void 0,value.length){case 10:country=1,city=value.slice(0,3),number=value.slice(3);break;case 11:country=value[0],city=value.slice(1,4),number=value.slice(4);break;case 12:country=value.slice(0,3),city=value.slice(3,5),number=value.slice(5);break;default:return tel}return 1===country&&(country=""),number=number.slice(0,3)+"-"+number.slice(3),(country+city+"-"+number).trim()}}),app.filter("uk_local_number",function(){return function(tel){return tel?tel.replace(/\+44 \(0\)/,"0"):""}}),app.filter("datetime",function(){return function(datetime,format,show_timezone){var result;return null==show_timezone&&(show_timezone=!0),datetime&&(datetime=moment(datetime),datetime.isValid())?(result=datetime.format(format),datetime.zone()!==(new Date).getTimezoneOffset()&&show_timezone&&(result+=datetime._z?datetime.format(" z"):" UTC"+datetime.format("Z")),result):void 0}}),app.filter("range",function(){return function(input,min,max){var i,_i,_ref,_ref1;for(i=_i=_ref=parseInt(min),_ref1=parseInt(max);_ref1>=_ref?_ref1>=_i:_i>=_ref1;i=_ref1>=_ref?++_i:--_i)input.push(i);return input}}),app.filter("international_number",function(){return function(){return function(number,prefix){return number&&prefix?""+prefix+" "+number:number?""+number:""}}(this)}),app.filter("add",function(){return function(){return function(item,value){return item&&value?(item=parseInt(item),item+value):void 0}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbAccordianRangeGroup",function(){return{restrict:"AE",replace:!0,scope:!0,require:"^?bbTimeRangeStacked",controller:"AccordianRangeGroup",link:function(scope,element,attrs,ctrl){return scope.options=scope.$eval(attrs.bbAccordianRangeGroup)||{},scope.options.using_stacked_items=null!=ctrl}}}),angular.module("BB.Controllers").controller("AccordianRangeGroup",function($scope,$attrs,$rootScope,$q,FormDataStoreService){var hasAvailability,setData,updateAvailability;return $scope.controller="public.controllers.AccordianRangeGroup",$scope.collaspe_when_time_selected=!0,$rootScope.connection_started.then(function(){return $scope.options&&$scope.options.range?$scope.init($scope.options.range[0],$scope.options.range[1],$scope.options):void 0}),$scope.setFormDataStoreId=function(id){return FormDataStoreService.init("AccordianRangeGroup"+id,$scope,[])},$scope.init=function(start_time,end_time,options){return $scope.setRange(start_time,end_time),$scope.collaspe_when_time_selected=options&&!options.collaspe_when_time_selected?!1:!0},$scope.setRange=function(start_time,end_time){return $scope.options||($scope.options=$scope.$eval($attrs.bbAccordianRangeGroup)||{}),$scope.start_time=start_time,$scope.end_time=end_time,setData()},setData=function(){var key,slot,_i,_len,_ref,_ref1;if($scope.accordian_slots=[],$scope.is_open=$scope.is_open||!1,$scope.has_availability=$scope.has_availability||!1,$scope.is_selected=$scope.is_selected||!1,$scope.source_slots=$scope.options&&$scope.options.slots?$scope.options.slots:$scope.day&&$scope.day.slots?$scope.day.slots:null,$scope.source_slots){if(angular.isArray($scope.source_slots))for(_ref=$scope.source_slots,_i=0,_len=_ref.length;_len>_i;_i++)slot=_ref[_i],slot.time>=$scope.start_time&&slot.time<$scope.end_time&&$scope.accordian_slots.push(slot);else{_ref1=$scope.source_slots;for(key in _ref1)slot=_ref1[key],slot.time>=$scope.start_time&&slot.time<$scope.end_time&&$scope.accordian_slots.push(slot)}return updateAvailability()}},updateAvailability=function(day,slot){var _i,_len,_ref;if($scope.selected_slot=null,$scope.accordian_slots&&($scope.has_availability=hasAvailability()),day&&slot&&day.date.isSame($scope.day.date)&&slot.time>=$scope.start_time&&slot.time<$scope.end_time)$scope.selected_slot=slot;else for(_ref=$scope.accordian_slots,_i=0,_len=_ref.length;_len>_i;_i++)if(slot=_ref[_i],slot.selected){$scope.selected_slot=slot;break}if($scope.selected_slot){if($scope.hideHeading=!0,$scope.is_selected=!0,$scope.collaspe_when_time_selected)return $scope.is_open=!1}else if($scope.is_selected=!1,$scope.collaspe_when_time_selected)return $scope.is_open=!1},hasAvailability=function(){var slot,_i,_len,_ref;if(!$scope.accordian_slots)return!1;for(_ref=$scope.accordian_slots,_i=0,_len=_ref.length;_len>_i;_i++)if(slot=_ref[_i],slot.availability()>0)return!0;return!1},$scope.$on("slotChanged",function(event,day,slot){return day&&slot?updateAvailability(day,slot):updateAvailability()}),$scope.$on("dataReloaded",function(){return setData()})})}.call(this),function(){angular.module("BB.Directives").directive("bbAddresses",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"AddressList"}}),angular.module("BB.Controllers").controller("AddressList",function($scope,$rootScope,$filter,$sniffer,AddressListService,FormDataStoreService){return $scope.controller="public.controllers.AddressList",$scope.manual_postcode_entry=!1,FormDataStoreService.init("AddressList",$scope,["show_complete_address"]),$rootScope.connection_started.then(function(){return function(){return $scope.client.postcode&&!$scope.bb.postcode&&($scope.bb.postcode=$scope.client.postcode),$scope.client.postcode&&$scope.bb.postcode&&$scope.client.postcode===$scope.bb.postcode&&!$scope.bb.address1&&($scope.bb.address1=$scope.client.address1,$scope.bb.address2=$scope.client.address2,$scope.bb.address3=$scope.client.address3,$scope.bb.address4=$scope.client.address4,$scope.bb.address5=$scope.client.address5),$scope.manual_postcode_entry=$scope.bb.postcode?!1:!0,$scope.show_complete_address=$scope.bb.address1?!0:!1,$scope.postcode_submitted?void 0:($scope.findByPostcode(),$scope.postcode_submitted=!1)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.findByPostcode=function(){return $scope.postcode_submitted=!0,$scope.bb.postcode?($scope.notLoaded($scope),AddressListService.query({company:$scope.bb.company,post_code:$scope.bb.postcode}).then(function(response){var addressArr,newaddr;addressArr=angular.isArray(response)?_.map(response,function(item){return{address:item.partialAddress,moniker:item.moniker}}):[{address:response.partialAddress,moniker:response.moniker}],1===addressArr.length&&$sniffer.msie&&(newaddr=[],newaddr.push(addressArr[0]),newaddr.push({address:""}),addressArr=newaddr),$scope.addresses=addressArr,$scope.bb.address=addressArr[0],$scope.client.address=addressArr[0],$scope.setLoaded($scope)},function(){return $scope.show_complete_address=!0,$scope.postcode_submitted=!0,$scope.setLoaded($scope)})):void 0},$scope.showCompleteAddress=function(){return $scope.show_complete_address=!0,$scope.postcode_submitted=!1,$scope.bb.address&&$scope.bb.address.moniker?($scope.notLoaded($scope),AddressListService.getAddress({company:$scope.bb.company,id:$scope.bb.address.moniker}).then(function(response){var address,address2,address3,addressLine2,building_number,house_number,streetName;console.log(response,"logging response"),address=response,house_number="","string"==typeof address.buildingNumber?house_number=address.buildingNumber:null==address.buildingNumber&&(house_number=address.buildingName),"string"==typeof address.streetName?(streetName=address.streetName?address.streetName:"",$scope.bb.address1=house_number+" "+streetName):(addressLine2=address.addressLine2?address.addressLine2:"",$scope.bb.address1=house_number+" "+addressLine2),address.buildingName&&null==address.buildingNumber&&($scope.bb.address1=house_number,$scope.bb.address2=address.streetName,null!=address.county&&($scope.bb.address4=address.county)),"string"==typeof address.buildingNumber&&"string"==typeof address.buildingName&&"string"==typeof address.streetName&&(streetName=address.streetName?address.streetName:"",$scope.bb.address1=address.buildingName,$scope.bb.address2=address.buildingNumber+" "+streetName),null!=address.buildingName&&address.buildingName.match(/(^[^0-9]+$)/)&&(building_number=address.buildingNumber?address.buildingNumber:"",$scope.bb.address1=address.buildingName+" "+building_number,$scope.bb.address2=address.streetName),null==address.buildingNumber&&null==address.streetName&&($scope.bb.address1=address.buildingName,$scope.bb.address2=address.addressLine3,$scope.bb.address4=address.town),null!=address.companyName&&($scope.bb.address1=address.companyName,null==address.buildingNumber&&null==address.streetName?$scope.bb.address2=address.addressLine3:null==address.buildingNumber?(address2=address.buildingName?address.buildingName+", "+address.streetName:address.streetName,$scope.bb.address2=address2):$scope.bb.address2=null==address.buildingName&&null==address.addressLine2?address.buildingNumber+", "+address.streetName:address.buildingName,$scope.bb.address3=address.buildingName,address3=address.addressLine3&&null!=address.buildingNumber?address.addressLine3:null==address.addressLine2&&null!=address.buildingNumber?address.buildingNumber+" "+address.streetName:null==address.addressLine2&&null==address.buildingNumber&&null!=address.buildingName?address.addressLine3:"",$scope.bb.address3=address3,$scope.bb.address4=address.town,$scope.bb.address5="",$scope.bb.postcode=address.postCode),null==address.buildingName&&null==address.companyName&&null==address.county?(address2=null==address.addressLine2&&null==address.companyName?address.addressLine3:address.addressLine2,$scope.bb.address2=address2):null==address.buildingName&&null==address.companyName&&($scope.bb.address2=address.addressLine3),null!=address.buildingName&&null!=address.streetName&&null==address.companyName&&null!=address.addressLine3?$scope.bb.address3=null==address.addressLine3?address.buildingName:address.addressLine3:null==address.buildingName&&null==address.companyName&&null!=address.addressLine2?$scope.bb.address3=address.addressLine3:null==address.buildingName&&null!=address.streetName&&null==address.addressLine3&&($scope.bb.address3=address.addressLine3),$scope.bb.address4=address.town,null!=address.county&&($scope.bb.address5=address.county),$scope.setLoaded($scope)},function(err){return $scope.show_complete_address=!0,$scope.postcode_submitted=!1,$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):void 0},$scope.setManualPostcodeEntry=function(value){return $scope.manual_postcode_entry=value},$scope.$on("client_details:reset_search",function(){return $scope.bb.address1=null,$scope.bb.address2=null,$scope.bb.address3=null,$scope.bb.address4=null,$scope.bb.address5=null,$scope.show_complete_address=!1,$scope.postcode_submitted=!1,$scope.bb.address=$scope.addresses[0]})})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbWidget",function(PathSvc,$http,$templateCache,$compile,$q,AppConfig,$timeout,$bbug){var appendCustomPartials,getTemplate,renderTemplate,setupPusher,updatePartials;return getTemplate=function(){var src;return src=PathSvc.directivePartial("main").$$unwrapTrustedValue(),$http.get(src,{cache:$templateCache}).then(function(response){return response.data})},updatePartials=function(scope,element,prms){var i,_i,_len,_ref;for(_ref=element.children(),_i=0,_len=_ref.length;_len>_i;_i++)i=_ref[_i],$bbug(i).hasClass("custom_partial")&&$bbug(i).remove();return appendCustomPartials(scope,element,prms).then(function(){return scope.$broadcast("refreshPage")})},setupPusher=function(scope,element,prms){return $timeout(function(){return scope.pusher=new Pusher("c8d8cea659cc46060608"),scope.pusher_channel=scope.pusher.subscribe("widget_"+prms.design_id),scope.pusher_channel.bind("update",function(){return updatePartials(scope,element,prms)})})},appendCustomPartials=function(scope,element,prms){var defer;return defer=$q.defer(),$http.get(prms.custom_partial_url).then(function(custom_templates){return $compile(custom_templates.data)(scope,function(custom,scope){var non_style,style,tag;return custom.addClass("custom_partial"),style=function(){var _i,_len,_results;for(_results=[],_i=0,_len=custom.length;_len>_i;_i++)tag=custom[_i],"STYLE"===tag.tagName&&_results.push(tag);return _results}(),non_style=function(){var _i,_len,_results;for(_results=[],_i=0,_len=custom.length;_len>_i;_i++)tag=custom[_i],"STYLE"!==tag.tagName&&_results.push(tag);return _results}(),$bbug("#widget_"+prms.design_id).html(non_style),element.append(style),scope.bb.path_setup=!0,defer.resolve(style)})}),defer.promise},renderTemplate=function(scope,element,design_mode){return $q.when(getTemplate()).then(function(template){return element.html(template).show(),design_mode&&element.append("<style widget_css scoped></style>"),$compile(element.contents())(scope)})},{restrict:"A",scope:{client:"=?",apiUrl:"@?"},transclude:!0,controller:"BBCtrl",link:function(scope,element,attrs){var prms;return null!=attrs.member&&(scope.client=attrs.member),scope.initWidget(scope.$eval(attrs.bbWidget)),prms=scope.bb,prms.custom_partial_url&&(prms.design_id=prms.custom_partial_url.match(/^.*\/(.*?)$/)[1],$bbug("[ng-app='BB']").append("<div id='widget_"+prms.design_id+"'></div>")),scope.bb.partial_url&&(AppConfig.partial_url=scope.bb.partial_url),scope.has_content?prms.custom_partial_url?(appendCustomPartials(scope,element,prms),prms.update_design&&setupPusher(scope,element,prms),scope.$on("refreshPage",function(){return scope.showPage(scope.bb.current_page)})):void 0:(prms.custom_partial_url?appendCustomPartials(scope,element,prms).then(function(style){return $q.when(getTemplate()).then(function(template){return element.html(template).show(),$compile(element.contents())(scope),element.append(style),prms.update_design?setupPusher(scope,element,prms):void 0})}):renderTemplate(scope,element,prms.design_mode),scope.$on("refreshPage",function(){return renderTemplate(scope,element,prms.design_mode)}))}}}),angular.module("BB.Controllers").controller("bbContentController",function($scope){return $scope.controller="public.controllers.bbContentController",$scope.initPage=function(){return function(){return $scope.setPageLoaded(),$scope.setLoadingPage(!1)}}(this)}),angular.module("BB.Controllers").controller("BBCtrl",function($scope,$location,$rootScope,halClient,$window,$http,$localCache,$q,$timeout,BasketService,LoginService,AlertService,$sce,$element,$compile,$sniffer,$modal,BBModel,BBWidget,SSOService,ErrorService,AppConfig,QueryStringService,QuestionService,LocaleService,PurchaseService,$sessionStorage,$bbug){var con_started,first_call,restoreBasket,setupDefaults,widget_started,_base,_base1;return $scope.cid="BBCtrl",$scope.controller="public.controllers.BBCtrl",$scope.bb=new BBWidget,AppConfig.uid=$scope.bb.uid,$scope.qs=QueryStringService,$scope.has_content=0!==$element[0].children.length,$scope.apiUrl&&($rootScope.bb||($rootScope.bb={}),$rootScope.bb.api_url=$scope.apiUrl),$rootScope.bb&&$rootScope.bb.api_url&&($scope.bb.api_url=$rootScope.bb.api_url,$scope.bb.partial_url=$rootScope.bb.partial_url?$rootScope.bb.partial_url:""),80!==$location.port()&&443!==$location.port()?(_base=$scope.bb).api_url||(_base.api_url=$location.protocol()+"://"+$location.host()+":"+$location.port()):(_base1=$scope.bb).api_url||(_base1.api_url=$location.protocol()+"://"+$location.host()),$scope.bb.stacked_items=[],first_call=!0,con_started=$q.defer(),$rootScope.connection_started=con_started.promise,widget_started=$q.defer(),$rootScope.widget_started=widget_started.promise,moment.locale([LocaleService,"en"]),$rootScope.Route={Company:0,Category:1,Service:2,Person:3,Resource:4,Duration:5,Date:6,Time:7,Client:8,Summary:9,Basket:10,Checkout:11,Slot:12},$compile("<span bb-display-mode></span>")($scope,function(){return function(cloned){return $bbug($element).append(cloned)}}(this)),$scope.set_company=function(){return function(prms){return $scope.initWidget(prms)}}(this),$scope.initWidget=function(_this){return function(prms){var src,url;null==prms&&(prms={}),_this.$init_prms=prms,con_started=$q.defer(),$rootScope.connection_started=con_started.promise,!$sniffer.msie||$sniffer.msie>9||!first_call?$scope.initWidget2():(setTimeout($scope.initWidget2,2e3),prms.api_url&&(url=document.createElement("a"),url.href=prms.api_url,src=":"===url.protocol[url.protocol.length-1]?""+url.protocol+"//"+url.host+"/ClientProxy.html":""+url.protocol+"://"+url.host+"/ClientProxy.html",$compile("<iframe id='ieapiframefix' name='"+url.hostname+("' src='"+src+"' style='visibility:false;display:none;'></iframe>"))($scope,function(cloned){return $bbug($element).append(cloned)})),prms.partial_url&&prms.partial_url.indexOf("http")>=0&&(url=document.createElement("a"),url.href=prms.partial_url||prms.bb.partial_url,src=":"===url.protocol[url.protocol.length-1]?""+url.protocol+"//"+url.host+"/ClientProxy.html":""+url.protocol+"://"+url.host+"/ClientProxy.html",$compile("<iframe id='iepartialframefix' name='"+url.hostname+("' src='"+src+"' style='visibility:false;display:none;'></iframe>"))($scope,function(cloned){return $bbug($element).append(cloned)})))}}(this),$scope.initWidget2=function(_this){return function(){var aff_promise,comp_promise,company_id,embed_params,get_total,k,params,prms,setup_promises,setup_promises2,sso_admin_login,sso_member_login,total_id,v,_ref;if($scope.init_widget_started=!0,prms=_this.$init_prms,prms.query){_ref=prms.query;for(k in _ref)v=_ref[k],prms[k]=QueryStringService(v)}return prms.custom_partial_url?($scope.bb.custom_partial_url=prms.custom_partial_url,$scope.bb.partial_id=prms.custom_partial_url.substring(prms.custom_partial_url.lastIndexOf("/")+1),prms.update_design&&($scope.bb.update_design=prms.update_design)):prms.design_mode&&($scope.bb.design_mode=prms.design_mode),company_id=$scope.bb.company_id,prms.company_id&&(company_id=prms.company_id),prms.affiliate_id&&($scope.bb.affiliate_id=prms.affiliate_id,$rootScope.affiliate_id=prms.affiliate_id),prms.api_url&&($scope.bb.api_url=prms.api_url),prms.partial_url&&($scope.bb.partial_url=prms.partial_url),prms.page_suffix&&($scope.bb.page_suffix=prms.page_suffix),prms.admin&&($scope.bb.isAdmin=prms.admin),$scope.bb.app_id=1,$scope.bb.app_key=1,$scope.bb.clear_basket=!0,prms.basket&&($scope.bb.clear_basket=!1),prms.clear_basket===!1&&($scope.bb.clear_basket=!1),($window.bb_setup||prms.client)&&(prms.clear_member||(prms.clear_member=!0)),prms.client&&($scope.bb.client_defaults=prms.client),prms.clear_member&&($scope.bb.clear_member=prms.clear_member,$sessionStorage.removeItem("login")),prms.app_id&&($scope.bb.app_id=prms.app_id),prms.app_key&&($scope.bb.app_key=prms.app_key),prms.item_defaults&&($scope.bb.item_defaults=prms.item_defaults),prms.route_format&&($scope.bb.setRouteFormat(prms.route_format),$scope.bb_route_init&&$scope.bb_route_init()),prms.locale&&moment.locale(prms.locale),$scope.hide_page=prms.hide===!0?!0:!1,prms.custom_partial_url||($scope.bb.path_setup=!0),prms.reserve_without_questions&&($scope.bb.reserve_without_questions=prms.reserve_without_questions),prms.extra_setup&&prms.extra_setup.step&&($scope.bb.starting_step_number=parseInt(prms.extra_setup.step)),prms.extra_setup&&prms.extra_setup.return_url&&($scope.bb.return_url=prms.extra_setup.return_url),_this.waiting_for_conn_started_def=$q.defer(),$scope.waiting_for_conn_started=_this.waiting_for_conn_started_def.promise,company_id||$scope.bb.affiliate_id?$scope.waiting_for_conn_started=$rootScope.connection_started:_this.waiting_for_conn_started_def.resolve(),widget_started.resolve(),setup_promises2=[],setup_promises=[],$scope.bb.affiliate_id&&(aff_promise=halClient.$get($scope.bb.api_url+"/api/v1/affiliates/"+$scope.affiliate_id),setup_promises.push(aff_promise),aff_promise.then(function(affiliate){var comp_p,comp_promise;return $scope.bb.$wait_for_routing&&setup_promises2.push($scope.bb.$wait_for_routing.promise),$scope.setAffiliate(new BBModel.Affiliate(affiliate)),$scope.bb.item_defaults.affiliate=$scope.affiliate,prms.company_ref?(comp_p=$q.defer(),comp_promise=$scope.affiliate.getCompanyByRef(prms.company_ref),setup_promises2.push(comp_p.promise),comp_promise.then(function(company){return $scope.setCompany(company,prms.keep_basket).then(function(val){return comp_p.resolve(val)},function(err){return comp_p.reject(err)})},function(err){return comp_p.reject(err)})):void 0})),company_id&&(prms.embed&&(embed_params=prms.embed),embed_params||(embed_params={}),null!=$scope.bb.item_defaults.category&&(embed_params.category_id=null!=$scope.bb.item_defaults.category.id?$scope.bb.item_defaults.category.id:$scope.bb.item_defaults.category),comp_promise=halClient.$get(new UriTemplate.parse($scope.bb.api_url+"/api/v1/company/{company_id}{?embed}").expand({company_id:company_id,embed:embed_params})),prms.embed&&(embed_params=prms.embed),comp_promise=halClient.$get(null!=$scope.bb.item_defaults.category?null!=$scope.bb.item_defaults.category.id?new UriTemplate.parse($scope.bb.api_url+"/api/v1/company/{company_id}{?category_id}{&embed}").expand({company_id:company_id,category_id:$scope.bb.item_defaults.category.id,embed:embed_params}):new UriTemplate.parse($scope.bb.api_url+"/api/v1/company/{company_id}{?category_id}{&embed}").expand({company_id:company_id,category_id:$scope.bb.item_defaults.category,embed:embed_params}):new UriTemplate.parse($scope.bb.api_url+"/api/v1/company/{company_id}{?embed}").expand({company_id:company_id,embed:embed_params})),setup_promises.push(comp_promise),comp_promise.then(function(company){var child,comp,cprom,parent_company;return $scope.bb.$wait_for_routing&&setup_promises2.push($scope.bb.$wait_for_routing.promise),comp=new BBModel.Company(company),cprom=$q.defer(),setup_promises2.push(cprom.promise),child=null,comp.companies&&$scope.bb.item_defaults.company&&(child=comp.findChildCompany($scope.bb.item_defaults.company)),child?(parent_company=comp,halClient.$get($scope.bb.api_url+"/api/v1/company/"+child.id).then(function(company){return comp=new BBModel.Company(company),setupDefaults(comp.id),$scope.bb.parent_company=parent_company,$scope.setCompany(comp,prms.keep_basket).then(function(){return cprom.resolve()},function(){return cprom.reject()})},function(){return cprom.reject()})):(setupDefaults(comp.id),$scope.setCompany(comp,prms.keep_basket).then(function(){return cprom.resolve()},function(){return cprom.reject()}))}),prms.member_sso&&(params={company_id:company_id,root:$scope.bb.api_url,member_sso:prms.member_sso},sso_member_login=SSOService.memberLogin(params).then(function(client){return $scope.setClient(client)}),setup_promises.push(sso_member_login)),prms.admin_sso&&(params={company_id:prms.parent_company_id?prms.parent_company_id:company_id,root:$scope.bb.api_url,admin_sso:prms.admin_sso},sso_admin_login=SSOService.adminLogin(params).then(function(admin){return $scope.bb.admin=admin}),setup_promises.push(sso_admin_login)),total_id=QueryStringService("total_id"),total_id&&(params={purchase_id:total_id,url_root:$scope.bb.api_url},get_total=PurchaseService.query(params).then(function(total){return $scope.bb.total=total,total.paid>0?$scope.bb.payment_status="complete":void 0}),setup_promises.push(get_total))),$scope.isLoaded=!1,$q.all(setup_promises).then(function(){return $q.all(setup_promises2).then(function(){var clear_prom,def_clear,_base2;return $scope.bb.basket||(_base2=$scope.bb).basket||(_base2.basket=new BBModel.Basket(null,$scope.bb)),$scope.client||$scope.clearClient(),def_clear=$q.defer(),clear_prom=def_clear.promise,$scope.bb.current_item?def_clear.resolve():clear_prom=$scope.clearBasketItem(),clear_prom.then(function(){var page;return $scope.client_details||($scope.client_details=new BBModel.ClientDetails),$scope.bb.stacked_items||($scope.bb.stacked_items=[]),!$scope.bb.company&&!$scope.bb.affiliate||(con_started.resolve(),$scope.done_starting=!0,prms.no_route)?void 0:(page=null,first_call&&$bbug.isEmptyObject($scope.bb.routeSteps)&&(page=$scope.bb.firstStep),prms.first_page&&(page=prms.first_page),first_call=!1,$scope.decideNextPage(page))})},function(err){return con_started.reject("Failed to start widget"),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},function(err){return con_started.reject("Failed to start widget"),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),setupDefaults=function(){return function(company_id){var category,def,event,event_group,k,person,resource,service,v,_ref;if(def=$q.defer(),first_call){if($scope.bb.default_setup_promises=[],$scope.bb.item_defaults.query){_ref=$scope.bb.item_defaults.query;for(k in _ref)v=_ref[k],$scope.bb.item_defaults[k]=QueryStringService(v)}$scope.bb.item_defaults.resource&&(resource=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/resources/"+$scope.bb.item_defaults.resource),$scope.bb.default_setup_promises.push(resource),resource.then(function(res){return $scope.bb.item_defaults.resource=new BBModel.Resource(res)})),$scope.bb.item_defaults.person&&(person=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/people/"+$scope.bb.item_defaults.person),$scope.bb.default_setup_promises.push(person),person.then(function(res){return $scope.bb.item_defaults.person=new BBModel.Person(res)})),$scope.bb.item_defaults.service&&(service=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/services/"+$scope.bb.item_defaults.service),$scope.bb.default_setup_promises.push(service),service.then(function(res){return $scope.bb.item_defaults.service=new BBModel.Service(res)})),$scope.bb.item_defaults.service_ref&&(service=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/services?api_ref="+$scope.bb.item_defaults.service_ref),$scope.bb.default_setup_promises.push(service),service.then(function(res){return $scope.bb.item_defaults.service=new BBModel.Service(res)})),$scope.bb.item_defaults.event_group&&(event_group=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/event_groups/"+$scope.bb.item_defaults.event_group),$scope.bb.default_setup_promises.push(event_group),event_group.then(function(res){return $scope.bb.item_defaults.event_group=new BBModel.EventGroup(res)})),$scope.bb.item_defaults.event&&(event=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/events/"+$scope.bb.item_defaults.event),$scope.bb.default_setup_promises.push(event),event.then(function(res){return $scope.bb.item_defaults.event=new BBModel.Event(res)})),$scope.bb.item_defaults.category&&(category=halClient.$get($scope.bb.api_url+"/api/v1/"+company_id+"/categories/"+$scope.bb.item_defaults.category),$scope.bb.default_setup_promises.push(category),category.then(function(res){return $scope.bb.item_defaults.category=new BBModel.Category(res)})),$scope.bb.item_defaults.duration&&($scope.bb.item_defaults.duration=parseInt($scope.bb.item_defaults.duration)),$q.all($scope.bb.default_setup_promises)["finally"](function(){return def.resolve()})}else def.resolve();return def.promise}}(this),$scope.setLoadingPage=function(){return function(val){return $scope.loading_page=val}}(this),$scope.isLoadingPage=function(){return function(){return $scope.loading_page}}(this),$scope.$on("$locationChangeStart",function(){return function(){var step;if($scope.bb.routeFormat)return $scope.bb.routing||(step=$scope.bb.matchURLToStep(),step&&$scope.loadStep(step)),$scope.bb.routing=!1}}(this)),$scope.showPage=function(){return function(route,dont_record_page){return $scope.bb.updateRoute(route),$scope.jumped=!1,$scope.isLoadingPage()?void 0:($window._gaq&&$window._gaq.push(["_trackPageview",route]),$scope.setLoadingPage(!0),$scope.bb.current_page===route?($scope.bb_main="",setTimeout(function(){return $scope.bb_main=$sce.trustAsResourceUrl($scope.bb.pageURL(route)),$scope.$apply()},0)):(AlertService.clear(),$scope.bb.current_page=route,dont_record_page||$scope.bb.recordCurrentPage(),$scope.notLoaded($scope),$scope.bb_main=$sce.trustAsResourceUrl($scope.bb.pageURL(route))),$rootScope.$emit("page:loaded"))}}(this),$scope.jumpToPage=function(){return function(route){return $scope.current_page=route,$scope.jumped=!0,$scope.bb_main=$sce.trustAsResourceUrl($scope.partial_url+route+$scope.page_suffix)}}(this),$scope.clearPage=function(){return $scope.bb_main=""},$scope.getPartial=function(file){return $scope.bb.pageURL(file)},$scope.setPageLoaded=function(){return $scope.setLoaded($scope)},$scope.setPageRoute=function(){return function(route){return $scope.bb.current_page_route=route,$scope.bb.routeSteps&&$scope.bb.routeSteps[route]?($scope.showPage($scope.bb.routeSteps[route]),!0):!1}}(this),$scope.decideNextPage=function(route){if(route){if("none"===route)return;if(!$scope.bb.total||"complete"!==$scope.bb.payment_status)return $scope.showPage(route);$scope.showPage("payment_complete")}if($scope.bb.nextSteps&&$scope.bb.current_page&&$scope.bb.nextSteps[$scope.bb.current_page])return $scope.showPage($scope.bb.nextSteps[$scope.bb.current_page]);if(!$scope.client.valid()&&LoginService.isLoggedIn()&&($scope.client=new BBModel.Client(LoginService.member()._data)),$scope.bb.company&&$scope.bb.company.companies||!$scope.bb.company&&$scope.affiliate){if($scope.setPageRoute($rootScope.Route.Company))return;return $scope.showPage("company_list")}if($scope.bb.total&&"complete"===$scope.bb.payment_status)return $scope.showPage("payment_complete");if($scope.bb.company.$has("event_groups")&&!$scope.bb.current_item.event_group&&!$scope.bb.current_item.service&&!$scope.bb.current_item.product)return $scope.showPage("event_group_list");if($scope.bb.company.$has("events")&&$scope.bb.current_item.event_group&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product)return $scope.showPage("event_list");if($scope.bb.company.$has("events")&&$scope.bb.current_item.event&&!$scope.bb.current_item.num_book&&!$scope.bb.current_item.tickets&&!$scope.bb.current_item.product)return $scope.showPage("event");if($scope.bb.company.$has("services")&&!$scope.bb.current_item.service&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product){if($scope.setPageRoute($rootScope.Route.Service))return;return $scope.showPage("service_list")}if($scope.bb.company.$has("resources")&&!$scope.bb.current_item.resource&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product){if($scope.setPageRoute($rootScope.Route.Resource))return;return $scope.showPage("resource_list")}if($scope.bb.company.$has("people")&&!$scope.bb.current_item.person&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product){if($scope.setPageRoute($rootScope.Route.Person))return;return $scope.showPage("person_list")}if(!$scope.bb.current_item.duration&&null==$scope.bb.current_item.event&&!$scope.bb.current_item.product){if($scope.setPageRoute($rootScope.Route.Duration))return;return $scope.showPage("duration_list")}if($scope.bb.current_item.days_link&&!$scope.bb.current_item.date&&null==$scope.bb.current_item.event){if($scope.bb.company.$has("slots")){if($scope.setPageRoute($rootScope.Route.Slot))return;
return $scope.showPage("slot_list")}if($scope.setPageRoute($rootScope.Route.Date))return;return $scope.showPage("day")}if(!(!$scope.bb.current_item.days_link||$scope.bb.current_item.time||null!=$scope.bb.current_item.event||$scope.bb.current_item.service&&"day"===$scope.bb.current_item.service.duration_unit)){if($scope.setPageRoute($rootScope.Route.Time))return;return $scope.showPage("time")}if(!(!$scope.bb.moving_booking||$scope.bb.current_item.ready&&$scope.bb.current_item.move_done))return $scope.showPage("check_move");if(!$scope.client.valid()){if($scope.setPageRoute($rootScope.Route.Client))return;return $scope.showPage($scope.bb.isAdmin?"client_admin":"client")}if(!$scope.bb.basket.readyToCheckout()||!$scope.bb.current_item.ready){if($scope.setPageRoute($rootScope.Route.Summary))return;return $scope.showPage($scope.bb.isAdmin?"check_items_admin":"check_items")}if($scope.bb.usingBasket&&!$scope.bb.confirmCheckout){if($scope.setPageRoute($rootScope.Route.Basket))return;return $scope.showPage("basket")}if($scope.bb.moving_booking&&$scope.bb.basket.readyToCheckout())return $scope.showPage("move_done");if($scope.bb.basket.readyToCheckout()&&null===$scope.bb.payment_status){if($scope.setPageRoute($rootScope.Route.Checkout))return;return $scope.showPage("checkout")}return $scope.bb.total&&"pending"===$scope.bb.payment_status?$scope.showPage("payment"):"complete"===$scope.bb.payment_status?$scope.showPage("payment_complete"):void 0},$scope.showCheckout=function(){return $scope.bb.current_item.ready},$scope.addItemToBasket=function(){var add_defer;return add_defer=$q.defer(),$scope.bb.current_item.submitted||$scope.bb.moving_booking?add_defer.resolve():($scope.bb.current_item.submitted=!0,$scope.moveToBasket(),$scope.updateBasket().then(function(basket){return add_defer.resolve(basket)},function(err){return 409===err.status&&($scope.bb.current_item.person=null,$scope.bb.current_item.resource=null,$scope.bb.current_item.setTime(null),$scope.bb.current_item.service&&$scope.bb.current_item.setService($scope.bb.current_item.service)),$scope.bb.current_item.submitted=!1,add_defer.reject(err)})),add_defer.promise},$scope.updateBasket=function(){var add_defer,params;return add_defer=$q.defer(),params={member_id:$scope.client.id,member:$scope.client,items:$scope.bb.basket.items,bb:$scope.bb},BasketService.updateBasket($scope.bb.company,params).then(function(basket){var item,_i,_len,_ref;for(_ref=basket.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],item.storeDefaults($scope.bb.item_defaults),item.reserve_without_questions=$scope.bb.reserve_without_questions;return halClient.clearCache("time_data"),halClient.clearCache("events"),basket.setSettings($scope.bb.basket.settings),$scope.setBasket(basket),$scope.setBasketItem(basket.items[0]),$scope.bb.current_item?add_defer.resolve(basket):$scope.clearBasketItem().then(function(){return add_defer.resolve(basket)})},function(err){var error_modal;return add_defer.reject(err),409===err.status?(halClient.clearCache("time_data"),halClient.clearCache("events"),$scope.bb.current_item.person=null,$scope.bb.current_item.selected_person=null,error_modal=$modal.open({templateUrl:$scope.getPartial("error_modal"),controller:function($scope,$modalInstance){return $scope.message=ErrorService.getError("ITEM_NO_LONGER_AVAILABLE").msg,$scope.ok=function(){return $modalInstance.close()}}}),error_modal.result["finally"](function(){return $scope.bb.nextSteps?$scope.loadPreviousStep():$scope.decideNextPage()})):void 0}),add_defer.promise},$scope.emptyBasket=function(){return BasketService.empty($scope.bb).then(function(basket){return $scope.bb.current_item.id&&delete $scope.bb.current_item.id,$scope.setBasket(basket)})},$scope.deleteBasketItem=function(item){return BasketService.deleteItem(item,$scope.bb.company,{bb:$scope.bb}).then(function(basket){return $scope.setBasket(basket)})},$scope.clearBasketItem=function(){var def;return def=$q.defer(),$scope.setBasketItem(new BBModel.BasketItem(null,$scope.bb)),$scope.bb.current_item.reserve_without_questions=$scope.bb.reserve_without_questions,$scope.bb.default_setup_promises?$q.all($scope.bb.default_setup_promises)["finally"](function(){return $scope.bb.current_item.setDefaults($scope.bb.item_defaults),$q.all($scope.bb.current_item.promises)["finally"](function(){return def.resolve()})}):def.resolve(),def.promise},$scope.setBasketItem=function(item){return $scope.bb.current_item=item,$scope.current_item=$scope.bb.current_item},$scope.setReadyToCheckout=function(ready){return $scope.bb.confirmCheckout=ready},$scope.moveToBasket=function(){return $scope.bb.basket.addItem($scope.bb.current_item)},$scope.quickEmptybasket=function(options){var def,preserve_stacked_items;return preserve_stacked_items=options&&options.preserve_stacked_items?!0:!1,preserve_stacked_items?($scope.bb.basket=new BBModel.Basket(null,$scope.bb),$scope.basket=$scope.bb.basket,$scope.bb.basket.company_id=$scope.bb.company_id,def=$q.defer(),def.resolve(),def.promise):($scope.bb.stacked_items=[],$scope.setBasket(new BBModel.Basket(null,$scope.bb)),$scope.clearBasketItem())},$scope.setBasket=function(basket){return $scope.bb.basket=basket,$scope.basket=basket,$scope.bb.basket.company_id=$scope.bb.company_id,$scope.bb.stacked_items?$scope.bb.setStackedItems(basket.items):void 0},$scope.logout=function(route){return $scope.client&&$scope.client.valid()?LoginService.logout({root:$scope.bb.api_url}).then(function(){return $scope.client=new BBModel.Client,$scope.decideNextPage(route)}):$scope.member?LoginService.logout({root:$scope.bb.api_url}).then(function(){return $scope.member=new BBModel.Member.Member,$scope.decideNextPage(route)}):void 0},$scope.setAffiliate=function(affiliate){return $scope.bb.affiliate_id=affiliate.id,$scope.bb.affiliate=affiliate,$scope.affiliate=affiliate,$scope.affiliate_id=affiliate.id},restoreBasket=function(){var restore_basket_defer;return restore_basket_defer=$q.defer(),$scope.quickEmptybasket().then(function(){var auth_token,href,params,status,uri;return auth_token=$sessionStorage.getItem("auth_token"),href=$scope.bb.api_url+"/api/v1/status{?company_id,affiliate_id,clear_baskets,clear_member}",params={company_id:$scope.bb.company_id,affiliate_id:$scope.bb.affiliate_id,clear_baskets:$scope.bb.clear_basket?"1":null,clear_member:$scope.bb.clear_member?"1":null},uri=new $window.UriTemplate.parse(href).expand(params),status=halClient.$get(uri,{auth_token:auth_token,no_cache:!0}),status.then(function(){return function(res){return res.$has("client")&&res.$get("client").then(function(client){return $scope.client=new BBModel.Client(client)}),res.$has("member")&&res.$get("member").then(function(member){return LoginService.setLogin(member)}),$scope.bb.clear_basket?restore_basket_defer.resolve():res.$has("baskets")?res.$get("baskets").then(function(baskets){var basket;return basket=_.find(baskets,function(b){return b.company_id===$scope.bb.company_id}),basket?(basket=new BBModel.Basket(basket,$scope.bb),basket.$get("items").then(function(items){var i,promises,_i,_len;for(items=function(){var _i,_len,_results;for(_results=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],_results.push(new BBModel.BasketItem(i));return _results}(),_i=0,_len=items.length;_len>_i;_i++)i=items[_i],basket.addItem(i);return $scope.setBasket(basket),promises=[].concat.apply([],function(){var _j,_len1,_results;for(_results=[],_j=0,_len1=items.length;_len1>_j;_j++)i=items[_j],_results.push(i.promises);return _results}()),$q.all(promises).then(function(){return basket.items.length>0&&$scope.setBasketItem(basket.items[0]),restore_basket_defer.resolve()})})):restore_basket_defer.resolve()}):restore_basket_defer.resolve()}}(this),function(){return restore_basket_defer.resolve()})}),restore_basket_defer.promise},$scope.setCompany=function(company,keep_basket){var defer;return defer=$q.defer(),$scope.bb.company_id=company.id,$scope.bb.company=company,$scope.company=company,$scope.bb.item_defaults.company=$scope.bb.company,company.$has("settings")?company.getSettings().then(function(){return function(settings){return $scope.bb.company_settings=settings,$scope.bb.company_settings.merge_resources&&($scope.bb.item_defaults.merge_resources=!0),$scope.bb.company_settings.merge_people&&($scope.bb.item_defaults.merge_people=!0),$rootScope.bb_currency=$scope.bb.company_settings.currency,$scope.bb.currency=$scope.bb.company_settings.currency,$scope.bb.has_prices=$scope.bb.company_settings.has_prices,!$scope.bb.basket||$scope.bb.basket.company_id!==$scope.bb.company_id&&!keep_basket?restoreBasket().then(function(){return defer.resolve(),$scope.$emit("company:setup")}):(defer.resolve(),$scope.$emit("company:setup"))}}(this)):!$scope.bb.basket||$scope.bb.basket.company_id!==$scope.bb.company_id&&!keep_basket?restoreBasket().then(function(){return defer.resolve(),$scope.$emit("company:setup")}):(defer.resolve(),$scope.$emit("company:setup")),defer.promise},$scope.recordStep=function(step,title){return $scope.bb.recordStep(step,title)},$scope.setStepTitle=function(title){return $scope.bb.steps[$scope.bb.current_step-1].title=title},$scope.getCurrentStepTitle=function(){var steps;return steps=$scope.bb.steps,_.compact(steps).length||(steps=$scope.bb.allSteps),$scope.bb.current_step?steps[$scope.bb.current_step-1].title:void 0},$scope.checkStepTitle=function(title){return $scope.bb.steps[$scope.bb.current_step-1].title?void 0:$scope.setStepTitle(title)},$scope.loadStep=function(step){var prev_step,st,_i,_len,_ref;if(step!==$scope.bb.current_step&&($scope.bb.calculatePercentageComplete(step),st=$scope.bb.steps[step],prev_step=$scope.bb.steps[step-1],st&&!prev_step&&(prev_step=st),st||(st=prev_step),st&&!$scope.bb.last_step_reached&&(st.stacked_length&&0!==st.stacked_length||($scope.bb.stacked_items=[]),$scope.bb.current_item.loadStep(st.current_item),$scope.bb.steps.splice(step,$scope.bb.steps.length-step),$scope.bb.current_step=step,$scope.showPage(prev_step.page,!0)),$scope.bb.allSteps)){for(_ref=$scope.bb.allSteps,_i=0,_len=_ref.length;_len>_i;_i++)step=_ref[_i],step.active=!1,step.passed=step.number<$scope.bb.current_step;if($scope.bb.allSteps[$scope.bb.current_step-1])return $scope.bb.allSteps[$scope.bb.current_step-1].active=!0}},$scope.loadPreviousStep=function(){var previousStep;return previousStep=$scope.bb.current_step-1,$scope.loadStep(previousStep)},$scope.loadStepByPageName=function(page_name){var step,_i,_len,_ref;for(_ref=$scope.bb.allSteps,_i=0,_len=_ref.length;_len>_i;_i++)if(step=_ref[_i],step.page===page_name)return $scope.loadStep(step.number);return $scope.loadStep(1)},$scope.restart=function(){return $scope.bb.last_step_reached=!1,$scope.loadStep(1)},$scope.setRoute=function(rdata){return $scope.bb.setRoute(rdata)},$scope.setBasicRoute=function(routes){return $scope.bb.setBasicRoute(routes)},$scope.skipThisStep=function(){return $scope.bb.current_step-=1},$scope.setUsingBasket=function(){return function(usingBasket){return $scope.bb.usingBasket=usingBasket}}(this),$scope.setClient=function(){return function(client){return $scope.client=client,client.postcode&&!$scope.bb.postcode?$scope.bb.postcode=client.postcode:void 0}}(this),$scope.clearClient=function(){return function(){return $scope.client=new BBModel.Client,$window.bb_setup&&$scope.client.setDefaults($window.bb_setup),$scope.bb.client_defaults?$scope.client.setDefaults($scope.bb.client_defaults):void 0}}(this),$scope.today=moment().toDate(),$scope.tomorrow=moment().add(1,"days").toDate(),$scope.parseDate=function(){return function(d){return moment(d)}}(this),$scope.getUrlParam=function(){return function(param){return $window.getURIparam(param)}}(this),$scope.base64encode=function(){return function(param){return $window.btoa(param)}}(this),$scope.setLastSelectedDate=function(){return function(date){return $scope.last_selected_date=date}}(this),$scope.setLoaded=function(cscope){var loadingFinished;for(cscope.$emit("hide:loader",cscope),cscope.isLoaded=!0,loadingFinished=!0;cscope;)cscope.hasOwnProperty("scopeLoaded")&&($scope.areScopesLoaded(cscope)?cscope.scopeLoaded=!0:loadingFinished=!1),cscope=cscope.$parent;loadingFinished&&$rootScope.$emit("loading:finished")},$scope.setLoadedAndShowError=function(scope){return scope.setLoaded(scope),AlertService.danger(ErrorService.getError("GENERIC"))},$scope.areScopesLoaded=function(cscope){var child;if(cscope.hasOwnProperty("isLoaded")&&!cscope.isLoaded)return!1;for(child=cscope.$$childHead;child;){if(!$scope.areScopesLoaded(child))return!1;child=child.$$nextSibling}return!0},$scope.notLoaded=function(cscope){for($scope.$emit("show:loader",$scope),cscope.isLoaded=!1;cscope;)cscope.hasOwnProperty("scopeLoaded")&&(cscope.scopeLoaded=!1),cscope=cscope.$parent},$scope.broadcastItemUpdate=function(){return function(){return $scope.$broadcast("currentItemUpdate",$scope.bb.current_item)}}(this),$scope.hidePage=function(){return $scope.hide_page=!0},$scope.bb.company_set=function(){return null!=$scope.bb.company_id},$scope.isAdmin=function(){return $scope.bb.isAdmin},$scope.isAdminIFrame=function(){var err,location;if(!$scope.bb.isAdmin)return!1;try{return location=$window.parent.location.href,location&&$window.parent.reload_dashboard?!0:!1}catch(_error){return err=_error,!1}},$scope.reloadDashboard=function(){return $window.parent.reload_dashboard()},$scope.$debounce=function(tim){return $scope._debouncing?!1:(tim||(tim=100),$scope._debouncing=!0,$timeout(function(){return $scope._debouncing=!1},tim))},$scope.supportsTouch=function(){return Modernizr.touch},$rootScope.$on("show:loader",function(){return $scope.loading=!0}),$rootScope.$on("hide:loader",function(){return $scope.loading=!1}),String.prototype.parameterise=function(seperator){return null==seperator&&(seperator="-"),this.trim().replace(/\s/g,seperator).toLowerCase()}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbMiniBasket",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"MiniBasket"}}),angular.module("BB.Controllers").controller("MiniBasket",function($scope,$rootScope){return $scope.controller="public.controllers.MiniBasket",$scope.setUsingBasket(!0),$rootScope.connection_started.then(function(){return function(){}}(this)),$scope.basketDescribe=function(){return function(nothing,single,plural){return $scope.bb.basket&&0!==$scope.bb.basket.length()?1===$scope.bb.basket.length()?single:plural.replace("$0",$scope.bb.basket.length()):nothing}}(this)}),angular.module("BB.Directives").directive("bbBasketList",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"BasketList"}}),angular.module("BB.Controllers").controller("BasketList",function($scope,$rootScope,BasketService,$q,AlertService){return $scope.controller="public.controllers.BasketList",$scope.setUsingBasket(!0),$scope.items=$scope.bb.basket.items,$scope.$watch("basket",function(){return function(){return $scope.items=$scope.bb.basket.items}}(this)),$scope.addAnother=function(){return function(route){return $scope.clearBasketItem(),$scope.bb.current_item.setCompany($scope.bb.company),$scope.decideNextPage(route)}}(this),$scope.checkout=function(){return function(route){return $scope.setReadyToCheckout(!0),$scope.decideNextPage(route)}}(this),$scope.applyCoupon=function(){return function(coupon){var params;return params={bb:$scope.bb,coupon:coupon},BasketService.applyCoupon($scope.bb.company,params).then(function(basket){var item,_i,_len,_ref;for(_ref=basket.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],item.storeDefaults($scope.bb.item_defaults),item.reserve_without_questions=$scope.bb.reserve_without_questions;return basket.setSettings($scope.bb.basket.settings),$scope.setBasket(basket)},function(err){return err&&err.data&&err.data.error&&(AlertService.clear(),AlertService.add("danger",{msg:err.data.error})),console.log(err)})}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbCategories",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CategoryList"}}),angular.module("BB.Controllers").controller("CategoryList",function($scope,$rootScope,CategoryService,$q,PageControllerService){return $scope.controller="public.controllers.CategoryList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$rootScope.connection_started.then(function(){return function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(){return function(comp){return CategoryService.query(comp).then(function(items){return $scope.items=items,1===items.length&&($scope.skipThisStep(),$rootScope.categories=items,$scope.selectItem(items[0],$scope.nextRoute)),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.selectItem=function(){return function(item,route){return $scope.bb.current_item.setCategory(item),$scope.decideNextPage(route)}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbCheckout",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Checkout"}}),angular.module("BB.Controllers").controller("Checkout",function($scope,$rootScope,BasketService,$q,$location,$window,FormDataStoreService){return $scope.controller="public.controllers.Checkout",$scope.notLoaded($scope),FormDataStoreService.destroy($scope),$rootScope.connection_started.then(function(){return function(){var loading_total_def;return $scope.bb.basket.setClient($scope.client),loading_total_def=$q.defer(),$scope.loadingTotal=BasketService.checkout($scope.bb.company,$scope.bb.basket,{bb:$scope.bb}),$scope.loadingTotal.then(function(total){return $scope.total=total,total.$has("new_payment")?$scope.checkStepTitle("Review"):($scope.checkStepTitle("Confirmed"),$scope.$emit("processDone")),$scope.checkoutSuccess=!0,$scope.setLoaded($scope)},function(){return $scope.setLoaded($scope),$scope.checkoutFailed=!0})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.print=function(){return function(){return $window.open($scope.bb.partial_url+"print_purchase.html?id="+$scope.total.long_id,"_blank","width=700,height=500,toolbar=0,menubar=0,location=0,status=1,scrollbars=1,resizable=1,left=0,top=0"),!0}}(this)})}.call(this),function(){angular.module("BB.Directives").directive("bbClientDetails",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ClientDetails"}}),angular.module("BB.Controllers").controller("ClientDetails",function($scope,$rootScope,ClientDetailsService,ClientService,LoginService,BBModel,ValidatorService,QuestionService){return $scope.controller="public.controllers.ClientDetails",$scope.notLoaded($scope),$scope.validator=ValidatorService,$rootScope.connection_started.then(function(){return function(){return!$scope.client.valid()&&LoginService.isLoggedIn()&&$scope.setClient(new BBModel.Client(LoginService.member()._data)),LoginService.isLoggedIn()&&LoginService.member().$has("child_clients")&&LoginService.member()&&LoginService.member().getChildClientsPromise().then(function(children){return $scope.bb.parent_client=new BBModel.Client(LoginService.member()._data),$scope.bb.child_clients=children,$scope.bb.basket.parent_client_id=$scope.bb.parent_client.id}),$scope.client.client_details?($scope.client_details=$scope.client.client_details,$scope.client_details.questions&&QuestionService.checkConditionalQuestions($scope.client_details.questions),$scope.setLoaded($scope)):ClientDetailsService.query($scope.bb.company).then(function(details){return $scope.client_details=details,$scope.client_details.questions&&QuestionService.checkConditionalQuestions($scope.client_details.questions),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$rootScope.$watch("member",function(){return function(){return!$scope.client.valid()&&LoginService.isLoggedIn()?$scope.setClient(new BBModel.Client(LoginService.member()._data)):void 0}}(this)),$scope.validateClient=function(){return function(client_form,route){return $scope.notLoaded($scope),$scope.bb&&$scope.bb.parent_client&&($scope.client.parent_client_id=$scope.bb.parent_client.id),$scope.client.setClientDetails($scope.client_details),ClientService.create_or_update($scope.bb.company,$scope.client).then(function(client){return $scope.setLoaded($scope),$scope.setClient(client),$scope.bb.isAdmin&&$scope.client.setValid(!0),$scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.clientLogin=function(){return function(){return $scope.login?LoginService.companyLogin($scope.bb.company,{},{email:$scope.login.email,password:$scope.login.password}).then(function(client){return $scope.setClient(new BBModel.Client(client)),$scope.decideNextPage()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):void 0}}(this),$scope.setReady=function(){return function(){return $scope.client.setClientDetails($scope.client_details),ClientService.create_or_update($scope.bb.company,$scope.client).then(function(client){return $scope.setLoaded($scope),$scope.setClient(client),client.waitingQuestions?client.gotQuestions.then(function(){return $scope.client_details=client.client_details}):void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),!0}}(this),$scope.clientSearch=function(){return null!=$scope.client&&null!=$scope.client.email&&""!==$scope.client.email?($scope.notLoaded($scope),ClientService.query_by_email($scope.bb.company,$scope.client.email).then(function(client){return null!=client&&($scope.setClient(client),$scope.client=client),$scope.setLoaded($scope)},function(){return $scope.setLoaded($scope)})):($scope.setClient({}),$scope.client={})},$scope.switchNumber=function(to){return $scope.no_mobile=!$scope.no_mobile,"mobile"===to?($scope.bb.basket.setSettings({send_sms_reminder:!0}),$scope.client.phone=null):($scope.bb.basket.setSettings({send_sms_reminder:!1}),$scope.client.mobile=null)},$scope.getQuestion=function(id){var question,_i,_len,_ref;for(_ref=$scope.client_details.questions,_i=0,_len=_ref.length;_len>_i;_i++)if(question=_ref[_i],question.id===id)return question;return null},$scope.useClient=function(client){return $scope.setClient(client)},$scope.recalc_question=function(){return $scope.client_details.questions?QuestionService.checkConditionalQuestions($scope.client_details.questions):void 0}})}.call(this),function(){"use strict";var CompanyListBase;CompanyListBase=function($scope,$rootScope,$q,$attrs){var options;return $scope.controller="public.controllers.CompanyList",$scope.notLoaded($scope),options=$scope.$eval($attrs.bbCompanies),$rootScope.connection_started.then(function(){return function(){if($scope.bb.company.companies)$scope.init($scope.bb.company),$rootScope.parent_id=$scope.bb.company.id;else if($rootScope.parent_id)return void $scope.initWidget({company_id:$rootScope.parent_id,first_page:$scope.bb.current_page});return $scope.bb.company?$scope.init($scope.bb.company):void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(){return function(){return $scope.companies=$scope.bb.company.companies,$scope.companies&&0!==$scope.companies.length||($scope.companies=[$scope.bb.company]),1===$scope.companies.length?$scope.selectItem($scope.companies[0]):$scope.items=options&&options.hide_not_live_stores?$scope.companies.filter(function(c){return c.live}):$scope.companies,$scope.setLoaded($scope)}}(this),$scope.selectItem=function(){return function(item){var prms;return $scope.notLoaded($scope),prms={company_id:item.id},$scope.initWidget(prms)}}(this),$scope.splitString=function(company){var arr,result;return arr=company.name.split(" "),result=arr[2]?arr[2]:""}},angular.module("BB.Directives").directive("bbCompanies",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CompanyList"}}),angular.module("BB.Controllers").controller("CompanyList",CompanyListBase),angular.module("BB.Directives").directive("bbPostcodeLookup",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PostcodeLookup"}}),angular.module("BB.Controllers").controller("PostcodeLookup",function($scope,$rootScope,$q,ValidatorService,AlertService,$attrs){return $scope.controller="PostcodeLookup",angular.extend(this,new CompanyListBase($scope,$rootScope,$q,$attrs)),$scope.validator=ValidatorService,$scope.searchPostcode=function(){return function(form,prms){var promise;return $scope.notLoaded($scope),promise=ValidatorService.validatePostcode(form,prms),promise?promise.then(function(){var loc;return $scope.bb.postcode=ValidatorService.getGeocodeResult().address_components[0].short_name,$scope.postcode=$scope.bb.postcode,loc=ValidatorService.getGeocodeResult().geometry.location,$scope.selectItem($scope.getNearestCompany({center:loc}))},function(){return $scope.setLoaded($scope)}):$scope.setLoaded($scope)}}(this),$scope.getNearestCompany=function(){return function(_arg){var R,a,c,center,chLat,chLon,company,d,dLat,dLon,distances,lat1,lat2,latlong,lon1,lon2,pi,rLat1,rLat2,_i,_len,_ref;for(center=_arg.center,pi=Math.PI,R=6371,distances=[],lat1=center.lat(),lon1=center.lng(),_ref=$scope.items,_i=0,_len=_ref.length;_len>_i;_i++)company=_ref[_i],company.address.lat&&company.address.long&&company.live&&(latlong=new google.maps.LatLng(company.address.lat,company.address.long),lat2=latlong.lat(),lon2=latlong.lng(),chLat=lat2-lat1,chLon=lon2-lon1,dLat=chLat*(pi/180),dLon=chLon*(pi/180),rLat1=lat1*(pi/180),rLat2=lat2*(pi/180),a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.sin(dLon/2)*Math.sin(dLon/2)*Math.cos(rLat1)*Math.cos(rLat2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c,company.distance=d,distances.push(company)),distances.sort(function(a,b){return a.distance-b.distance});return distances[0]}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbCustomBookingText",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CustomBookingText"}}),angular.module("BB.Controllers").controller("CustomBookingText",function($scope,$rootScope,CustomTextService){return $scope.controller="public.controllers.CustomBookingText",$scope.notLoaded($scope),$rootScope.connection_started.then(function(){return function(){return CustomTextService.BookingText($scope.bb.company,$scope.bb.current_item).then(function(msgs){return $scope.messages=msgs,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}),angular.module("BB.Directives").directive("bbCustomConfirmationText",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"CustomConfirmationText"}}),angular.module("BB.Controllers").controller("CustomConfirmationText",function($scope,$rootScope,CustomTextService){return $scope.controller="public.controllers.CustomConfirmationText",$scope.notLoaded($scope),$rootScope.connection_started.then(function(){return $scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loadData=function(){return function(){return $scope.total?CustomTextService.confirmationText($scope.bb.company,$scope.total).then(function(msgs){return $scope.messages=msgs,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.loadingTotal?$scope.loadingTotal.then(function(total){return CustomTextService.confirmationText($scope.bb.company,total).then(function(msgs){return $scope.messages=msgs,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.setLoaded($scope)}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbMonthAvailability",function(){return{restrict:"A",replace:!0,scope:!0,controller:"DayList"}}),angular.module("BB.Controllers").controller("DayList",function($scope,$rootScope,$q,DayService){return $scope.controller="public.controllers.DayList",$scope.notLoaded($scope),$scope.WeekHeaders=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],$scope.day_data={},$scope.type||($scope.type="month"),$scope.data_source||($scope.data_source=$scope.bb.current_item),$rootScope.connection_started.then(function(){return function(){return!$scope.current_date&&$scope.last_selected_date?$scope.current_date=$scope.last_selected_date.startOf($scope.type):$scope.current_date||($scope.current_date=moment().startOf($scope.type)),$scope.loadData()}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.$on("currentItemUpdate",function(){return $scope.loadData()}),$scope.setCalType=function(){return function(type){return $scope.type=type}}(this),$scope.setDataSource=function(){return function(source){return $scope.data_source=source}}(this),$scope.format_date=function(){return function(fmt){return $scope.current_date?$scope.current_date.format(fmt):void 0}}(this),$scope.format_start_date=function(){return function(fmt){return $scope.format_date(fmt)}}(this),$scope.format_end_date=function(){return function(fmt){return $scope.end_date?$scope.end_date.format(fmt):void 0}}(this),$scope.selectDay=function(){return function(day,route,force){return 0!==day.spaces||force?($scope.setLastSelectedDate(day.date),$scope.bb.current_item.setDate(day),$scope.decideNextPage(route)):!1}}(this),$scope.setMonth=function(){return function(month,year){return $scope.current_date=moment().startOf("month").year(year).month(month-1),$scope.current_date.year(),$scope.type="month"}}(this),$scope.setWeek=function(){return function(week,year){return $scope.current_date=moment().year(year).isoWeek(week).startOf("week"),$scope.current_date.year(),$scope.type="week"}}(this),$scope.add=function(){return function(type,amount){return $scope.current_date.add(amount,type),$scope.loadData()}}(this),$scope.subtract=function(){return function(type,amount){return $scope.add(type,-amount)}}(this),$scope.isPast=function(){return function(){return $scope.current_date?moment().isAfter($scope.current_date):!0}}(this),$scope.loadData=function(){return function(){return"week"===$scope.type?$scope.loadWeek():$scope.loadMonth()}}(this),$scope.loadMonth=function(){return function(){var date,edate;return date=$scope.current_date,$scope.month=date.month(),$scope.notLoaded($scope),edate=moment(date).add(1,"months"),$scope.end_date=moment(edate).add(-1,"days"),$scope.data_source?DayService.query({company:$scope.bb.company,cItem:$scope.data_source,month:date.format("MMYY"),client:$scope.client}).then(function(days){var d,day,w,week,weeks,_i,_j,_k,_len;for($scope.days=days,_i=0,_len=days.length;_len>_i;_i++)day=days[_i],$scope.day_data[day.string_date]=day;for(weeks=[],w=_j=0;5>=_j;w=++_j){for(week=[],d=_k=0;6>=_k;d=++_k)week.push(days[7*w+d]);weeks.push(week)}return $scope.weeks=weeks,$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.setLoaded($scope)}}(this),$scope.loadWeek=function(){return function(){var date,edate;return date=$scope.current_date,$scope.notLoaded($scope),edate=moment(date).add(7,"days"),$scope.end_date=moment(edate).add(-1,"days"),$scope.data_source?DayService.query({company:$scope.bb.company,cItem:$scope.data_source,date:date.toISODate(),edate:edate.toISODate(),client:$scope.client}).then(function(days){var day,_i,_len;for($scope.days=days,_i=0,_len=days.length;_len>_i;_i++)day=days[_i],$scope.day_data[day.string_date]=day;
return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):$scope.setLoaded($scope)}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbDurations",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"DurationList"}}),angular.module("BB.Controllers").controller("DurationList",function($scope,$rootScope,PageControllerService,$q,$attrs){return $scope.controller="public.controllers.DurationList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$rootScope.connection_started.then(function(){return $scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loadData=function(){return function(){var d,duration,id,initial_duration,rem,service,_i,_len,_ref;if(id=$scope.bb.company_id,service=$scope.bb.current_item.service,service&&!$scope.durations){for($scope.durations=function(){var _i,_len,_ref,_results;for(_ref=_.zip(service.durations,service.prices),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)d=_ref[_i],_results.push({value:d[0],price:d[1]});return _results}(),initial_duration=$scope.$eval($attrs.bbInitialDuration),_ref=$scope.durations,_i=0,_len=_ref.length;_len>_i;_i++)duration=_ref[_i],$scope.bb.current_item.duration&&duration.value===$scope.bb.current_item.duration?$scope.duration=duration:initial_duration&&initial_duration===duration.value&&($scope.duration=duration,$scope.bb.current_item.setDuration(duration.value)),duration.value<60?duration.pretty=duration.value+" minutes":60===duration.value?duration.pretty="1 hour":(duration.pretty=Math.floor(duration.value/60)+" hours",rem=duration.value%60,0!==rem&&(duration.pretty+=" "+rem+" minutes"));1===$scope.durations.length&&($scope.skipThisStep(),$scope.selectDuration($scope.durations[0],$scope.nextRoute))}return $scope.setLoaded($scope)}}(this),$scope.selectDuration=function(){return function(dur,route){return $scope.$parent.$has_page_control?($scope.duration=dur,!1):($scope.bb.current_item.setDuration(dur.value),$scope.decideNextPage(route),!0)}}(this),$scope.durationChanged=function(){return function(){return $scope.bb.current_item.setDuration($scope.duration.value),$scope.broadcastItemUpdate()}}(this),$scope.setReady=function(){return function(){return $scope.duration?($scope.bb.current_item.setDuration($scope.duration.value),!0):!0}}(this),$scope.$on("currentItemUpdate",function(){return $scope.loadData()})})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbEvent",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Event"}}),angular.module("BB.Controllers").controller("Event",function($scope,$rootScope,EventService,$q,PageControllerService,BBModel){return $scope.controller="public.controllers.Event",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$rootScope.connection_started.then(function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(){return $scope.event=$scope.bb.current_item.event,$scope.event.prepEvent().then(function(){return function(){var ticket,_i,_len,_ref;for(_ref=$scope.event.tickets,_i=0,_len=_ref.length;_len>_i;_i++)ticket=_ref[_i],ticket.qty=0;return $scope.setLoaded($scope)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.selectTickets=function(){var base_item,c,item,ticket,_i,_j,_len,_ref,_ref1;for($scope.notLoaded($scope),$scope.bb.emptyStackedItems(),$scope.setBasket(new BBModel.Basket(null,$scope.bb)),base_item=$scope.current_item,_ref=$scope.event.tickets,_i=0,_len=_ref.length;_len>_i;_i++)if(ticket=_ref[_i],ticket.qty&&"single_space"===$scope.event.chain.ticket_type)for(c=_j=1,_ref1=ticket.qty;_ref1>=1?_ref1>=_j:_j>=_ref1;c=_ref1>=1?++_j:--_j)item=new BBModel.BasketItem,angular.extend(item,base_item),item.tickets=angular.copy(ticket),item.tickets.qty=1,$scope.bb.stackItem(item);return 0===$scope.bb.stacked_items.length?void $scope.setLoaded($scope):($scope.bb.pushStackToBasket(),$scope.updateBasket().then(function(){return function(){return $scope.setLoaded($scope),$scope.selected_tickets=!0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}))},$scope.selectItem=function(){return function(item,route){return $scope.$parent.$has_page_control?($scope.event=item,!1):($scope.bb.current_item.setEvent(item),$scope.bb.current_item.ready=!1,$scope.decideNextPage(route),!0)}}(this),$scope.setReady=function(){return function(){}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbEventGroups",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"EventGroupList",link:function(scope,element,attrs){attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem)),attrs.bbShowAll&&(scope.show_all=!0)}}}),angular.module("BB.Controllers").controller("EventGroupList",function($scope,$rootScope,$q,$attrs,ItemService,FormDataStoreService,ValidatorService,PageControllerService){var setEventGroupItem;return $scope.controller="public.controllers.EventGroupList",FormDataStoreService.init("EventGroupList",$scope,["event_group"]),$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.validator=ValidatorService,$rootScope.connection_started.then(function(){return function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(comp){var ppromise;return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),ppromise=comp.getEventGroupsPromise(),ppromise.then(function(items){var filterItems,item,_i,_j,_len,_len1;if(filterItems="false"===$attrs.filterServices?!1:!0,filterItems&&($scope.booking_item.service_ref&&!$scope.show_all?items=items.filter(function(x){return x.api_ref===$scope.booking_item.service_ref}):$scope.booking_item.category&&!$scope.show_all&&(items=items.filter(function(x){return x.$has("category")&&x.$href("category")===$scope.booking_item.category.self}))),1!==items.length||$scope.allowSinglePick?setEventGroupItem(items):$scope.selectItem(items[0],$scope.nextRoute)?$scope.skipThisStep():setEventGroupItem(items),$scope.booking_item.defaultService())for(_i=0,_len=items.length;_len>_i;_i++)item=items[_i],item.self===$scope.booking_item.defaultService().self&&$scope.selectItem(item,$scope.nextRoute);if($scope.booking_item.event_group)for(_j=0,_len1=items.length;_len1>_j;_j++)item=items[_j],item.selected=!1,item.self===$scope.booking_item.event_group.self&&($scope.event_group=item,item.selected=!0,$scope.booking_item.setEventGroup($scope.event_group));return $scope.setLoaded($scope),$scope.booking_item.event_group||!$scope.booking_item.person&&!$scope.booking_item.resource?$scope.bookable_services=$scope.items:void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},setEventGroupItem=function(items){return $scope.items=items,$scope.event_group?_.each(items,function(item){return item.id===$scope.event_group.id?$scope.event_group=item:void 0}):void 0},$scope.selectItem=function(){return function(item,route){return $scope.$parent.$has_page_control?($scope.event_group=item,!1):($scope.booking_item.setEventGroup(item),$scope.decideNextPage(route),!0)}}(this),$scope.$watch("event_group",function(){return function(){return!$scope.event_group||$scope.booking_item.event_group&&$scope.booking_item.event_group.self===$scope.event_group.self?void 0:($scope.booking_item.setEventGroup($scope.event_group),$scope.broadcastItemUpdate())}}(this)),$scope.setReady=function(){return function(){return $scope.event_group?($scope.booking_item.setEventGroup($scope.event_group),!0):!1}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbEvents",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"EventList",link:function(scope,element,attrs){scope.summary=attrs.summary}}}),angular.module("BB.Controllers").controller("EventList",function($scope,$rootScope,EventService,$q,PageControllerService,FormDataStoreService){return $scope.controller="public.controllers.EventList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.pick={},$scope.start_date=moment(),$scope.end_date=moment().add(1,"year"),FormDataStoreService.init("EventList",$scope,["selected_date","event_group_id"]),$rootScope.connection_started.then(function(){return $scope.bb.company?$scope.summary?$scope.getSummary():$scope.init():void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.fully_booked=!1,$scope.getSummary=function(){var comp,current_event,params;return current_event=$scope.current_item.event,$scope.current_item.event&&(delete $scope.current_item.event,delete $scope.current_item.event_chain),$scope.notLoaded($scope),comp=$scope.bb.company,params={item:$scope.bb.current_item,start_date:$scope.start_date.toISODate(),end_date:$scope.end_date.toISODate()},EventService.summary(comp,params).then(function(items){var d,item,item_dates,_i,_len;if(items&&items.length>0){for(item_dates=[],_i=0,_len=items.length;_len>_i;_i++)item=items[_i],d=moment(item),item_dates.push({date:d,idate:parseInt(d.format("YYYYDDDD")),count:1,spaces:1,today:moment().isSame(d,"day")});$scope.item_dates=item_dates.sort(function(a,b){return a.idate-b.idate}),null!=$scope.current_item&&null!=$scope.current_item.event_group&&($scope.current_item.event_group.id!==$scope.event_group_id&&$scope.showDate($scope.item_dates[0].date),$scope.event_group_id=$scope.current_item.event_group.id),$scope.showDate($scope.selected_date&&($scope.selected_date.isAfter($scope.item_dates[0].date)||$scope.selected_date.isSame($scope.item_dates[0].date))&&($scope.selected_date.isBefore($scope.item_dates[$scope.item_dates.length-1].date)||$scope.selected_date.isSame($scope.item_dates[$scope.item_dates.length-1].date))?$scope.selected_date:$scope.item_dates[0].date)}return $scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.init=function(comp){var current_event,params;return current_event=$scope.current_item.event,$scope.current_item.event&&(delete $scope.current_item.event,delete $scope.current_item.event_chain),$scope.notLoaded($scope),comp||(comp=$scope.bb.company),params={item:$scope.bb.current_item,start_date:$scope.start_date.toISODate(),end_date:$scope.end_date.toISODate()},EventService.query(comp,params).then(function(items){var full_events,idate,item,item_dates,x,y,_i,_j,_k,_len,_len1,_len2,_ref;for($scope.items=items,_ref=$scope.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],item.prepEvent(),current_event&&current_event.self===item.self&&(item.select(),$scope.event=item);if(!$scope.summary){if(item_dates={},items.length>0){for(_j=0,_len1=items.length;_len1>_j;_j++)item=items[_j],item.getDuration(),idate=parseInt(item.date.format("YYYYDDDD")),item.idate=idate,item_dates[idate]||(item_dates[idate]={date:item.date,idate:idate,count:0,spaces:0}),item_dates[idate].count+=1,item_dates[idate].spaces+=item.num_spaces;$scope.item_dates=[];for(x in item_dates)y=item_dates[x],$scope.item_dates.push(y);$scope.item_dates=$scope.item_dates.sort(function(a,b){return a.idate-b.idate})}else idate=parseInt($scope.start_date.format("YYYYDDDD")),$scope.item_dates=[{date:$scope.start_date,idate:idate,count:0,spaces:0}];null!=$scope.current_item&&null!=$scope.current_item.event_group&&($scope.current_item.event_group.id!==$scope.event_group_id&&$scope.showDate($scope.item_dates[0].date),$scope.event_group_id=$scope.current_item.event_group.id),$scope.showDate($scope.selected_date&&($scope.selected_date.isAfter($scope.item_dates[0].date)||$scope.selected_date.isSame($scope.item_dates[0].date))&&($scope.selected_date.isBefore($scope.item_dates[$scope.item_dates.length-1].date)||$scope.selected_date.isSame($scope.item_dates[$scope.item_dates.length-1].date))?$scope.selected_date:$scope.item_dates[0].date)}for(full_events=[],_k=0,_len2=items.length;_len2>_k;_k++)item=items[_k],item.getDuration(),item.num_spaces===item.spaces_booked?full_events.push(item):item.qty=1;return full_events.length===items.length&&($scope.fully_booked=!0),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},$scope.showDate=function(date){return date?($scope.event&&!$scope.selected_date.isSame(date,"day")&&delete $scope.event,$scope.selected_date=date,$scope.summary?($scope.start_date=moment(date),$scope.end_date=moment(date),$scope.init()):$scope.items=[]):void 0},$scope.$watch("pick.date",function(){return function(newValue){return newValue?($scope.start_date=moment(newValue),$scope.end_date=moment(newValue),$scope.init()):void 0}}(this)),$scope.selectItem=function(){return function(item,route){return item.hasSpace()?($scope.notLoaded($scope),$scope.$parent.$has_page_control?($scope.event&&$scope.event.unselect(),$scope.event=item,$scope.event.select(),$scope.setLoaded($scope),!1):($scope.bb.current_item.setEvent(item),$scope.bb.current_item.ready=!1,$q.all($scope.bb.current_item.promises).then(function(){return $scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),!0)):!1}}(this),$scope.setReady=function(){return $scope.event?($scope.bb.current_item.setEvent($scope.event),!0):!1}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbItemDetails",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ItemDetails",link:function(scope,element,attrs){var item;attrs.bbItemDetails&&(item=scope.$eval(attrs.bbItemDetails),scope.loadItem(item))}}}),angular.module("BB.Controllers").controller("ItemDetails",function($scope,$rootScope,ItemDetailsService,PurchaseBookingService,AlertService,BBModel,FormDataStoreService,ValidatorService,QuestionService,$modal,$location,$upload){var confirming,setItemDetails;return $scope.controller="public.controllers.ItemDetails",FormDataStoreService.init("ItemDetails",$scope,["item_details"]),QuestionService.addAnswersByName($scope.client,["first_name","last_name","email","mobile"]),$scope.notLoaded($scope),$scope.validator=ValidatorService,confirming=!1,$rootScope.connection_started.then(function(){return $scope.product=$scope.bb.current_item.product,confirming?void 0:$scope.loadItem($scope.bb.current_item)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loadItem=function(item){var params;return confirming=!0,$scope.item=item,$scope.item.item_details?(setItemDetails($scope.item.item_details),QuestionService.addDynamicAnswersByName($scope.item_details.questions),$scope.bb.item_defaults.answers&&QuestionService.addAnswersByKey($scope.item_details.questions,$scope.bb.item_defaults.answers),$scope.recalc_price(),$scope.setLoaded($scope)):(params={company:$scope.bb.company,cItem:$scope.item},ItemDetailsService.query(params).then(function(details){return setItemDetails(details),$scope.item.item_details=$scope.item_details,$scope.bb.item_defaults.answers&&QuestionService.addAnswersByKey($scope.item_details.questions,$scope.bb.item_defaults.answers),$scope.recalc_price(),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}))},setItemDetails=function(details){var oldQuestions;return $scope.item&&$scope.item.defaults&&_.each(details.questions,function(item){var n;return n="q_"+item.name,$scope.item.defaults[n]?item.answer=$scope.item.defaults[n]:void 0}),$scope.hasOwnProperty("item_details")&&(oldQuestions=$scope.item_details.questions,_.each(details.questions,function(item){var search;return search=_.findWhere(oldQuestions,{name:item.name}),search?item.answer=search.answer:void 0})),$scope.item_details=details},$scope.recalc_price=function(){var bprice,qprice;return qprice=$scope.item_details.questionPrice($scope.item.getQty()),bprice=$scope.item.base_price,$scope.item.setPrice(qprice+bprice)},$scope.confirm=function(form,route){return ValidatorService.validateForm(form)?$scope.bb.moving_booking?$scope.confirm_move(form,route):($scope.item.setAskedQuestions(),$scope.item.ready?($scope.notLoaded($scope),$scope.addItemToBasket().then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(){return $scope.setLoaded($scope)})):$scope.decideNextPage(route)):void 0},$scope.setReady=function(){return function(){return $scope.item.setAskedQuestions(),$scope.item.ready?$scope.addItemToBasket():!0}}(this),$scope.confirm_move=function(form,route){return confirming=!0,$scope.item||($scope.item=$scope.bb.current_item),$scope.item.setAskedQuestions(),$scope.item.ready?($scope.notLoaded($scope),PurchaseBookingService.update($scope.item).then(function(booking){var b,oldb,_i,_j,_len,_ref;if(b=new BBModel.Purchase.Booking(booking),$scope.bookings)for(_ref=$scope.bookings,_i=_j=0,_len=_ref.length;_len>_j;_i=++_j)oldb=_ref[_i],oldb.id===b.id&&($scope.bookings[_i]=b);return $scope.purchase.bookings=$scope.bookings,$scope.setLoaded($scope),$scope.item.move_done=!0,$rootScope.$emit("booking:moved")},function(){return function(){return $scope.setLoaded($scope),AlertService.clear(),AlertService.add("danger",{msg:"Failed to Move Booking"})}}(this))):$scope.decideNextPage(route)},$scope.openTermsAndConditions=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:$scope.getPartial("terms_and_conditions"),scope:$scope})},$scope.getQuestion=function(id){var question,_i,_len,_ref;for(_ref=$scope.item_details.questions,_i=0,_len=_ref.length;_len>_i;_i++)if(question=_ref[_i],question.id===id)return question;return null},$scope.updateItem=function(){return $scope.item.setAskedQuestions(),$scope.item.ready?($scope.notLoaded($scope),PurchaseBookingService.update($scope.item).then(function(booking){var b,oldb,_i,_j,_len,_ref;if(b=new BBModel.Purchase.Booking(booking),$scope.bookings)for(_ref=$scope.bookings,_i=_j=0,_len=_ref.length;_len>_j;_i=++_j)oldb=_ref[_i],oldb.id===b.id&&($scope.bookings[_i]=b);return $scope.purchase.bookings=$scope.bookings,$scope.item_details_updated=!0,$scope.setLoaded($scope)},function(){return function(){return $scope.setLoaded($scope)}}(this))):void 0},$scope.editItem=function(){return $scope.item_details_updated=!1},$scope.onFileSelect=function(item,$file,existing){var att_id,file,method,url;return $scope.upload_progress=0,file=$file,att_id=null,existing&&(att_id=existing),method="POST",att_id&&(method="PUT"),url=item.$href("add_attachment"),$scope.upload=$upload.upload({url:url,method:method,data:{attachment_id:att_id},file:file}).progress(function(evt){return $scope.upload_progress<100?$scope.upload_progress=parseInt(99*evt.loaded/evt.total):void 0}).success(function(data){return $scope.upload_progress=100,data&&item?(item.attachment=data,item.attachment_id=data.id):void 0})}})}.call(this),function(){angular.module("BB.Directives").directive("bbLogin",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Login"}}),angular.module("BB.Controllers").controller("Login",function($scope,$rootScope,LoginService){return $scope.controller="public.controllers.Login",$scope.login_sso=function(){return function(token,route){return $rootScope.connection_started.then(function(){return LoginService.ssoLogin({company_id:$scope.bb.company.id,root:$scope.bb.api_url},{token:token}).then(function(){return route?$scope.showPage(route):void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.login_with_password=function(){return function(email,password){return LoginService.companyLogin($scope.bb.company,{},{email:email,password:password})}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbMap",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"MapCtrl"}}),angular.module("BB.Controllers").controller("MapCtrl",function($scope,$element,$attrs,$rootScope,AlertService,ErrorService,FormDataStoreService,$q,$window,$timeout){var checkDataStore,geolocateFail,map_ready_def,options,reverseGeocode,searchFailed,searchPlaces,searchSuccess;return $scope.controller="public.controllers.MapCtrl",FormDataStoreService.init("MapCtrl",$scope,["address","selectedStore","prms"]),options=$scope.$eval($attrs.bbMap)||{},map_ready_def=$q.defer(),$scope.mapLoaded=$q.defer(),$scope.mapReady=map_ready_def.promise,$scope.map_init=$scope.mapLoaded.promise,$scope.numSearchResults=options.num_search_results||6,$scope.range_limit=options.range_limit||1/0,$scope.showAllMarkers=!1,$scope.mapMarkers=[],$scope.shownMarkers=$scope.shownMarkers||[],$scope.numberedPin||($scope.numberedPin=null),$scope.defaultPin||($scope.defaultPin=null),$scope.hide_not_live_stores=!1,$scope.address=$scope.$eval($attrs.bbAddress||null),$scope.notLoaded($scope),$rootScope.connection_started.then(function(){var comp,key,latlong,value,_i,_len,_ref,_ref1;if($scope.setLoaded($scope),!$scope.bb.company.companies)return $rootScope.parent_id?void $scope.initWidget({company_id:$rootScope.parent_id,first_page:$scope.bb.current_page,keep_basket:!0}):void $scope.initWidget({company_id:$scope.bb.company.id,first_page:null});for($rootScope.parent_id=$scope.bb.company.id,$scope.companies=$scope.bb.company.companies,$scope.companies&&0!==$scope.companies.length||($scope.companies=[$scope.bb.company]),$scope.mapBounds=new google.maps.LatLngBounds,_ref=$scope.companies,_i=0,_len=_ref.length;_len>_i;_i++)comp=_ref[_i],comp.address.lat&&comp.address.long&&(latlong=new google.maps.LatLng(comp.address.lat,comp.address.long),$scope.mapBounds.extend(latlong));if($scope.mapOptions={center:$scope.mapBounds.getCenter(),zoom:6,mapTypeId:google.maps.MapTypeId.ROADMAP},options&&options.map_options){_ref1=options.map_options;for(key in _ref1)value=_ref1[key],$scope.mapOptions[key]=value}return map_ready_def.resolve(!0)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.map_init.then(function(){var comp,latlong,marker,_i,_len,_ref;for(_ref=$scope.companies,_i=0,_len=_ref.length;_len>_i;_i++)comp=_ref[_i],comp.address.lat&&comp.address.long&&(latlong=new google.maps.LatLng(comp.address.lat,comp.address.long),marker=new google.maps.Marker({map:$scope.myMap,position:latlong,visible:$scope.showAllMarkers,icon:$scope.defaultPin}),marker.company=comp,(!$scope.hide_not_live_stores||comp.live)&&$scope.mapMarkers.push(marker));return $timeout(function(){return $scope.myMap.fitBounds($scope.mapBounds),$scope.myMap.setZoom(15)}),checkDataStore()}),$scope.init=function(options){return options?$scope.hide_not_live_stores=options.hide_not_live_stores:void 0},checkDataStore=function(){return $scope.selectedStore&&$scope.prms?($scope.searchAddress($scope.prms),google.maps.event.addListenerOnce($scope.myMap,"idle",function(){return _.each($scope.mapMarkers,function(marker){return $scope.selectedStore.id===marker.company.id?google.maps.event.trigger(marker,"click"):void 0})})):void 0},$scope.title=function(){var ci,p1;return ci=$scope.bb.current_item,p1=ci.cagetgory&&ci.category.description?ci.category.description:$scope.bb.company.extra.department,p1+" - "+$scope.$eval("getCurrentStepTitle()")},$scope.searchAddress=function(prms){return $scope.reverse_geocode_address&&$scope.reverse_geocode_address===$scope.address?!1:(delete $scope.geocoder_result,prms||(prms={}),$scope.search_prms=prms,$scope.map_init.then(function(){var address,ne,req,sw;return address=$scope.address,prms.address&&(address=prms.address),address?(req={address:address},prms.region&&(req.region=prms.region),prms.componentRestrictions&&(req.componentRestrictions=prms.componentRestrictions),prms.bounds&&(sw=new google.maps.LatLng(prms.bounds.sw.x,prms.bounds.sw.y),ne=new google.maps.LatLng(prms.bounds.ne.x,prms.bounds.ne.y),req.bounds=new google.maps.LatLngBounds(sw,ne)),(new google.maps.Geocoder).geocode(req,function(results,status){return $scope.prms=prms,results.length>0&&"OK"===status&&($scope.geocoder_result=results[0]),!$scope.geocoder_result||$scope.geocoder_result&&$scope.geocoder_result.partial_match?void searchPlaces(req):$scope.geocoder_result?searchSuccess($scope.geocoder_result):searchFailed()})):void 0}))},searchPlaces=function(prms){var req,service;return req={query:prms.address,types:["shopping_mall","store","embassy"]},prms.bounds&&(req.bounds=prms.bounds),service=new google.maps.places.PlacesService($scope.myMap),service.textSearch(req,function(results,status){return results.length>0&&"OK"===status?searchSuccess(results[0]):$scope.geocoder_result?searchSuccess($scope.geocoder_result):searchFailed()})},searchSuccess=function(result){return AlertService.clear(),$scope.search_failed=!1,$scope.loc=result.geometry.location,$scope.myMap.setCenter($scope.loc),$scope.myMap.setZoom(15),$scope.showClosestMarkers($scope.loc),$rootScope.$emit("map:search_success")},searchFailed=function(){return $scope.search_failed=!0,AlertService.danger(ErrorService.getError("LOCATION_NOT_FOUND")),$rootScope.$apply()},$scope.validateAddress=function(form){return form?form.$error.required?(AlertService.clear(),AlertService.danger(ErrorService.getError("MISSING_LOCATION")),!1):!0:!1},$scope.showClosestMarkers=function(latlong){var R,a,c,chLat,chLon,d,dLat,dLon,distances,iconPath,index,lat1,lat2,localBounds,lon1,lon2,marker,pi,rLat1,rLat2,_i,_j,_len,_len1,_ref,_ref1;for(pi=Math.PI,R=6371,distances=[],lat1=latlong.lat(),lon1=latlong.lng(),_ref=$scope.mapMarkers,_i=0,_len=_ref.length;_len>_i;_i++)marker=_ref[_i],lat2=marker.position.lat(),lon2=marker.position.lng(),chLat=lat2-lat1,chLon=lon2-lon1,dLat=chLat*(pi/180),dLon=chLon*(pi/180),rLat1=lat1*(pi/180),rLat2=lat2*(pi/180),a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.sin(dLon/2)*Math.sin(dLon/2)*Math.cos(rLat1)*Math.cos(rLat2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c,d=.621371192*d,$scope.showAllMarkers||marker.setVisible(!1),marker.distance=d,d<$scope.range_limit&&distances.push(marker);for(distances.sort(function(a,b){return a.distance-b.distance}),$scope.shownMarkers=distances.slice(0,$scope.numSearchResults),localBounds=new google.maps.LatLngBounds,localBounds.extend(latlong),index=1,_ref1=$scope.shownMarkers,_j=0,_len1=_ref1.length;_len1>_j;_j++)marker=_ref1[_j],$scope.numberedPin&&(iconPath=$window.sprintf($scope.numberedPin,index),marker.setIcon(iconPath)),marker.setVisible(!0),localBounds.extend(marker.position),index+=1;return google.maps.event.trigger($scope.myMap,"resize"),$scope.myMap.fitBounds(localBounds)},$scope.openMarkerInfo=function(marker){return $scope.currentMarker=marker,$scope.myInfoWindow.open($scope.myMap,marker)},$scope.selectItem=function(item,route){return $scope.$debounce(1e3)?($scope.notLoaded($scope),$scope.selectedStore&&$scope.selectedStore.id!==item.id&&$scope.$emit("change:storeLocation"),$scope.selectedStore=item,$scope.initWidget({company_id:item.id,first_page:route})):void 0},$scope.roundNumberUp=function(num,places){return Math.round(num*Math.pow(10,places))/Math.pow(10,places)},$scope.geolocate=function(){return!navigator.geolocation||$scope.reverse_geocode_address&&$scope.reverse_geocode_address===$scope.address?!1:(options={timeout:5e3,maximumAge:36e5},navigator.geolocation.getCurrentPosition(reverseGeocode,geolocateFail,options))},geolocateFail=function(error){switch(error.code){case 2:case 3:return AlertService.danger(ErrorService.getError("GEOLOCATION_ERROR"))}},reverseGeocode=function(position){var lat,latlng,long;return lat=parseFloat(position.coords.latitude),long=parseFloat(position.coords.longitude),latlng=new google.maps.LatLng(lat,long),(new google.maps.Geocoder).geocode({latLng:latlng},function(results,status){var ac,_i,_len,_ref;if(results.length>0&&"OK"===status){for($scope.geocoder_result=results[0],_ref=$scope.geocoder_result.address_components,_i=0,_len=_ref.length;_len>_i;_i++)ac=_ref[_i],ac.types.indexOf("route")>=0&&($scope.reverse_geocode_address=ac.long_name),ac.types.indexOf("locality")>=0&&($scope.reverse_geocode_address+=", "+ac.long_name),$scope.address=$scope.reverse_geocode_address;return searchSuccess($scope.geocoder_result)}})},$scope.increaseRange=function(){return $scope.range_limit=1/0,$scope.searchAddress($scope.search_prms)},$scope.$watch("display.xs",function(){return function(new_value,old_value){return new_value!==old_value&&$scope.loc?($scope.myInfoWindow.close(),$scope.myMap.setCenter($scope.loc),$scope.myMap.setZoom(15),$scope.showClosestMarkers($scope.loc)):void 0}}(this))})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty;angular.module("BB.Directives").directive("bbMultiServiceSelect",function(){return{restrict:"AE",scope:!0,controller:"MultiServiceSelect"}}),angular.module("BB.Controllers").controller("MultiServiceSelect",function($scope,$rootScope,$q,$attrs,BBModel,AlertService,CategoryService,FormDataStoreService){var collectCategories,initialise;return FormDataStoreService.init("MultiServiceSelect",$scope,["selected_category_name"]),$scope.options=$scope.$eval($attrs.bbMultiServiceSelect)||{},$scope.options.max_services=$scope.options.max_services||3,$scope.options.ordered_categories=$scope.options.ordered_categories||!1,$scope.options.services=$scope.options.services||"items",CategoryService.query($scope.bb.company).then(function(){return function(items){var item,_i,_len;for(_i=0,_len=items.length;_len>_i;_i++)item=items[_i],$scope.options.ordered_categories&&(item.order=parseInt(item.name.slice(0,2)),item.name=item.name.slice(3));return $scope.all_categories=_.indexBy(items,"id")}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.$watch($scope.options.services,function(newval){return newval&&angular.isArray(newval)&&$scope.all_categories&&!$scope.initialised?($scope.items=newval,initialise()):void 0}),$scope.$watch("all_categories",function(newval){return newval&&angular.isArray(newval)&&$scope.items&&!$scope.initialised?initialise():void 0}),initialise=function(){var item,stacked_item,_i,_j,_len,_len1,_ref,_ref1;if($scope.initialised=!0,collectCategories(),$scope.bb.basket&&$scope.bb.basket.items.length>0&&$scope.bb.basket.items[0].service&&($scope.bb.stacked_items&&0!==$scope.bb.stacked_items.length||$scope.bb.setStackedItems($scope.bb.basket.items)),$scope.bb.stacked_items&&$scope.bb.stacked_items.length>0)for(_ref=$scope.bb.stacked_items,_i=0,_len=_ref.length;_len>_i;_i++)for(stacked_item=_ref[_i],_ref1=$scope.items,_j=0,_len1=_ref1.length;_len1>_j;_j++)if(item=_ref1[_j],item.self===stacked_item.service.self){stacked_item.service=item,stacked_item.service.selected=!0;break}return $scope.bb.moving_booking&&$scope.nextStep(),$scope.setLoaded($scope)},collectCategories=function(){var all_categories,categories,category,category_details,category_id,key,services,sub_categories,value,_results;all_categories=_.groupBy($scope.items,function(item){return item.category_id}),categories={};for(key in all_categories)__hasProp.call(all_categories,key)&&(value=all_categories[key],value.length>0&&(categories[key]=value));$scope.categories=[],_results=[];for(category_id in categories)services=categories[category_id],sub_categories=_.groupBy(services,function(service){return service.extra.extra_category}),$scope.all_categories[category_id]&&(category_details={name:$scope.all_categories[category_id].name,description:$scope.all_categories[category_id].description}),category={name:category_details.name,description:category_details.description,sub_categories:sub_categories},$scope.options.ordered_categories&&(category.order=$scope.all_categories[category_id].order),$scope.categories.push(category),_results.push($scope.selected_category_name&&$scope.selected_category_name===category_details.name?$scope.selected_category=$scope.categories[$scope.categories.length-1]:void 0);
return _results},$scope.changeCategory=function(category_name,services){return category_name&&services?($scope.selected_category={name:category_name,sub_categories:services},$scope.selected_category_name=$scope.selected_category.name,$rootScope.$emit("multi_service_select:category_changed")):void 0},$scope.addItem=function(item){var i,iitem,_i,_len,_ref,_results;if($scope.bb.stacked_items.length<$scope.options.max_services)return item.selected=!0,iitem=new BBModel.BasketItem(null,$scope.bb),iitem.setDefaults($scope.bb.item_defaults),iitem.setService(item),iitem.setGroup(item.group),$scope.bb.stackItem(iitem),$rootScope.$emit("multi_service_select:item_added");for(_ref=$scope.items,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)i=_ref[_i],i.popover="Sorry, you can only book a maximum of "+$scope.options.max_services+" treatments",_results.push(i.popoverText=i.popover);return _results},$scope.removeItem=function(item){var i,_i,_len,_ref,_results;for(item.selected=!1,$scope.bb.deleteStackedItemByService(item),_ref=$scope.items,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)i=_ref[_i],_results.push(i.self===item.self?i.selected=!1:void 0);return _results},$scope.nextStep=function(){return $scope.bb.stacked_items.length>1?$scope.decideNextPage():1===$scope.bb.stacked_items.length?($scope.bb.basket&&$scope.bb.basket.items.length>0&&$scope.quickEmptybasket({preserve_stacked_items:!0}),$scope.setBasketItem($scope.bb.stacked_items[0]),$scope.decideNextPage()):(AlertService.clear(),AlertService.add("danger",{msg:"You need to select at least one treatment to continue"}))},$scope.addService=function(){return $rootScope.$emit("multi_service_select:add_item")}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPackagePicker",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PackagePicker"}}),angular.module("BB.Controllers").controller("PackagePicker",function($scope,$rootScope,$q,TimeService,BBModel){return $scope.controller="public.controllers.PackagePicker",$scope.sel_date=moment().add(1,"days"),$scope.selected_date=$scope.sel_date.toDate(),$scope.picked_time=!1,$scope.$watch("selected_date",function(){return function(newv){return $scope.sel_date=moment(newv),$scope.loadDay()}}(this)),$scope.loadDay=function(){return function(){var item,pslots,_i,_len,_ref;for($scope.timeSlots=[],$scope.notLoaded($scope),pslots=[],_ref=$scope.stackedItems,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],pslots.push(TimeService.query({company:$scope.bb.company,cItem:item,date:$scope.sel_date,client:$scope.client}));return $q.all(pslots).then(function(res){var earliest,latest,next_earliest,next_latest,slot,_j,_k,_l,_len1,_len2,_len3,_len4,_len5,_m,_n,_ref1,_ref2,_ref3,_ref4,_ref5,_results;for($scope.setLoaded($scope),$scope.data_valid=!0,$scope.timeSlots=[],_ref1=$scope.stackedItems,_i=_j=0,_len1=_ref1.length;_len1>_j;_i=++_j)item=_ref1[_i],item.slots=res[_i],item.slots&&0!==item.slots.length||($scope.data_valid=!1),item.order=_i;if($scope.data_valid){for($scope.timeSlots=res,earliest=null,_ref2=$scope.stackedItems,_k=0,_len2=_ref2.length;_len2>_k;_k++){for(item=_ref2[_k],next_earliest=null,_ref3=item.slots,_l=0,_len3=_ref3.length;_len3>_l;_l++)slot=_ref3[_l],earliest&&slot.time<earliest?slot.disable():next_earliest||(next_earliest=slot.time+item.service.duration);earliest=next_earliest}for(latest=null,_ref4=$scope.bb.stacked_items.slice(0).reverse(),_results=[],_m=0,_len4=_ref4.length;_len4>_m;_m++){for(item=_ref4[_m],next_latest=null,_ref5=item.slots,_n=0,_len5=_ref5.length;_len5>_n;_n++)slot=_ref5[_n],latest&&slot.time>latest?slot.disable():next_latest=slot.time-item.service.duration;_results.push(latest=next_latest)}return _results}},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.selectSlot=function(){return function(sel_item,slot){var count,current,item,latest,next,slots,time,_i,_j,_k,_len,_len1,_len2,_ref,_ref1;for(_ref=$scope.stackedItems,count=_i=0,_len=_ref.length;_len>_i;count=++_i)if(item=_ref[count],count===sel_item.order){if(item.setDate(new BBModel.Day({date:$scope.sel_date.format(),spaces:1})),item.setTime(slot),next=slot.time+item.service.duration,time=slot.time,slot=null,count>0)for(current=count-1;current>=0;){if(item=$scope.bb.stacked_items[current],latest=time-item.service.duration,!item.time||item.time.time>latest)for(item.setDate(new BBModel.Day({date:$scope.sel_date.format(),spaces:1})),item.setTime(null),_ref1=item.slots,_j=0,_len1=_ref1.length;_len1>_j;_j++)slot=_ref1[_j],slot.time<latest&&item.setTime(slot);time=item.time.time,current-=1}}else if(count>sel_item.order&&(slots=item.slots,item.setDate(new BBModel.Day({date:$scope.sel_date.format(),spaces:1})),slots))for(item.setTime(null),_k=0,_len2=slots.length;_len2>_k;_k++)slot=slots[_k],slot.time>=next&&!item.time&&(item.setTime(slot),next=slot.time+item.service.duration);return $scope.picked_time=!0}}(this),$scope.hasAvailability=function(){return function(slots,start_time,end_time){var slot,_i,_j,_k,_l,_len,_len1,_len2,_len3;if(!slots)return!1;if(start_time&&end_time){for(_i=0,_len=slots.length;_len>_i;_i++)if(slot=slots[_i],slot.time>=start_time&&slot.time<end_time&&slot.availability()>0)return!0}else if(end_time){for(_j=0,_len1=slots.length;_len1>_j;_j++)if(slot=slots[_j],slot.time<end_time&&slot.availability()>0)return!0}else if(start_time){for(_k=0,_len2=slots.length;_len2>_k;_k++)if(slot=slots[_k],slot.time>=start_time&&slot.availability()>0)return!0}else for(_l=0,_len3=slots.length;_len3>_l;_l++)if(slot=slots[_l],slot.availability()>0)return!0}}(this),$scope.confirm=function(){return function(){}}(this)})}.call(this),function(){"use strict";var BBBasicPageCtrl;BBBasicPageCtrl=function($scope,$q,ValidatorService){var isScopeReady;return $scope.controllerClass="public.controllers.PageController",$scope.$has_page_control=!0,$scope.validator=ValidatorService,isScopeReady=function(){return function(cscope){var child,children,ready,ready_list,_i,_len;for(ready_list=[],children=[],child=cscope.$$childHead;child;)children.push(child),child=child.$$nextSibling;for(children.sort(function(a,b){return(a.ready_order||0)>=(b.ready_order||0)?1:-1}),_i=0,_len=children.length;_len>_i;_i++)child=children[_i],ready=isScopeReady(child),angular.isArray(ready)?Array.prototype.push.apply(ready_list,ready):ready_list.push(ready);return cscope.hasOwnProperty("setReady")&&ready_list.push(cscope.setReady()),ready_list}}(this),$scope.checkReady=function(){var checkread,ready_list,v,_i,_len;if(ready_list=isScopeReady($scope),checkread=$q.defer(),$scope.$checkingReady=checkread.promise,ready_list=ready_list.filter(function(v){return!("boolean"==typeof v&&v)}),!ready_list||0===ready_list.length)return checkread.resolve(),!0;for(_i=0,_len=ready_list.length;_len>_i;_i++)if(v=ready_list[_i],"boolean"==typeof value||!v)return checkread.reject(),!1;return $scope.notLoaded($scope),$q.all(ready_list).then(function(){return $scope.setLoaded($scope),checkread.resolve()},function(){return $scope.setLoaded($scope)}),!0},$scope.routeReady=function(route){return $scope.$checkingReady?$scope.$checkingReady.then(function(){return function(){return $scope.decideNextPage(route)}}(this)):$scope.decideNextPage(route)}},angular.module("BB.Directives").directive("bbPage",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PageController"}}),angular.module("BB.Controllers").controller("PageController",BBBasicPageCtrl),angular.module("BB.Services").value("PageControllerService",BBBasicPageCtrl)}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPayForm",function($window,$timeout,$sce,$http,$compile,$document){var applyCustomPartials,linker;return applyCustomPartials=function(custom_partial_url,scope,element){return null!=custom_partial_url?($document.domain="bookingbug.com",$http.get(custom_partial_url).then(function(custom_templates){return $compile(custom_templates.data)(scope,function(custom,scope){var custom_form,e,_i,_len;for(_i=0,_len=custom.length;_len>_i;_i++)e=custom[_i],"STYLE"===e.tagName&&element.after(e.outerHTML);return custom_form=function(){var _j,_len1,_results;for(_results=[],_j=0,_len1=custom.length;_len1>_j;_j++)e=custom[_j],"payment_form"===e.id&&_results.push(e);return _results}(),custom_form&&custom_form[0]?$compile(custom_form[0].innerHTML)(scope,function(compiled_form){var action,form;return form=element.find("form")[0],action=form.action,compiled_form.attr("action",action),$(form).replaceWith(compiled_form)}):void 0})})):void 0},linker=function(scope,element){return $window.addEventListener("message",function(){return function(event){switch(event.data.type){case"load":return scope.$apply(function(){return scope.referrer=event.data.message,event.data.custom_partial_url?applyCustomPartials(event.data.custom_partial_url,scope,element):void 0})}}}(this),!1)},{restrict:"AE",replace:!0,scope:!0,controller:"PayForm",link:linker}}),angular.module("BB.Controllers").controller("PayForm",function($scope,$location){var sendSubmittingEvent,submitPaymentForm;return $scope.controller="public.controllers.PayForm",$scope.setTotal=function(total){return $scope.total=total},$scope.setCard=function(card){return $scope.card=card},sendSubmittingEvent=function(){return function(){var origin,payload,referrer;return origin=$location.protocol()+"://"+$location.host()+":"+$location.port(),referrer=$location.protocol()+"://"+$location.host(),$location.port()&&(referrer+=":"+$location.port()),payload={type:"submitting",message:referrer},parent.postMessage(payload,origin)}}(this),submitPaymentForm=function(){return function(){var payment_form;return payment_form=angular.element.find("form"),payment_form[0].submit()}}(this),$scope.submitAndSendMessage=function(){return function(event){return event.preventDefault(),event.stopPropagation(),sendSubmittingEvent(),submitPaymentForm()}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPayment",function($window,$location){var error,getHost,linker,sendLoadEvent;return error=function(scope,message){return scope.error(message)},getHost=function(url){var a;return a=document.createElement("a"),a.href=url,a.protocol+"//"+a.host},sendLoadEvent=function(element,origin,scope){var payload,referrer;return referrer=$location.protocol()+"://"+$location.host(),$location.port()&&(referrer+=":"+$location.port()),payload={type:"load",message:referrer,custom_partial_url:scope.bb.custom_partial_url},element.find("iframe")[0].contentWindow.postMessage(payload,origin)},linker=function(scope,element){return element.find("iframe").bind("load",function(){return function(){var origin,url;return url=scope.bb.total.$href("new_payment"),origin=getHost(url),sendLoadEvent(element,origin,scope)}}(this)),$window.addEventListener("message",function(){return function(event){return scope.$apply(function(){switch(event.data.type){case"submitting":return scope.callNotLoaded();case"error":return scope.callSetLoaded(),error(scope,event.data.message);case"payment_complete":return scope.callSetLoaded(),scope.paymentDone()}})}}(this),!1)},{restrict:"AE",replace:!0,scope:!0,controller:"Payment",link:linker}}),angular.module("BB.Controllers").controller("Payment",function($scope,$rootScope,$q,$location,$window,$sce,$log){return $scope.controller="public.controllers.Payment",$rootScope.connection_started.then(function(){return function(){return $scope.total&&($scope.bb.total=$scope.total),$scope.bb.total.total_price&&"0.0"!==$scope.bb.total.total_price?$scope.url=$sce.trustAsResourceUrl($scope.bb.total.$href("new_payment")):void $scope.decideNextPage()}}(this)),$scope.callNotLoaded=function(){return function(){return $scope.notLoaded($scope)}}(this),$scope.callSetLoaded=function(){return function(){return $scope.setLoaded($scope)}}(this),$scope.paymentDone=function(){return $scope.bb.payment_status="complete",$scope.decideNextPage()},$scope.error=function(message){return $log.warn("Payment Failure: "+message)}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPeople",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PersonList",link:function(scope,element,attrs){attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem))}}}),angular.module("BB.Controllers").controller("PersonList",function($scope,$rootScope,PageControllerService,PersonService,ItemService,$q,BBModel,PersonModel){var getItemFromPerson,loadData,setPerson;return $scope.controller="public.controllers.PersonList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$rootScope.connection_started.then(function(){return loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),loadData=function(){var bi,ppromise;return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),bi=$scope.booking_item,bi.service&&bi.service!==$scope.change_watch_item?($scope.change_watch_item=bi.service,$scope.notLoaded($scope),ppromise=PersonService.query($scope.bb.company),ppromise.then(function(people){return bi.group&&(people=people.filter(function(x){return!x.group_id||x.group_id===bi.group})),$scope.all_people=people}),ItemService.query({company:$scope.bb.company,cItem:bi,wait:ppromise,item:"person"}).then(function(items){var i,promises,_i,_len;for(bi.group&&(items=items.filter(function(x){return!x.group_id||x.group_id===bi.group})),promises=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],promises.push(i.promise);return $q.all(promises).then(function(){return function(){var people,_j,_len1;for(people=[],_j=0,_len1=items.length;_len1>_j;_j++)i=items[_j],people.push(i.item),bi&&bi.person&&bi.person.self===i.item.self&&($scope.person=i.item,$scope.selected_bookable_items=[i]),bi&&bi.selected_person&&bi.selected_person.item.self===i.item.self&&(bi.selected_person=i);return 1===items.length&&$scope.bb.company.settings&&$scope.bb.company.settings.merge_people?$scope.selectItem(items[0],$scope.nextRoute)?$scope.skipThisStep():(setPerson(people),$scope.bookable_items=items,$scope.selected_bookable_items=items):(setPerson(people),$scope.bookable_items=items,$scope.selected_bookable_items||($scope.selected_bookable_items=items)),$scope.setLoaded($scope)}}(this))},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):void(bi.service||$scope.setLoaded($scope))},setPerson=function(people){return $scope.bookable_people=people,$scope.person?_.each(people,function(person){return person.id===$scope.person.id?$scope.person=person:void 0}):void 0},getItemFromPerson=function(){return function(person){var item,_i,_len,_ref;if(person instanceof PersonModel&&$scope.bookable_items)for(_ref=$scope.bookable_items,_i=0,_len=_ref.length;_len>_i;_i++)if(item=_ref[_i],item.item.self===person.self)return item;return person}}(this),$scope.selectItem=function(){return function(item,route){return $scope.$parent.$has_page_control?($scope.person=item,!1):($scope.booking_item.setPerson(getItemFromPerson(item)),$scope.decideNextPage(route),!0)}}(this),$scope.selectAndRoute=function(){return function(item,route){return $scope.booking_item.setPerson(getItemFromPerson(item)),$scope.decideNextPage(route),!0}}(this),$scope.$watch("person",function(){return function(newval,oldval){if($scope.person&&$scope.booking_item){if(!$scope.booking_item.person||$scope.booking_item.person.self!==$scope.person.self)return $scope.booking_item.setPerson(getItemFromPerson($scope.person)),$scope.broadcastItemUpdate()}else if(newval!==oldval)return $scope.booking_item.setPerson(null),$scope.broadcastItemUpdate()}}(this)),$scope.$on("currentItemUpdate",function(){return loadData()}),$scope.setReady=function(){return function(){return $scope.person?($scope.booking_item.setPerson(getItemFromPerson($scope.person)),!0):($scope.booking_item.setPerson(null),!0)}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbProductList",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ProductList",link:function(scope,element,attrs){attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem)),attrs.bbShowAll&&(scope.show_all=!0)}}}),angular.module("BB.Controllers").controller("ProductList",function($scope,$rootScope,$q,$attrs,ItemService,FormDataStoreService,ValidatorService){return $scope.controller="public.controllers.ProductList",$scope.notLoaded($scope),$scope.validator=ValidatorService,$rootScope.connection_started.then(function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(company){return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),company.$get("products").then(function(products){return products.$get("products").then(function(products){return $scope.products=products,$scope.setLoaded($scope)})})},$scope.selectItem=function(item,route){return $scope.$parent.$has_page_control?($scope.product=item,!1):($scope.booking_item.setProduct(item),$scope.decideNextPage(route),!0)}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbPurchaseTotal",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"PurchaseTotal"}}),angular.module("BB.Controllers").controller("PurchaseTotal",function($scope,$rootScope,$window,PurchaseTotalService,$q){return $scope.controller="public.controllers.PurchaseTotal",angular.extend(this,new $window.PageController($scope,$q)),$scope.load=function(){return function(total_id){return $rootScope.connection_started.then(function(){return $scope.loadingTotal=PurchaseTotalService.query({company:$scope.bb.company,total_id:total_id}),$scope.loadingTotal.then(function(total){return $scope.total=total})})}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbResources",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ResourceList"}}),angular.module("BB.Controllers").controller("ResourceList",function($scope,$rootScope,$attrs,PageControllerService,ResourceService,ItemService,$q,BBModel,ResourceModel){var getItemFromResource,loadData;return $scope.controller="public.controllers.ResourceList",$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.options=$scope.$eval($attrs.bbResources)||{},$rootScope.connection_started.then(function(){return function(){return loadData()}}(this)),loadData=function(){return function(){var params,rpromise;return $scope.bb.steps&&"resource_list"===$scope.bb.steps[0].page||$scope.options.resource_first||$scope.bb.current_item.service&&$scope.bb.current_item.service!==$scope.change_watch_item?($scope.change_watch_item=$scope.bb.current_item.service,$scope.notLoaded($scope),rpromise=ResourceService.query($scope.bb.company),rpromise.then(function(resources){return $scope.bb.current_item.group&&(resources=resources.filter(function(x){return!x.group_id||x.group_id===$scope.bb.current_item.group})),$scope.all_resources=resources}),params={company:$scope.bb.company,cItem:$scope.bb.current_item,wait:rpromise,item:"resource"},ItemService.query(params).then(function(items){var i,promises,_i,_len;for(promises=[],$scope.bb.current_item.group&&(items=items.filter(function(x){return!x.group_id||x.group_id===$scope.bb.current_item.group})),_i=0,_len=items.length;_len>_i;_i++)i=items[_i],promises.push(i.promise);return $q.all(promises).then(function(){var resources,_j,_len1;for(resources=[],_j=0,_len1=items.length;_len1>_j;_j++)i=items[_j],resources.push(i.item),$scope.bb.current_item&&$scope.bb.current_item.resource&&$scope.bb.current_item.resource.self===i.item.self&&($scope.resource=i.item);return 1===resources.length?$scope.selectItem(items[0].item,$scope.nextRoute,!0)||($scope.bookable_resources=resources,$scope.bookable_items=items):($scope.bookable_resources=resources,$scope.bookable_items=items),$scope.setLoaded($scope)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})},function(err){return"No service link found"===err&&($scope.bb.steps&&"resource_list"===$scope.bb.steps[0].page||$scope.options.resource_first)?$scope.setLoaded($scope):$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):void($scope.bb.current_item.service||$scope.setLoaded($scope))}}(this),getItemFromResource=function(){return function(resource){var item,_i,_len,_ref;if(resource instanceof ResourceModel&&$scope.bookable_items)for(_ref=$scope.bookable_items,_i=0,_len=_ref.length;_len>_i;_i++)if(item=_ref[_i],item.item.self===resource.self)return item;return resource}}(this),$scope.selectItem=function(){return function(item,route,skip_step){return null==skip_step&&(skip_step=!1),$scope.$parent.$has_page_control?($scope.resource=item,!1):($scope.bb.current_item.setResource(getItemFromResource(item)),skip_step&&$scope.skipThisStep(),$scope.decideNextPage(route),!0)}}(this),$scope.$watch("resource",function(){return function(newval,oldval){return $scope.resource?($scope.bb.current_item.setResource(getItemFromResource($scope.resource)),$scope.broadcastItemUpdate()):newval!==oldval?($scope.bb.current_item.setResource(null),$scope.broadcastItemUpdate()):void 0}}(this)),$scope.$on("currentItemUpdate",function(){return loadData()}),$scope.setReady=function(){return function(){return $scope.resource?($scope.bb.current_item.setResource(getItemFromResource($scope.resource)),!0):($scope.bb.current_item.setResource(null),!0)}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbServices",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"ServiceList",link:function(scope,element,attrs){scope.options=scope.$eval(attrs.bbServices)||{},attrs.bbItem&&(scope.booking_item=scope.$eval(attrs.bbItem)),(attrs.bbShowAll||scope.options.show_all)&&(scope.show_all=!0),scope.options.allow_single_pick&&(scope.allowSinglePick=!0)}}}),angular.module("BB.Controllers").controller("ServiceList",function($scope,$rootScope,$q,$attrs,ItemService,FormDataStoreService,ValidatorService,PageControllerService){var setServiceItem;return $scope.controller="public.controllers.ServiceList",FormDataStoreService.init("ServiceList",$scope,["service"]),$scope.notLoaded($scope),angular.extend(this,new PageControllerService($scope,$q)),$scope.validator=ValidatorService,$rootScope.connection_started.then(function(){return function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(comp){var ppromise;return $scope.booking_item||($scope.booking_item=$scope.bb.current_item),$scope.service&&$scope.service.company_id!==$scope.bb.company.id&&($scope.service=null),ppromise=comp.getServicesPromise(),this.skipped=!1,ppromise.then(function(_this){return function(items){var filterItems,item,_i,_j,_len,_len1;if(filterItems="false"===$attrs.filterServices?!1:!0,filterItems&&($scope.booking_item.service_ref&&!$scope.show_all?items=items.filter(function(x){return x.api_ref===$scope.booking_item.service_ref}):$scope.booking_item.category&&!$scope.show_all&&(items=items.filter(function(x){return x.$has("category")&&x.$href("category")===$scope.booking_item.category.self}))),1!==items.length||$scope.allowSinglePick?setServiceItem(items):$scope.selectItem(items[0],$scope.nextRoute)?_this.skipped||($scope.skipThisStep(),_this.skipped=!0):setServiceItem(items),$scope.booking_item.defaultService())for(_i=0,_len=items.length;_len>_i;_i++)item=items[_i],(item.self===$scope.booking_item.defaultService().self||item.name===$scope.booking_item.defaultService().name&&!item.deleted)&&$scope.selectItem(item,$scope.nextRoute);if($scope.booking_item.service)for(_j=0,_len1=items.length;_len1>_j;_j++)item=items[_j],item.selected=!1,item.self===$scope.booking_item.service.self&&($scope.service=item,item.selected=!0,$scope.booking_item.setService($scope.service));return $scope.setLoaded($scope),$scope.booking_item.service||!$scope.booking_item.person&&!$scope.booking_item.resource?$scope.bookable_services=$scope.items:void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.booking_item.person&&!$scope.booking_item.anyPerson()||$scope.booking_item.resource&&!$scope.booking_item.anyResource()?ItemService.query({company:$scope.bb.company,cItem:$scope.booking_item,wait:ppromise,item:"service"}).then(function(_this){return function(items){var i,services;return $scope.booking_item.service_ref&&(items=items.filter(function(x){return x.api_ref===$scope.booking_item.service_ref})),$scope.booking_item.group&&(items=items.filter(function(x){return!x.group_id||x.group_id===$scope.booking_item.group})),services=function(){var _i,_len,_results;for(_results=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],null!=i.item&&_results.push(i.item);return _results}(),$scope.bookable_services=services,$scope.bookable_items=items,1!==services.length||$scope.allowSinglePick?setServiceItem(items):$scope.selectItem(services[0],$scope.nextRoute)?_this.skipped||($scope.skipThisStep(),_this.skipped=!0):setServiceItem(services),$scope.setLoaded($scope)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):void 0},setServiceItem=function(items){return $scope.items=items,$scope.service?_.each(items,function(item){return item.id===$scope.service.id?$scope.service=item:void 0}):void 0},$scope.selectItem=function(){return function(item,route){return $scope.routed?!0:$scope.$parent.$has_page_control?($scope.service=item,!1):item.is_event_group?($scope.booking_item.setEventGroup(item),$scope.decideNextPage(route),$scope.routed=!0):($scope.booking_item.setService(item),$scope.decideNextPage(route),$scope.routed=!0,!0)}}(this),$scope.$watch("service",function(){return function(){return!$scope.service||$scope.booking_item.service&&$scope.booking_item.service.self===$scope.service.self?void 0:($scope.booking_item.setService($scope.service),$scope.broadcastItemUpdate())}}(this)),$scope.setReady=function(){return function(){return $scope.service?($scope.booking_item.setService($scope.service),!0):!1}}(this)})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbSpaces",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"SpaceList"}}),angular.module("BB.Controllers").controller("SpaceList",function($scope,$rootScope,ServiceService,SpaceService){return $scope.controller="public.controllers.SpaceList",$rootScope.connection_started.then(function(){return function(){return $scope.bb.company?$scope.init($scope.bb.company):void 0}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.init=function(){return function(comp){return SpaceService.query(comp).then(function(items){return $scope.currentItem.category&&(items=items.filter(function(x){return x.$has("category")&&x.$href("category")===$scope.currentItem.category.self})),$scope.items=items,1!==items.length||$scope.allowSinglePick?$scope.listLoaded=!0:($scope.skipThisStep(),$rootScope.services=items,$scope.selectItem(items[0],$scope.nextRoute))},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.selectItem=function(){return function(item,route){return $scope.currentItem.setService(item),$scope.decide_next_page(route)}}(this)})}.call(this),function(){angular.module("BB.Directives").directive("bbSurveyQuestions",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"SurveyQuestions",link:function(){}}}),angular.module("BB.Controllers").controller("SurveyQuestions",function($scope,$rootScope,CompanyService,PurchaseService,ClientService,$modal,$location,$timeout,BBWidget,BBModel,$q,QueryStringService,SSOService,AlertService,LoginService,$window,$upload,ServiceService,ValidatorService,PurchaseBookingService,$sessionStorage){var getMember,setPurchaseCompany,showLoginError;return $scope.controller="SurveyQuestions",$scope.completed=!1,$scope.login={email:"",password:""},$scope.login_error=!1,$scope.booking_ref="",showLoginError=function(){return function(){return $scope.login_error=!0}}(this),getMember=function(){return function(){var params;return params={member_id:$scope.member_id,company_id:$scope.company_id},LoginService.memberQuery(params).then(function(member){return $scope.member=member})}}(this),$scope.checkIfLoggedIn=function(){return function(){return LoginService.checkLogin()}}(this),$scope.checkIfLoggedIn(),setPurchaseCompany=function(company){return $scope.bb.company_id=company.id,$scope.bb.company=new BBModel.Company(company),$scope.company=$scope.bb.company,$scope.bb.item_defaults.company=$scope.bb.company,company.settings&&(company.settings.merge_resources&&($scope.bb.item_defaults.merge_resources=!0),company.settings.merge_people)?$scope.bb.item_defaults.merge_people=!0:void 0},$scope.loadSurvey=function(){return function(){return $scope.company||$scope.purchase.$get("company").then(function(company){return setPurchaseCompany(company)}),$scope.purchase.$has("client")&&$scope.purchase.$get("client").then(function(client){return $scope.setClient(new BBModel.Client(client))}),$scope.purchase.getBookingsPromise().then(function(bookings){var address,booking,pretty_address,_i,_len,_ref,_results;for($scope.bookings=bookings,_ref=$scope.bookings,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)booking=_ref[_i],booking.datetime&&(booking.pretty_date=moment(booking.datetime).format("dddd, MMMM Do YYYY")),booking.address&&(address=new BBModel.Address(booking.address),pretty_address=address.addressSingleLine(),booking.pretty_address=pretty_address),_results.push(booking.$get("survey_questions").then(function(details){var item_details;return item_details=new BBModel.ItemDetails(details),booking.survey_questions=item_details.survey_questions,booking.getSurveyAnswersPromise().then(function(answers){var answer,question,_j,_len1,_ref1,_results1;for(booking.survey_answers=answers,_ref1=booking.survey_questions,_results1=[],_j=0,_len1=_ref1.length;_len1>_j;_j++)question=_ref1[_j],_results1.push(booking.survey_answers?function(){var _k,_len2,_ref2,_results2;for(_ref2=booking.survey_answers,_results2=[],_k=0,_len2=_ref2.length;_len2>_k;_k++)answer=_ref2[_k],_results2.push(answer.question_text===question.name&&answer.value?question.answer=answer.value:void 0);return _results2}():void 0);return _results1})}));return _results},function(){return $scope.setLoaded($scope),failMsg()})}}(this),$scope.submitSurveyLogin=function(){return function(form){return ValidatorService.validateForm(form)?LoginService.companyLogin($scope.company,{},{email:$scope.login.email,password:$scope.login.password,id:$scope.company.id}).then(function(member){return LoginService.setLogin(member),$scope.loadPurchase().then(function(purchase){return $scope.loadSurvey(purchase)})},function(err){return showLoginError(),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):void 0}}(this),$scope.loadPurchase=function(){return function(){var auth_token,id,params,purchase_id,split;return purchase_id=window.location.search,split=purchase_id.split("="),id=split.pop(),params={purchase_id:id,url_root:$scope.bb.api_url},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),PurchaseService.query(params).then(function(purchase){return $scope.purchase=purchase,$scope.total=$scope.purchase,$scope.purchase},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.loadCompany=function(){return function(){var company_id,id,split;return company_id=window.location.pathname,split=company_id.split("/"),id=split.pop(),LoginService.companyQuery(id).then(function(company){return setPurchaseCompany(company)})}}(this),$scope.submitSurvey=function(){return function(form){var booking,params,_i,_len,_ref,_results;
if(ValidatorService.validateForm(form)){for(_ref=$scope.bookings,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)booking=_ref[_i],booking.checkReady(),booking.ready?($scope.notLoaded($scope),booking.client_id=$scope.client.id,params=booking,_results.push(PurchaseBookingService.addSurveyAnswersToBooking(params).then(function(){return $scope.setLoaded($scope),$scope.completed=!0},function(){return $scope.setLoaded($scope)}))):_results.push($scope.decideNextPage(route));return _results}}}(this),$scope.submitBookingRef=function(){return function(form){var auth_token,params;if(ValidatorService.validateForm(form))return params={booking_ref:$scope.booking_ref,url_root:$scope.bb.api_url,raw:!0},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),PurchaseService.bookingRefQuery(params).then(function(purchase){return $scope.purchase=purchase,$scope.total=$scope.purchase,$scope.loadSurvey($scope.purchase)},function(err){return showLoginError(),$scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.storeBookingCookie=function(){return document.cookie="bookingrefsc="+$scope.booking_ref}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTimes",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"TimeList"}}),angular.module("BB.Controllers").controller("TimeList",function($attrs,$element,$scope,$rootScope,$q,TimeService,AlertService,BBModel){return $scope.controller="public.controllers.TimeList",$scope.notLoaded($scope),$scope.data_source||($scope.data_source=$scope.bb.current_item),$scope.options=$scope.$eval($attrs.bbTimes)||{},$rootScope.connection_started.then(function(){return function(){return $scope.loadDay()}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.setDate=function(){return function(date){var day;return day=new BBModel.Day({date:date,spaces:1}),$scope.setDay(day)}}(this),$scope.setDay=function(){return function(dayItem){return $scope.selected_day=dayItem,$scope.selected_date=dayItem.date}}(this),$scope.setDataSource=function(){return function(source){return $scope.data_source=source}}(this),$scope.setItemLinkSource=function(){return function(source){return $scope.item_link_source=source}}(this),$scope.$on("dateChanged",function(){return function(event,newdate){return $scope.setDate(newdate),$scope.loadDay()}}(this)),$scope.$on("currentItemUpdate",function(){return $scope.loadDay()}),$scope.format_date=function(){return function(fmt){return $scope.data_source.date?$scope.data_source.date.date.format(fmt):void 0}}(this),$scope.selectSlot=function(){return function(slot,route){return slot&&slot.availability()>0?($scope.item_link_source&&$scope.data_source.setItem($scope.item_link_source),$scope.selected_day&&($scope.setLastSelectedDate($scope.selected_day.date),$scope.data_source.setDate($scope.selected_day)),$scope.data_source.setTime(slot),$scope.data_source.ready?$scope.addItemToBasket().then(function(){return $scope.decideNextPage(route)}):$scope.decideNextPage(route)):void 0}}(this),$scope.highlightSlot=function(){return function(slot){return slot&&slot.availability()>0?($scope.selected_day&&($scope.setLastSelectedDate($scope.selected_day.date),$scope.data_source.setDate($scope.selected_day)),$scope.data_source.setTime(slot),$scope.$broadcast("slotChanged")):void 0}}(this),$scope.status=function(slot){var status;if(slot)return status=slot.status()},$scope.add=function(){return function(type,amount){var newdate;return newdate=moment($scope.data_source.date.date).add(amount,type),$scope.data_source.setDate(new BBModel.Day({date:newdate.format(),spaces:0})),$scope.setLastSelectedDate(newdate),$scope.loadDay(),$scope.$broadcast("dateChanged",newdate)}}(this),$scope.subtract=function(){return function(type,amount){return $scope.add(type,-amount)}}(this),$scope.loadDay=function(){return function(){var pslots;return AlertService.clear(),$scope.notLoaded($scope),$scope.data_source&&$scope.data_source.days_link||$scope.item_link_source?(!$scope.selected_date&&$scope.data_source&&$scope.data_source.date&&($scope.selected_date=$scope.data_source.date.date),pslots=TimeService.query({company:$scope.bb.company,cItem:$scope.data_source,item_link:$scope.item_link_source,date:$scope.selected_date,client:$scope.client}),pslots["finally"](function(){return $scope.setLoaded($scope)}),pslots.then(function(data){var dtimes,found_time,pad,s,t,v,_i,_j,_k,_len,_len1,_len2,_ref;if($scope.slots=data,$scope.$broadcast("slotsUpdated"),$scope.add_padding&&data.length>0){for(dtimes={},_i=0,_len=data.length;_len>_i;_i++)s=data[_i],dtimes[s.time]=1;for(_ref=$scope.add_padding,v=_j=0,_len1=_ref.length;_len1>_j;v=++_j)pad=_ref[v],dtimes[pad]||data.splice(v,0,new BBModel.TimeSlot({time:pad,avail:0},data[0].service))}if(($scope.data_source.requested_time||$scope.data_source.time)&&$scope.selected_date.isSame($scope.data_source.date.date)){for(found_time=!1,_k=0,_len2=data.length;_len2>_k;_k++)t=data[_k],t.time===$scope.data_source.requested_time&&($scope.data_source.requestedTimeUnavailable(),$scope.selectSlot(t),found_time=!0),$scope.data_source.time&&t.time===$scope.data_source.time.time&&($scope.data_source.setTime(t),found_time=!0);if(!found_time)return $scope.options.persist_requested_time||$scope.data_source.requestedTimeUnavailable(),$scope.time_not_found=!0,AlertService.add("danger",{msg:"Sorry, your requested time slot is not available. Please choose a different time."})}},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):$scope.setLoaded($scope)}}(this),$scope.padTimes=function(){return function(times){return $scope.add_padding=times}}(this),$scope.setReady=function(){return function(){return $scope.data_source.time?$scope.data_source.ready?$scope.addItemToBasket():!0:(AlertService.clear(),AlertService.add("danger",{msg:"You need to select a time slot"}),!1)}}(this)}),angular.module("BB.Directives").directive("bbAccordianGroup",function(){return{restrict:"AE",scope:!0,controller:"AccordianGroup"}}),angular.module("BB.Controllers").controller("AccordianGroup",function($scope){var hasAvailability,updateAvailability;return $scope.accordian_slots=[],$scope.is_open=!1,$scope.has_availability=!1,$scope.is_selected=!1,$scope.collaspe_when_time_selected=!0,$scope.start_time=0,$scope.end_time=0,$scope.init=function(){return function(start_time,end_time,options){var slot,_i,_len,_ref;for($scope.start_time=start_time,$scope.end_time=end_time,$scope.collaspe_when_time_selected=options&&!options.collaspe_when_time_selected?!1:!0,_ref=$scope.slots,_i=0,_len=_ref.length;_len>_i;_i++)slot=_ref[_i],slot.time>=start_time&&slot.time<end_time&&$scope.accordian_slots.push(slot);return updateAvailability()}}(this),updateAvailability=function(){return function(){var item;if($scope.has_availability=!1,$scope.accordian_slots){if($scope.has_availability=hasAvailability(),item=$scope.data_source,!(item.time&&item.time.time>=$scope.start_time&&item.time.time<$scope.end_time&&item.date&&item.date.date.isSame($scope.selected_day.date,"day")))return $scope.is_selected=!1,$scope.is_open=!1;if($scope.is_selected=!0,!$scope.collaspe_when_time_selected)return $scope.is_open=!0}}}(this),hasAvailability=function(){return function(){var slot,_i,_len,_ref;if(!$scope.accordian_slots)return!1;for(_ref=$scope.accordian_slots,_i=0,_len=_ref.length;_len>_i;_i++)if(slot=_ref[_i],slot.availability()>0)return!0;return!1}}(this),$scope.$on("slotChanged",function(){return function(){return updateAvailability()}}(this)),$scope.$on("slotsUpdated",function(){return function(){var slot,_i,_len,_ref;for($scope.accordian_slots=[],_ref=$scope.slots,_i=0,_len=_ref.length;_len>_i;_i++)slot=_ref[_i],slot.time>=$scope.start_time&&slot.time<$scope.end_time&&$scope.accordian_slots.push(slot);return updateAvailability()}}(this))})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTimeRanges",function(){return{restrict:"AE",replace:!0,scope:!0,priority:1,controller:"TimeRangeList"}}),angular.module("BB.Controllers").controller("TimeRangeList",function($scope,$element,$attrs,$rootScope,$q,TimeService,AlertService,BBModel,FormDataStoreService){var currentPostcode,setTimeRange;return $scope.controller="public.controllers.TimeRangeList",currentPostcode=$scope.bb.postcode,FormDataStoreService.init("TimeRangeList",$scope,["selected_slot","postcode","original_start_date","start_at_week_start"]),currentPostcode!==$scope.postcode&&($scope.selected_slot=null,$scope.selected_date=null),$scope.postcode=$scope.bb.postcode,$scope.notLoaded($scope),$scope.data_source||($scope.data_source=$scope.bb.current_item),$rootScope.connection_started.then(function(){var diff,selected_day,start_date;return $scope.options=$scope.$eval($attrs.bbTimeRanges)||{},$scope.time_range_length=null!=$attrs.bbTimeRangeLength?$scope.$eval($attrs.bbTimeRangeLength):$scope.options&&$scope.options.time_range_length?$scope.options.time_range_length:7,(null!=$attrs.bbDayOfWeek||$scope.options&&$scope.options.day_of_week)&&($scope.day_of_week=null!=$attrs.bbDayOfWeek?$scope.$eval($attrs.bbDayOfWeek):$scope.options.day_of_week),(null!=$attrs.bbSelectedDay||$scope.options&&$scope.options.selected_day)&&(selected_day=moment(null!=$attrs.bbSelectedDay?$scope.$eval($attrs.bbSelectedDay):$scope.options.selected_day),moment.isMoment(selected_day)&&($scope.selected_day=selected_day)),!$scope.start_date&&$scope.last_selected_date?$scope.original_start_date?(diff=$scope.last_selected_date.diff($scope.original_start_date,"days"),diff%=$scope.time_range_length,diff=0===diff?diff:diff+1,start_date=$scope.last_selected_date.clone().subtract(diff,"days"),setTimeRange($scope.last_selected_date,start_date)):setTimeRange($scope.last_selected_date):$scope.bb.current_item.date?setTimeRange($scope.bb.current_item.date.date):$scope.selected_day?($scope.original_start_date=$scope.original_start_date||moment($scope.selected_day),setTimeRange($scope.selected_day)):($scope.start_at_week_start=!0,setTimeRange(moment())),$scope.loadData()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),setTimeRange=function(selected_date,start_date){$scope.start_date=start_date?start_date:$scope.day_of_week?selected_date.clone().day($scope.day_of_week):$scope.start_at_week_start?selected_date.clone().startOf("week"):selected_date.clone(),$scope.selected_day=selected_date,$scope.selected_date=$scope.selected_day.toDate()},$scope.init=function(options){return null==options&&(options={}),null==options.selected_day||options.selected_day._isAMomementObject?void 0:$scope.selected_day=moment(options.selected_day)},$scope.moment=function(){return moment()},$scope.setDataSource=function(source){return $scope.data_source=source},$scope.$on("currentItemUpdate",function(){return $scope.loadData()}),$scope.add=function(type,amount){switch(amount>0&&($element.removeClass("subtract"),$element.addClass("add")),$scope.selected_day=moment($scope.selected_date),type){case"days":setTimeRange($scope.selected_day.add(amount,"days"));break;case"weeks":$scope.start_date.add(amount,"weeks"),setTimeRange($scope.start_date)}return $scope.loadData()},$scope.subtract=function(type,amount){return $element.removeClass("add"),$element.addClass("subtract"),$scope.add(type,-amount)},$scope.isSubtractValid=function(type,amount){var date;return $scope.start_date?(date=$scope.start_date.clone().subtract(amount,type),!date.isBefore(moment(),"day")):!0},$scope.selectedDateChanged=function(){return setTimeRange(moment($scope.selected_date)),$scope.selected_slot=null,$scope.loadData()},$scope.updateHideStatus=function(){var day,_i,_len,_ref,_results;for(_ref=$scope.days,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)day=_ref[_i],_results.push(day.hide=!day.date.isSame($scope.selected_day,"day"));return _results},$scope.isPast=function(){return $scope.start_date?moment().isAfter($scope.start_date):!0},$scope.status=function(day,slot){var status;if(slot)return status=slot.status()},$scope.selectSlot=function(day,slot,route){return slot&&slot.availability()>0?($scope.bb.current_item.setTime(slot),day&&($scope.setLastSelectedDate(day.date),$scope.bb.current_item.setDate(day)),$scope.bb.current_item.reserve_ready?($scope.notLoaded($scope),$scope.addItemToBasket().then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):$scope.decideNextPage(route)):void 0},$scope.highlightSlot=function(day,slot){var curItem;return curItem=$scope.bb.current_item,slot&&slot.availability()>0?(day&&($scope.setLastSelectedDate(day.date),curItem.setDate(day)),curItem.setTime(slot),curItem.setDate(day),$scope.selected_slot=slot,$scope.selected_day=day.date,$scope.selected_date=day.date.toDate(),!$scope.bb.current_item.earliest_time_slot||!$scope.bb.current_item.earliest_time_slot.selected||$scope.bb.current_item.earliest_time_slot.date.isSame(day.date,"day")&&$scope.bb.current_item.earliest_time_slot.time===slot.time||($scope.bb.current_item.earliest_time_slot.selected=!1),$scope.updateHideStatus(),$rootScope.$emit("time:selected"),$scope.$broadcast("slotChanged",day,slot)):void 0},$scope.loadData=function(){var curItem,date,duration,edate,loc,promise;return curItem=$scope.bb.current_item,curItem.service&&($scope.min_date=curItem.service.min_advance_datetime,$scope.max_date=curItem.service.max_advance_datetime,$scope.selected_day&&$scope.selected_day.isBefore(curItem.service.min_advance_datetime,"day")&&setTimeRange(curItem.service.min_advance_datetime)),date=$scope.start_date,edate=moment(date).add($scope.time_range_length,"days"),$scope.end_date=moment(edate).add(-1,"days"),AlertService.clear(),duration=$scope.bb.current_item.duration,$scope.bb.current_item.min_duration&&(duration=$scope.bb.current_item.min_duration),loc=null,$scope.bb.postcode&&(loc=",,,,"+$scope.bb.postcode+","),$scope.data_source&&$scope.data_source.days_link?($scope.notLoaded($scope),loc=null,$scope.bb.postcode&&(loc=",,,,"+$scope.bb.postcode+","),promise=TimeService.query({company:$scope.bb.company,cItem:$scope.data_source,date:date,client:$scope.client,end_date:$scope.end_date,duration:duration,location:loc,num_resources:$scope.bb.current_item.num_resources,available:1}),promise["finally"](function(){return $scope.setLoaded($scope)}),promise.then(function(dateTimeArr){var d,day,dtimes,found_time,move_date,pad,pair,slot,timeSlotsArr,v,_i,_j,_k,_l,_len,_len1,_len2,_len3,_len4,_m,_ref,_ref1,_ref2;if($scope.days=[],null!=$scope.bb.moving_booking&&(move_date=$scope.bb.moving_booking.datetime,move_date>=date&&edate>=move_date))if(0===dateTimeArr[move_date.toISODate()].length)v=move_date.minutes()+60*move_date.hours(),dateTimeArr[move_date.toISODate()].splice(0,0,new BBModel.TimeSlot({time:v,avail:1},curItem));else for(_ref=dateTimeArr[move_date.toISODate()],_i=0,_len=_ref.length;_len>_i;_i++)slot=_ref[_i],curItem.time&&curItem.time.time===slot.time&&(slot.avail=1);for(_ref1=_.sortBy(_.pairs(dateTimeArr),function(pair){return pair[0]}),_j=0,_len1=_ref1.length;_len1>_j;_j++){if(pair=_ref1[_j],d=pair[0],timeSlotsArr=pair[1],day={date:moment(d),slots:timeSlotsArr},$scope.days.push(day),timeSlotsArr.length>0&&((!curItem.earliest_time||curItem.earliest_time.isAfter(d))&&(curItem.earliest_time=moment(d).add(timeSlotsArr[0].time,"minutes")),(!curItem.earliest_time_slot||curItem.earliest_time_slot.date.isAfter(d))&&(curItem.earliest_time_slot={date:moment(d).add(timeSlotsArr[0].time,"minutes"),time:timeSlotsArr[0].time})),$scope.add_padding&&timeSlotsArr.length>0){for(dtimes={},_k=0,_len2=timeSlotsArr.length;_len2>_k;_k++)slot=timeSlotsArr[_k],dtimes[slot.time]=1,slot.date=day.date.format("DD-MM-YY");for(_ref2=$scope.add_padding,v=_l=0,_len3=_ref2.length;_len3>_l;v=++_l)pad=_ref2[v],dtimes[pad]||timeSlotsArr.splice(v,0,new BBModel.TimeSlot({time:pad,avail:0},timeSlotsArr[0].service))}if((curItem.requested_time||curItem.time)&&day.date.isSame(curItem.date.date)){for(found_time=!1,_m=0,_len4=timeSlotsArr.length;_len4>_m;_m++){if(slot=timeSlotsArr[_m],slot.time===curItem.requested_time)return curItem.requestedTimeUnavailable(),$scope.selectSlot(day,slot),found_time=!0,void($scope.days=[]);curItem.time&&curItem.time.time===slot.time&&1===slot.avail&&($scope.selected_slot&&$scope.selected_slot.time!==curItem.time.time&&($scope.selected_slot=curItem.time),curItem.setTime(slot),found_time=!0)}found_time||(curItem.requestedTimeUnavailable(),AlertService.add("danger",{msg:"Sorry, your requested time slot is not available. Please choose a different time."}))}}return $scope.updateHideStatus()},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})):$scope.setLoaded($scope)},$scope.padTimes=function(times){return $scope.add_padding=times},$scope.setReady=function(){return $scope.bb.current_item.time?$scope.bb.moving_booking&&$scope.bb.current_item.datetime.isSame($scope.bb.current_item.original_datetime)?(AlertService.add("danger",{msg:"Your appointment is already booked for this time."}),!1):$scope.bb.current_item.reserve_ready?$scope.addItemToBasket():!0:(AlertService.add("danger",{msg:"You need to select a time slot"}),!1)},$scope.format_date=function(fmt){return $scope.start_date?$scope.start_date.format(fmt):void 0},$scope.format_start_date=function(fmt){return $scope.format_date(fmt)},$scope.format_end_date=function(fmt){return $scope.end_date?$scope.end_date.format(fmt):void 0},$scope.pretty_month_title=function(month_format,year_format,seperator){var month_year_format,start_date;return null==seperator&&(seperator="-"),month_year_format=month_format+" "+year_format,$scope.start_date&&$scope.end_date&&$scope.end_date.isAfter($scope.start_date,"month")?(start_date=$scope.format_start_date(month_format),11===$scope.start_date.month()&&(start_date=$scope.format_start_date(month_year_format)),start_date+" "+seperator+" "+$scope.format_end_date(month_year_format)):$scope.format_start_date(month_year_format)},$scope.selectEarliestTimeSlot=function(){var day,slot;return day=_.find($scope.days,function(day){return day.date.isSame($scope.bb.current_item.earliest_time_slot.date,"day")}),slot=_.find(day.slots,function(slot){return slot.time===$scope.bb.current_item.earliest_time_slot.time}),day&&slot?($scope.bb.current_item.earliest_time_slot.selected=!0,$scope.highlightSlot(day,slot)):void 0}})}.call(this),function(){"use strict";angular.module("BB.Directives").directive("bbTotal",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Total"}}),angular.module("BB.Controllers").controller("Total",function($scope,$rootScope,$q,$location,$window){return $scope.controller="public.controllers.Total",$scope.notLoaded($scope),$rootScope.connection_started.then(function(){return function(){return $scope.bb.payment_status=null,$scope.total=$scope.bb.total,$scope.setLoaded($scope)}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.print=function(){return function(){return $window.open($scope.bb.partial_url+"print_purchase.html?id="+$scope.total.long_id,"_blank","width=700,height=500,toolbar=0,menubar=0,location=0,status=1,scrollbars=1,resizable=1,left=0,top=0"),!0}}(this)})}.call(this),function(){angular.module("BBMember").controller("editBookingModalForm",function($scope,$modalInstance,$log,booking){return $scope.title="Booking Details",booking.$get("edit_booking").then(function(booking_schema){return $scope.form=booking_schema.form,$scope.schema=booking_schema.schema,booking.getAnswersPromise().then(function(answers){var answer,_i,_len,_ref;for(_ref=answers.answers,_i=0,_len=_ref.length;_len>_i;_i++)answer=_ref[_i],booking["question"+answer.question_id]=answer.value;return $scope.booking=booking})}),$scope.submit=function(booking){return $scope.booking.$put("self",{},booking).then(function(){return $log.info("Booking update success"),$modalInstance.close($scope.booking)},function(){return $log.error("Booking update failure")})},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}})}.call(this),function(){angular.module("BB.Controllers").controller("MembersBookings",function($scope,$rootScope,$location,$filter,$q,$timeout,$modal,MemberBookingService,LoginService,BBModel){var doCancel,flushBookings,getBookings;return $scope.init=function(_this){return function(options){return _this.type=options.type,_this.limit=options.limit}}(this),$scope.$watch("members",function(){return function(){return $scope.members?getBookings():void 0}}(this)),$scope.$watch("member",function(){return function(){return $scope.member?getBookings():void 0}}(this)),$scope.$on("updateBookings",function(){return function(){return flushBookings(),getBookings()}}(this)),getBookings=function(_this){return function(){switch(_this.type){case"upcoming":return $scope.upcoming();case"historical":return $scope.historical("years",-1)}}}(this),flushBookings=function(_this){return function(){var member,params;switch(_this.type){case"upcoming":return params={start_date:moment().format("YYYY-MM-DD")},member=$scope.member,MemberBookingService.flush(member,params)}}}(this),$scope.filter_bookings=function(booking){return booking.deleted===!0},doCancel=function(member,booking){return MemberBookingService.cancel(member,booking).then(function(){return $scope.bookings&&($scope.bookings=$scope.bookings.filter(function(b){return b.id!==booking.id})),$scope.removeBooking?$scope.removeBooking(booking):void 0},function(){return console.log("cancel error")})},$scope.cancel=function(booking){var modalInstance;return modalInstance=$modal.open({templateUrl:"deleteModal.html",windowClass:"bbug",controller:function($scope,$rootScope,$modalInstance,booking){return $scope.controller="ModalDelete",$scope.booking=booking,$scope.confirm_delete=function(){return $modalInstance.close(booking)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},resolve:{booking:function(){return booking}}}),modalInstance.result.then(function(booking){return console.log("close booking",booking,$scope.member,$scope.members),$scope.member&&doCancel($scope.member,booking),$scope.client?doCancel($scope.client,booking):$scope.members?booking.$get("member").then(function(member){return doCancel(member,booking)}):void 0})},$scope.upcoming=function(_this){return function(){var member,members,params,promises;return $scope.notLoaded($scope),params={start_date:moment().format("YYYY-MM-DD")},_this.limit&&(params.per_page=_this.limit),$scope.members?members=$scope.members:$scope.member&&(members=[$scope.member]),promises=function(){var _i,_len,_results;for(_results=[],_i=0,_len=members.length;_len>_i;_i++)member=members[_i],_results.push(MemberBookingService.query(member,params));return _results}(),$q.all(promises).then(function(bookings){return $scope.setLoaded($scope),$scope.bookings=[].concat.apply([],bookings)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.historical=function(_this){return function(type,num){var date,member,members,params,promises;return $scope.notLoaded($scope),date=moment().add(num,type),params={start_date:date.format("YYYY-MM-DD"),end_date:moment().format("YYYY-MM-DD")},_this.limit&&(params.per_page=_this.limit),$scope.members?members=$scope.members:$scope.member&&(members=[$scope.member]),promises=function(){var _i,_len,_results;for(_results=[],_i=0,_len=members.length;_len>_i;_i++)member=members[_i],_results.push(MemberBookingService.query(member,params));return _results}(),$q.all(promises).then(function(bookings){return $scope.setLoaded($scope),$scope.bookings=[].concat.apply([],bookings)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),$scope.move=function(booking,route,options){return null==options&&(options={}),booking.getMemberPromise().then(function(member){return $scope.setClient(member),$scope.notLoaded($scope),$scope.initWidget({company_id:booking.company_id,no_route:!0}),$scope.clearPage(),$timeout(function(){return function(){var new_item;return $scope.bb.moving_booking=booking,new_item=new BBModel.BasketItem(booking,$scope.bb),new_item.setSrcBooking(booking),new_item.ready=!1,booking.$has("resource")&&options.use_resource?booking.$get("resource").then(function(resource){return new_item.setResource(new BBModel.Resource(resource)),booking.$has("service")?booking.$get("service").then(function(service){return new_item.setService(new BBModel.Service(service)),$scope.setBasketItem(new_item),$scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):($scope.setBasketItem(new_item),$scope.setLoaded($scope),$scope.decideNextPage(route))}):booking.$has("service")?booking.$get("service").then(function(service){return new_item.setService(new BBModel.Service(service)),$scope.setBasketItem(new_item),$scope.setLoaded($scope),$scope.decideNextPage(route)},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}):($scope.setBasketItem(new_item),$scope.setLoaded($scope),$scope.decideNextPage(route))}}(this))})},$scope.isMovable=function(booking){return booking.min_cancellation_time?moment().isBefore(booking.min_cancellation_time):booking.datetime.isAfter(moment())}})}.call(this),function(){angular.module("BBMember").directive("memberBookingsTable",function($modal,$log,$rootScope,MemberLoginService,MemberBookingService){var controller,link;return controller=function($scope,$modal){var getBookings;return $scope.loading=!0,$scope.fields||($scope.fields=["describe","full_describe"]),$scope.$watch("member",function(member){return null!=member?getBookings($scope,member):void 0}),$scope.edit=function(id){var booking;return booking=_.find($scope.booking_models,function(b){return b.id===id}),$modal.open({templateUrl:"edit_booking_modal_form.html",controller:"editBookingModalForm",resolve:{booking:function(){return booking}}})},getBookings=function($scope,member){var params;return params={start_date:moment().format("YYYY-MM-DD")},MemberBookingService.query(member,params).then(function(bookings){return $scope.booking_models=bookings,$scope.bookings=_.map(bookings,function(booking){return _.pick(booking,"id","full_describe","describe")}),$scope.loading=!1},function(err){return $log.error(err.data),$scope.loading=!1})}},link=function(scope){var _base,_base1;return $rootScope.bb||($rootScope.bb={}),(_base=$rootScope.bb).api_url||(_base.api_url=scope.apiUrl),(_base1=$rootScope.bb).api_url||(_base1.api_url="http://www.bookingbug.com")},{link:link,controller:controller,templateUrl:"member_bookings_table.html",scope:{apiUrl:"@",fields:"=?",member:"="}}})}.call(this),function(){angular.module("BBMember").directive("memberForm",function($modal,$log,$rootScope){var controller,link;return controller=function($scope){return $scope.loading=!0,$scope.$watch("member",function(member){return null!=member?member.$get("edit_member").then(function(member_schema){return $scope.form=member_schema.form,$scope.schema=member_schema.schema,$scope.loading=!1}):void 0}),$scope.submit=function(form){return $scope.loading=!0,$scope.member.$put("self",{},form).then(function(){return $log.info("Successfully updated member"),$scope.loading=!1},function(err){return $log.error("Failed to update member - "+err),$scope.loading=!1})}},link=function(scope,element,attrs){var _base,_base1;return $rootScope.bb||($rootScope.bb={}),(_base=$rootScope.bb).api_url||(_base.api_url=attrs.apiUrl),(_base1=$rootScope.bb).api_url||(_base1.api_url="http://www.bookingbug.com")},{link:link,controller:controller,template:'<div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\n<form sf-schema="schema" sf-form="form" sf-model="member"\n  ng-submit="submit(member)" ng-hide="loading"></form>'}})}.call(this),function(){angular.module("BBMember").directive("loginMember",function($modal,$log,$rootScope,MemberLoginService,$templateCache,$q){var link,loginMemberController,pickCompanyController;return loginMemberController=function($scope,$modalInstance,company_id){return $scope.title="Login",$scope.schema={type:"object",properties:{email:{type:"string",title:"Email"},password:{type:"string",title:"Password"}}},$scope.form=[{key:"email",type:"email",feedback:!1,autofocus:!0},{key:"password",type:"password",feedback:!1}],$scope.login_form={},$scope.submit=function(form){var options;return options={company_id:company_id},MemberLoginService.login(form,options).then(function(member){return member.email=form.email,member.password=form.password,$modalInstance.close(member)},function(err){return $modalInstance.dismiss(err)})},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},pickCompanyController=function($scope,$modalInstance,companies){var c;return $scope.title="Pick Company",$scope.schema={type:"object",properties:{company_id:{type:"integer",title:"Company"}}},$scope.schema.properties.company_id["enum"]=function(){var _i,_len,_results;for(_results=[],_i=0,_len=companies.length;_len>_i;_i++)c=companies[_i],_results.push(c.id);return _results}(),$scope.form=[{key:"company_id",type:"select",titleMap:function(){var _i,_len,_results;for(_results=[],_i=0,_len=companies.length;_len>_i;_i++)c=companies[_i],_results.push({value:c.id,name:c.name});return _results}(),autofocus:!0}],$scope.pick_company_form={},$scope.submit=function(form){return $modalInstance.close(form.company_id)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}},link=function(scope){var loginModal,pickCompanyModal,tryLogin,_base,_base1;return $rootScope.bb||($rootScope.bb={}),(_base=$rootScope.bb).api_url||(_base.api_url=scope.apiUrl),(_base1=$rootScope.bb).api_url||(_base1.api_url="http://www.bookingbug.com"),loginModal=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:"login_modal_form.html",controller:loginMemberController,resolve:{company_id:function(){return scope.companyId}}}),modalInstance.result.then(function(result){return scope.memberEmail=result.email,scope.memberPassword=result.password,result.$has("members")?result.$get("members").then(function(members){var m;return scope.members=members,$q.all(function(){var _i,_len,_results;for(_results=[],_i=0,_len=members.length;_len>_i;_i++)m=members[_i],_results.push(m.$get("company"));return _results}()).then(function(companies){return pickCompanyModal(companies)})}):scope.member=result},function(){return loginModal()})},pickCompanyModal=function(companies){var modalInstance;return modalInstance=$modal.open({templateUrl:"pick_company_modal_form.html",controller:pickCompanyController,resolve:{companies:function(){return companies}}}),modalInstance.result.then(function(company_id){return scope.companyId=company_id,tryLogin()},function(){return pickCompanyModal()})},tryLogin=function(){var login_form,options;return login_form={email:scope.memberEmail,password:scope.memberPassword},options={company_id:scope.companyId},MemberLoginService.login(login_form,options).then(function(result){return result.$has("members")?result.$get("members").then(function(members){var m;return scope.members=members,$q.all(function(){var _i,_len,_results;for(_results=[],_i=0,_len=members.length;_len>_i;_i++)m=members[_i],_results.push(m.$get("company"));return _results}()).then(function(companies){return pickCompanyModal(companies)})}):scope.member=result},function(){return loginModal()})},scope.memberEmail&&scope.memberPassword?tryLogin():loginModal()},{link:link,scope:{memberEmail:"@",memberPassword:"@",companyId:"@",apiUrl:"@",member:"="},transclude:!0,template:"<div ng-hide='member'><img src='/BB_wait.gif' class=\"loader\"></div>\n<div ng-show='member' ng-transclude></div>"}})}.call(this),function(){"use strict";var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child
}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Member.BookingModel",function($q,$window,BBModel,BaseModel){var Member_Booking;return Member_Booking=function(_super){function Member_Booking(data){this.getMemberPromise=__bind(this.getMemberPromise,this),Member_Booking.__super__.constructor.call(this,data),this.datetime=moment.parseZone(this.datetime),this.time_zone&&this.datetime.tz(this.time_zone),this.end_datetime=moment.parseZone(this.end_datetime),this.time_zone&&this.end_datetime.tz(this.time_zone)}return __extends(Member_Booking,_super),Member_Booking.prototype.getGroup=function(){return this.group?this.group:this._data.$has("event_groups")?this._data.$get("event_groups").then(function(_this){return function(group){return _this.group=group,_this.group}}(this)):void 0},Member_Booking.prototype.getColour=function(){return this.getGroup()?this.getGroup().colour:"#FFFFFF"},Member_Booking.prototype.getCompany=function(){return this.company?this.company:this.$has("company")?this._data.$get("company").then(function(_this){return function(company){return _this.company=new BBModel.Company(company),_this.company}}(this)):void 0},Member_Booking.prototype.getAnswers=function(){var defer;return defer=$q.defer(),this.answers&&defer.resolve(this.answers),this._data.$has("answers")?this._data.$get("answers").then(function(_this){return function(answers){var a;return _this.answers=function(){var _i,_len,_results;for(_results=[],_i=0,_len=answers.length;_len>_i;_i++)a=answers[_i],_results.push(new BBModel.Answer(a));return _results}(),defer.resolve(_this.answers)}}(this)):defer.resolve([]),defer.promise},Member_Booking.prototype.printed_price=function(){return parseFloat(this.price)%1===0?""+this.price:$window.sprintf("%.2f",parseFloat(this.price))},Member_Booking.prototype.getMemberPromise=function(){var defer;return defer=$q.defer(),this.member&&defer.resolve(this.member),this._data.$has("member")&&this._data.$get("member").then(function(_this){return function(member){return _this.member=new BBModel.Member.Member(member),defer.resolve(_this.member)}}(this)),defer.promise},Member_Booking}(BaseModel)})}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Member.MemberModel",function($q,BBModel,BaseModel,ClientModel){var Member_Member;return Member_Member=function(_super){function Member_Member(){return Member_Member.__super__.constructor.apply(this,arguments)}return __extends(Member_Member,_super),Member_Member}(ClientModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Member.PrepaidBookingModel",function($q,BBModel,BaseModel){var Member_PrePaidBooking;return Member_PrePaidBooking=function(_super){function Member_PrePaidBooking(data){Member_PrePaidBooking.__super__.constructor.call(this,data)}return __extends(Member_PrePaidBooking,_super),Member_PrePaidBooking.prototype.checkValidity=function(event){return this.service_id&&event.service_id&&this.service_id!==event.service_id?!1:this.resource_id&&event.resource_id&&this.resource_id!==event.resource_id?!1:this.person_id&&event.person_id&&this.person_id!==event.person_id?!1:!0},Member_PrePaidBooking}(BaseModel)})}.call(this),function(){angular.module("BB.Services").factory("AddressListService",function($q,$window,halClient){return{query:function(prms){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/company/{company_id}/addresses/{post_code}",uri=new $window.UriTemplate.parse(href).expand({company_id:prms.company.id,post_code:prms.post_code}),halClient.$get(uri,{}).then(function(addressList){return deferred.resolve(addressList)},function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},getAddress:function(prms){var deferred,href,uri;return deferred=$q.defer(),href="/api/v1/company/{company_id}/addresses/address/{id}",uri=new $window.UriTemplate.parse(href).expand({company_id:prms.company.id,id:prms.id}),halClient.$get(uri,{}).then(function(customerAddress){return deferred.resolve(customerAddress)},function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("AlertService",function($rootScope){var alertService,titleLookup;return $rootScope.alerts=[],titleLookup=function(type,title){if(title)return title;switch(type){case"error":case"danger":title="Error";break;default:title=null}return title},alertService={add:function(type,_arg){var msg,title;return title=_arg.title,msg=_arg.msg,$rootScope.alerts=[],$rootScope.alerts.push({type:type,title:titleLookup(type,title),msg:msg,close:function(){return alertService.closeAlert(this)}}),$rootScope.$emit("alert:raised")},closeAlert:function(alert){return this.closeAlertIdx($rootScope.alerts.indexOf(alert))},closeAlertIdx:function(index){return $rootScope.alerts.splice(index,1)},clear:function(){return $rootScope.alerts=[]},error:function(alert){return this.add("error",{title:alert.title,msg:alert.msg})},danger:function(alert){return this.add("danger",{title:alert.title,msg:alert.msg})},info:function(alert){return this.add("info",{title:alert.title,msg:alert.msg})},warning:function(alert){return this.add("warning",{title:alert.title,msg:alert.msg})}}})}.call(this),function(){angular.module("BB.Services").factory("BasketService",function($q,$rootScope,BBModel,MutexService){return{addItem:function(company,params){var data,deferred,lnk;return deferred=$q.defer(),lnk=params.item.book_link,data=params.item.getPostData(),lnk?MutexService.getLock().then(function(mutex){return lnk.$post("book",params,data).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,item,promises,_i,_len;for(promises=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return deferred.resolve(mbasket)}):deferred.resolve(mbasket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}):deferred.reject("rel book not found for event"),deferred.promise},applyCoupon:function(company,params){var deferred;return deferred=$q.defer(),MutexService.getLock().then(function(mutex){return company.$post("coupon",{},{coupon:params.coupon}).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,item,promises,_i,_len;for(promises=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return deferred.resolve(mbasket)}):deferred.resolve(mbasket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}),deferred.promise},updateBasket:function(company,params){var data,deferred,item,lnk,xdata,_i,_len,_ref;for(deferred=$q.defer(),data={entire_basket:!0,items:[]},_ref=params.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],item.book_link&&(lnk=item.book_link),xdata=item.getPostData(),data.items.push(xdata);return lnk?(MutexService.getLock().then(function(mutex){return lnk.$post("book",params,data).then(function(basket){var mbasket;return MutexService.unlock(mutex),company.$flush("basket"),mbasket=new BBModel.Basket(basket,params.bb),basket.$get("items").then(function(items){var i,promises,_j,_len1;for(promises=[],_j=0,_len1=items.length;_len1>_j;_j++)i=items[_j],item=new BBModel.BasketItem(i,params.bb),mbasket.addItem(item),promises=promises.concat(item.promises);return promises.length>0?$q.all(promises).then(function(){return deferred.resolve(mbasket)}):deferred.resolve(mbasket)},function(err){return deferred.reject(err)})},function(err){return MutexService.unlock(mutex),deferred.reject(err)})}),deferred.promise):(deferred.reject("rel book not found for event"),deferred.promise)},checkPrePaid:function(company,event,pre_paid_bookings){var booking,valid_pre_paid,_i,_len;for(valid_pre_paid=null,_i=0,_len=pre_paid_bookings.length;_len>_i;_i++)booking=pre_paid_bookings[_i],booking.checkValidity(event)&&(valid_pre_paid=booking);return valid_pre_paid},query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("basket")?company.$get("basket").then(function(basket){return basket=new BBModel.Basket(basket,params.bb),basket.$has("items")&&basket.$get("items").then(function(items){var item,_i,_len,_results;for(_results=[],_i=0,_len=items.length;_len>_i;_i++)item=items[_i],_results.push(basket.addItem(new BBModel.BasketItem(item,params.bb)));return _results}),deferred.resolve(basket)},function(err){return deferred.reject(err)}):deferred.reject("rel basket not found for company"),deferred.promise},deleteItem:function(item,company,params){var deferred;return params||(params={}),deferred=$q.defer(),item.$has("self")?item.$del("self",params).then(function(basket){return company.$flush("basket"),basket=new BBModel.Basket(basket,params.bb),basket.$has("items")&&basket.$get("items").then(function(items){var _i,_len,_results;for(_results=[],_i=0,_len=items.length;_len>_i;_i++)item=items[_i],_results.push(basket.addItem(new BBModel.BasketItem(item,params.bb)));return _results}),deferred.resolve(basket)},function(err){return deferred.reject(err)}):deferred.reject("rel self not found for item"),deferred.promise},checkout:function(company,basket,params){var data,deferred;return deferred=$q.defer(),basket.$has("checkout")?(data=basket.getPostData(),data.affiliate_id=$rootScope.affiliate_id,basket.$post("checkout",params,data).then(function(total){var tot;return $rootScope.$broadcast("updateBookings"),tot=new BBModel.Purchase.Total(total),$rootScope.$broadcast("newCheckout",tot),deferred.resolve(tot)},function(err){return deferred.reject(err)})):deferred.reject("rel checkout not found for basket"),deferred.promise},empty:function(bb){var deferred;return deferred=$q.defer(),bb.company.$del("basket").then(function(basket){return bb.company.$flush("basket"),deferred.resolve(new BBModel.Basket(basket,bb))},function(err){return deferred.reject(err)}),deferred.promise},memberCheckout:function(basket,params){var data,deferred,item;return deferred=$q.defer(),basket.$has("checkout")?null===$rootScope.member?deferred.reject("member not set"):(basket._data.setOption("auth_token",$rootScope.member._data.getOption("auth_token")),data={items:function(){var _i,_len,_ref,_results;for(_ref=basket.items,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],_results.push(item._data);return _results}()},basket.$post("checkout",params,data).then(function(total){return total.$has("member")&&total.$get("member").then(function(member){return $rootScope.member.flushBookings(),$rootScope.member=new BBModel.Member.Member(member)}),deferred.resolve(total)},function(err){return deferred.reject(err)})):deferred.reject("rel checkout not found for basket"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("BreadcrumbService",function(){var current_step;return current_step=1,{setCurrentStep:function(step){return current_step=step},getCurrentStep:function(){return current_step}}})}.call(this),function(){angular.module("BB.Services").factory("CategoryService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("categories")?company.$get("named_categories").then(function(){return function(resource){return resource.$get("categories").then(function(items){var cat,categories,i,_i,_j,_len;for(categories=[],_i=_j=0,_len=items.length;_len>_j;_i=++_j)i=items[_i],cat=new BBModel.Category(i),cat.order||(cat.order=_i),categories.push(cat);return deferred.resolve(categories)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No categories found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ClientService",function($q,BBModel,MutexService){return{create:function(company,client){var deferred;return deferred=$q.defer(),company.$has("client")?MutexService.getLock().then(function(mutex){return company.$post("client",{},client.getPostData()).then(function(){return function(cl){return deferred.resolve(new BBModel.Client(cl)),MutexService.unlock(mutex)}}(this),function(){return function(err){return deferred.reject(err),MutexService.unlock(mutex)}}(this))}):deferred.reject("Cannot create new people for this company"),deferred.promise},update:function(company,client){var deferred;return deferred=$q.defer(),MutexService.getLock().then(function(mutex){return client.$put("self",{},client.getPostData()).then(function(){return function(cl){return deferred.resolve(new BBModel.Client(cl)),MutexService.unlock(mutex)}}(this),function(){return function(err){return deferred.reject(err),MutexService.unlock(mutex)}}(this))}),deferred.promise},create_or_update:function(company,client){return client.$has("self")?this.update(company,client):this.create(company,client)},query_by_email:function(company,email){var deferred;return deferred=$q.defer(),null!=company&&null!=email?company.$get("client_by_email",{email:email}).then(function(){return function(client){return deferred.resolve(null!=client?new BBModel.Client(client):{})}}(this),function(err){return deferred.reject(err)}):deferred.reject("No company or email defined"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ClientDetailsService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("client_details")?company.$get("client_details").then(function(){return function(details){return deferred.resolve(new BBModel.ClientDetails(details))}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No client_details found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("CompanyService",function($q,halClient,BBModel){return{query:function(company_id,options){var deferred,url;return options.root||(options.root=""),url=options.root+"/api/v1/company/"+company_id,deferred=$q.defer(),halClient.$get(url,options).then(function(){return function(company){return deferred.resolve(company)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},queryChildren:function(company){var deferred;return deferred=$q.defer(),company.$has("companies")?company.$get("companies").then(function(){return function(resource){return resource.$get("companies").then(function(items){var companies,i,_i,_len;for(companies=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],companies.push(new BBModel.Company(i));return deferred.resolve(companies)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No child companies found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("CustomTextService",function($q){return{BookingText:function(company,basketItem){var deferred;return deferred=$q.defer(),company.$get("booking_text").then(function(){return function(emb){return emb.$get("booking_text").then(function(details){var detail,link,msgs,name,_i,_len,_ref;for(msgs=[],_i=0,_len=details.length;_len>_i;_i++)if(detail=details[_i],"Booking"===detail.message_type){_ref=basketItem.parts_links;for(name in _ref)link=_ref[name],detail.$href("item")===link&&-1===msgs.indexOf(detail.message)&&msgs.push(detail.message)}return deferred.resolve(msgs)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},confirmationText:function(company,total){var deferred;return deferred=$q.defer(),company.$get("booking_text").then(function(emb){return emb.$get("booking_text").then(function(details){return total.getMessages(details,"Confirm").then(function(msgs){return deferred.resolve(msgs)})})},function(err){return deferred.reject(err)}),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("DayService",function($q,BBModel){return{query:function(prms){var deferred,extra;return deferred=$q.defer(),prms.cItem.days_link?(extra={},extra.month=prms.month,extra.date=prms.date,extra.edate=prms.edate,prms.client&&(extra.location=prms.client.addressCsvLine()),prms.cItem.person&&!prms.cItem.anyPerson()&&(extra.person_id=prms.cItem.person.id),prms.cItem.resource&&!prms.cItem.anyResource()&&(extra.resource_id=prms.cItem.resource.id),prms.cItem.days_link.$get("days",extra).then(function(){return function(found){var afound,days,i,_i,_len;for(afound=found.days,days=[],_i=0,_len=afound.length;_len>_i;_i++)i=afound[_i],i.type===prms.item&&days.push(new BBModel.Day(i));return deferred.resolve(days)}}(this),function(){return function(err){return deferred.reject(err)}}(this))):deferred.reject("No Days Link found"),deferred.promise}}})}.call(this),function(){angular.module("BB").config(function($logProvider){return $logProvider.debugEnabled(!0)}),angular.module("BB.Services").factory("DebugUtilsService",function($rootScope,$location,$window,$log){var logObjectKeys,showScopeChain;return logObjectKeys=function(obj,showValue){var key,value;for(key in obj)value=obj[key],!obj.hasOwnProperty(key)||_.isFunction(value)||/^\$\$/.test(key)||(console.log(key),showValue&&console.log("	",value,"\n"))},showScopeChain=function(){var $root,data,f;$root=$("[ng-app]"),data=$root.data(),data&&data.$scope&&(f=function(scope){return console.log(scope.$id),console.log(scope),scope.$$nextSibling?f(scope.$$nextSibling):scope.$$childHead?f(scope.$$childHead):void 0})(data.$scope)},function(){return"localhost"!==$location.host()&&"127.0.0.1"!==$location.host()||3e3!==$location.port()?void 0:window.setTimeout(function(){var scope;for(scope=$rootScope;scope&&"public.controllers.BBCtrl"!==scope.controller;)scope=scope.$$childHead;return $($window).on("dblclick",function(e){var controller,controllerName,pscope;for(scope=angular.element(e.target).scope(),controller=scope.hasOwnProperty("controller"),pscope=scope,controller&&(controllerName=scope.controller);!controller;)pscope=pscope.$parent,controllerName=pscope.controller,controller=pscope.hasOwnProperty("controller");return $window.bbScope=scope,$log.log(e.target),$log.log($window.bbScope),$log.log("Controller ->",controllerName)}),$window.bbBBCtrlScopeKeyNames=function(prop){return logObjectKeys(scope,prop)},$window.bbBBCtrlScope=function(){return scope},$window.bbCurrentItem=function(){return scope.current_item},$window.bbShowScopeChain=showScopeChain},10)}(),{logObjectKeys:logObjectKeys}})}.call(this),function(){angular.module("BB.Services").factory("ErrorService",[function(){var errors;return errors=[{id:1,type:"GENERIC",title:"",msg:"Sorry, it appears that something went wrong. Please try again or call the business you're booking with if the problem persists."},{id:2,type:"LOCATION_NOT_FOUND",title:"",msg:"Sorry, we don't recognise that location"},{id:3,type:"MISSING_LOCATION",title:"",msg:"Please enter your location"},{id:4,type:"MISSING_POSTCODE",title:"",msg:"Please enter a postcode"},{id:5,type:"INVALID_POSTCODE",title:"",msg:"Please enter a valid postcode"},{id:6,type:"ITEM_NO_LONGER_AVAILABLE",title:"",msg:"Sorry. The item you were trying to book is no longer available. Please try again."},{id:7,type:"FORM_INVALID",title:"",msg:"Please complete all required fields"},{id:6,type:"GEOLOCATION_ERROR",title:"",msg:"Sorry, we could not determine your location. Please try searching instead."}],{getError:function(type){var error,_i,_len;for(_i=0,_len=errors.length;_len>_i;_i++)if(error=errors[_i],error.type===type)return error;return errors[0]}}}])}.call(this),function(){angular.module("BB.Services").factory("EventService",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("events")?(params.item&&(params.item.event_group&&(params.event_group_id=params.item.event_group.id),params.item.event_chain&&(params.event_chain_id=params.item.event_chain.id),params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),company.$get("events",params).then(function(){return function(resource){return resource.$get("events",params).then(function(events){var event;return events=function(){var _i,_len,_results;for(_results=[],_i=0,_len=events.length;_len>_i;_i++)event=events[_i],_results.push(new BBModel.Event(event));return _results}(),deferred.resolve(events)})}}(this),function(){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise},summary:function(company,params){var deferred;return deferred=$q.defer(),company.$has("events")?(params.item&&(params.item.event_group&&(params.event_group_id=params.item.event_group.id),params.item.event_chain&&(params.event_chain_id=params.item.event_chain.id),params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),params.summary=!0,company.$get("events",params).then(function(){return function(resource){return deferred.resolve(resource.events)}}(this),function(){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("EventChainService",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("event_chains")?company.$get("event_chains",params).then(function(){return function(resource){return resource.$get("event_chains",params).then(function(event_chains){var event_chain;return event_chains=function(){var _i,_len,_results;for(_results=[],_i=0,_len=event_chains.length;_len>_i;_i++)event_chain=event_chains[_i],_results.push(new BBModel.EventChain(event_chain));return _results}(),deferred.resolve(event_chains)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("company does not have event_chains"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("EventGroupService",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("event_groups")?company.$get("event_groups",params).then(function(){return function(resource){return resource.$get("event_groups",params).then(function(event_groups){var event_group;return event_groups=function(){var _i,_len,_results;for(_results=[],_i=0,_len=event_groups.length;_len>_i;_i++)event_group=event_groups[_i],_results.push(new BBModel.EventGroup(event_group));return _results}(),deferred.resolve(event_groups)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("company does not have event_groups"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("EventSequenceService",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("event_sequences")?company.$get("event_sequences",params).then(function(){return function(resource){return resource.$get("event_sequences",params).then(function(event_sequences){var event_sequence;return event_sequences=function(){var _i,_len,_results;for(_results=[],_i=0,_len=event_sequences.length;_len>_i;_i++)event_sequence=event_sequences[_i],_results.push(new BBModel.EventSequence(event_sequence));return _results}(),deferred.resolve(event_sequences)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("company does not have event_sequences"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("PathSvc",function($sce,AppConfig){return{directivePartial:function(fileName){var partial_url;return AppConfig.partial_url?(partial_url=AppConfig.partial_url,$sce.trustAsResourceUrl(""+partial_url+"/"+fileName+".html")):$sce.trustAsResourceUrl(""+fileName+".html")}}})}.call(this),function(){"use strict";angular.module("BB.Services").factory("FormDataStoreService",function($rootScope,$window,$log,$parse){var checkForListeners,checkRegisteredWidgets,clear,dataStore,div,getParentScope,init,log,register,registeredWidgetArr,removeWidget,resetValuesOnScope,setIfUndefined,setListeners,setValuesOnScope,showInfo,storeFormData,toId;return registeredWidgetArr=[],dataStore={},toId=0,div="___",log=function(){},showInfo=function(){return log(dataStore)},setIfUndefined=function(keyName,val){var getter,scope;return scope=this,getter=$parse(keyName),"undefined"==typeof getter(scope)?getter.assign(scope,val):void 0},resetValuesOnScope=function(scope,props){var prop,setter,_i,_len;for(_i=0,_len=props.length;_len>_i;_i++)prop=props[_i],prop=$parse(prop),(setter=prop.assign)(scope,null)},clear=function(scope,keepScopeValues){var data,key,widgetId;if(!scope)throw new Error("Missing scope object. Cannot clear form data without scope");if(_.isString(scope))return data=dataStore[scope],keepScopeValues||resetValuesOnScope(data[0],data[1]),void delete dataStore[scope];if(scope=getParentScope(scope),scope&&scope.bb){widgetId=scope.bb.uid,removeWidget(scope);for(key in dataStore)data=dataStore[key],-1!==key.indexOf(widgetId)&&(data[3]&&_.each(data[3],function(func){return _.isFunction(func)?func():void 0}),keepScopeValues||resetValuesOnScope(data[0],data[1]),delete dataStore[key])}},storeFormData=function(){var key,ndata,prop,props,scope,step,val,_i,_len;log("formDataStore ->",dataStore);for(key in dataStore){for(step=dataStore[key],log("	",key),scope=step[0],props=step[1],ndata=step[2],ndata||(ndata=step[2]={}),_i=0,_len=props.length;_len>_i;_i++)prop=props[_i],val=ndata[prop],"data:destroyed"===val?ndata[prop]=null:(val=angular.copy(scope.$eval(prop)),ndata[prop]=val),log("		",prop,val);log("\n")}},setValuesOnScope=function(currentPage,scope){var cpage,storedValues;cpage=dataStore[currentPage],storedValues=cpage[2],log("Decorating scope ->",currentPage,storedValues),_.isObject(storedValues)&&_.each(_.keys(storedValues),function(keyName){var getter;return"undefined"!=typeof storedValues[keyName]&&"data:destroyed"!==storedValues[keyName]?(getter=$parse(keyName),getter.assign(scope,storedValues[keyName])):void 0}),cpage[0]=scope,log(scope),log("\n")},getParentScope=function(scope){for(;scope;){if(scope.hasOwnProperty("cid")&&"BBCtrl"===scope.cid)return scope;scope=scope.$parent}},checkRegisteredWidgets=function(scope){var isRegistered,rscope,_i,_len;for(isRegistered=!1,scope=getParentScope(scope),_i=0,_len=registeredWidgetArr.length;_len>_i;_i++)rscope=registeredWidgetArr[_i],rscope===scope&&(isRegistered=!0);return isRegistered},checkForListeners=function(propsArr){var watchArr;return watchArr=[],_.each(propsArr,function(propName,index){var split;return split=propName.split("->"),2===split.length?(watchArr.push(split),propsArr[index]=split[0]):void 0}),watchArr},setListeners=function(scope,listenerArr,currentPage){var cpage,listenersArr;return listenerArr.length?(cpage=dataStore[currentPage],listenersArr=cpage[3]||[],_.each(listenerArr,function(item){var func;return func=$rootScope.$on(item[1],function(){var e;try{return cpage[2][item[0]]="data:destroyed"}catch(_error){return e=_error,log(e)}}),listenersArr.push(func)}),cpage[3]=listenersArr):void 0},init=function(uid,scope,propsArr){var currentPage,watchArr;if(checkRegisteredWidgets(scope)){if(currentPage=scope.bb.uid+div+scope.bb.current_page+div+uid,currentPage=currentPage.toLowerCase(),watchArr=checkForListeners(propsArr),scope.clearStoredData=function(currentPage){return function(){clear(currentPage)}}(currentPage),!currentPage)throw new Error("Missing current step");if(dataStore[currentPage])return void setValuesOnScope(currentPage,scope);log("Controller registered ->",currentPage,scope,"\n\n"),dataStore[currentPage]=[scope,propsArr],setListeners(scope,watchArr,currentPage)}},removeWidget=function(scope){registeredWidgetArr=_.without(registeredWidgetArr,scope)},register=function(scope){var registered;for(registered=!1;!_.has(scope,"cid");)scope=scope.$parent;if("BBCtrl"!==scope.cid)throw new Error("This directive can only be used with the BBCtrl");return _.each(registeredWidgetArr,function(stored){return scope===stored?registered=!0:void 0}),registered?void 0:(log("Scope registered ->",scope),scope.$on("destroy",removeWidget),registeredWidgetArr.push(scope))},$rootScope.$watch(function(){$window.clearTimeout(toId),toId=setTimeout(storeFormData,300)}),$rootScope.$on("save:formData",storeFormData),$rootScope.$on("clear:formData",clear),{init:init,destroy:function(scope){return clear(scope,!0)},showInfo:showInfo,register:register,setIfUndefined:setIfUndefined}})}.call(this),function(){angular.module("BB.Services").factory("ItemService",function($q,BBModel){return{query:function(prms){var deferred;return deferred=$q.defer(),prms.cItem.service&&"service"!==prms.item?prms.cItem.service.$has("items")?this.build_items(prms.cItem.service.$get("items"),prms,deferred):prms.cItem.service.$get("item").then(function(_this){return function(base_item){return _this.build_items(base_item.$get("items"),prms,deferred)}}(this)):prms.cItem.resource&&!prms.cItem.anyResource()&&"resource"!==prms.item?prms.cItem.resource.$has("items")?this.build_items(prms.cItem.resource.$get("items"),prms,deferred):prms.cItem.resource.$get("item").then(function(_this){return function(base_item){return _this.build_items(base_item.$get("items"),prms,deferred)}}(this)):prms.cItem.person&&!prms.cItem.anyPerson()&&"person"!==prms.item?prms.cItem.person.$has("items")?this.build_items(prms.cItem.person.$get("items"),prms,deferred):prms.cItem.person.$get("item").then(function(_this){return function(base_item){return _this.build_items(base_item.$get("items"),prms,deferred)}}(this)):deferred.reject("No service link found"),deferred.promise},build_items:function(base_items,prms,deferred){var wait_items;return wait_items=[base_items],prms.wait&&wait_items.push(prms.wait),$q.all(wait_items).then(function(){return function(resources){var resource;return resource=resources[0],resource.$get("items").then(function(found){var matching,v,wlist,_i,_len;for(matching=[],wlist=[],_i=0,_len=found.length;_len>_i;_i++)v=found[_i],v.type===prms.item&&matching.push(new BBModel.BookableItem(v));return deferred.resolve(matching)})}}(this))}}})}.call(this),function(){angular.module("BB.Services").factory("ItemDetailsService",function($q,BBModel){return{query:function(prms){var deferred;return deferred=$q.defer(),prms.cItem.service?prms.cItem.service.$has("questions")?prms.cItem.service.$get("questions").then(function(){return function(details){return deferred.resolve(new BBModel.ItemDetails(details))}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.resolve(new BBModel.ItemDetails):prms.cItem.event_chain?prms.cItem.event_chain.$has("questions")?prms.cItem.event_chain.$get("questions").then(function(){return function(details){return deferred.resolve(new BBModel.ItemDetails(details))}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.resolve(new BBModel.ItemDetails):deferred.reject("No service link found"),deferred.promise
}}})}.call(this),function(){angular.module("BB.Services").factory("LocaleService",function($window){var locale;return locale=$window.getURIparam("locale"),locale?locale:$window.navigator.language?$window.navigator.language:"en"})}.call(this),function(){angular.module("BB.Services").factory("LoginService",function($q,halClient,$rootScope,BBModel,$sessionStorage){return{companyLogin:function(company,params,form){var deferred;return deferred=$q.defer(),company.$post("login",params,form).then(function(_this){return function(login){return login.$get("member").then(function(member){return _this.setLogin(member),deferred.resolve(member)},function(err){return deferred.reject(err)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},login:function(form,options){var deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login",halClient.$post(url,options,form).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("member").then(function(member){return _this.setLogin(member),deferred.resolve(member)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},companyQuery:function(){return function(id){var comp_promise;return id?(comp_promise=halClient.$get(location.protocol+"//"+location.host+"/api/v1/company/"+id),comp_promise.then(function(company){return company=new BBModel.Company(company)})):void 0}}(this),memberQuery:function(){return function(params){var member_promise;return params.member_id&&params.company_id?(member_promise=halClient.$get(location.protocol+"//"+location.host+("/api/v1/"+params.company_id+"/")+"members/"+params.member_id),member_promise.then(function(member){return member=new BBModel.Member.Member(member)})):void 0}}(this),ssoLogin:function(options,data){var deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login/sso/"+options.company_id,halClient.$post(url,{},data).then(function(_this){return function(login){var params;return params={auth_token:login.auth_token},login.$get("member").then(function(member){return member=new BBModel.Member.Member(member),_this.setLogin(member),deferred.resolve(member)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},isLoggedIn:function(){return this.checkLogin(),$rootScope.member&&!$rootScope.user?!0:!1},setLogin:function(member){var auth_token;return auth_token=member.getOption("auth_token"),member=new BBModel.Member.Member(member),$sessionStorage.setItem("login",member.$toStore()),$sessionStorage.setItem("auth_token",auth_token),$rootScope.member=member,member},member:function(){return this.checkLogin(),$rootScope.member},checkLogin:function(){var member;if(!$rootScope.member)return member=$sessionStorage.getItem("login"),member?$rootScope.member=halClient.createResource(member):void 0},logout:function(options){var deferred,url;return $rootScope.member=null,$sessionStorage.removeItem("login"),$sessionStorage.removeItem("auth_token"),$sessionStorage.clear(),deferred=$q.defer(),options||(options={}),options.root||(options.root=""),url=options.root+"/api/v1/logout",halClient.$del(url,options,{}).then(function(){return function(){return deferred.resolve(!0)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ModalForm",function($modal,$log){var editForm,newForm;return newForm=function($scope,$modalInstance,company,title,new_rel,post_rel,success,fail){return $scope.title=title,$scope.company=company,$scope.company.$get(new_rel).then(function(schema){return $scope.form=_.reject(schema.form,function(x){return"submit"===x.type}),$scope.schema=schema.schema,$scope.form_model={}}),$scope.submit=function(){return $scope.$broadcast("schemaFormValidate"),$scope.company.$post(post_rel,{},$scope.form_model).then(function(model){return $modalInstance.close(model),success?success(model):void 0},function(err){return $modalInstance.close(err),$log.error("Failed to create"),fail?fail(err):void 0})},$scope.cancel=function(event){return event.preventDefault(),event.stopPropagation(),$modalInstance.dismiss("cancel")}},editForm=function($scope,$modalInstance,model,title,success,fail){return $scope.title=title,$scope.model=model,$scope.model.$get("edit").then(function(schema){return $scope.form=_.reject(schema.form,function(x){return"submit"===x.type}),$scope.schema=schema.schema,$scope.form_model=$scope.model}),$scope.submit=function(){return $scope.$broadcast("schemaFormValidate"),$scope.model.$put("self",{},$scope.form_model).then(function(model){return $modalInstance.close(model),success?success():void 0},function(err){return $modalInstance.close(err),$log.error("Failed to create"),fail?fail():void 0})},$scope.cancel=function(event){return event.preventDefault(),event.stopPropagation(),$modalInstance.dismiss("cancel")}},{"new":function(config){return $modal.open({templateUrl:"modal_form.html",controller:newForm,resolve:{company:function(){return config.company},title:function(){return config.title},new_rel:function(){return config.new_rel},post_rel:function(){return config.post_rel},success:function(){return config.success},fail:function(){return config.fail}}})},edit:function(config){return $modal.open({templateUrl:"modal_form.html",controller:editForm,resolve:{model:function(){return config.model},title:function(){return config.title},success:function(){return config.success},fail:function(){return config.fail}}})}}})}.call(this),function(){angular.module("BB.Services").factory("MutexService",function($q,$window,$rootScope){return{getLock:function(){var iprom,mprom;return mprom=$q.defer(),iprom=$q.defer(),mprom.promise.then(function(){var next_mux;return $rootScope.mutexes.shift(),$rootScope.mutexes.length>0?(next_mux=$rootScope.mutexes[0],next_mux.iprom.resolve(next_mux.mprom)):void 0}),$rootScope.mutexes&&0!==$rootScope.mutexes.length?($rootScope.mutexes.push({mprom:mprom,iprom:iprom}),iprom.promise):($rootScope.mutexes=[{mprom:mprom,iprom:iprom}],iprom.resolve(mprom),iprom.promise)},unlock:function(mutex){return mutex.resolve()}}})}.call(this),function(){angular.module("BB.Services").factory("PersonService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("people")?company.$get("people").then(function(){return function(resource){return resource.$get("people").then(function(items){var i,people,_i,_len;for(people=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],people.push(new BBModel.Person(i));return deferred.resolve(people)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No people found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("PurchaseTotalService",function($q,BBModel){return{query:function(prms){var deferred;return deferred=$q.defer(),prms.company.$has("total")?prms.company.$get("total",{total_id:prms.total_id}).then(function(){return function(total){return deferred.resolve(new BBModel.PurchaseTotal(total))}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No Total link found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("QueryStringService",function($window){return function(keyName){var hash,hashes,href,isNum,val,varObj,_i,_len;if(varObj={},href=$window.location.href,!(href.indexOf("?")<0)){for(hashes=href.slice(href.indexOf("?")+1).split(/[#&]/),isNum=function(num){return null==num||"0"===num.substr(0,1)||/[a-zA-Z\-\_\+\.\#\%\*\,]/.test(num)||window.isNaN(window.parseInt(num,10))?void 0:!0},_i=0,_len=hashes.length;_len>_i;_i++)hash=hashes[_i],hash=hash.split("="),val=hash[1],val=isNum(val)?window.parseInt(val,10):"true"===val?!0:"false"===val?!1:window.decodeURIComponent(val),varObj[hash[0]]=val;return keyName?varObj[keyName]:varObj}}})}.call(this),function(){"use strict";angular.module("BB.Services").factory("QuestionService",function($window,QueryStringService,$bbug){var addAnswersById,addAnswersByKey,addAnswersByName,addDynamicAnswersByName,checkConditionalQuestions,convertDates,convertToSnakeCase,defaults,findByQuestionId,storeDefaults;return defaults=QueryStringService()||{},convertDates=function(obj){return _.each(obj,function(val,key){var date;return date=$window.moment(obj[key]),_.isString(obj[key])&&date.isValid()?obj[key]=date:void 0})},$window.bb_setup&&(convertDates($window.bb_setup),angular.extend(defaults,$window.bb_setup)),addAnswersById=function(questions){questions&&(angular.isArray(questions)?_.each(questions,function(question){var id;return id=question.id+"",!question.answer&&defaults[id]?question.answer=defaults[id]:void 0}):questions.answer=defaults[questions.id+""])},convertToSnakeCase=function(str){return str=str.toLowerCase(),str=$.trim(str),str=str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,""),str=str.replace(/\s{2,}/g," "),str=str.replace(/\s/g,"_")},addDynamicAnswersByName=function(questions){var keys;return angular.isArray(questions)?(keys=_.keys(defaults),_.each(questions,function(question){var name;return name=convertToSnakeCase(question.name),_.each(keys,function(key){name.indexOf(key)>=0&&defaults[key]&&!question.answer&&(question.answer=defaults[key],delete defaults[key])})})):void 0},addAnswersByName=function(obj,keys){var key,type,_i,_len;if(type=Object.prototype.toString.call(obj).slice(8,-1),"Object"===type&&angular.isArray(keys))for(_i=0,_len=keys.length;_len>_i;_i++)key=keys[_i],defaults[key]&&!obj[key]&&(obj[key]=defaults[key],delete defaults[key])},addAnswersByKey=function(questions,answers){var name,question,_i,_len,_results;for(_results=[],_i=0,_len=questions.length;_len>_i;_i++)question=questions[_i],name=question.help_text,_results.push(answers[name]?question.answer=answers[name]:void 0);return _results},storeDefaults=function(obj){return angular.extend(defaults,obj.bb_setup||{})},checkConditionalQuestions=function(questions){var a,ans,cond,found,q,v,_i,_len,_ref,_results;for(_results=[],_i=0,_len=questions.length;_len>_i;_i++)if(q=questions[_i],q.settings&&q.settings.conditional_question)if(cond=findByQuestionId(questions,parseInt(q.settings.conditional_question))){ans=cond.getAnswerId(),found=!1,$bbug.isEmptyObject(q.settings.conditional_answers)&&"check"===cond.detail_type&&!cond.answer&&(found=!0),_ref=q.settings.conditional_answers;for(a in _ref)v=_ref[a],"c"===a[0]&&1===parseInt(v)&&cond.answer?found=!0:parseInt(a)===ans&&1===parseInt(v)&&(found=!0);_results.push(found?q.showElement():q.hideElement())}else _results.push(void 0);else _results.push(void 0);return _results},findByQuestionId=function(questions,qid){var q,_i,_len;for(_i=0,_len=questions.length;_len>_i;_i++)if(q=questions[_i],q.id===qid)return q;return null},{getStoredData:function(){return defaults},storeDefaults:storeDefaults,addAnswersById:addAnswersById,addAnswersByName:addAnswersByName,addDynamicAnswersByName:addDynamicAnswersByName,addAnswersByKey:addAnswersByKey,convertToSnakeCase:convertToSnakeCase,checkConditionalQuestions:checkConditionalQuestions}})}.call(this),function(){angular.module("BB.Services").factory("ResourceService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("resources")?company.$get("resources").then(function(){return function(resource){return resource.$get("resources").then(function(items){var i,resources,_i,_len;for(resources=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],resources.push(new BBModel.Resource(i));return deferred.resolve(resources)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No resource found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("ServiceService",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("services")?company.$get("services").then(function(){return function(resource){return resource.$get("services").then(function(items){var i,services,_i,_len;for(services=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],services.push(new BBModel.Service(i));return deferred.resolve(services)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No services found"),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("SpaceService",["$q",function($q,BBModel){return{query:function(company){var deferred;return deferred=$q.defer(),company.$has("spaces")?company.$get("spaces").then(function(){return function(resource){return resource.$get("spaces").then(function(items){var i,spaces,_i,_len;for(spaces=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],spaces.push(new BBModel.Space(i));return deferred.resolve(spaces)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("No spaces found"),deferred.promise}}}])}.call(this),function(){angular.module("BB.Services").factory("SSOService",function($q,$rootScope,halClient,LoginService){return{memberLogin:function(options){var data,deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login/sso/"+options.company_id,data={token:options.member_sso},halClient.$post(url,{},data).then(function(){return function(login){var params;return params={auth_token:login.auth_token},login.$get("member").then(function(member){return member=LoginService.setLogin(member),deferred.resolve(member)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},adminLogin:function(options){var data,deferred,url;return deferred=$q.defer(),options.root||(options.root=""),url=options.root+"/api/v1/login/admin_sso/"+options.company_id,data={token:options.admin_sso},halClient.$post(url,{},data).then(function(){return function(login){var params;return params={auth_token:login.auth_token},login.$get("administrator").then(function(admin){return deferred.resolve(admin)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("TemplateSvc",function($q,$http,$templateCache){return{get:function(path){var cacheTmpl,deferred;return deferred=$q.defer(),cacheTmpl=$templateCache.get(path),cacheTmpl?deferred.resolve(angular.element(cacheTmpl)):$http({method:"GET",url:path}).success(function(tmpl){return $templateCache.put(path,tmpl),deferred.resolve(angular.element(tmpl))}).error(function(data){return deferred.reject(data)}),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("TimeService",function($q,BBModel,halClient){return{query:function(prms){var date,deferred,extra,item_link;if(deferred=$q.defer(),prms.date)date=prms.date.toISODate();else{if(!prms.cItem.date)return deferred.reject("No date set"),deferred.promise;date=prms.cItem.date.date.toISODate()}return null==prms.duration&&prms.cItem&&prms.cItem.duration&&(prms.duration=prms.cItem.duration),item_link=prms.item_link,prms.cItem&&prms.cItem.days_link&&!item_link&&(item_link=prms.cItem.days_link),item_link?(extra={date:date},prms.location&&(extra.location=prms.location),prms.cItem.event_id&&(extra.event_id=prms.cItem.event_id),!prms.cItem.person||prms.cItem.anyPerson()||item_link.event_id||extra.event_id||(extra.person_id=prms.cItem.person.id),!prms.cItem.resource||prms.cItem.anyResource()||item_link.event_id||extra.event_id||(extra.resource_id=prms.cItem.resource.id),prms.end_date&&(extra.end_date=prms.end_date.toISODate()),extra.duration=prms.duration,extra.num_resources=prms.num_resources,extra.event_id&&(item_link=prms.company),item_link.$get("times",extra).then(function(_this){return function(results){var times;return results.$has("date_links")?results.$get("date_links").then(function(all_days){var all_days_def,date_times,day,_fn,_i,_len;for(date_times={},all_days_def=[],_fn=function(day){var times;return day.elink=$q.defer(),all_days_def.push(day.elink.promise),day.$has("event_links")?day.$get("event_links").then(function(all_events){var times;return times=_this.merge_times(all_events,prms.cItem.service,prms.cItem),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),date_times[day.date]=times,day.elink.resolve()}):day.times?(times=_this.merge_times([day],prms.cItem.service,prms.cItem),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),date_times[day.date]=times,day.elink.resolve()):void 0},_i=0,_len=all_days.length;_len>_i;_i++)day=all_days[_i],_fn(day);return $q.all(all_days_def).then(function(){return deferred.resolve(date_times)})}):results.$has("event_links")?results.$get("event_links").then(function(all_events){var times;return times=_this.merge_times(all_events,prms.cItem.service,prms.cItem),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),deferred.resolve(times)}):results.times?(times=_this.merge_times([results],prms.cItem.service,prms.cItem),prms.available&&(times=_.filter(times,function(t){return t.avail>=prms.available})),deferred.resolve(times)):void 0}}(this),function(err){return deferred.reject(err)})):deferred.reject("No day data"),deferred.promise},merge_times:function(){return function(all_events,service,item){var date_times,ev,i,sorted_times,times,_i,_j,_k,_len,_len1,_len2,_ref;if(!all_events||0===all_events.length)return[];for(sorted_times=[],_i=0,_len=all_events.length;_len>_i;_i++)if(ev=all_events[_i],ev.times){for(_ref=ev.times,_j=0,_len1=_ref.length;_len1>_j;_j++)i=_ref[_j],(!sorted_times[i.time]||0===sorted_times[i.time].avail||0===Math.floor(Math.random()*all_events.length)&&i.avail>0)&&(i.event_id=ev.event_id,sorted_times[i.time]=i);item&&item.id&&item.held&&item.held.event_id===ev.event_id&&item.held.time&&!sorted_times[item.held.time.time]&&item.held.date&&item.held.date.date.toISODate()===ev.date?(sorted_times[item.held.time.time]=item.held.time,halClient.clearCache(ev.$href("self"))):item&&item.id&&item.event_id===ev.event_id&&item.time&&!sorted_times[item.time.time]&&item.date&&item.date.date.toISODate()===ev.date&&(sorted_times[item.time.time]=item.time,halClient.clearCache(ev.$href("self")))}for(times=[],date_times={},_k=0,_len2=sorted_times.length;_len2>_k;_k++)i=sorted_times[_k],i&&times.push(new BBModel.TimeSlot(i,service));return times}}(this)}})}.call(this),function(){angular.module("BB.Services").factory("TimeSlotService",function($q,BBModel){return{query:function(params){var company,defer;return defer=$q.defer(),company=params.company,company.$get("slots",params).then(function(collection){return collection.$get("slots").then(function(slots){var s;return slots=function(){var _i,_len,_results;for(_results=[],_i=0,_len=slots.length;_len>_i;_i++)s=slots[_i],_results.push(new BBModel.TimeSlot(s));return _results}(),defer.resolve(slots)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise}}})}.call(this),function(){angular.module("BB.Services").factory("BB.Service.address",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Address(resource)}}}),angular.module("BB.Services").factory("BB.Service.person",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Person(resource)}}}),angular.module("BB.Services").factory("BB.Service.people",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("people").then(function(){return function(items){var i,models,_i,_len;for(models=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],models.push(new BBModel.Person(i));return deferred.resolve(models)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.resource",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Resource(resource)}}}),angular.module("BB.Services").factory("BB.Service.resources",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("resources").then(function(){return function(items){var i,models,_i,_len;for(models=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],models.push(new BBModel.Resource(i));return deferred.resolve(models)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.service",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Service(resource)}}}),angular.module("BB.Services").factory("BB.Service.services",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("services").then(function(){return function(items){var i,models,_i,_len;for(models=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],models.push(new BBModel.Service(i));return deferred.resolve(models)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.event_group",function($q,BBModel){return{unwrap:function(resource){return new BBModel.EventGroup(resource)}}}),angular.module("BB.Services").factory("BB.Service.event_groups",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("event_groups").then(function(){return function(items){var i,models,_i,_len;for(models=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],models.push(new BBModel.EventGroup(i));return deferred.resolve(models)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.category",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Category(resource)}}}),angular.module("BB.Services").factory("BB.Service.categories",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("categories").then(function(){return function(items){var cat,i,models,_i,_len;for(models=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],cat=new BBModel.Category(i),cat.order||(cat.order=_i),models.push(cat);return deferred.resolve(models)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.client",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Client(resource)}}}),angular.module("BB.Services").factory("BB.Service.child_clients",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),console.log("resource.$links",resource.$links),resource.$get("clients").then(function(){return function(items){var i,models,_i,_len;for(console.log("items",items),models=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],models.push(new BBModel.Client(i)),console.log("models",models);return deferred.resolve(models)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.clients",function($q,BBModel){return{promise:!0,unwrap:function(resource){var deferred;return deferred=$q.defer(),resource.$get("clients").then(function(){return function(items){var i,models,_i,_len;for(models=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],models.push(new BBModel.Client(i));return deferred.resolve(models)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}}),angular.module("BB.Services").factory("BB.Service.questions",function($q,BBModel){return{unwrap:function(resource){var defer,i,_i,_j,_len,_len1,_ref,_results,_results1;if(resource.questions){for(_ref=resource.questions,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)i=_ref[_i],_results.push(new BBModel.Question(i));return _results}if(resource.$has("questions"))return defer=$q.defer(),resource.$get("questions").then(function(items){return defer.resolve(function(){var _j,_len1,_results1;for(_results1=[],_j=0,_len1=items.length;_len1>_j;_j++)i=items[_j],_results1.push(new BBModel.Question(i));return _results1}())},function(err){return defer.reject(err)}),defer.promise;for(_results1=[],_j=0,_len1=resource.length;_len1>_j;_j++)i=resource[_j],_results1.push(new BBModel.Question(i));return _results1}}}),angular.module("BB.Services").factory("BB.Service.question",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Question(resource)}}}),angular.module("BB.Services").factory("BB.Service.answers",function($q,BBModel){return{promise:!1,unwrap:function(items){var answers,i,models,_i,_len;for(models=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],models.push(new BBModel.Answer(i));return answers={answers:models,getAnswer:function(question){var a,_j,_len1,_ref;for(_ref=this.answers,_j=0,_len1=_ref.length;_len1>_j;_j++)if(a=_ref[_j],a.question_text===question)return a.value}}}}}),angular.module("BB.Services").factory("BB.Service.administrators",function($q,BBModel){return{unwrap:function(items){var i,_i,_len,_results;for(_results=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],_results.push(new BBModel.Admin.User(i));return _results}}}),angular.module("BB.Services").factory("BB.Service.company",function($q,BBModel){return{unwrap:function(resource){return new BBModel.Company(resource)}}}),angular.module("BB.Services").factory("BB.Service.event_chains",function($q,BBModel){return{promise:!0,unwrap:function(resource){return new BBModel.EventChain(resource)}}})}.call(this),function(){angular.module("BB").config(function($logProvider){return $logProvider.debugEnabled(!0)}),angular.module("BB.Services").factory("DebugUtilsService",function($rootScope,$location,$window,$log){var logObjectKeys,showScopeChain;return logObjectKeys=function(obj,showValue){var key,value;for(key in obj)value=obj[key],!obj.hasOwnProperty(key)||_.isFunction(value)||/^\$\$/.test(key)||(console.log(key),showValue&&console.log("	",value,"\n"))},showScopeChain=function(){var $root,data,f;$root=$("[ng-app]"),data=$root.data(),data&&data.$scope&&(f=function(scope){return console.log(scope.$id),console.log(scope),scope.$$nextSibling?f(scope.$$nextSibling):scope.$$childHead?f(scope.$$childHead):void 0})(data.$scope)},function(){return"localhost"!==$location.host()&&"127.0.0.1"!==$location.host()||3e3!==$location.port()?void 0:window.setTimeout(function(){var scope;for(scope=$rootScope;scope&&"public.controllers.BBCtrl"!==scope.controller;)scope=scope.$$childHead;return $($window).on("dblclick",function(e){var controller,controllerName,pscope;for(scope=angular.element(e.target).scope(),controller=scope.hasOwnProperty("controller"),pscope=scope,controller&&(controllerName=scope.controller);!controller;)pscope=pscope.$parent,controllerName=pscope.controller,controller=pscope.hasOwnProperty("controller");return $window.bbScope=scope,$log.log(e.target),$log.log($window.bbScope),$log.log("Controller ->",controllerName)}),$window.bbBBCtrlScopeKeyNames=function(prop){return logObjectKeys(scope,prop)},$window.bbBBCtrlScope=function(){return scope},$window.bbCurrentItem=function(){return scope.current_item},$window.angular.bbShowScopeChain=showScopeChain},10)}(),{logObjectKeys:logObjectKeys}})}.call(this),function(){angular.module("BB.Services").factory("ValidatorService",function($rootScope,AlertService,ErrorService,BBModel,$q,$bbug){var alphanumeric,geocode_result,international_number,mobile_regex_lenient,number_only_regex,uk_landline_regex_lenient,uk_landline_regex_strict,uk_mobile_regex_strict,uk_postcode_regex,uk_postcode_regex_lenient;return uk_postcode_regex=/^(((([A-PR-UWYZ][0-9][0-9A-HJKS-UW]?)|([A-PR-UWYZ][A-HK-Y][0-9][0-9ABEHMNPRV-Y]?))\s{0,1}[0-9]([ABD-HJLNP-UW-Z]{2}))|(GIR\s{0,2}0AA))$/i,uk_postcode_regex_lenient=/^[A-Z]{1,2}[0-9][0-9A-Z]?\s*[0-9][A-Z]{2}$/i,number_only_regex=/^\d+$/,uk_mobile_regex_strict=/^((\+44\s?|0)7([45789]\d{2}|624)\s?\d{3}\s?\d{3})$/,mobile_regex_lenient=/^(0|\+)([\d \(\)]{9,19})$/,uk_landline_regex_strict=/^(\(?(0|\+44)[1-9]{1}\d{1,4}?\)?\s?\d{3,4}\s?\d{3,4})$/,uk_landline_regex_lenient=/^(0|\+)([\d \(\)]{9,19})$/,international_number=/^(\+)([\d \(\)]{9,19})$/,alphanumeric=/^[a-zA-Z0-9]*$/,geocode_result=null,{alpha:/^[a-zA-Z\s]*$/,us_phone_number:/(^[\d \(\)-]{9,16})$/,getUKPostcodePattern:function(){return uk_postcode_regex_lenient},getNumberOnlyPattern:function(){return number_only_regex},getAlphaNumbericPattern:function(){return alphanumeric},getUKMobilePattern:function(strict){return null==strict&&(strict=!1),strict?uk_mobile_regex_strict:mobile_regex_lenient},getMobilePattern:function(){return mobile_regex_lenient},getUKLandlinePattern:function(strict){return null==strict&&(strict=!1),strict?uk_landline_regex_strict:uk_landline_regex_lenient},getIntPhonePattern:function(){return international_number},getGeocodeResult:function(){return geocode_result?geocode_result:void 0},validatePostcode:function(form,prms){var deferred,geocoder,ne,postcode,req,sw;return AlertService.clear(),form&&form.postcode?form.$error.required?(AlertService.danger(ErrorService.getError("MISSING_POSTCODE")),!1):form.$error.pattern?(AlertService.danger(ErrorService.getError("INVALID_POSTCODE")),!1):(deferred=$q.defer(),postcode=form.postcode.$viewValue,req={address:postcode},prms.region&&(req.region=prms.region),req.componentRestrictions={postalCode:req.address},prms.bounds&&(sw=new google.maps.LatLng(prms.bounds.sw.x,prms.bounds.sw.y),ne=new google.maps.LatLng(prms.bounds.ne.x,prms.bounds.ne.y),req.bounds=new google.maps.LatLngBounds(sw,ne)),geocoder=new google.maps.Geocoder,geocoder.geocode(req,function(results,status){return 1===results.length&&"OK"===status?(geocode_result=results[0],deferred.resolve(!0)):(AlertService.danger(ErrorService.getError("INVALID_POSTCODE")),$rootScope.$apply(),deferred.reject(!1))}),deferred.promise):!1},validateForm:function(form){return form?(form.submitted=!0,form.$invalid&&form.raise_alerts&&form.alert?(AlertService.danger(form.alert),!1):form.$invalid&&form.raise_alerts?(AlertService.danger(ErrorService.getError("FORM_INVALID")),!1):form.$invalid?!1:!0):!1},resetForm:function(form){return form?(form.submitted=!1,form.$setPristine()):void 0},resetForms:function(forms){var form,_i,_len,_results;if(forms&&$bbug.isArray(forms)){for(_results=[],_i=0,_len=forms.length;_len>_i;_i++)form=forms[_i],form.submitted=!1,_results.push(form.$setPristine());return _results}}}})}.call(this),function(){"use strict";angular.module("BB.Services").factory("MemberBookingService",function($q,$window,SpaceCollections,$rootScope,MemberService,BBModel){return{query:function(member,params){var deferred;return deferred=$q.defer(),member.$has("bookings")?member.$get("bookings",params).then(function(){return function(bookings){var booking;return $window.typeIsArray(bookings)?(bookings=function(){var _i,_len,_results;for(_results=[],_i=0,_len=bookings.length;_len>_i;_i++)booking=bookings[_i],_results.push(new BBModel.Member.Booking(booking));return _results}(),deferred.resolve(bookings)):bookings.$get("bookings",params).then(function(bookings){return bookings=function(){var _i,_len,_results;for(_results=[],_i=0,_len=bookings.length;_len>_i;_i++)booking=bookings[_i],_results.push(new BBModel.Member.Booking(booking));return _results}(),deferred.resolve(bookings)},function(err){return deferred.reject(err)})}}(this),function(err){return deferred.reject(err)}):deferred.reject("member does not have bookings"),deferred.promise},cancel:function(member,booking){var deferred;return deferred=$q.defer(),booking.$del("self").then(function(){return function(b){return booking.deleted=!0,b=new BBModel.Member.Booking(b),MemberService.refresh(member).then(function(member){return member=member},function(err){return console.log(err)}),deferred.resolve(b)
}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},update:function(booking){var deferred;return deferred=$q.defer(),$rootScope.member.flushBookings(),booking.$put("self",{},booking).then(function(){return function(booking){var book;return book=new BBModel.Member.Booking(booking),SpaceCollections.checkItems(book),deferred.resolve(book)}}(this),function(){return function(err){return _.each(booking,function(value,key,booking){return"data"!==key&&"self"!==key?booking[key]=booking.data[key]:void 0}),deferred.reject(err,new BBModel.Member.Booking(booking))}}(this)),deferred.promise},flush:function(member,params){return member.$has("bookings")?member.$flush("bookings",params):void 0}}})}.call(this),function(){angular.module("BBMember.Services").factory("MemberLoginService",function($q,halClient,$rootScope,BBModel){return{login:function(form,options){var defer,url;return defer=$q.defer(),url=""+$rootScope.bb.api_url+"/api/v1/login",null!=options.company_id&&(url=""+url+"/member/"+options.company_id),halClient.$post(url,options,form).then(function(login){return login.$has("member")?login.$get("member").then(function(member){return member=new BBModel.Member.Member(member),defer.resolve(member)}):login.$has("members")?defer.resolve(login):defer.reject("No member account for login")},function(){return function(err){var login;return 400===err.status?(login=halClient.$parse(err.data),login.$has("members")?defer.resolve(login):defer.reject(err)):defer.reject(err)}}(this)),defer.promise}}})}.call(this),function(){angular.module("BB.Services").factory("MemberService",function($q,halClient,$rootScope,BBModel){return{refresh:function(member){var deferred;return deferred=$q.defer(),member.$flush("self"),member.$get("self").then(function(){return function(member){return member=new BBModel.Member.Member(member),deferred.resolve(member)}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},current:function(){var callback,deferred;return deferred=$q.defer(),callback=function(){return deferred.resolve($rootScope.member)},setTimeout(callback,200),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("MemberPrePaidBookingService",function($q,$window){return{query:function(member,params){var deferred;return deferred=$q.defer(),member.$has("pre_paid_bookings")?member.$get("pre_paid_bookings",params).then(function(){return function(bookings){var booking;return $window.typeIsArray(bookings)?(bookings=function(){var _i,_len,_results;for(_results=[],_i=0,_len=bookings.length;_len>_i;_i++)booking=bookings[_i],_results.push(new BBModel.Member.PrePaidBooking(booking));return _results}(),deferred.resolve(bookings)):bookings.$get("pre_paid_bookings",params).then(function(bookings){return bookings=function(){var _i,_len,_results;for(_results=[],_i=0,_len=bookings.length;_len>_i;_i++)booking=bookings[_i],_results.push(new BBModel.Member.PrePaidBooking(booking));return _results}(),deferred.resolve(bookings)})}}(this),function(){return function(err){return deferred.reject(err)}}(this)):deferred.reject("member does not have pre paid bookings"),deferred.promise}}})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("AddressModel",function($q,BBModel,BaseModel){var Address;return Address=function(_super){function Address(){return Address.__super__.constructor.apply(this,arguments)}return __extends(Address,_super),Address.prototype.addressSingleLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+=", "),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+=", "),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+=", "),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+=", "),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+=", "),this.postcode&&(str+=this.postcode),str},Address.prototype.hasAddress=function(){return this.address1||this.address2||this.postcode},Address.prototype.addressCsvLine=function(){var str;return str="",this.address1&&(str+=this.address1),str+=", ",this.address2&&(str+=this.address2),str+=", ",this.address3&&(str+=this.address3),str+=", ",this.address4&&(str+=this.address4),str+=", ",this.address5&&(str+=this.address5),str+=", ",this.postcode&&(str+=this.postcode),str+=", ",this.country&&(str+=this.country),str},Address.prototype.addressMultiLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+="<br/>"),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+="<br/>"),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+="<br/>"),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+="<br/>"),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+="<br/>"),this.postcode&&(str+=this.postcode),str},Address}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("AnswerModel",function($q,BBModel,BaseModel){var Answer;return Answer=function(_super){function Answer(data){Answer.__super__.constructor.call(this,data)}return __extends(Answer,_super),Answer.prototype.getQuestion=function(){var defer;return defer=$q.defer(),this.question&&defer.resolve(this.question),this._data.$has("question")?this._data.$get("question").then(function(_this){return function(question){return _this.question=question,defer.resolve(_this.question)}}(this)):defer.resolve([]),defer.promise},Answer}(BaseModel)})}.call(this),function(){angular.module("BB.Models").service("BBModel",function($q,$injector){var admin_models,afuncs,funcs,member_models,mfuncs,model,models,pfuncs,purchase_models,_fn,_fn1,_fn2,_fn3,_i,_j,_k,_l,_len,_len1,_len2,_len3;for(models=["Address","Answer","Affiliate","Basket","BasketItem","BookableItem","Category","Client","ClientDetails","Company","CompanySettings","Day","Event","EventChain","EventGroup","EventTicket","EventSequence","ItemDetails","Person","PurchaseItem","PurchaseTotal","Question","Resource","Service","Slot","Space","SurveyQuestion","TimeSlot"],funcs={},_fn=function(){return function(model){return funcs[model]=function(p1,p2){return new($injector.get(model+"Model"))(p1,p2)}}}(this),_i=0,_len=models.length;_len>_i;_i++)model=models[_i],_fn(model);for(purchase_models=["Booking","Total"],pfuncs={},_fn1=function(){return function(model){return pfuncs[model]=function(init){return new($injector.get("Purchase."+model+"Model"))(init)}}}(this),_j=0,_len1=purchase_models.length;_len1>_j;_j++)model=purchase_models[_j],_fn1(model);for(funcs.Purchase=pfuncs,member_models=["Member","Booking","PrepaidBooking"],mfuncs={},_fn2=function(){return function(model){return mfuncs[model]=function(init){return new($injector.get("Member."+model+"Model"))(init)}}}(this),_k=0,_len2=member_models.length;_len2>_k;_k++)model=member_models[_k],_fn2(model);for(funcs.Member=mfuncs,admin_models=["Booking","Slot","User","Administrator","Schedule","Resource","Person","Service","Login"],afuncs={},_fn3=function(){return function(model){return afuncs[model]=function(init){return new($injector.get("Admin."+model+"Model"))(init)}}}(this),_l=0,_len3=admin_models.length;_len3>_l;_l++)model=admin_models[_l],_fn3(model);return funcs.Admin=afuncs,funcs}),angular.module("BB.Models").service("BaseModel",function($q,$injector,$rootScope,$timeout){var Base;return Base=function(){function Base(data){var link,links,m,n,name,obj,_fn;if(this.deleted=!1,data&&(this._data=data),data)for(n in data)m=data[n],this[n]=m;if(this._data&&this._data.$href){this.self=this._data.$href("self"),links=this.$links(),this.__linkedData={},this.__linkedPromises={},_fn=function(_this){return function(link,obj,name){return _this[name]||(_this[name]=function(){return this.$buildOject(link)}),_this[name+"Promise"]?void 0:_this[name+"Promise"]=function(){return this.$buildOjectPromise(link)}}}(this);for(link in links)obj=links[link],name=this._snakeToCamel("get_"+link),_fn(link,obj,name)}}return Base.prototype._snakeToCamel=function(s){return s.replace(/(\_\w)/g,function(m){return m[1].toUpperCase()})},Base.prototype.$buildOject=function(link){return this.__linkedData[link]?this.__linkedData[link]:(this.$buildOjectPromise(link).then(function(_this){return function(ans){return _this.__linkedData[link]=ans,$timeout(function(){return _this.__linkedData[link]=ans})}}(this)),null)},Base.prototype.$buildOjectPromise=function(link){var prom;return this.__linkedPromises[link]?this.__linkedPromises[link]:(prom=$q.defer(),this.__linkedPromises[link]=prom.promise,this.$get(link).then(function(){return function(res){var inj;return inj=$injector.get("BB.Service."+link),inj?inj.promise?inj.unwrap(res).then(function(ans){return prom.resolve(ans)},function(err){return prom.reject(err)}):prom.resolve(inj.unwrap(res)):prom.resolve(res)}}(this),function(err){return prom.reject(err)}),this.__linkedPromises[link])},Base.prototype.get=function(ikey){return this._data?this._data[ikey]:null},Base.prototype.set=function(ikey,value){return this._data?this._data[ikey]=value:null},Base.prototype.$href=function(rel,params){return this._data?this._data.$href(rel,params):void 0},Base.prototype.$has=function(rel){return this._data?this._data.$has(rel):void 0},Base.prototype.$flush=function(rel,params){return this._data?this._data.$href(rel,params):void 0},Base.prototype.$get=function(rel,params){return this._data?this._data.$get(rel,params):void 0},Base.prototype.$post=function(rel,params,dat){return this._data?this._data.$post(rel,params,dat):void 0},Base.prototype.$put=function(rel,params,dat){return this._data?this._data.$put(rel,params,dat):void 0},Base.prototype.$patch=function(rel,params,dat){return this._data?this._data.$patch(rel,params,dat):void 0},Base.prototype.$del=function(rel,params){return this._data?this._data.$del(rel,params):void 0},Base.prototype.$links=function(){return this._data?this._data.$links():void 0},Base.prototype.$toStore=function(){return this._data?this._data.$toStore():void 0},Base}()})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("BasketModel",function($q,BBModel,BaseModel){var Basket;return Basket=function(_super){function Basket(data,scope){this.is_admin=scope&&scope.isAdmin?scope.isAdmin:!1,null!=scope&&scope.parent_client&&(this.parent_client_id=scope.parent_client.id),this.items=[],Basket.__super__.constructor.call(this,data)}return __extends(Basket,_super),Basket.prototype.addItem=function(item){var i,_i,_len,_ref;for(_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++){if(i=_ref[_i],i===item)return;if(i.id&&item.id&&i.id===item.id)return}return this.items.push(item)},Basket.prototype.clear=function(){return this.items=[]},Basket.prototype.readyToCheckout=function(){return this.items.length>0?!0:!1},Basket.prototype.timeItems=function(){var i,titems,_i,_len,_ref;for(titems=[],_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++)i=_ref[_i],i.is_coupon||titems.push(i);return titems},Basket.prototype.setSettings=function(set){return set?(this.settings||(this.settings={}),$.extend(this.settings,set)):void 0},Basket.prototype.setClient=function(client){return this.client=client},Basket.prototype.setClientDetails=function(client_details){return this.client_details=new BBModel.PurchaseItem(client_details)},Basket.prototype.getPostData=function(){var item,post,_i,_len,_ref;for(post={client:this.client.getPostData(),settings:this.settings,reference:this.reference},post.is_admin=this.is_admin,post.parent_client_id=this.parent_client_id,post.items=[],_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],post.items.push(item.getPostData());return post},Basket.prototype.dueTotal=function(){var item,total,_i,_len,_ref;for(total=this.total_price,_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],item.isWaitlist()&&(total-=item.price);return 0>total&&(total=0),total},Basket.prototype.length=function(){return this.items.length},Basket.prototype.questionPrice=function(){var item,price,_i,_len,_ref;for(price=0,_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],price+=item.questionPrice();return price},Basket.prototype.totalPrice=function(){var item,price,_i,_len,_ref;for(price=0,_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],price+=item.totalPrice();return price},Basket.prototype.fullPrice=function(){var item,price,_i,_len,_ref;for(price=0,_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],price+=item.fullPrice();return price},Basket.prototype.hasCoupon=function(){var item,_i,_len,_ref;for(_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++)if(item=_ref[_i],item.is_coupon)return!0;return!1},Basket.prototype.totalDuration=function(){var duration,item,_i,_len,_ref;for(duration=0,_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],item.service&&item.service.listed_duration&&(duration=+item.service.listed_duration);return duration},Basket}(BaseModel)})}.call(this),function(){"use strict";var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("BasketItemModel",function($q,$window,BBModel,BookableItemModel,BaseModel,$bbug){var BasketItem;return BasketItem=function(_super){function BasketItem(data,bb){this.fullPrice=__bind(this.fullPrice,this),this.totalPrice=__bind(this.totalPrice,this),this.getQty=__bind(this.getQty,this),this.questionPrice=__bind(this.questionPrice,this);var chain,comp,per,res,serv,t;BasketItem.__super__.constructor.call(this,data),this.ready=!1,this.days_link=null,this.book_link=null,this.parts_links={},this.settings||(this.settings={}),this.has_questions=!1,bb&&(this.reserve_without_questions=bb.reserve_without_questions),this.time&&(this.time=new BBModel.TimeSlot({time:this.time,event_id:this.event_id,selected:!0,avail:1,price:this.price})),this.date&&(this.date=new BBModel.Day({date:this.date,spaces:1})),this.datetime&&(this.date=new BBModel.Day({date:this.datetime.toISODate(),spaces:1}),t=60*this.datetime.hour()+this.datetime.minute(),this.time=new BBModel.TimeSlot({time:t,event_id:this.event_id,selected:!0,avail:1,price:this.price})),this.id&&(this.ready=!0,this.held={time:this.time,date:this.date,event_id:this.event_id}),this.promises=[],data&&(data.$has("answers")&&data.$get("answers").then(function(){return function(answers){var a,_i,_len,_results;for(data.questions=[],_results=[],_i=0,_len=answers.length;_len>_i;_i++)a=answers[_i],_results.push(data.questions.push({id:a.question_id,answer:a.value}));return _results}}(this)),data.$has("company")&&(comp=data.$get("company"),this.promises.push(comp),comp.then(function(_this){return function(comp){var c;return c=new BBModel.Company(comp),_this.promises.push(c.getSettings()),_this.setCompany(c)}}(this))),data.$has("service")&&(serv=data.$get("service"),this.promises.push(serv),serv.then(function(_this){return function(serv){var prom;return serv.$has("category")&&(prom=serv.$get("category"),_this.promises.push(prom),prom.then(function(cat){return _this.setCategory(new BBModel.Category(cat))})),_this.setService(new BBModel.Service(serv),data.questions),_this.time?_this.time.service=_this.service:void 0}}(this))),data.$has("event_group")&&(serv=data.$get("event_group"),this.promises.push(serv),serv.then(function(_this){return function(serv){var prom;return serv.$has("category")&&(prom=serv.$get("category"),_this.promises.push(prom),prom.then(function(cat){return _this.setCategory(new BBModel.Category(cat))})),_this.setEventGroup(new BBModel.EventGroup(serv)),_this.time?_this.time.service=_this.event_group:void 0}}(this))),data.$has("event_chain")&&(chain=data.$get("event_chain"),this.promises.push(chain),chain.then(function(_this){return function(serv){return _this.setEventChain(new BBModel.EventChain(serv),data.questions)}}(this))),data.$has("resource")&&(res=data.$get("resource"),this.promises.push(res),res.then(function(_this){return function(res){return _this.setResource(new BBModel.Resource(res),!1)}}(this))),data.$has("person")&&(per=data.$get("person"),this.promises.push(per),per.then(function(_this){return function(per){return _this.setPerson(new BBModel.Person(per),!1)}}(this))),data.$has("event")&&data.$get("event").then(function(_this){return function(event){return _this.setEvent(new BBModel.Event(event))}}(this)),data.settings&&(this.settings=$bbug.extend(!0,{},data.settings)),data.attachment_id&&(this.attachment_id=data.attachment_id),data.$has("product")&&data.$get("product").then(function(_this){return function(product){return _this.setProduct(product)}}(this)))}return __extends(BasketItem,_super),BasketItem.prototype.setDefaults=function(defaults){return defaults.settings&&(this.settings=defaults.settings),defaults.company&&this.setCompany(defaults.company),defaults.merge_resources&&this.setResource(null),defaults.merge_people&&this.setPerson(null),defaults.resource&&this.setResource(defaults.resource),defaults.person&&this.setPerson(defaults.person),defaults.service&&this.setService(defaults.service),defaults.category&&this.setCategory(defaults.category),defaults.time&&(this.requested_time=parseInt(defaults.time)),defaults.date&&(this.date=new BBModel.Day({date:defaults.date,spaces:1})),defaults.service_ref&&(this.service_ref=defaults.service_ref),defaults.group&&(this.group=defaults.group),defaults.private_note&&(this.private_note=defaults.private_note),defaults.event_group&&this.setEventGroup(defaults.event_group),defaults.event&&this.setEvent(defaults.event),this.defaults=defaults},BasketItem.prototype.storeDefaults=function(defaults){return this.defaults=defaults},BasketItem.prototype.defaultService=function(){return this.defaults?this.defaults.service:null},BasketItem.prototype.requestedTimeUnavailable=function(){return delete this.requested_time},BasketItem.prototype.setSlot=function(slot){var t;return this.date=new BBModel.Day({date:slot.datetime.toISODate(),spaces:1}),t=60*slot.datetime.hour()+slot.datetime.minute(),this.time=new BBModel.TimeSlot({time:t,avail:1,price:this.price}),this.available_slot=slot.id},BasketItem.prototype.setCompany=function(company){return this.company=company,this.parts_links.company=this.company.$href("self"),this.item_details?this.item_details.currency_code=this.company.currency_code:void 0},BasketItem.prototype.clearExistingItem=function(){var prom;return this.$has("self")&&this.event_id&&(prom=this.$del("self"),this.promises.push(prom),prom.then(function(){})),delete this.earliest_time,delete this.event_id},BasketItem.prototype.setItem=function(item){return item?"person"===item.type?this.setPerson(item):"service"===item.type?this.setService(item):"resource"===item.type?this.setResource(item):void 0:void 0},BasketItem.prototype.setService=function(serv,default_questions){var prom;if(null==default_questions&&(default_questions=null),this.service){if(this.service.self&&serv.self&&this.service.self===serv.self)return this.service.$has("book")&&(this.book_link=this.service),serv.$has("days")&&(this.days_link=serv),void(serv.$has("book")&&(this.book_link=serv));this.item_details=null,this.clearExistingItem()}return this.service=serv,serv&&serv instanceof BookableItemModel&&(this.service=serv.item),this.parts_links.service=this.service.$href("self"),this.service.$has("book")&&(this.book_link=this.service),serv.$has("days")&&(this.days_link=serv),serv.$has("book")&&(this.book_link=serv),this.service.$has("questions")?(this.has_questions=!0,prom=this.service.$get("questions"),this.promises.push(prom),prom.then(function(_this){return function(details){return _this.company&&(details.currency_code=_this.company.currency_code),_this.item_details=new BBModel.ItemDetails(details),_this.has_questions=_this.item_details.hasQuestions,default_questions?(_this.item_details.setAnswers(default_questions),_this.setAskedQuestions()):void 0}}(this),function(_this){return function(){return _this.has_questions=!1}}(this))):this.has_questions=!1,this.service&&this.service.durations&&1===this.service.durations.length&&(this.setDuration(this.service.durations[0]),this.listed_duration=this.service.durations[0]),this.service&&this.service.listed_durations&&1===this.service.listed_durations.length&&(this.listed_duration=this.service.listed_durations[0]),this.service.$has("category")&&(prom=this.service.getCategoryPromise())?this.promises.push(prom):void 0},BasketItem.prototype.setEventGroup=function(event_group){var prom;if(!(this.event_group&&this.event_group.self&&event_group.self&&this.event_group.self===event_group.self))return this.event_group=event_group,this.parts_links.event_group=this.event_group.$href("self").replace("event_group","service"),this.event_group.$has("category")&&(prom=this.event_group.getCategoryPromise())?this.promises.push(prom):void 0},BasketItem.prototype.setEventChain=function(event_chain,default_questions){var prom;return null==default_questions&&(default_questions=null),this.event_chain&&this.event_chain.self&&event_chain.self&&this.event_chain.self===event_chain.self?void 0:(this.event_chain=event_chain,this.base_price=parseFloat(event_chain.price),this.setPrice(this.base_price),this.event_chain.isSingleBooking()&&(this.tickets={name:"Admittance",max:1,type:"normal",price:this.base_price},this.num_book&&(this.tickets.qty=this.num_book)),this.event_chain.$has("questions")?(this.has_questions=!0,prom=this.event_chain.$get("questions"),this.promises.push(prom),prom.then(function(_this){return function(details){return _this.item_details=new BBModel.ItemDetails(details),_this.has_questions=_this.item_details.hasQuestions,default_questions?(_this.item_details.setAnswers(default_questions),_this.setAskedQuestions()):void 0}}(this),function(_this){return function(){return _this.has_questions=!1}}(this))):this.has_questions=!1)},BasketItem.prototype.setEvent=function(event){var prom;return this.event&&this.event.unselect(),this.event=event,this.event.select(),this.event_chain_id=event.event_chain_id,this.setDate({date:event.date}),this.setTime(event.time),this.setDuration(event.duration),event.$has("book")&&(this.book_link=event),prom=this.event.getChain(),this.promises.push(prom),prom.then(function(_this){return function(chain){return _this.setEventChain(chain)}}(this)),prom=this.event.getGroup(),this.promises.push(prom),prom.then(function(_this){return function(group){return _this.setEventGroup(group)}}(this)),this.num_book=event.qty},BasketItem.prototype.setCategory=function(cat){return this.category=cat},BasketItem.prototype.setPerson=function(per,set_selected){if(null==set_selected&&(set_selected=!0),set_selected&&this.earliest_time&&delete this.earliest_time,per){if(this.person=per,set_selected&&(this.settings.person=this.person.id),this.parts_links.person=this.person.$href("self"),per.$has("days")&&(this.days_link=per),per.$has("book")&&(this.book_link=per),this.event_id&&this.$has("person")&&this.$href("person")!==this.person.self&&(delete this.event_id,this.resource&&this.defaults&&this.defaults.merge_resources))return this.setResource(null)}else if(this.person=!0,set_selected&&(this.settings.person=-1),this.parts_links.person=null,this.service&&this.setService(this.service),this.resource&&!this.anyResource()&&this.setResource(this.resource,!1),this.event_id&&(delete this.event_id,this.resource&&this.defaults&&this.defaults.merge_resources))return this.setResource(null)},BasketItem.prototype.setResource=function(res,set_selected){if(null==set_selected&&(set_selected=!0),set_selected&&this.earliest_time&&delete this.earliest_time,res){if(this.resource=res,set_selected&&(this.settings.resource=this.resource.id),this.parts_links.resource=this.resource.$href("self"),res.$has("days")&&(this.days_link=res),res.$has("book")&&(this.book_link=res),this.event_id&&this.$has("resource")&&this.$href("resource")!==this.resource.self&&(delete this.event_id,this.person&&this.defaults&&this.defaults.merge_people))return this.setPerson(null)}else if(this.resource=!0,set_selected&&(this.settings.resource=-1),this.parts_links.resource=null,this.service&&this.setService(this.service),this.person&&!this.anyPerson()&&this.setPerson(this.person,!1),this.event_id&&(delete this.event_id,this.person&&this.defaults&&this.defaults.merge_people))return this.setPerson(null)},BasketItem.prototype.setDuration=function(dur){return this.duration=dur,this.service&&(this.base_price=this.service.getPriceByDuration(dur)),this.time&&this.time.price&&(this.base_price=this.time.price),this.base_price?this.setPrice(this.base_price):void 0},BasketItem.prototype.print_time=function(){return this.time?this.time.print_time():void 0},BasketItem.prototype.print_end_time=function(){return this.time?this.time.print_end_time(this.duration):void 0},BasketItem.prototype.print_time12=function(show_suffix){return null==show_suffix&&(show_suffix=!0),this.time?this.time.print_time12(show_suffix):void 0},BasketItem.prototype.print_end_time12=function(show_suffix){return null==show_suffix&&(show_suffix=!0),this.time?this.time.print_end_time12(show_suffix,this.duration):void 0},BasketItem.prototype.setTime=function(time){var hours,mins,val;return this.time&&this.time.unselect(),this.time=time,this.time&&(this.time.select(),this.datetime&&(val=parseInt(time.time),hours=parseInt(val/60),mins=val%60,this.datetime.hour(hours),this.datetime.minutes(mins)),this.setPrice(this.time.price?this.time.price:null)),this.checkReady()},BasketItem.prototype.setDate=function(date){return this.date=date,this.date&&(this.date.date=moment(this.date.date),this.datetime&&(this.datetime.date(this.date.date.date()),this.datetime.month(this.date.date.month()),this.datetime.year(this.date.date.year()))),this.checkReady()},BasketItem.prototype.setGroup=function(group){return this.group=group},BasketItem.prototype.setAskedQuestions=function(){return this.asked_questions=!0,this.checkReady()},BasketItem.prototype.checkReady=function(){return!(this.date&&this.time&&this.service||this.event||this.product||this.date&&this.service&&"day"===this.service.duration_unit)||!this.asked_questions&&this.has_questions||(this.ready=!0),(this.date&&this.time&&this.service||this.event||this.product||this.date&&this.service&&"day"===this.service.duration_unit)&&(this.asked_questions||!this.has_questions||this.reserve_without_questions)?this.reserve_ready=!0:void 0},BasketItem.prototype.getPostData=function(){var data,m_question,o_question,_i,_j,_len,_len1,_ref,_ref1;if(this.cloneAnswersItem)for(_ref=this.cloneAnswersItem.item_details.questions,_i=0,_len=_ref.length;_len>_i;_i++)for(o_question=_ref[_i],_ref1=this.item_details.questions,_j=0,_len1=_ref1.length;_len1>_j;_j++)m_question=_ref1[_j],m_question.id===o_question.id&&(m_question.answer=o_question.answer);return data={},this.date&&(data.date=this.date.date.toISODate()),this.time?(data.time=this.time.time,this.time.event_id&&(data.event_id=this.time.event_id)):this.date&&this.date.event_id&&(data.event_id=this.date.event_id),data.price=this.price,data.paid=this.paid,this.book_link&&(data.book=this.book_link.$href("book")),data.id=this.id,data.duration=this.duration,data.settings=this.settings,data.settings||(data.settings={}),this.earliest_time&&(data.settings.earliest_time=this.earliest_time),this.item_details&&(data.questions=this.item_details.getPostData()),this.move_item_id&&(data.move_item_id=this.move_item_id),this.srcBooking&&(data.move_item_id=this.srcBooking.id),this.service&&(data.service_id=this.service.id),this.resource&&(data.resource_id=this.resource.id),this.person&&(data.person_id=this.person.id),data.length=this.length,this.event&&(data.event_id=this.event.id,null!=this.event.pre_paid_booking&&(data.pre_paid_booking=this.event.pre_paid_booking),data.tickets=this.tickets),data.event_chain_id=this.event_chain_id,data.event_group_id=this.event_group_id,data.qty=this.qty,null!=this.num_resources&&(data.num_resources=parseInt(this.num_resources)),data.product=this.product,data.coupon_id=this.coupon_id,data.is_coupon=this.is_coupon,this.attachment_id&&(data.attachment_id=this.attachment_id),null!=this.email&&(data.email=this.email),null!=this.email_admin&&(data.email_admin=this.email_admin),this.private_note&&(data.private_note=this.private_note),this.available_slot&&(data.available_slot=this.available_slot),data},BasketItem.prototype.setPrice=function(nprice){return null==nprice?(this.price=null,this.printed_price=null,this.printed_vat_cal=null,this.printed_vat=null,this.printed_vat_inc=null):(this.price=parseFloat(nprice),this.printed_price=this.price%1===0?""+parseInt(this.price):$window.sprintf("%.2f",this.price),this.company&&this.company.settings&&(this.printed_vat_cal=this.company.settings.payment_tax),this.printed_vat_cal&&(this.printed_vat=this.printed_vat_cal/100*this.price),this.printed_vat_cal?this.printed_vat_inc=this.printed_vat_cal/100*this.price+this.price:void 0)},BasketItem.prototype.getStep=function(){var temp;return temp={},temp.service=this.service,temp.category=this.category,temp.person=this.person,temp.resource=this.resource,temp.duration=this.duration,temp.event=this.event,temp.event_group=this.event_group,temp.event_chain=this.event_chain,temp.time=this.time,temp.date=this.date,temp.days_link=this.days_link,temp.book_link=this.book_link,temp.ready=this.ready,temp},BasketItem.prototype.loadStep=function(step){return this.id?void 0:(this.service=step.service,this.category=step.category,this.person=step.person,this.resource=step.resource,this.duration=step.duration,this.event=step.event,this.event_chain=step.event_chain,this.event_group=step.event_group,this.time=step.time,this.date=step.date,this.days_link=step.days_link,this.book_link=step.book_link,this.ready=step.ready)},BasketItem.prototype.describe=function(){var title;return title="-",this.service&&(title=this.service.name),this.event_group&&this.event&&"-"===title&&(title=this.event_group.name+" - "+this.event.description),this.product&&(title=this.product.name),title},BasketItem.prototype.booking_date=function(format){return this.date&&this.date.date?this.date.date.format(format):null},BasketItem.prototype.booking_time=function(seperator){var duration;return null==seperator&&(seperator="-"),this.time?(duration=this.listed_duration?this.listed_duration:this.duration,this.time.print_time()+" "+seperator+" "+this.time.print_end_time(duration)):null},BasketItem.prototype.duePrice=function(){return this.isWaitlist()?0:this.price},BasketItem.prototype.isWaitlist=function(){return this.status&&8===this.status},BasketItem.prototype.start_datetime=function(){var start_datetime;return this.date&&this.time?(start_datetime=moment(this.date.date.toISODate()),start_datetime.minutes(this.time.time),start_datetime):null},BasketItem.prototype.end_datetime=function(){var end_datetime;return this.date&&this.time&&this.listed_duration?(end_datetime=moment(this.date.date.toISODate()),end_datetime.minutes(this.time.time+this.listed_duration),end_datetime):null
},BasketItem.prototype.setSrcBooking=function(booking){return this.srcBooking=booking,this.duration=booking.duration/60},BasketItem.prototype.anyPerson=function(){return this.person&&"boolean"==typeof this.person},BasketItem.prototype.anyResource=function(){return this.resource&&"boolean"==typeof this.resource},BasketItem.prototype.isMovingBooking=function(){return this.srcBooking||this.move_item_id},BasketItem.prototype.setCloneAnswers=function(otherItem){return this.cloneAnswersItem=otherItem},BasketItem.prototype.questionPrice=function(){return this.item_details?this.item_details.questionPrice(this.getQty()):0},BasketItem.prototype.getQty=function(){return this.qty?this.qty:this.tickets?this.tickets.qty:1},BasketItem.prototype.totalPrice=function(){var pr;return null!=this.discount_price?this.discount_price:(pr=this.total_price,pr||(pr=this.price),pr||(pr=0),pr+this.questionPrice())},BasketItem.prototype.fullPrice=function(){var pr;return pr=this.total_price,pr||(pr=this.price),pr||(pr=0),pr+this.questionPrice()},BasketItem.prototype.setProduct=function(product){return this.product=product,this.product.$has("book")?this.book_link=this.product:void 0},BasketItem.prototype.hasPrice=function(){return this.price?!0:!1},BasketItem.prototype.getAttachment=function(){return this.attachment?this.attachment:this.$has("attachment")&&this.attachment_id?this._data.$get("attachment").then(function(_this){return function(att){return _this.attachment=att,_this.attachment}}(this)):void 0},BasketItem}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("BookableItemModel",function($q,BBModel,BaseModel){var BookableItem;return BookableItem=function(_super){function BookableItem(){BookableItem.__super__.constructor.apply(this,arguments),this.name="-Waiting-",this.promise=this._data.$get("item"),this.promise.then(function(_this){return function(val){var m,n,_ref,_ref1,_ref2,_results,_results1,_results2;if("person"===val.type){if(_this.item=new BBModel.Person(val),_this.item){_ref=_this.item._data,_results=[];for(n in _ref)m=_ref[n],_results.push(_this.item._data.hasOwnProperty(n)&&"function"!=typeof m?_this[n]=m:void 0);return _results}}else if("resource"===val.type){if(_this.item=new BBModel.Resource(val),_this.item){_ref1=_this.item._data,_results1=[];for(n in _ref1)m=_ref1[n],_results1.push(_this.item._data.hasOwnProperty(n)&&"function"!=typeof m?_this[n]=m:void 0);return _results1}}else if("service"===val.type&&(_this.item=new BBModel.Service(val),_this.item)){_ref2=_this.item._data,_results2=[];for(n in _ref2)m=_ref2[n],_results2.push(_this.item._data.hasOwnProperty(n)&&"function"!=typeof m?_this[n]=m:void 0);return _results2}}}(this))}return __extends(BookableItem,_super),BookableItem.prototype.item=null,BookableItem.prototype.promise=null,BookableItem}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("CategoryModel",function($q,BBModel,BaseModel){var Category;return Category=function(_super){function Category(){return Category.__super__.constructor.apply(this,arguments)}return __extends(Category,_super),Category}(BaseModel)})}.call(this),function(){"use strict";var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("ClientModel",function($q,BBModel,BaseModel){var Client;return Client=function(_super){function Client(data){this.setClientDetails=__bind(this.setClientDetails,this),Client.__super__.constructor.apply(this,arguments),this.name=this.getName(),data&&(data.answers&&data.$has("questions")&&(this.waitingQuestions=$q.defer(),this.gotQuestions=this.waitingQuestions.promise,data.$get("questions").then(function(_this){return function(details){return _this.client_details=new BBModel.ClientDetails(details),_this.client_details.setAnswers(data.answers),_this.questions=_this.client_details.questions,_this.setAskedQuestions(),_this.waitingQuestions.resolve()}}(this))),this.raw_mobile=this.mobile,this.mobile&&"0"!==this.mobile[0]&&(this.mobile="0"+this.mobile),this.phone&&"0"!==this.phone[0]&&(this.phone="0"+this.phone))}return __extends(Client,_super),Client.prototype.setClientDetails=function(details){return this.client_details=details,this.questions=this.client_details.questions},Client.prototype.setDefaults=function(values){return values.name&&(this.name=values.name),values.first_name&&(this.first_name=values.first_name),values.last_name&&(this.last_name=values.last_name),values.phone&&(this.phone=values.phone),values.mobile&&(this.mobile=values.mobile),values.email&&(this.email=values.email),values.id&&(this.id=values.id),values.ref&&(this.comp_ref=values.ref),values.comp_ref&&(this.comp_ref=values.comp_ref),values.address1&&(this.address1=values.address1),values.address2&&(this.address2=values.address2),values.address3&&(this.address3=values.address3),values.address4&&(this.address4=values.address4),values.address5&&(this.address5=values.address5),values.postcode&&(this.postcode=values.postcode),values.country?this.country=values.country:void 0},Client.prototype.getName=function(){var str;return str="",this.first_name&&(str+=this.first_name),str.length>0&&this.last_name&&(str+=" "),this.last_name&&(str+=this.last_name),str},Client.prototype.addressSingleLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+=", "),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+=", "),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+=", "),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+=", "),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+=", "),this.postcode&&(str+=this.postcode),str},Client.prototype.hasAddress=function(){return this.address1||this.address2||this.postcode},Client.prototype.addressCsvLine=function(){var str;return str="",this.address1&&(str+=this.address1),str+=", ",this.address2&&(str+=this.address2),str+=", ",this.address3&&(str+=this.address3),str+=", ",this.address4&&(str+=this.address4),str+=", ",this.address5&&(str+=this.address5),str+=", ",this.postcode&&(str+=this.postcode),str+=", ",this.country&&(str+=this.country),str},Client.prototype.addressMultiLine=function(){var str;return str="",this.address1&&(str+=this.address1),this.address2&&str.length>0&&(str+="<br/>"),this.address2&&(str+=this.address2),this.address3&&str.length>0&&(str+="<br/>"),this.address3&&(str+=this.address3),this.address4&&str.length>0&&(str+="<br/>"),this.address4&&(str+=this.address4),this.address5&&str.length>0&&(str+="<br/>"),this.address5&&(str+=this.address5),this.postcode&&str.length>0&&(str+="<br/>"),this.postcode&&(str+=this.postcode),str},Client.prototype.getPostData=function(){var q,x,_i,_len,_ref;if(x={},x.first_name=this.first_name,x.last_name=this.last_name,x.address1=this.house_number?this.house_number+" "+this.address1:this.address1,x.address2=this.address2,x.address3=this.address3,x.address4=this.address4,x.address5=this.address5,x.postcode=this.postcode,x.country=this.country,x.phone=this.phone,x.email=this.email,x.id=this.id,x.comp_ref=this.comp_ref,x.parent_client_id=this.parent_client_id,x.password=this.password,this.mobile&&(this.remove_prefix(),x.mobile=this.mobile,x.mobile_prefix=this.mobile_prefix),this.questions)for(x.questions=[],_ref=this.questions,_i=0,_len=_ref.length;_len>_i;_i++)q=_ref[_i],x.questions.push(q.getPostData());return x},Client.prototype.valid=function(){return this.isValid?this.isValid:this.email||this.hasServerId()?!0:!1},Client.prototype.setValid=function(val){return this.isValid=val},Client.prototype.hasServerId=function(){return this.id},Client.prototype.setAskedQuestions=function(){return this.asked_questions=!0},Client.prototype.fullMobile=function(){return this.mobile?this.mobile_prefix?"+"+this.mobile_prefix+this.mobile:this.mobile:void 0},Client.prototype.remove_prefix=function(){var pref_arr;return pref_arr=this.mobile.match(/^(\+|00)(999|998|997|996|995|994|993|992|991|990|979|978|977|976|975|974|973|972|971|970|969|968|967|966|965|964|963|962|961|960|899|898|897|896|895|894|893|892|891|890|889|888|887|886|885|884|883|882|881|880|879|878|877|876|875|874|873|872|871|870|859|858|857|856|855|854|853|852|851|850|839|838|837|836|835|834|833|832|831|830|809|808|807|806|805|804|803|802|801|800|699|698|697|696|695|694|693|692|691|690|689|688|687|686|685|684|683|682|681|680|679|678|677|676|675|674|673|672|671|670|599|598|597|596|595|594|593|592|591|590|509|508|507|506|505|504|503|502|501|500|429|428|427|426|425|424|423|422|421|420|389|388|387|386|385|384|383|382|381|380|379|378|377|376|375|374|373|372|371|370|359|358|357|356|355|354|353|352|351|350|299|298|297|296|295|294|293|292|291|290|289|288|287|286|285|284|283|282|281|280|269|268|267|266|265|264|263|262|261|260|259|258|257|256|255|254|253|252|251|250|249|248|247|246|245|244|243|242|241|240|239|238|237|236|235|234|233|232|231|230|229|228|227|226|225|224|223|222|221|220|219|218|217|216|215|214|213|212|211|210|98|95|94|93|92|91|90|86|84|82|81|66|65|64|63|62|61|60|58|57|56|55|54|53|52|51|49|48|47|46|45|44|43|41|40|39|36|34|33|32|31|30|27|20|7|1)/),pref_arr?(this.mobile.replace(pref_arr[0],""),this.mobile_prefix=pref_arr[0]):void 0},Client}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("ClientDetailsModel",function($q,BBModel,BaseModel){var ClientDetails;return ClientDetails=function(_super){function ClientDetails(data){var q,_i,_len,_ref;if(ClientDetails.__super__.constructor.apply(this,arguments),this.questions=[],this._data)for(_ref=data.questions,_i=0,_len=_ref.length;_len>_i;_i++)q=_ref[_i],this.questions.push(new BBModel.Question(q));this.hasQuestions=this.questions.length>0}return __extends(ClientDetails,_super),ClientDetails.prototype.getPostData=function(questions){var data,q,_i,_len;for(data=[],_i=0,_len=questions.length;_len>_i;_i++)q=questions[_i],data.push({answer:q.answer,id:q.id,price:q.price});return data},ClientDetails.prototype.setAnswers=function(answers){var a,ahash,q,_i,_j,_len,_len1,_ref,_results;for(ahash={},_i=0,_len=answers.length;_len>_i;_i++)a=answers[_i],ahash[a.question_id]=a;for(_ref=this.questions,_results=[],_j=0,_len1=_ref.length;_len1>_j;_j++)q=_ref[_j],_results.push(ahash[q.id]?q.answer=ahash[q.id].answer:void 0);return _results},ClientDetails}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("CompanyModel",function($q,BBModel,BaseModel){var Company;return Company=function(_super){function Company(data){Company.__super__.constructor.call(this,data),this.test=1}return __extends(Company,_super),Company.prototype.getCompanyByRef=function(ref){var defer;return defer=$q.defer(),this.$get("companies").then(function(companies){var company;return company=_.find(companies,function(c){return c.reference===ref}),company?defer.resolve(company):defer.reject("No company for ref "+ref)},function(err){return console.log("err ",err),defer.reject(err)}),defer.promise},Company.prototype.findChildCompany=function(id){var c,cname,name,_i,_j,_len,_len1,_ref,_ref1;if(!this.companies)return null;for(_ref=this.companies,_i=0,_len=_ref.length;_len>_i;_i++)if(c=_ref[_i],c.id===parseInt(id))return c;if("string"==typeof id)for(name=id.replace(/[\s\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,"").toLowerCase(),_ref1=this.companies,_j=0,_len1=_ref1.length;_len1>_j;_j++)if(c=_ref1[_j],cname=c.name.replace(/[\s\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|'!<>;:,.~`=+-@&%"]/g,"").toLowerCase(),name===cname)return c;return null},Company.prototype.getSettings=function(){var def;return def=$q.defer(),this.settings?def.resolve(this.settings):this.$has("settings")?this.$get("settings").then(function(_this){return function(set){return _this.settings=new BBModel.CompanySettings(set),def.resolve(_this.settings)}}(this)):def.reject("Company has no settings"),def.promise},Company}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("CompanySettingsModel",function($q,BBModel,BaseModel){var CompanySettings;return CompanySettings=function(_super){function CompanySettings(){return CompanySettings.__super__.constructor.apply(this,arguments)}return __extends(CompanySettings,_super),CompanySettings}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("DayModel",function($q,BBModel,BaseModel){var Day;return Day=function(_super){function Day(){Day.__super__.constructor.apply(this,arguments),this.string_date=this.date,this.date=moment(this.date)}return __extends(Day,_super),Day.prototype.day=function(){return this.date.date()},Day.prototype.off=function(month){return this.date.month()!==month},Day.prototype["class"]=function(month){var str;return str="",this.date.month()<month&&(str+="off off-prev"),this.date.month()>month&&(str+="off off-next"),0===this.spaces&&(str+=" not-avail"),str},Day}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("EventModel",function($q,BBModel,BaseModel){var Event;return Event=function(_super){function Event(data){Event.__super__.constructor.call(this,data),this.getDate(),this.time=new BBModel.TimeSlot({time:60*parseInt(this.date.format("h"))+parseInt(this.date.format("mm"))}),this.duration&&(this.end_datetime=this.date.clone().add(this.duration,"minutes"))}return __extends(Event,_super),Event.prototype.getGroup=function(){var defer;return defer=$q.defer(),this.group?defer.resolve(this.group):this.$has("event_groups")?this.$get("event_groups").then(function(_this){return function(group){return _this.group=new BBModel.EventGroup(group),defer.resolve(_this.group)}}(this),function(err){return defer.reject(err)}):defer.reject("No event group"),defer.promise},Event.prototype.getChain=function(){var defer;return defer=$q.defer(),this.chain?defer.resolve(this.chain):this.$has("event_chains")?this.$get("event_chains").then(function(_this){return function(chain){return _this.chain=new BBModel.EventChain(chain),defer.resolve(_this.chain)}}(this)):defer.reject("No event chain"),defer.promise},Event.prototype.getDate=function(){return this.date?this.date:(this.date=moment(this._data.datetime),this.date)},Event.prototype.dateString=function(str){var date;return date=this.date(),date?date.format(str):void 0},Event.prototype.getDuration=function(){var defer;return defer=new $q.defer,this.duration?defer.resolve(this.duration):this.getChain().then(function(_this){return function(chain){return _this.duration=chain.duration,defer.resolve(_this.duration)}}(this)),defer.promise},Event.prototype.printDuration=function(){var h,m;return this.duration<60?this.duration+" mins":(h=Math.round(this.duration/60),m=this.duration%60,0===m?h+" hours":h+" hours "+m+" mins")},Event.prototype.getDescription=function(){return this.getChain().description},Event.prototype.getColour=function(){return this.getGroup()?this.getGroup().colour:"#FFFFFF"},Event.prototype.getPerson=function(){return this.getChain().person_name},Event.prototype.getPounds=function(){return this.chain?Math.floor(this.getPrice()).toFixed(0):void 0},Event.prototype.getPrice=function(){return 0},Event.prototype.getPence=function(){return this.chain?(this.getPrice()%1).toFixed(2).slice(-2):void 0},Event.prototype.getNumBooked=function(){return this.spaces_blocked+this.spaces_booked+this.spaces_reserved+this.spaces_held},Event.prototype.getSpacesLeft=function(pool){return null==pool&&(pool=null),pool&&this.ticket_spaces&&this.ticket_spaces[pool]?this.ticket_spaces[pool].left:this.num_spaces-this.getNumBooked()},Event.prototype.hasSpace=function(){return this.getSpacesLeft()>0},Event.prototype.hasWaitlistSpace=function(){return this.getSpacesLeft()<=0&&this.getChain().waitlength>this.spaces_wait},Event.prototype.getRemainingDescription=function(){var left;return left=this.getSpacesLeft(),left>0&&3>left?"Only "+left+" "+(left>1?"spaces":"space")+" left":this.hasWaitlistSpace()?"Join Waitlist":""},Event.prototype.select=function(){return this.selected=!0},Event.prototype.unselect=function(){return this.selected?delete this.selected:void 0},Event.prototype.prepEvent=function(){var def;return def=$q.defer(),this.getChain().then(function(_this){return function(){return _this.chain.getTickets().then(function(tickets){return _this.tickets=tickets,def.resolve()})}}(this)),def.promise},Event}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("EventChainModel",function($q,BBModel,BaseModel){var EventChain;return EventChain=function(_super){function EventChain(){return EventChain.__super__.constructor.apply(this,arguments)}return __extends(EventChain,_super),EventChain.prototype.name=function(){return this._data.name},EventChain.prototype.isSingleBooking=function(){return 1===this.max_num_bookings&&!this.$has("ticket_sets")},EventChain.prototype.hasTickets=function(){return this.$has("ticket_sets")},EventChain.prototype.getTickets=function(){var def;return def=$q.defer(),this.tickets?def.resolve(this.tickets):this.$has("ticket_sets")?this.$get("ticket_sets").then(function(_this){return function(tickets){var ticket,_i,_len;for(_this.tickets=[],_i=0,_len=tickets.length;_len>_i;_i++)ticket=tickets[_i],_this.tickets.push(new BBModel.EventTicket(ticket));return _this.adjustTicketsForRemaining(),def.resolve(_this.tickets)}}(this)):(this.tickets=[new BBModel.EventTicket({name:"Admittance",min_num_bookings:1,max_num_bookings:this.max_num_bookings,type:"normal",price:this.price})],this.adjustTicketsForRemaining(),def.resolve(this.tickets)),def.promise},EventChain.prototype.adjustTicketsForRemaining=function(){var _i,_len,_ref,_results;if(this.tickets){for(_ref=this.tickets,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)this.ticket=_ref[_i],_results.push(this.ticket.max_spaces=this.spaces);return _results}},EventChain}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("EventGroupModel",function($q,BBModel,BaseModel){var EventGroup;return EventGroup=function(_super){function EventGroup(){return EventGroup.__super__.constructor.apply(this,arguments)}return __extends(EventGroup,_super),EventGroup.prototype.name=function(){return this._data.name},EventGroup.prototype.colour=function(){return this._data.colour},EventGroup}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("EventSequenceModel",function($q,BBModel,BaseModel){var EventSequence;return EventSequence=function(_super){function EventSequence(){return EventSequence.__super__.constructor.apply(this,arguments)}return __extends(EventSequence,_super),EventSequence.prototype.name=function(){return this._data.name},EventSequence}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("EventTicketModel",function($q,BBModel,BaseModel){var EventTicket;return EventTicket=function(_super){function EventTicket(data){var ms;EventTicket.__super__.constructor.call(this,data),this.max=this.max_num_bookings,this.max_spaces&&(ms=this.max_spaces,this.counts_as&&(ms=this.max_spaces/this.counts_as),max>ms&&(this.max=ms))}return __extends(EventTicket,_super),EventTicket.prototype.fullName=function(){return this.pool_name?this.pool_name+" - "+this.name:this.name},EventTicket.prototype.getRange=function(cap){var c,_ref,_results;return cap&&(c=cap,this.counts_as&&(c=cap/this.counts_as),c+this.min_num_bookings<this.max&&(this.max=c+this.min_num_bookings)),[0].concat(function(){_results=[];for(var _i=_ref=this.min_num_bookings,_ref1=this.max;_ref1>=_ref?_ref1>=_i:_i>=_ref1;_ref1>=_ref?_i++:_i--)_results.push(_i);return _results}.apply(this))},EventTicket.prototype.totalQty=function(){return this.qty?this.counts_as?this.qty*this.counts_as:this.qty:0},EventTicket.prototype.getMax=function(cap,ev){var c,live_max,ticket,used,_i,_len,_ref;if(null==ev&&(ev=null),live_max=this.max,ev){for(used=0,_ref=ev.tickets,_i=0,_len=_ref.length;_len>_i;_i++)ticket=_ref[_i],used+=ticket.totalQty();this.qty&&(used-=this.totalQty()),this.counts_as&&(used=Math.ceil(used/this.counts_as)),live_max-=used,0>live_max&&(live_max=0)}return cap&&(c=cap,this.counts_as&&(c=cap/this.counts_as),c+this.min_num_bookings<live_max)?c+this.min_num_bookings:live_max},EventTicket.prototype.add=function(value){return this.qty||(this.qty=0),this.qty=parseInt(this.qty),angular.isNumber(this.qty)&&this.qty>=this.max&&value>0||0===this.qty&&0>value?void 0:this.qty+=value},EventTicket.prototype.subtract=function(value){return this.add(-value)},EventTicket}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("ItemDetailsModel",function($q,BBModel,BaseModel,$bbug,QuestionService){var ItemDetails;return ItemDetails=function(_super){function ItemDetails(data){var q,_i,_len,_ref;if(this._data=data,this._data&&(this.self=this._data.$href("self")),this.questions=[],this.survey_questions=[],data)for(_ref=data.questions,_i=0,_len=_ref.length;_len>_i;_i++)q=_ref[_i],q.outcome===!1?(data.currency_code&&(q.currency_code=data.currency_code),this.questions.push(new BBModel.Question(q))):this.survey_questions.push(new BBModel.SurveyQuestion(q));this.hasQuestions=this.questions.length>0,this.hasSurveyQuestions=this.survey_questions.length>0}return __extends(ItemDetails,_super),ItemDetails.prototype.questionPrice=function(qty){var price,q,_i,_len,_ref;for(qty||(qty=1),this.checkConditionalQuestions(),price=0,_ref=this.questions,_i=0,_len=_ref.length;_len>_i;_i++)q=_ref[_i],price+=q.selectedPriceQty(qty);return price},ItemDetails.prototype.checkConditionalQuestions=function(){return QuestionService.checkConditionalQuestions(this.questions)},ItemDetails.prototype.getPostData=function(){var data,q,_i,_len,_ref;for(data=[],_ref=this.questions,_i=0,_len=_ref.length;_len>_i;_i++)q=_ref[_i],q.currentlyShown&&data.push(q.getPostData());return data},ItemDetails.prototype.setAnswers=function(answers){var a,ahash,q,_i,_j,_len,_len1,_ref;for(ahash={},_i=0,_len=answers.length;_len>_i;_i++)a=answers[_i],ahash[a.id]=a;for(_ref=this.questions,_j=0,_len1=_ref.length;_len1>_j;_j++)q=_ref[_j],ahash[q.id]&&(q.answer=ahash[q.id].answer);return this.checkConditionalQuestions()},ItemDetails.prototype.getQuestion=function(id){return _.findWhere(this.questions,{id:id})},ItemDetails}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("PersonModel",function($q,BBModel,BaseModel){var Person;return Person=function(_super){function Person(){return Person.__super__.constructor.apply(this,arguments)}return __extends(Person,_super),Person}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("PurchaseItemModel",function($q,BBModel,BaseModel){var PurchaseItem;return PurchaseItem=function(_super){function PurchaseItem(data){PurchaseItem.__super__.constructor.call(this,data),this.parts_links={},data&&(data.$has("service")&&(this.parts_links.service=data.$href("service")),data.$has("resource")&&(this.parts_links.resource=data.$href("resource")),data.$has("person")&&(this.parts_links.person=data.$href("person")),data.$has("company")&&(this.parts_links.company=data.$href("company")))}return __extends(PurchaseItem,_super),PurchaseItem.prototype.describe=function(){return this.get("describe")},PurchaseItem.prototype.full_describe=function(){return this.get("full_describe")},PurchaseItem.prototype.hasPrice=function(){return this.price&&this.price>0},PurchaseItem}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("PurchaseTotalModel",function($q,BBModel,BaseModel){var PurchaseTotal;return PurchaseTotal=function(_super){function PurchaseTotal(data){var cprom;PurchaseTotal.__super__.constructor.call(this,data),this.promise=this._data.$get("purchase_items"),this.items=[],this.promise.then(function(_this){return function(items){var item,_i,_len,_results;for(_results=[],_i=0,_len=items.length;_len>_i;_i++)item=items[_i],_results.push(_this.items.push(new BBModel.PurchaseItem(item)));return _results}}(this)),this._data.$has("client")&&(cprom=data.$get("client"),cprom.then(function(_this){return function(client){return _this.client=new BBModel.Client(client)}}(this)))}return __extends(PurchaseTotal,_super),PurchaseTotal.prototype.icalLink=function(){return this._data.$href("ical")},PurchaseTotal.prototype.webcalLink=function(){return this._data.$href("ical")},PurchaseTotal.prototype.gcalLink=function(){return this._data.$href("gcal")},PurchaseTotal.prototype.id=function(){return this.get("id")},PurchaseTotal}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("QuestionModel",function($q,$filter,BBModel,BaseModel){var Question;return Question=function(_super){function Question(data){var currency,option,_i,_len,_ref;if(Question.__super__.constructor.call(this,data),this.price&&(this.price=parseFloat(this.price)),this._data["default"]&&(this.answer=this._data["default"]),this._data.options)for(_ref=this._data.options,_i=0,_len=_ref.length;_len>_i;_i++)option=_ref[_i],option.is_default&&(this.answer=option.name),this.hasPrice()?(option.price=parseFloat(option.price),currency=data.currency_code?data.currency_code:"GBP",option.display_name=""+option.name+" ("+$filter("currency")(option.price,currency)+")"):option.display_name=option.name;("check"===this._data.detail_type||"check-price"===this._data.detail_type)&&(this.answer=this._data["default"]&&"1"===this._data["default"]),this.currentlyShown=!0}return __extends(Question,_super),Question.prototype.hasPrice=function(){return"check-price"===this.detail_type||"select-price"===this.detail_type||"radio-price"===this.detail_type},Question.prototype.selectedPrice=function(){var option,_i,_len,_ref;if(!this.hasPrice())return 0;if("check-price"===this.detail_type)return this.answer?this.price:0;for(_ref=this._data.options,_i=0,_len=_ref.length;_len>_i;_i++)if(option=_ref[_i],this.answer===option.name)return option.price;return 0},Question.prototype.selectedPriceQty=function(qty){var p;return qty||(qty=1),p=this.selectedPrice(),this.price_per_booking&&(p*=qty),p},Question.prototype.getAnswerId=function(){var o,_i,_len,_ref;if(!this.answer||!this.options||0===this.options.length)return null;for(_ref=this.options,_i=0,_len=_ref.length;_len>_i;_i++)if(o=_ref[_i],this.answer===o.name)return o.id;return null},Question.prototype.showElement=function(){return this.currentlyShown=!0},Question.prototype.hideElement=function(){return this.currentlyShown=!1},Question.prototype.getPostData=function(){var p,x;return x={},x.id=this.id,x.answer=this.answer,"date"===this.detail_type&&this.answer&&(x.answer=moment(this.answer).toISODate()),p=this.selectedPrice(),p&&(x.price=p),x},Question}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("ResourceModel",function($q,BBModel,BaseModel){var Resource;return Resource=function(_super){function Resource(){return Resource.__super__.constructor.apply(this,arguments)
}return __extends(Resource,_super),Resource}(BaseModel)})}.call(this),function(){"use strict";var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("ServiceModel",function($q,BBModel,BaseModel){var Service;return Service=function(_super){function Service(){this.days_array=__bind(this.days_array,this),this.getCategoryPromise=__bind(this.getCategoryPromise,this),Service.__super__.constructor.apply(this,arguments),this.prices&&this.prices.length>0&&(this.price=this.prices[0]),this.durations&&this.durations.length>0&&(this.duration=this.durations[0]),this.listed_durations||(this.listed_durations=this.durations),this.listed_durations&&this.listed_durations.length>0&&(this.listed_duration=this.listed_durations[0]),this.min_advance_datetime=moment().add(this.min_advance_period,"seconds"),this.max_advance_datetime=moment().add(this.max_advance_period,"seconds")}return __extends(Service,_super),Service.prototype.getPriceByDuration=function(dur){var d,i,_i,_len,_ref;for(_ref=this.durations,i=_i=0,_len=_ref.length;_len>_i;i=++_i)if(d=_ref[i],d===dur)return this.prices[i]},Service.prototype.getCategoryPromise=function(){var prom;return this.$has("category")?(prom=this.$get("category"),prom.then(function(_this){return function(cat){return _this.category=new BBModel.Category(cat)}}(this)),prom):null},Service.prototype.days_array=function(){var arr,str,x,_i,_ref,_ref1;for(arr=[],x=_i=_ref=this.min_bookings,_ref1=this.max_bookings;_ref1>=_ref?_ref1>=_i:_i>=_ref1;x=_ref1>=_ref?++_i:--_i)str=""+x+" day",x>1&&(str+="s"),arr.push({name:str,val:x});return arr},Service}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("SpaceModel",function($q,BBModel,BaseModel){var Space;return Space=function(_super){function Space(){return Space.__super__.constructor.apply(this,arguments)}return __extends(Space,_super),Space}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("SurveyQuestionModel",function($q,$window,BBModel,BaseModel,QuestionModel){var SurveyQuestion;return SurveyQuestion=function(_super){function SurveyQuestion(){return SurveyQuestion.__super__.constructor.apply(this,arguments)}return __extends(SurveyQuestion,_super),SurveyQuestion}(QuestionModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("TimeSlotModel",function($q,$window,BBModel,BaseModel){var TimeSlot;return TimeSlot=function(_super){function TimeSlot(data,service){TimeSlot.__super__.constructor.call(this,data),this.service=service,this.time_12=this.print_time12(),this.time_24=this.print_time()}return __extends(TimeSlot,_super),TimeSlot.prototype.print_time=function(){var min,t;return this.start?this.start.format("h:mm"):(t=this.get("time"),min=10>t%60?"0"+t%60:t%60,""+Math.floor(t/60)+":"+min)},TimeSlot.prototype.print_end_time=function(dur){var min,t;return this.end?this.end.format("h:mm"):(dur||(dur=this.service.listed_durations[0]),t=this.get("time")+dur,min=10>t%60?"0"+t%60:t%60,""+Math.floor(t/60)+":"+min)},TimeSlot.prototype.print_time12=function(show_suffix){var h,m,suffix,t,time;return null==show_suffix&&(show_suffix=!0),t=this.get("time"),h=Math.floor(t/60),m=t%60,suffix="am",h>=12&&(suffix="pm"),h>12&&(h-=12),time=$window.sprintf("%d.%02d",h,m),show_suffix&&(time+=suffix),time},TimeSlot.prototype.print_end_time12=function(show_suffix,dur){var end_time,h,m,suffix,t;return null==show_suffix&&(show_suffix=!0),dur=null,dur||(dur=null!=this.service.listed_duration?this.service.listed_duration:this.service.listed_durations[0]),t=this.get("time")+dur,h=Math.floor(t/60),m=t%60,suffix="am",h>=12&&(suffix="pm"),h>12&&(h-=12),end_time=$window.sprintf("%d.%02d",h,m),show_suffix&&(end_time+=suffix),end_time},TimeSlot.prototype.availability=function(){return this.avail},TimeSlot.prototype.select=function(){return this.selected=!0},TimeSlot.prototype.unselect=function(){return this.selected?delete this.selected:void 0},TimeSlot.prototype.disable=function(reason){return this.disabled=!0,this.disabled_reason=reason},TimeSlot.prototype.enable=function(){return this.disabled&&delete this.disabled,this.disabled_reason?delete this.disabled_reason:void 0},TimeSlot.prototype.status=function(){return this.selected?"selected":this.disabled?"disabled":this.availability()>0?"enabled":"disabled"},TimeSlot}(BaseModel)})}.call(this),function(){var ModalDelete;angular.module("BB.Directives").directive("bbPurchase",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"Purchase",link:function(scope,element,attrs){scope.init(scope.$eval(attrs.bbPurchase))}}}),angular.module("BB.Controllers").controller("Purchase",function($scope,$rootScope,CompanyService,PurchaseService,ClientService,$modal,$location,$timeout,BBWidget,BBModel,$q,QueryStringService,SSOService,AlertService,LoginService,$window,$upload,ServiceService,$sessionStorage){var checkIfMoveBooking,failMsg,getCompanyID,getPurchaseID,id,loginRequired,setPurchaseCompany;return $scope.controller="Purchase",setPurchaseCompany=function(company){return $scope.bb.company_id=company.id,$scope.bb.company=new BBModel.Company(company),$scope.company=$scope.bb.company,$scope.bb.item_defaults.company=$scope.bb.company,company.settings&&(company.settings.merge_resources&&($scope.bb.item_defaults.merge_resources=!0),company.settings.merge_people)?$scope.bb.item_defaults.merge_people=!0:void 0},failMsg=function(){return AlertService.danger($scope.fail_msg?{msg:$scope.fail_msg}:{msg:"Sorry, something went wrong"})},$scope.init=function(options){return options.move_route&&($scope.move_route=options.move_route),options.move_all&&($scope.move_all=options.move_all),options.login_redirect&&$scope.requireLogin({redirect:options.login_redirect}),$scope.notLoaded($scope),options.fail_msg&&($scope.fail_msg=options.fail_msg),options.member_sso?SSOService.memberLogin(options).then(function(){return $scope.load()},function(){return $scope.setLoaded($scope),failMsg()}):$scope.load()},$scope.load=function(id){return $scope.notLoaded($scope),id||(id=QueryStringService("ref")),QueryStringService("booking_id")&&(id=QueryStringService("booking_id")),$scope.loaded||$rootScope.widget_started.then(function(){return function(){return $scope.waiting_for_conn_started.then(function(){var auth_token,company_id,params;return company_id=getCompanyID(),company_id&&CompanyService.query(company_id,{}).then(function(company){return setPurchaseCompany(company)}),params={purchase_id:id,url_root:$scope.bb.api_url},auth_token=$sessionStorage.getItem("auth_token"),auth_token&&(params.auth_token=auth_token),PurchaseService.query(params).then(function(purchase){return null==$scope.bb.company&&purchase.$get("company").then(function(){return function(company){return setPurchaseCompany(company)}}(this)),$scope.purchase=purchase,$scope.total=$scope.purchase,$scope.price=!(0===$scope.purchase.price),$scope.purchase.getBookingsPromise().then(function(bookings){var booking,_i,_len,_ref,_results;for($scope.bookings=bookings,$scope.setLoaded($scope),checkIfMoveBooking(bookings),_ref=$scope.bookings,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)booking=_ref[_i],_results.push(booking.getAnswersPromise().then(function(answers){return booking.answers=answers}));return _results},function(){return $scope.setLoaded($scope),failMsg()}),purchase.$has("client")&&purchase.$get("client").then(function(){return function(client){return $scope.setClient(new BBModel.Client(client))}}(this)),$scope.purchase.getConfirmMessages().then(function(messages){return $scope.messages=messages})},function(err){return $scope.setLoaded($scope),err&&401===err.status&&$scope.login_action?LoginService.isLoggedIn()?failMsg():loginRequired():failMsg()})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this),function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")}),$scope.loaded=!0},checkIfMoveBooking=function(bookings){var b,id,matches,move_booking;return matches=/^.*(?:\?|&)move_booking=(.*?)(?:&|$)/.exec($location.absUrl()),matches&&(id=parseInt(matches[1])),id&&(move_booking=function(){var _i,_len,_results;for(_results=[],_i=0,_len=bookings.length;_len>_i;_i++)b=bookings[_i],b.id===id&&_results.push(b);return _results}(),move_booking.length>0&&$scope.isMovable(bookings[0]))?$scope.move(move_booking[0]):void 0},$scope.requireLogin=function(){return function(action){var div;return _.isString(action.redirect)&&(div=-1===action.redirect.indexOf("?")?"?":"&",action.redirect+=div+"ref="+encodeURIComponent(QueryStringService("ref"))),$scope.login_action=action}}(this),loginRequired=function(){return function(){return $scope.login_action.redirect?window.location=$scope.login_action.redirect:void 0}}(this),getCompanyID=function(){var company_id,matches;return matches=/^.*(?:\?|&)company_id=(.*?)(?:&|$)/.exec($location.absUrl()),matches&&(company_id=matches[1]),company_id},getPurchaseID=function(){var id,matches;return matches=/^.*(?:\?|&)id=(.*?)(?:&|$)/.exec($location.absUrl()),matches||(matches=/^.*print_purchase\/(.*?)(?:\?|$)/.exec($location.absUrl())),matches||(matches=/^.*print_purchase_jl\/(.*?)(?:\?|$)/.exec($location.absUrl())),matches&&(id=matches[1]),id},$scope.move=function(booking,route,options){return null==options&&(options={}),route||(route=$scope.move_route),$scope.move_all?$scope.moveAll(route,options):($scope.notLoaded($scope),$scope.clearPage(),$scope.initWidget({company_id:booking.company_id,no_route:!0}),$timeout(function(){return function(){return $rootScope.connection_started.then(function(){var new_item,proms;return proms=[],$scope.bb.moving_booking=booking,$scope.quickEmptybasket(),new_item=new BBModel.BasketItem(booking,$scope.bb),new_item.setSrcBooking(booking,$scope.bb),new_item.ready=!1,Array.prototype.push.apply(proms,new_item.promises),$scope.bb.basket.addItem(new_item),$scope.setBasketItem(new_item),$q.all(proms).then(function(){return $scope.setLoaded($scope),$rootScope.$emit("booking:move"),$scope.decideNextPage(route)},function(){return $scope.setLoaded($scope),failMsg()})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this)))},$scope.moveAll=function(route,options){return null==options&&(options={}),route||(route=$scope.move_route),$scope.notLoaded($scope),$scope.clearPage(),$scope.initWidget({company_id:$scope.bookings[0].company_id,no_route:!0}),$timeout(function(){return function(){return $rootScope.connection_started.then(function(){var booking,new_item,proms,_i,_len,_ref;for(proms=[],$scope.bb.moving_booking=1===$scope.bookings.length?$scope.bookings[0]:$scope.purchase,$scope.quickEmptybasket(),_ref=$scope.bookings,_i=0,_len=_ref.length;_len>_i;_i++)booking=_ref[_i],new_item=new BBModel.BasketItem(booking,$scope.bb),new_item.setSrcBooking(booking),new_item.ready=!1,new_item.move_done=!1,Array.prototype.push.apply(proms,new_item.promises),$scope.bb.basket.addItem(new_item);return $scope.bb.sortStackedItems(),$scope.setBasketItem($scope.bb.basket.items[0]),$q.all(proms).then(function(){return $scope.setLoaded($scope),$scope.decideNextPage(route)},function(){return $scope.setLoaded($scope),failMsg()})},function(err){return $scope.setLoadedAndShowError($scope,err,"Sorry, something went wrong")})}}(this))},$scope.confirm_delete=function(){var modalInstance;return modalInstance=$modal.open,modalInstance.booking.$del("self").then(function(){return function(){return modalInstance.close,$rootScope.$emit("booking:cancelled")}}(this))},$scope["delete"]=function(booking){var modalInstance;return $scope.clearPage(),modalInstance=$modal.open({templateUrl:$scope.getPartial("cancel_modal"),controller:ModalDelete,resolve:{booking:function(){return booking}}}),modalInstance.result.then(function(booking){return booking.$del("self").then(function(){return function(){return $scope.bookings=_.without($scope.bookings,booking)}}(this))})},$scope.cancel=function(){var modalInstance;return modalInstance=$modal.open,modalInstance.dismiss("cancel")},$scope.isMovable=function(booking){return booking.min_cancellation_time?moment().isBefore(booking.min_cancellation_time):booking.datetime.isAfter(moment())},$scope.onFileSelect=function(booking,$file,existing){var att_id,file,method;return $scope.upload_progress=0,console.log($file,booking,existing),console.log,file=$file,att_id=null,existing&&(att_id=existing.id),method="POST",att_id&&(method="PUT"),$scope.upload=$upload.upload({url:booking.$href("attachments"),method:method,data:{att_id:att_id},file:file}).progress(function(evt){return $scope.upload_progress<100?$scope.upload_progress=parseInt(99*evt.loaded/evt.total):void 0}).success(function(data){return $scope.upload_progress=100,data&&data.attachments&&booking?booking.attachments=data.attachments:void 0})},$scope.bb.total?$scope.load($scope.bb.total.long_id):(id=getPurchaseID(),id&&$scope.load(id)),$scope.createBasketItem=function(booking){var item;return item=new BBModel.BasketItem(booking,$scope.bb),item.setSrcBooking(booking),item},$scope.checkAnswer=function(answer){return"boolean"==typeof answer.value||"string"==typeof answer.value||"number"==typeof answer.value}}),ModalDelete=function($scope,$rootScope,$modalInstance,booking){return $scope.controller="ModalDelete",$scope.booking=booking,$scope.confirm_delete=function(){return $modalInstance.close(booking)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}}}.call(this),function(){"use strict";var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Purchase.BookingModel",function($q,$window,BBModel,BaseModel){var Purchase_Booking;return Purchase_Booking=function(_super){function Purchase_Booking(data){this.getSurveyAnswersPromise=__bind(this.getSurveyAnswersPromise,this),this.getAnswersPromise=__bind(this.getAnswersPromise,this),Purchase_Booking.__super__.constructor.call(this,data),this.ready=!1,this.datetime=moment.parseZone(this.datetime),this.time_zone&&this.datetime.tz(this.time_zone),this.original_datetime=moment(this.datetime),this.end_datetime=moment.parseZone(this.end_datetime),this.time_zone&&this.end_datetime.tz(this.time_zone)}return __extends(Purchase_Booking,_super),Purchase_Booking.prototype.getGroup=function(){return this.group?this.group:this._data.$has("event_groups")?this._data.$get("event_groups").then(function(_this){return function(group){return _this.group=group,_this.group}}(this)):void 0},Purchase_Booking.prototype.getColour=function(){return this.getGroup()?this.getGroup().colour:"#FFFFFF"},Purchase_Booking.prototype.getCompany=function(){return this.company?this.company:this.$has("company")?this._data.$get("company").then(function(_this){return function(company){return _this.company=new BBModel.Company(company),_this.company}}(this)):void 0},Purchase_Booking.prototype.getAnswersPromise=function(){var defer;return defer=$q.defer(),this.answers&&defer.resolve(this.answers),this._data.$has("answers")?this._data.$get("answers").then(function(_this){return function(answers){var a;return _this.answers=function(){var _i,_len,_results;for(_results=[],_i=0,_len=answers.length;_len>_i;_i++)a=answers[_i],_results.push(new BBModel.Answer(a));return _results}(),defer.resolve(_this.answers)}}(this)):defer.resolve([]),defer.promise},Purchase_Booking.prototype.getSurveyAnswersPromise=function(){var defer;return defer=$q.defer(),this.survey_answers&&defer.resolve(this.survey_answers),this._data.$has("survey_answers")?this._data.$get("survey_answers").then(function(_this){return function(survey_answers){var a;return _this.survey_answers=function(){var _i,_len,_results;for(_results=[],_i=0,_len=survey_answers.length;_len>_i;_i++)a=survey_answers[_i],_results.push(new BBModel.Answer(a));return _results}(),defer.resolve(_this.survey_answers)}}(this)):defer.resolve([]),defer.promise},Purchase_Booking.prototype.getPostData=function(){var data,formatted_survey_answers,q,_i,_len,_ref;if(data={},data.attended=this.attended,data.client_id=this.client_id,data.company_id=this.company_id,data.time=60*this.datetime.hour()+this.datetime.minute(),data.date=this.datetime.toISODate(),data.deleted=this.deleted,data.describe=this.describe,data.duration=this.duration,data.end_datetime=this.end_datetime,this.event&&(data.event_id=this.event.id),data.full_describe=this.full_describe,data.id=this.id,data.min_cancellation_time=this.min_cancellation_time,data.on_waitlist=this.on_waitlist,data.paid=this.paid,data.person_name=this.person_name,data.price=this.price,data.purchase_id=this.purchase_id,data.purchase_ref=this.purchase_ref,data.quantity=this.quantity,data.self=this.self,this.move_item_id&&(data.move_item_id=this.move_item_id),this.srcBooking&&(data.move_item_id=this.srcBooking.id),this.person&&(data.person_id=this.person.id),this.service&&(data.service_id=this.service.id),this.resource&&(data.resource_id=this.resource.id),this.item_details&&(data.questions=this.item_details.getPostData()),data.service_name=this.service_name,data.settings=this.settings,null!=this.email&&(data.email=this.email),null!=this.email_admin&&(data.email_admin=this.email_admin),formatted_survey_answers=[],this.survey_questions){for(data.survey_questions=this.survey_questions,_ref=this.survey_questions,_i=0,_len=_ref.length;_len>_i;_i++)q=_ref[_i],formatted_survey_answers.push({value:q.answer,outcome:q.outcome,detail_type_id:q.id,price:q.price});data.survey_answers=formatted_survey_answers}return data},Purchase_Booking.prototype.checkReady=function(){return this.datetime&&this.id&&this.purchase_ref?this.ready=!0:void 0},Purchase_Booking.prototype.printed_price=function(){return parseFloat(this.price)%1===0?""+parseInt(this.price):$window.sprintf("%.2f",parseFloat(this.price))},Purchase_Booking.prototype.getDateString=function(){return this.datetime.toISODate()},Purchase_Booking.prototype.getTimeInMins=function(){return 60*this.datetime.hour()+this.datetime.minute()},Purchase_Booking.prototype.getAttachments=function(){return this.attachments?this.attachments:this.$has("attachments")?this._data.$get("attachments").then(function(_this){return function(atts){return _this.attachments=atts.attachments,_this.attachments}}(this)):void 0},Purchase_Booking}(BaseModel)})}.call(this),function(){"use strict";var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Purchase.TotalModel",function($q,$window,BBModel,BaseModel,$sce){var Purchase_Total;return Purchase_Total=function(_super){function Purchase_Total(data){this.getConfirmMessages=__bind(this.getConfirmMessages,this),this.getClient=__bind(this.getClient,this),this.getMessages=__bind(this.getMessages,this),this.getProducts=__bind(this.getProducts,this),this.getPackages=__bind(this.getPackages,this),this.getBookingsPromise=__bind(this.getBookingsPromise,this),this.getItems=__bind(this.getItems,this),Purchase_Total.__super__.constructor.call(this,data),this.getItems().then(function(_this){return function(items){return _this.items=items}}(this)),this.getClient().then(function(_this){return function(client){return _this.client=client}}(this))}return __extends(Purchase_Total,_super),Purchase_Total.prototype.id=function(){return this.get("id")},Purchase_Total.prototype.icalLink=function(){return this._data.$href("ical")},Purchase_Total.prototype.webcalLink=function(){return this._data.$href("ical")},Purchase_Total.prototype.gcalLink=function(){return this._data.$href("gcal")},Purchase_Total.prototype.getItems=function(){var defer,items;return defer=$q.defer(),this.items&&defer.resolve(this.items),items=[],this.getBookingsPromise().then(function(_this){return function(bookings){return null!=bookings&&bookings.length>0&&(items=items.concat(bookings)),_this.getPackages().then(function(packages){return null!=packages&&packages.length>0&&(items=items.concat(packages)),defer.resolve(items)},function(){return defer.resolve(items)})}}(this),function(){return this.getPackages().then(function(packages){return null!=packages&&packages.length>0&&(items=items.concat(packages)),defer.resolve(items)})}),defer.promise},Purchase_Total.prototype.getBookingsPromise=function(){var defer;return defer=$q.defer(),this.bookings&&defer.resolve(this.bookings),this._data.$has("bookings")?this._data.$get("bookings").then(function(_this){return function(bookings){var b;return _this.bookings=function(){var _i,_len,_results;for(_results=[],_i=0,_len=bookings.length;_len>_i;_i++)b=bookings[_i],_results.push(new BBModel.Purchase.Booking(b));return _results}(),_this.bookings.sort(function(a,b){return a.datetime.unix()-b.datetime.unix()}),defer.resolve(_this.bookings)}}(this)):defer.reject("No bookings"),defer.promise},Purchase_Total.prototype.getPackages=function(){var defer;return defer=$q.defer(),this.packages&&defer.resolve(this.packages),this._data.$has("packages")?this._data.$get("packages").then(function(_this){return function(){return defer.resolve(_this.packages)}}(this)):defer.reject("No packages"),defer.promise},Purchase_Total.prototype.getProducts=function(){var defer;return defer=$q.defer(),this.products&&defer.resolve(this.products),this._data.$has("products")?this._data.$get("products").then(function(_this){return function(){return defer.resolve(_this.products)}}(this)):defer.reject("No products"),defer.promise},Purchase_Total.prototype.getMessages=function(booking_texts,msg_type){var bt,defer;return defer=$q.defer(),booking_texts=function(){var _i,_len,_results;for(_results=[],_i=0,_len=booking_texts.length;_len>_i;_i++)bt=booking_texts[_i],bt.message_type===msg_type&&_results.push(bt);return _results}(),0===booking_texts.length?defer.resolve([]):this.getItems().then(function(items){var booking_text,item,msgs,type,_i,_j,_k,_len,_len1,_len2,_ref;for(msgs=[],_i=0,_len=booking_texts.length;_len>_i;_i++)for(booking_text=booking_texts[_i],_j=0,_len1=items.length;_len1>_j;_j++)for(item=items[_j],_ref=["company","person","resource","service"],_k=0,_len2=_ref.length;_len2>_k;_k++)type=_ref[_k],item.$has(type)&&item.$href(type)===booking_text.$href("item")&&-1===msgs.indexOf(booking_text.message)&&msgs.push(booking_text.message);return defer.resolve(msgs)}),defer.promise},Purchase_Total.prototype.getClient=function(){var defer;return defer=$q.defer(),this._data.$has("client")?this._data.$get("client").then(function(_this){return function(client){return _this.client=new BBModel.Client(client),defer.resolve(_this.client)}}(this)):defer.reject("No client"),defer.promise},Purchase_Total.prototype.getConfirmMessages=function(){var defer;return defer=$q.defer(),this._data.$has("confirm_messages")?this._data.$get("confirm_messages").then(function(_this){return function(msgs){return _this.getMessages(msgs,"Confirm").then(function(filtered_msgs){return defer.resolve(filtered_msgs)})}}(this)):defer.reject("no messages"),defer.promise},Purchase_Total.prototype.printed_total_price=function(){return parseFloat(this.total_price)%1===0?""+parseInt(this.total_price):$window.sprintf("%.2f",parseFloat(this.total_price))},Purchase_Total.prototype.newPaymentUrl=function(){return this._data.$has("new_payment")?$sce.trustAsResourceUrl(this._data.$href("new_payment")):void 0},Purchase_Total.prototype.totalDuration=function(){var duration,item,_i,_len,_ref;for(duration=0,_ref=this.items,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],item.duration&&(duration=+item.duration);return duration/=60},Purchase_Total}(BaseModel)})}.call(this),function(){"use strict";angular.module("BB.Services").factory("PurchaseBookingService",function($q,halClient,BBModel){return{update:function(booking){var data,deferred;return deferred=$q.defer(),data=booking.getPostData(),booking.srcBooking.$put("self",{},data).then(function(){return function(booking){return deferred.resolve(new BBModel.Purchase.Booking(booking))}}(this),function(){return function(err){return deferred.reject(err,new BBModel.Purchase.Booking(booking))}}(this)),deferred.promise},addSurveyAnswersToBooking:function(booking){var data,deferred;return deferred=$q.defer(),data=booking.getPostData(),booking.$put("self",{},data).then(function(){return function(booking){return deferred.resolve(new BBModel.Purchase.Booking(booking))}}(this),function(){return function(err){return deferred.reject(err,new BBModel.Purchase.Booking(booking))}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("PurchaseService",function($q,halClient,BBModel,$window){return{query:function(params){var defer,uri;return defer=$q.defer(),uri=params.url_root+"/api/v1/purchases/"+params.purchase_id,halClient.$get(uri,params).then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(err){return defer.reject(err)}),defer.promise},bookingRefQuery:function(params){var defer,uri;return defer=$q.defer(),uri=new $window.UriTemplate.parse(params.url_root+"/api/v1/purchases/booking_ref/{booking_ref}{?raw}").expand(params),halClient.$get(uri,params).then(function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)},function(err){return defer.reject(err)}),defer.promise},update:function(params){var bdata,booking,data,defer,_i,_len,_ref;if(defer=$q.defer(),!params.purchase)return defer.reject("No purchase present"),defer.promise;if(data={},params.bookings){for(bdata=[],_ref=params.bookings,_i=0,_len=_ref.length;_len>_i;_i++)booking=_ref[_i],bdata.push(booking.getPostData());data.bookings=bdata}return params.purchase.$put("self",{},data).then(function(){return function(purchase){return purchase=new BBModel.Purchase.Total(purchase),defer.resolve(purchase)}}(this),function(){return function(err){return defer.reject(err)}}(this)),defer.promise}}})}.call(this),function(){"use strict";angular.module("BBAdmin.Directives").directive("bbDashboardBooking",function(){return{restrict:"AE",replace:!0,scope:{avail:"=available",booking:"=",person:"=",time:"=",allDayBlocking:"=",first:"=",numServices:"="},templateUrl:function(tElm,tAttrs){return tAttrs.template},controller:function($scope){return $scope.openModal=$scope.$parent.openModal,$scope.$watchCollection("[booking, allDayBlocking, avail, first]",function(newValues){var booking,start;return booking=newValues[0],$scope.completed=!1,$scope.checked_in=!1,$scope.being_seen=!1,$scope.no_show=!1,$scope.blocking=newValues[1],$scope.blocked=null!=newValues[1],$scope.allDay=!1,null!=booking&&($scope.allDay|=booking.allDay),$scope.allDay|=null!=$scope.blocking,$scope.available=newValues[2],$scope.showHeader=newValues[3]||!$scope.blocked,null!=booking?($scope.blocked|=4!==booking.status,$scope.blocking=booking,null==booking.multi_status||$scope.blocked||($scope.completed=booking.hasStatus("completed"),$scope.checked_in=booking.hasStatus("checked_in"),$scope.no_show=booking.hasStatus("no_show"),$scope.being_seen=booking.hasStatus("being_seen")),start=booking.start.minutes()+60*booking.start.hours(),$scope.showHeader=start===$scope.time):void 0})}}})}.call(this),function(){"use strict";angular.module("BBAdmin.Directives").directive("bbPeopleList",function(){return{restrict:"AE",replace:!0,scope:!0,controller:function($scope,$rootScope){return $rootScope.connection_started.then(function(){return $scope.bb.company.getPeoplePromise().then(function(people){var person,_i,_len,_results;for($scope.people=people,_results=[],_i=0,_len=people.length;_len>_i;_i++)person=people[_i],_results.push(person.show=!0);return _results})}),$scope.show_all_people=function(){var x,_i,_len,_ref,_results;for(_ref=$scope.people,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)x=_ref[_i],_results.push(x.show=!0);return _results},$scope.hide_all_people=function(){var x,_i,_len,_ref,_results;for(_ref=$scope.people,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)x=_ref[_i],_results.push(x.show=!1);return _results}},link:function(){}}}),angular.module("BBAdmin.Directives").directive("bbBookingList",function(){return{restrict:"AE",replace:!0,scope:{bookings:"=",cancelled:"=",params:"="},templateUrl:function(tElm,tAttrs){return tAttrs.template},controller:function($scope,$filter){var status;return $scope.title=$scope.params.title,status=$scope.params.status,$scope.$watch(function(){return $scope.bookings},function(){var bookings,cancelled;return bookings=$scope.bookings,cancelled=$scope.cancelled,null==cancelled&&(cancelled=!1),null!=bookings&&(bookings=$filter("filter")(bookings,function(booking){var ret;return ret=booking.is_cancelled===cancelled,ret&=null!=status?booking.hasStatus(status):null==booking.multi_status||0===Object.keys(booking.multi_status).length,ret&=4===booking.status}),$scope.relevantBookings=$filter("orderBy")(bookings,"datetime")),null!=$scope.relevantBookings?$scope.relevantBookings:$scope.relevantBookings=[]})}}})}.call(this),function(){var app;app=angular.module("BB.Directives"),app.directive("intTelNumber",function(){return{restrict:"A",link:function(scope,element,attrs){var options;return options=scope.$eval(attrs.intTelNumber),element.intlTelInput(options)}}})}.call(this),function(){angular.module("BB.Directives").directive("bbMonthPicker",function(){return{restrict:"AE",replace:!0,scope:!0,link:function(scope,el,attrs){return scope.picker_settings=scope.$eval(attrs.bbMonthPicker),scope.num_months=scope.picker_settings.months||3,scope.watch_val=attrs.dayData,scope.$watch(scope.watch_val,function(newval){return newval?scope.processDates(newval):void 0})},controller:function($scope){return $scope.processDates=function(dates){var cur_month,d,date,datehash,m,month,months,w,week,_i,_j,_k,_l,_len,_ref;for(datehash={},_i=0,_len=dates.length;_len>_i;_i++)date=dates[_i],datehash[date.date.format("DDMMYY")]=date,!$scope.first_available_day&&date.spaces>0&&($scope.first_available_day=date.date);for(cur_month=$scope.picker_settings.start_at_first_available_day?$scope.first_available_day.clone().startOf("month"):dates[0].date.clone().startOf("month"),date=cur_month.startOf("week"),months=[],m=_j=1,_ref=$scope.num_months;_ref>=1?_ref>=_j:_j>=_ref;m=_ref>=1?++_j:--_j){for(date=cur_month.clone().startOf("week"),month={weeks:[]},w=_k=1;6>=_k;w=++_k){for(week={days:[]},d=_l=1;7>=_l;d=++_l)week.days.push({date:date.clone(),data:datehash[date.format("DDMMYY")]}),date.isSame(date.clone().startOf("month"),"day")&&!month.start_date&&(month.start_date=date.clone()),date.add(1,"day");
month.weeks.push(week)}months.push(month),cur_month.add(1,"month")}return $scope.months=months,null!=$scope.selected_date&&$scope.selectMonthNumber($scope.selected_date.month()),$scope.selected_month=$scope.selected_month||$scope.months[0]},$scope.selectMonth=function(month){var day,week,_i,_j,_len,_len1,_ref,_ref1;for($scope.selected_month=month,_ref=month.weeks,_i=0,_len=_ref.length;_len>_i;_i++)for(week=_ref[_i],_ref1=week.days,_j=0,_len1=_ref1.length;_len1>_j;_j++)if(day=_ref1[_j],day.data&&day.data.spaces>0&&(day.date.isSame(month.start_date,"day")||day.date.isAfter(month.start_date,"day")))return void $scope.showDate(day.date)},$scope.selectMonthNumber=function(month){var m,_i,_len,_ref;if(!$scope.selected_month||$scope.selected_month.start_date.month()!==month){for(_ref=$scope.months,_i=0,_len=_ref.length;_len>_i;_i++)m=_ref[_i],m.start_date.month()===month&&$scope.selectMonth(m);return!0}},$scope.add=function(value){var index,month,_i,_len,_ref;for(_ref=$scope.months,index=_i=0,_len=_ref.length;_len>_i;index=++_i)if(month=_ref[index],$scope.selected_month===month&&$scope.months[index+value])return $scope.selectMonth($scope.months[index+value]),!0;return!1},$scope.subtract=function(value){return $scope.add(-value)}}}})}.call(this),function(){"use strict";var app;app=angular.module("BB.Directives"),app.directive("bbPaypal",function(PathSvc){return{restrict:"A",replace:!0,scope:{ppDetails:"=bbPaypal"},templateUrl:PathSvc.directivePartial("paypal_button"),link:function(scope){var keys;return scope.inputs=[],scope.ppDetails?(keys=_.keys(scope.ppDetails),_.each(keys,function(keyName){var obj;return obj={name:keyName,value:scope.ppDetails[keyName]},scope.inputs.push(obj)})):void 0}}})}.call(this),function(){angular.module("BB.Directives").directive("bbToggleEdit",function($compile,$window,$document){return{restrict:"AE",link:function(scope,element){return scope.editing=!1,element.on("dblclick",function(){return function(){return scope.$apply(function(){return scope.editing=!0})}}(this)),$document.on("click",function(){return function(){return element.is(":hover")?void 0:scope.$apply(function(){return scope.editing=!1})}}(this)),!0}}})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("Admin.LoginModel",function($q,BBModel,BaseModel){var Admin_Login;return Admin_Login=function(_super){function Admin_Login(data){Admin_Login.__super__.constructor.call(this,data)}return __extends(Admin_Login,_super),Admin_Login}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("AffiliateModel",function($q,BBModel,BaseModel){var Affiliate;return Affiliate=function(_super){function Affiliate(data){Affiliate.__super__.constructor.call(this,data),this.test=1}return __extends(Affiliate,_super),Affiliate.prototype.getCompanyByRef=function(ref){var defer;return defer=$q.defer(),this.$get("companies",{reference:ref}).then(function(company){return console.log(company),company?defer.resolve(new BBModel.Company(company)):defer.reject("No company for ref "+ref)},function(err){return console.log("err ",err),defer.reject(err)}),defer.promise},Affiliate}(BaseModel)})}.call(this),function(){"use strict";var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};angular.module("BB.Models").factory("SlotModel",function($q,BBModel,BaseModel){var Slot;return Slot=function(_super){function Slot(data){Slot.__super__.constructor.call(this,data),this.datetime=moment(data.datetime)}return __extends(Slot,_super),Slot}(BaseModel)})}.call(this),function(){angular.module("BBAdmin.Services").factory("AdminClientService",function($q,$window,$rootScope,halClient,ClientCollections,BBModel){return{query:function(prms){var deferred,href,uri,url;return prms.company&&(prms.company_id=prms.company.id),url="",$rootScope.bb.api_url&&(url=$rootScope.bb.api_url),href=url+"/api/v1/admin/{company_id}/client{/id}{?page,per_page,filter_by,filter_by_fields,order_by,order_by_reverse}",uri=new $window.UriTemplate.parse(href).expand(prms||{}),deferred=$q.defer(),halClient.$get(uri,{}).then(function(){return function(resource){var client;return resource.$has("clients")?resource.$get("clients").then(function(items){var clients,i,people,_i,_len;for(people=[],_i=0,_len=items.length;_len>_i;_i++)i=items[_i],people.push(new BBModel.Client(i));return clients=new $window.Collection.Client(resource,people,prms),clients.total_entries=resource.total_entries,ClientCollections.add(clients),deferred.resolve(clients)}):(client=new BBModel.Client(resource),deferred.resolve(client))}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise},update:function(client){var deferred;return deferred=$q.defer(),client.$put("self",{},client).then(function(){return function(res){return deferred.resolve(new BBModel.Client(res))}}(this),function(){return function(err){return deferred.reject(err)}}(this)),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("SlotService",function($q,BBModel){return{query:function(company,params){var deferred;return deferred=$q.defer(),company.$has("slots")?(params.item&&(params.item.resource&&(params.resource_id=params.item.resource.id),params.item.person&&(params.person_id=params.item.person.id)),company.$get("slots",params).then(function(){return function(resource){return resource.$get("slots",params).then(function(slots){var slot;return slots=function(){var _i,_len,_results;for(_results=[],_i=0,_len=slots.length;_len>_i;_i++)slot=slots[_i],_results.push(new BBModel.Slot(slot));return _results}(),deferred.resolve(slots)})}}(this),function(){return function(err){return deferred.reject(err)}}(this))):deferred.resolve([]),deferred.promise}}})}.call(this),function(){angular.module("BB.Services").factory("TimeSlotService",function($q,BBModel){return{query:function(params){var company,defer;return defer=$q.defer(),company=params.company,company.$get("slots",params).then(function(collection){return collection.$get("slots").then(function(slots){var s;return slots=function(){var _i,_len,_results;for(_results=[],_i=0,_len=slots.length;_len>_i;_i++)s=slots[_i],_results.push(new BBModel.TimeSlot(s));return _results}(),defer.resolve(slots)},function(err){return defer.reject(err)})},function(err){return defer.reject(err)}),defer.promise}}})}.call(this),angular.module("BB").run(["$templateCache",function($templateCache){$templateCache.put("modal_form.html",'<div class="modal-header">\n  <h3 class="modal-title">{{title}}</h3>\n</div>\n<form name="modal_form" ng-submit="submit(modal_form)">\n  <div class="modal-body" sf-schema="schema" sf-form="form"\n    sf-model="form_model">\n  </div>\n  <div class="modal-footer">\n    <input type="submit" class="btn btn-primary" value="OK">\n    <button class="btn btn-default" ng-click="cancel($event)">Cancel</button>\n  </div>\n</form>\n'),$templateCache.put("edit_booking_modal_form.html",'<div class="modal-header">\n  <h3 class="modal-title">{{title}}</h3>\n</div>\n<form name="booking_form" ng-submit="submit(booking)">\n  <div class="modal-body" sf-schema="schema" sf-form="form" sf-model="booking">\n    <ul>\n      <li>{{model.full_describe}}</li>\n      <li>{{model.person_name}}</li>\n      <li>{{model.describe}}</li>\n    </ul>\n  </div>\n  <div class="modal-footer">\n    <input type="submit" class="btn btn-primary" value="OK">\n    <button class="btn btn-default" ng-click="cancel($event)">Dismiss</button>\n  </div>\n</form>\n'),$templateCache.put("login.html",'<form name="login_form" ng-submit="submit()" class="form-horizontal"\n  role="form">\n  <div class="alert alert-danger" role="alert" ng-if="alert && alert.length > 0">{{alert}}</div>\n  <div ng-class="{\'form-group\': true, \'has-error\': emailIsInvalid()}">\n    <label for="email" class="col-sm-2 control-label">Email</label>\n    <div class="col-sm-10">\n      <input type="email" ng-model="email" name="email" class="form-control"\n        id="email" placeholder="Email" required autofocus>\n    </div>\n  </div>\n  <div ng-class="{\'form-group\': true, \'has-error\': passwordIsInvalid()}">\n    <label for="password" class="col-sm-2 control-label">Password</label>\n    <div class="col-sm-10">\n      <input type="password" ng-model="password" name="password"\n        class="form-control" id="password" placeholder="Password" required>\n    </div>\n  </div>\n  <div class="form-group">\n    <div class="col-sm-offset-2 col-sm-10">\n      <button type="submit" class="btn btn-primary">Log In</button>\n    </div>\n  </div>\n</form>\n'),$templateCache.put("login_modal_form.html",'<div class="modal-header">\n  <h3 class="modal-title">{{title}}</h3>\n</div>\n<form name="login_form" ng-submit="submit(login_form)">\n  <div class="modal-body" sf-schema="schema" sf-form="form"\n    sf-model="login_form">\n  </div>\n  <div class="modal-footer">\n    <input type="submit" class="btn btn-primary" value="OK">\n    <button class="btn btn-default" ng-click="cancel($event)">Dismiss</button>\n  </div>\n</form>\n'),$templateCache.put("member_bookings_table.html",'<div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\n<table tr-ng-grid="" items="bookings" enable-filtering="false"\n  ng-hide="loading" fields="fields">\n  <thead>\n    <tr>\n      <th field-name="describe" display-name="Date/Time"></th>\n      <th field-name="full_describe" display-name="Description"></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>\n        <button class="btn btn-default btn-sm"\n          ng-click="delete(gridItem.id)">\n            Cancel\n        </button>\n        <button class="btn btn-default btn-sm"\n          ng-click="edit(gridItem.id)">\n            Details\n        </button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n'),$templateCache.put("pick_company.html",'<form name="pick_company_form" ng-submit="selectedCompany()" role="form">\n  <p>Pick Company</p>\n  <div ng-repeat="admin in administrators" class="radio">\n    <label>\n      <input id="company{{admin.company_id}}" type="radio"\n        ng-model="$parent.selected_admin" ng-value="admin" required\n        name="company">\n      {{admin.company_name}}\n    </label>\n  </div>\n  <input type="submit" class="btn btn-default">\n</form>\n'),$templateCache.put("pick_company_modal_form.html",'<div class="modal-header">\n  <h3 class="modal-title">{{title}}</h3>\n</div>\n<form name="pick_company_form" ng-submit="submit(pick_company_form)">\n  <div class="modal-body" sf-schema="schema" sf-form="form"\n    sf-model="pick_company_form">\n  </div>\n  <div class="modal-footer">\n    <input type="submit" class="btn btn-primary" value="OK">\n    <button class="btn btn-default" ng-click="cancel($event)">Dismiss</button>\n  </div>\n</form>\n'),$templateCache.put("basket.html","<div>\n  <h1>Not a mini basket</h1>\n</div>"),$templateCache.put("basket_mini.html",'<div class="bb-mini-basket">\n  <span class=\'glyphicon glyphicon-shopping-cart\'></span>\n  <span>{{basketStatus}}</span>\n  <span ng-if="basketItemCount">\n    <a href=\'#\' ng-click="BasketCtrl.empty()" class="btn btn-default btn-xs">\n      <span class="glyphicon glyphicon-remove-circle"></span>\n    </a>\n    <a href=\'#\' ng-click="BasketCtrl.view()" class="btn btn-default btn-xs">\n      <span class="glyphicon glyphicon-edit"></span>\n    </a>\n  </span>\n</div>'),$templateCache.put("breadcrumb.html",'<div class="breadcrumbs-holder" ng-init="setBasicRoute([])">\n  <ol class="breadcrumb">\n    <li ng-repeat="step in steps" type="button" ng-class="{active: $last}" href="" ng-click="loadStep(step.number)" >\n      <a href="" ng-click="loadStep(step.number)" ng-if="!$last">\n        <span class="step-num">{{step.number}}.</span>\n        <span class="step-title">{{step.title}}</span>\n      </a>\n      <span class="step-num" ng-if="$last">{{step.number}}.</span>\n      <span class="step-title" ng-if="$last">{{step.title}}</span>\n    </li>\n  </ol>\n</div>\n'),$templateCache.put("breadcrumb_complex.html",'<div class="container breadcrumbs" ng-init="setRoute([\n  {page:\'service_list\', title: \'Set a Service\'},\n  {page:\'person_list\', title: \'Pick a Person\'},\n  {page:\'day\', title: \'Select a Date\'}\n  ])">\n\n  <div class="row">\n    <tabset>\n      <tab ng-repeat="step in allSteps" heading="{{step.title}}" active="step.active" disabled="!step.passed" select="loadStep(step.number)">\n      </tab>\n    </tabset>\n\n    <div class="breadcrumbs">\n      <span ng-repeat="step in steps">\n        <a ng-if="!$last" href="" ng-click="loadStep(step.number)" class="btn default med flat">  {{step.number}}.\n        </a>\n        <div ng-if="$last" class="step">{{step.number}}. {{step.title}}</div>\n      <span>\n    </div>\n  </div>\n</div>'),$templateCache.put("check_items.html",'<div ng-controller="ItemDetails" ng-init="checkStepTitle(\'Confirm Details\')">\n  <div class="bb-booking">\n    <div class="bb-frame">\n      <div class="bb-head">\n        <h2>Your details</h2>\n      </div>\n      <form name="client_form" class="bb-form" role="form">\n        <div class="bb-node">\n          <h3>Client</h3>\n          <ul>\n            <li>\n              <label>Name:</label><span>{{client.getName()}}</span>\n            </li>\n            <li>\n              <label>Email:</label><span>{{client.email}}</span>\n            </li>\n            <li>\n              <label>Address:</label><span>{{client.addressSingleLine()}}</span>\n            </li>\n          </ul>\n        </div>\n        <div class="bb-node" ng-if="!product">\n          <h3>Booking</h3>\n            <ul>\n              <li>\n                <label>Details:</label><span>{{item.describe()}}</span>\n              </li>\n              <li>\n                <label>Date:</label>\n                <span>{{item.booking_date("dddd, MMMM Do YYYY")}}</span>\n              </li>\n              <li>\n                <label>Time:</label><span>{{item.booking_time()}}</span>\n              </li>\n              <li ng-show="item.hasPrice()">\n                <label>Price:</label><span>{{item.printed_price}}</span>\n              </li>\n            </ul>\n        </div>\n        <div class="bb-node" ng-if="product">\n          <h3>Product</h3>\n          <ul>\n            <li>\n              <label>Name:</label><span>{{product.name}}</span>\n            </li>\n          </ul>\n        </div>\n        <div ng-controller=\'CustomBookingText\' class="message-node">\n          <div ng-repeat="msg in messages">{{msg}}</div>\n        </div>\n        <div ng-show="item_details.hasQuestions" class="question-node">\n          <h3>Questions</h3>\n          <ul>\n            <li ng-repeat="question in item_details.questions"\n              bb-question-line ng-show="question.currentlyShown">\n              <label>{{question.name}}:</label> \n              <span>\n                <input bb-question="question" class="form-control"/><br/>\n                <small>{{question.help_text}}</small>\n              </span>\n            </li>\n          </ul>\n        </div>\n      </form>\n    </div>\n    <div class="bb-actions">\n      <div class="bb-prev">\n      </div>\n      <div class="bb-current">\n      </div>\n      <div class="bb-next">\n        <a href="" class="bb-btn-next" ng-disabled="!client_form.$valid"\n          ng-click="confirm(client_form)">Confirm</a>\n      </div>\n    </div>\n  </div>\n</div>\n'),$templateCache.put("checkout.html",'<div ng-controller="Checkout">\n  <div class="bb-checkout">\n\n    <div ng-show="checkoutFailed" class="bb-frame">\n      <div class="bb-head">\n        <h3>\n          I\'m sorry, for some reason this booking failed. Please Try again.\n        </h3>\n      </div>\n      <div>\n        <p>I\'m sorry, for some reason this booking failed. Please Try again.</p>\n      </div>\n    </div>\n\n    <div ng-show="total" class="bb-frame">  \n      <div class="bb-head">\n        <h2>Your details<h2>\n      </div>\n      <div class="bb-node">\n      <h3>Client Details</h3>\n        <ul>\n          <li>\n            <label>Name:</label><span>{{client.getName()}}</span>\n          </li>\n          <li>\n            <label>Email:</label><span>{{client.email}}</span>\n          </li>\n          <li>\n            <label>Address:</label><span>{{client.addressSingleLine()}}</span>\n          </li>\n        </ul>\n      </div>\n\n      <div class="bb-node">\n        <h3>Booking Confirmation Details</h3>\n        <ul class="show_list" ng-repeat="i in total.items">\n          <li>\n            <label>Service:</label><span>{{i.full_describe}}</span>\n          </li>\n          <li>\n            <label>Date/Time:</label><span>{{i.describe}}</span>\n          </li>\n        </ul>\n      </div>\n\n\n      <div class="bb-node calendar-node">\n        <h3>Export to calendar</h3>\n        <ul class="show_list" ng-repeat="i in total.items">\n          <li>\n            <label>Links :</label>\n            <span>\n              <a class="image" title="Add this booking to an Outlook Calendar" href="{{total.icalLink()}}"><img alt="" src="http://uk.bookingbug.com/assets/outlook.png"></a>\n              <a class="image" title="Export this booking to an iCal Calendar" href="{{total.webcalLink()}}"><img alt="" src="http://uk.bookingbug.com/assets/ical.png"></a>\n              <a class="image" title="Export this booking to Google Calendar" href="{{total.gcalLink()}}" target="_blank"><img src="http://uk.bookingbug.com/assets/gcal.png" border="0"></a>\n            </span>\n          </li>\n        </ul>\n      </div>\n\n      <div ng-controller=\'CustomConfirmationText\' class="message-node">\n        <div ng-repeat="msg in messages">{{msg}}</div>\n      </div>\n\n\n    </div>\n\n    <div class="bb-actions">\n      <div class="bb-prev">\n      </div>\n      <div class="bb-current">\n      </div>\n      <div class="bb-next">\n        <payment_button value="Make Payment" class="bb-btn-next"\n          ng-if="total.$has(\'new_payment\')" total="total" bb="bb"\n          decide-next-page="decideNextPage">\n        </payment_button>\n        <a href="" class="bb-btn-next" ng-click="print()">Print</a>\n      </div>\n    </div>\n\n  </div>\n</div>\n'),$templateCache.put("content_main.html",'<div ng-include="bb_main"\n      ng-hide="hide_page"\n      onload="initPage()"\n      bbContent="null">\n</div>\n'),$templateCache.put("dash.html",'<h1>Dashboard</h1>\n  <div class="dashcontainer" ng-controller="DashboardContainer" style="">\n\n  <div class="row">\n\n    <div class="col-md-4">\n      <h4>Pick a Location/Service</h4>\n\n      <div ng-controller="CompanyList" ng-init="init()">\n\n        <div class="" ng-repeat="comp in companies"  >\n          <h3>{{comp.name}}</h3>\n\n          <div ng-controller="PersonList" ng-init="init(comp)">\n\n            <a class="" ng-repeat="person in all_people"  style="margin-left:20px;font-size:14px;display:block;cursor:pointer;">\n              {{person.name}}\n            </a>\n          </div>\n        </div>\n      </div>\n\n      <div ng-show="selectedSlot">\n        <div ng-controller="SelectedSlotDetails" class="side_details">\n          <div ng-include="showItemView">\n          </div>\n        </div>\n      </div>  \n\n    </div> \n\n    <div class="col-md-8">\n\n      <div ng-controller="CalendarCtrl" ng-init="init()">\n\n        <div ui-calendar="uiConfig.calendar" ng-model="eventSources" calendar="myCalendar">\n      </div>\n\n    </div>\n  </div>\n\n\n    <div id="dialog-modal" title="" display:none;>\n      \n    </div>\n  </div>\n'),$templateCache.put("day.html",'<div bb-month-availability ng-init="checkStepTitle(\'Pick a date\')" id="day_page">\n  <div class="bb-navigation container">\n      <div class="bb-nav">\n          <a href="" class="bb-btn-prev btn btn-default pull-left" ng-click="subtract(\'months\',1)" ng-disabled="isPast()">Prev Month</a>\n          <span class="bb-date">{{format_date(\'MMMM YYYY\')}}</span>\n          <a href="" class="bb-btn-next btn btn-default pull-right" ng-click="add(\'months\',1)">Next Month</a>\n      </div>\n  </div>\n\n  <div class="bb-date-pick container">\n    <div class="bb-month-frame panel panel-default" id="frame">\n      <div class="bb-month-name panel-heading text-primary">\n        <h2>{{format_date(\'MMMM\')}}<h2>\n      </div>\n      <table class="bb-month">\n        <tr ng-repeat="week in weeks">\n          <td ng-repeat="day in week">    \n            <a href="" ng-disabled="day.off(month)" class="time-slot\n              {{day.class(month)}} btn btn-default" ng-click="selectDay(day)">\n              {{day.day()}}\n            </a>\n          </td>\n        <tr>  \n      </table>\n    </div>\n  </div>\n  \n</div>\n'),$templateCache.put("loader.html","<div class='bb-loader' ng-hide='scopeLoaded'>\n  <div id='loading_icon'>\n    <div id='wait_graphic'>&nbsp;</div>\n  </div>\n</div>"),$templateCache.put("main.html",'<div bb-breadcrumb></div>\n<div ng-show="loading"><img src=\'/BB_wait.gif\' class="loader"></div>\n<div ng-hide="loading"><div bb-content-new></div></div>\n'),$templateCache.put("service_list.html",'<div bb-services ng-init="checkStepTitle(\'Select a service\')"\n  id="service_list_page" class="bb_wrap">\n\n  <div class="bb-services bb-list">\n    <div class="bb-list-item container">\n      <div class="bb-item" ng-click="selectItem(item)" ng-repeat="item in items">\n        <div class="bb-desc form-control">\n          <div class="bb-txt col-sm-10">\n            <h5>{{item.name}}</h5>\n            <small>{{item.description}}</small>\n          </div> \n          <div class="bb-price col-sm-2 btn-default">\n            <span ng-show="item.price > 0">{{item.price | currency:"GBP"}}</span>\n            <span ng-show="item.price == 0">Free</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  \n</div>\n'),$templateCache.put("time.html",'<div bb-times ng-init="checkStepTitle(\'Select a time\')" id="time_page">\n\n  <div class="bb-navigation container">\n    <div class="bb-nav text-center">\n      <button type="button" class="bb-btn-prev btn btn-primary pull-left" ng-click="subtract(\'days\',1)">Previous Day</button>\n      <span class="bb-date">{{format_date(\'Do MMM YYYY\')}}</span>\n      <button type="button" class="bb-btn-next btn btn-primary pull-right" ng-click="add(\'days\',1)">Next Day</button>\n    </div>\n  </div>\n\n  <div>\n    <div ng-hide="slots">\n      <span class="no_value">No available times</span>\n    </div>\n    <div class="bb-times container">\n      <div class="bb-time panel panel-default">\n        <div class="clearfix">\n          <div class="time-slot col-sm-2" ng-repeat="slot in slots">\n            <button type="button" class="btn btn-default btn-block" ng-click="selectSlot(slot)">{{slot.print_time()}}</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n</div>\n'),$templateCache.put("login.html",'<div>\n  <form name="login_form" ng-submit="login()" class="form-horizontal"\n  role="form">\n    <div class="alert alert-danger" role="alert" ng-if="alert && alert.length > 0">{{alert}}</div>\n\n    <div ng-class="{\'form-group\': true}">\n      <label for="host" class="col-sm-2 control-label">Host</label>\n      <div class="col-sm-10">\n        <input type="host" ng-model="host" name="host" class="form-control"\n          id="host" placeholder="Host" required autofocus>\n      </div>\n    </div>\n\n\n    <div ng-class="{\'form-group\': true, \'has-error\': emailIsInvalid()}">\n      <label for="email" class="col-sm-2 control-label">Email</label>\n      <div class="col-sm-10">\n        <input type="email" ng-model="email" name="email" class="form-control"\n          id="email" placeholder="Email" required autofocus>\n      </div>\n    </div>\n\n    <div ng-class="{\'form-group\': true, \'has-error\': passwordIsInvalid()}">\n      <label for="password" class="col-sm-2 control-label">Password</label>\n      <div class="col-sm-10">\n        <input type="password" ng-model="password" name="password"\n          class="form-control" id="password" placeholder="Password" required>\n      </div>\n    </div>\n\n    <div class="form-group">\n      <div class="col-sm-offset-2 col-sm-10">\n        <button type="submit" class="btn btn-primary">Log In</button>\n      </div>\n    </div>\n  </form>\n\n  <div ng-if="administrators">\n    <h3>Select a company</h3>\n    <ul>\n      <li ng-repeat="admin in administrators">\n        <a ng-click="pickAdmin(admin)">{{admin.company_name}}</a>\n      </li>\n    </ul>\n  </div>\n</div>'),$templateCache.put("person_form.html",'<div class="modal-header">\n  <h3 class="modal-title">{{title}}</h3>\n</div>\n<form name="person_form" ng-submit="submit(person_form)">\n  <div class="modal-body" sf-schema="schema" sf-form="form" sf-model="person">\n  </div>\n  <div class="modal-footer">\n    <input type="submit" class="btn btn-primary" value="OK">\n    <button class="btn btn-default" ng-click="cancel($event)">Cancel</button>\n  </div>\n</form>\n'),$templateCache.put("person_table_main.html",'<button class="btn btn-default" ng-click="newPerson()">New Person</button>\n<table tr-ng-grid="" items="people">\n   <tbody>\n    <tr>\n      <td>\n        <button class="btn btn-default btn-sm"\n          ng-click="delete(gridDisplayItem.id)">\n            Delete\n        </button>\n        <button class="btn btn-default btn-sm"\n          ng-click="edit(gridDisplayItem.id)">\n            Edit\n        </button>\n        <button class="btn btn-default btn-sm"\n          ng-click="schedule(gridDisplayItem.id)">\n            Schedule\n        </button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n'),$templateCache.put("resource_form.html",'<div class="modal-header">\n  <h3 class="modal-title">{{title}}</h3>\n</div>\n<form name="resource_form" ng-submit="submit(resource_form)">\n  <div class="modal-body" sf-schema="schema" sf-form="form" sf-model="resource">\n  </div>\n  <div class="modal-footer">\n    <input type="submit" class="btn btn-primary" value="OK">\n    <button class="btn btn-default" ng-click="cancel($event)">Cancel</button>\n  </div>\n</form>\n'),$templateCache.put("resource_table_main.html",'<button class="btn btn-default" ng-click="newResource()">New Resource</button>\n<table tr-ng-grid="" items="resources">\n   <tbody>\n    <tr>\n      <td>\n        <button class="btn btn-default btn-sm"\n          ng-click="delete(gridDisplayItem.id)">\n            Delete\n        </button>\n        <button class="btn btn-default btn-sm"\n          ng-click="edit(gridDisplayItem.id)">\n            Edit\n        </button>\n        <button class="btn btn-default btn-sm"\n          ng-click="schedule(gridDisplayItem.id)">\n            Schedule\n        </button>\n      </td>\n    </tr>\n  </tbody>\n</table>'),$templateCache.put("schedule_edit_form.html",'<div class="form-group" ng-class="{\'has-error\': hasError()}">\n  <label class="control-label" ng-show="showTitle()">{{form.title}}</label>\n\n  <div schedule-edit ng-model="$$value$$"></div>\n\n  <span class="help-block">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span>\n</div>\n'),$templateCache.put("schedule_edit_main.html",'<table>\n  <thead>\n    <tr>\n      <th><!--empty cell--></th>\n      <th ng-repeat="date in dates">{{date | dayName}}</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="hour in hours" ng-init="$last ? lastHour() : null">\n      <td class="hour-label">{{hour | hourName}}</td>\n      <td class="eng-item" ng-repeat="date in dates" ng-init="$last ? lastDate() : null" id="{{date}}|{{hour}}"></td>\n    </tr>\n  </tbody>\n</table>\n\n'),$templateCache.put("schedule_table_main.html",'<button class="btn btn-default" ng-click="newSchedule()">New Schedule</button>\n<table tr-ng-grid="" items="schedules">\n   <tbody>\n    <tr>\n      <td>\n        <button class="btn btn-default btn-sm"\n          ng-click="delete(gridDisplayItem.id)">\n            Delete\n        </button>\n        <button class="btn btn-default btn-sm"\n          ng-click="edit(gridDisplayItem.id)">\n            Edit\n        </button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n'),$templateCache.put("service_form.html",'<div class="modal-header">\n	<h3 class="modal-title">{{title}}</h3>\n</div>\n<form name="service_form" ng-submit="submit(service_form)">\n	<div class="modal-body" sf-schema="schema" sf-form="form" sf-model="service"></div>\n	<div class="modal-footer">\n		<input type="submit" class="btn btn-primary" value="OK">\n		<button class="btn btn-default" ng-click="cancel($event)">Cancel</button>\n	</div>\n</form>'),$templateCache.put("service_table_main.html",'<button class="btn btn-default" ng-click="newService()">New Service</button>\n<table tr-ng-grid="" items="services">\n	<tbody>\n		<tr>\n			<td>\n				<button class="btn btn-default btn-sm" ng-click="edit(gridDisplayItem.id)">Edit</button>\n			</td>\n		</tr>\n	</tbody>\n</table>'),$templateCache.put("admin_form.html",'<div class="modal-header">\n  <h3 class="modal-title">{{title}}</h3>\n</div>\n<form name="administrator_form" ng-submit="submit(administrator_form)">\n  <div class="modal-body" sf-schema="schema" sf-form="form" sf-model="admin"></div>\n  <div class="modal-footer">\n    <input type="submit" class="btn btn-primary" value="OK">\n    <button class="btn btn-default" ng-click="cancel($event)">Cancel</button>\n  </div>\n</form>'),$templateCache.put("admin_table_main.html",'<button class="btn btn-default" ng-click="newAdministrator()">New Administrator</button>\n<table tr-ng-grid="" items="administrators">\n   <tbody>\n    <tr>\n      <td>\n        <button class="btn btn-default btn-sm" ng-click="edit(gridDisplayItem.id)">Edit</button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]);